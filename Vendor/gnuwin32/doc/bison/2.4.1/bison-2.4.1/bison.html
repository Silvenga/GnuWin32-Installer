<html lang="en">
<head>
<title>Bison 2.4.1</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Bison 2.4.1">
<meta name="generator" content="makeinfo 4.7">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual (19 November 2008) is for GNU Bison (version
2.4.1), the GNU parser generator.

Copyright (C) 1988, 1989, 1990, 1991, 1992, 1993, 1995, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software
Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover texts
     being "A GNU Manual," and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     "GNU Free Documentation License."

     (a) The FSF's Back-Cover Text is: "You have the freedom to copy and
     modify this GNU manual.  Buying copies from the FSF supports it in
     developing GNU and promoting software freedom."
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc { font-variant:small-caps }
  span.roman { font-family: serif; font-weight: normal; } 
--></style>
</head>
<body>
<h1 class="settitle">Bison 2.4.1</h1>
   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">Bison</a>
<li><a name="toc_Introduction" href="#Introduction">Introduction</a>
<li><a name="toc_Conditions" href="#Conditions">Conditions for Using Bison</a>
<li><a name="toc_Copying" href="#Copying">GNU GENERAL PUBLIC LICENSE</a>
<li><a name="toc_Concepts" href="#Concepts">1 The Concepts of Bison</a>
<ul>
<li><a href="#Language-and-Grammar">1.1 Languages and Context-Free Grammars</a>
<li><a href="#Grammar-in-Bison">1.2 From Formal Rules to Bison Input</a>
<li><a href="#Semantic-Values">1.3 Semantic Values</a>
<li><a href="#Semantic-Actions">1.4 Semantic Actions</a>
<li><a href="#GLR-Parsers">1.5 Writing <acronym>GLR</acronym> Parsers</a>
<ul>
<li><a href="#Simple-GLR-Parsers">1.5.1 Using <acronym>GLR</acronym> on Unambiguous Grammars</a>
<li><a href="#Merging-GLR-Parses">1.5.2 Using <acronym>GLR</acronym> to Resolve Ambiguities</a>
<li><a href="#GLR-Semantic-Actions">1.5.3 GLR Semantic Actions</a>
<li><a href="#Compiler-Requirements">1.5.4 Considerations when Compiling <acronym>GLR</acronym> Parsers</a>
</li></ul>
<li><a href="#Locations-Overview">1.6 Locations</a>
<li><a href="#Bison-Parser">1.7 Bison Output: the Parser File</a>
<li><a href="#Stages">1.8 Stages in Using Bison</a>
<li><a href="#Grammar-Layout">1.9 The Overall Layout of a Bison Grammar</a>
</li></ul>
<li><a name="toc_Examples" href="#Examples">2 Examples</a>
<ul>
<li><a href="#RPN-Calc">2.1 Reverse Polish Notation Calculator</a>
<ul>
<li><a href="#Rpcalc-Declarations">2.1.1 Declarations for <code>rpcalc</code></a>
<li><a href="#Rpcalc-Rules">2.1.2 Grammar Rules for <code>rpcalc</code></a>
<ul>
<li><a href="#Rpcalc-Input">2.1.2.1 Explanation of <code>input</code></a>
<li><a href="#Rpcalc-Line">2.1.2.2 Explanation of <code>line</code></a>
<li><a href="#Rpcalc-Expr">2.1.2.3 Explanation of <code>expr</code></a>
</li></ul>
<li><a href="#Rpcalc-Lexer">2.1.3 The <code>rpcalc</code> Lexical Analyzer</a>
<li><a href="#Rpcalc-Main">2.1.4 The Controlling Function</a>
<li><a href="#Rpcalc-Error">2.1.5 The Error Reporting Routine</a>
<li><a href="#Rpcalc-Generate">2.1.6 Running Bison to Make the Parser</a>
<li><a href="#Rpcalc-Compile">2.1.7 Compiling the Parser File</a>
</li></ul>
<li><a href="#Infix-Calc">2.2 Infix Notation Calculator: <code>calc</code></a>
<li><a href="#Simple-Error-Recovery">2.3 Simple Error Recovery</a>
<li><a href="#Location-Tracking-Calc">2.4 Location Tracking Calculator: <code>ltcalc</code></a>
<ul>
<li><a href="#Ltcalc-Declarations">2.4.1 Declarations for <code>ltcalc</code></a>
<li><a href="#Ltcalc-Rules">2.4.2 Grammar Rules for <code>ltcalc</code></a>
<li><a href="#Ltcalc-Lexer">2.4.3 The <code>ltcalc</code> Lexical Analyzer.</a>
</li></ul>
<li><a href="#Multi_002dfunction-Calc">2.5 Multi-Function Calculator: <code>mfcalc</code></a>
<ul>
<li><a href="#Mfcalc-Declarations">2.5.1 Declarations for <code>mfcalc</code></a>
<li><a href="#Mfcalc-Rules">2.5.2 Grammar Rules for <code>mfcalc</code></a>
<li><a href="#Mfcalc-Symbol-Table">2.5.3 The <code>mfcalc</code> Symbol Table</a>
</li></ul>
<li><a href="#Exercises">2.6 Exercises</a>
</li></ul>
<li><a name="toc_Grammar-File" href="#Grammar-File">3 Bison Grammar Files</a>
<ul>
<li><a href="#Grammar-Outline">3.1 Outline of a Bison Grammar</a>
<ul>
<li><a href="#Prologue">3.1.1 The prologue</a>
<li><a href="#Prologue-Alternatives">3.1.2 Prologue Alternatives</a>
<li><a href="#Bison-Declarations">3.1.3 The Bison Declarations Section</a>
<li><a href="#Grammar-Rules">3.1.4 The Grammar Rules Section</a>
<li><a href="#Epilogue">3.1.5 The epilogue</a>
</li></ul>
<li><a href="#Symbols">3.2 Symbols, Terminal and Nonterminal</a>
<li><a href="#Rules">3.3 Syntax of Grammar Rules</a>
<li><a href="#Recursion">3.4 Recursive Rules</a>
<li><a href="#Semantics">3.5 Defining Language Semantics</a>
<ul>
<li><a href="#Value-Type">3.5.1 Data Types of Semantic Values</a>
<li><a href="#Multiple-Types">3.5.2 More Than One Value Type</a>
<li><a href="#Actions">3.5.3 Actions</a>
<li><a href="#Action-Types">3.5.4 Data Types of Values in Actions</a>
<li><a href="#Mid_002dRule-Actions">3.5.5 Actions in Mid-Rule</a>
</li></ul>
<li><a href="#Locations">3.6 Tracking Locations</a>
<ul>
<li><a href="#Location-Type">3.6.1 Data Type of Locations</a>
<li><a href="#Actions-and-Locations">3.6.2 Actions and Locations</a>
<li><a href="#Location-Default-Action">3.6.3 Default Action for Locations</a>
</li></ul>
<li><a href="#Declarations">3.7 Bison Declarations</a>
<ul>
<li><a href="#Require-Decl">3.7.1 Require a Version of Bison</a>
<li><a href="#Token-Decl">3.7.2 Token Type Names</a>
<li><a href="#Precedence-Decl">3.7.3 Operator Precedence</a>
<li><a href="#Union-Decl">3.7.4 The Collection of Value Types</a>
<li><a href="#Type-Decl">3.7.5 Nonterminal Symbols</a>
<li><a href="#Initial-Action-Decl">3.7.6 Performing Actions before Parsing</a>
<li><a href="#Destructor-Decl">3.7.7 Freeing Discarded Symbols</a>
<li><a href="#Expect-Decl">3.7.8 Suppressing Conflict Warnings</a>
<li><a href="#Start-Decl">3.7.9 The Start-Symbol</a>
<li><a href="#Pure-Decl">3.7.10 A Pure (Reentrant) Parser</a>
<li><a href="#Push-Decl">3.7.11 A Push Parser</a>
<li><a href="#Decl-Summary">3.7.12 Bison Declaration Summary</a>
</li></ul>
<li><a href="#Multiple-Parsers">3.8 Multiple Parsers in the Same Program</a>
</li></ul>
<li><a name="toc_Interface" href="#Interface">4 Parser C-Language Interface</a>
<ul>
<li><a href="#Parser-Function">4.1 The Parser Function <code>yyparse</code></a>
<li><a href="#Push-Parser-Function">4.2 The Push Parser Function <code>yypush_parse</code></a>
<li><a href="#Pull-Parser-Function">4.3 The Pull Parser Function <code>yypull_parse</code></a>
<li><a href="#Parser-Create-Function">4.4 The Parser Create Function <code>yystate_new</code></a>
<li><a href="#Parser-Delete-Function">4.5 The Parser Delete Function <code>yystate_delete</code></a>
<li><a href="#Lexical">4.6 The Lexical Analyzer Function <code>yylex</code></a>
<ul>
<li><a href="#Calling-Convention">4.6.1 Calling Convention for <code>yylex</code></a>
<li><a href="#Token-Values">4.6.2 Semantic Values of Tokens</a>
<li><a href="#Token-Locations">4.6.3 Textual Locations of Tokens</a>
<li><a href="#Pure-Calling">4.6.4 Calling Conventions for Pure Parsers</a>
</li></ul>
<li><a href="#Error-Reporting">4.7 The Error Reporting Function <code>yyerror</code></a>
<li><a href="#Action-Features">4.8 Special Features for Use in Actions</a>
<li><a href="#Internationalization">4.9 Parser Internationalization</a>
</li></ul>
<li><a name="toc_Algorithm" href="#Algorithm">5 The Bison Parser Algorithm</a>
<ul>
<li><a href="#Lookahead">5.1 Lookahead Tokens</a>
<li><a href="#Shift_002fReduce">5.2 Shift/Reduce Conflicts</a>
<li><a href="#Precedence">5.3 Operator Precedence</a>
<ul>
<li><a href="#Why-Precedence">5.3.1 When Precedence is Needed</a>
<li><a href="#Using-Precedence">5.3.2 Specifying Operator Precedence</a>
<li><a href="#Precedence-Examples">5.3.3 Precedence Examples</a>
<li><a href="#How-Precedence">5.3.4 How Precedence Works</a>
</li></ul>
<li><a href="#Contextual-Precedence">5.4 Context-Dependent Precedence</a>
<li><a href="#Parser-States">5.5 Parser States</a>
<li><a href="#Reduce_002fReduce">5.6 Reduce/Reduce Conflicts</a>
<li><a href="#Mystery-Conflicts">5.7 Mysterious Reduce/Reduce Conflicts</a>
<li><a href="#Generalized-LR-Parsing">5.8 Generalized <acronym>LR</acronym> (<acronym>GLR</acronym>) Parsing</a>
<li><a href="#Memory-Management">5.9 Memory Management, and How to Avoid Memory Exhaustion</a>
</li></ul>
<li><a name="toc_Error-Recovery" href="#Error-Recovery">6 Error Recovery</a>
<li><a name="toc_Context-Dependency" href="#Context-Dependency">7 Handling Context Dependencies</a>
<ul>
<li><a href="#Semantic-Tokens">7.1 Semantic Info in Token Types</a>
<li><a href="#Lexical-Tie_002dins">7.2 Lexical Tie-ins</a>
<li><a href="#Tie_002din-Recovery">7.3 Lexical Tie-ins and Error Recovery</a>
</li></ul>
<li><a name="toc_Debugging" href="#Debugging">8 Debugging Your Parser</a>
<ul>
<li><a href="#Understanding">8.1 Understanding Your Parser</a>
<li><a href="#Tracing">8.2 Tracing Your Parser</a>
</li></ul>
<li><a name="toc_Invocation" href="#Invocation">9 Invoking Bison</a>
<ul>
<li><a href="#Bison-Options">9.1 Bison Options</a>
<li><a href="#Option-Cross-Key">9.2 Option Cross Key</a>
<li><a href="#Yacc-Library">9.3 Yacc Library</a>
</li></ul>
<li><a name="toc_Other-Languages" href="#Other-Languages">10 Parsers Written In Other Languages</a>
<ul>
<li><a href="#C_002b_002b-Parsers">10.1 C++ Parsers</a>
<ul>
<li><a href="#C_002b_002b-Bison-Interface">10.1.1 C++ Bison Interface</a>
<li><a href="#C_002b_002b-Semantic-Values">10.1.2 C++ Semantic Values</a>
<li><a href="#C_002b_002b-Location-Values">10.1.3 C++ Location Values</a>
<li><a href="#C_002b_002b-Parser-Interface">10.1.4 C++ Parser Interface</a>
<li><a href="#C_002b_002b-Scanner-Interface">10.1.5 C++ Scanner Interface</a>
<li><a href="#A-Complete-C_002b_002b-Example">10.1.6 A Complete C++ Example</a>
<ul>
<li><a href="#Calc_002b_002b-_002d_002d_002d-C_002b_002b-Calculator">10.1.6.1 Calc++ &mdash; C++ Calculator</a>
<li><a href="#Calc_002b_002b-Parsing-Driver">10.1.6.2 Calc++ Parsing Driver</a>
<li><a href="#Calc_002b_002b-Parser">10.1.6.3 Calc++ Parser</a>
<li><a href="#Calc_002b_002b-Scanner">10.1.6.4 Calc++ Scanner</a>
<li><a href="#Calc_002b_002b-Top-Level">10.1.6.5 Calc++ Top Level</a>
</li></ul>
</li></ul>
<li><a href="#Java-Parsers">10.2 Java Parsers</a>
<ul>
<li><a href="#Java-Bison-Interface">10.2.1 Java Bison Interface</a>
<li><a href="#Java-Semantic-Values">10.2.2 Java Semantic Values</a>
<li><a href="#Java-Location-Values">10.2.3 Java Location Values</a>
<li><a href="#Java-Parser-Interface">10.2.4 Java Parser Interface</a>
<li><a href="#Java-Scanner-Interface">10.2.5 Java Scanner Interface</a>
<li><a href="#Java-Action-Features">10.2.6 Special Features for Use in Java Actions</a>
<li><a href="#Java-Differences">10.2.7 Differences between C/C++ and Java Grammars</a>
<li><a href="#Java-Declarations-Summary">10.2.8 Java Declarations Summary</a>
</li></ul>
</li></ul>
<li><a name="toc_FAQ" href="#FAQ">11 Frequently Asked Questions</a>
<ul>
<li><a href="#Memory-Exhausted">11.1 Memory Exhausted</a>
<li><a href="#How-Can-I-Reset-the-Parser">11.2 How Can I Reset the Parser</a>
<li><a href="#Strings-are-Destroyed">11.3 Strings are Destroyed</a>
<li><a href="#Implementing-Gotos_002fLoops">11.4 Implementing Gotos/Loops</a>
<li><a href="#Multiple-start_002dsymbols">11.5 Multiple start-symbols</a>
<li><a href="#Secure_003f-Conform_003f">11.6 Secure?  Conform?</a>
<li><a href="#I-can_0027t-build-Bison">11.7 I can't build Bison</a>
<li><a href="#Where-can-I-find-help_003f">11.8 Where can I find help?</a>
<li><a href="#Bug-Reports">11.9 Bug Reports</a>
<li><a href="#More-Languages">11.10 More Languages</a>
<li><a href="#Beta-Testing">11.11 Beta Testing</a>
<li><a href="#Mailing-Lists">11.12 Mailing Lists</a>
</li></ul>
<li><a name="toc_Table-of-Symbols" href="#Table-of-Symbols">Appendix A Bison Symbols</a>
<li><a name="toc_Glossary" href="#Glossary">Appendix B Glossary</a>
<li><a name="toc_Copying-This-Manual" href="#Copying-This-Manual">Appendix C Copying This Manual</a>
<li><a name="toc_Index" href="#Index">Index</a>
</li></ul>
</div>



<div class="node">
<p><hr>
<a name="Top"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>
<br>
</div>

<h2 class="unnumbered">Bison</h2>

<p>This manual (19 November 2008) is for <acronym>GNU</acronym> Bison (version
2.4.1), the <acronym>GNU</acronym> parser generator.

   <p>Copyright &copy; 1988, 1989, 1990, 1991, 1992, 1993, 1995, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software
Foundation, Inc.

   <blockquote>
Permission is granted to copy, distribute and/or modify this document
under the terms of the <acronym>GNU</acronym> Free Documentation License,
Version 1.2 or any later version published by the Free Software
Foundation; with no Invariant Sections, with the Front-Cover texts
being &ldquo;A <acronym>GNU</acronym> Manual,&rdquo; and with the Back-Cover Texts as in
(a) below.  A copy of the license is included in the section entitled
&ldquo;<acronym>GNU</acronym> Free Documentation License.&rdquo;

        <p>(a) The FSF's Back-Cover Text is: &ldquo;You have the freedom to copy and
modify this <acronym>GNU</acronym> manual.  Buying copies from the <acronym>FSF</acronym>
supports it in developing <acronym>GNU</acronym> and promoting software
freedom.&rdquo;
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#Introduction">Introduction</a>
<li><a accesskey="2" href="#Conditions">Conditions</a>
<li><a accesskey="3" href="#Copying">Copying</a>:              The <acronym>GNU</acronym> General Public License says
                          how you can copy and share Bison.

</li></ul>
<p>Tutorial sections:
</p>
<ul class="menu">
<li><a accesskey="4" href="#Concepts">Concepts</a>:             Basic concepts for understanding Bison. 
<li><a accesskey="5" href="#Examples">Examples</a>:             Three simple explained examples of using Bison.

</li></ul>
<p>Reference sections:
</p>
<ul class="menu">
<li><a accesskey="6" href="#Grammar-File">Grammar File</a>:         Writing Bison declarations and rules. 
<li><a accesskey="7" href="#Interface">Interface</a>:            C-language interface to the parser function <code>yyparse</code>. 
<li><a accesskey="8" href="#Algorithm">Algorithm</a>:            How the Bison parser works at run-time. 
<li><a accesskey="9" href="#Error-Recovery">Error Recovery</a>:       Writing rules for error recovery. 
<li><a href="#Context-Dependency">Context Dependency</a>:   What to do if your language syntax is too
                          messy for Bison to handle straightforwardly. 
<li><a href="#Debugging">Debugging</a>:            Understanding or debugging Bison parsers. 
<li><a href="#Invocation">Invocation</a>:           How to run Bison (to produce the parser source file). 
<li><a href="#Other-Languages">Other Languages</a>:      Creating C++ and Java parsers. 
<li><a href="#FAQ">FAQ</a>:                  Frequently Asked Questions
<li><a href="#Table-of-Symbols">Table of Symbols</a>:     All the keywords of the Bison language are explained. 
<li><a href="#Glossary">Glossary</a>:             Basic concepts are explained. 
<li><a href="#Copying-This-Manual">Copying This Manual</a>:  License for copying this manual. 
<li><a href="#Index">Index</a>:                Cross-references to the text.

</li></ul>
<p>--- The Detailed Node Listing ---

<p>The Concepts of Bison

</p>
<ul class="menu">
<li><a href="#Language-and-Grammar">Language and Grammar</a>:  Languages and context-free grammars,
                           as mathematical ideas. 
<li><a href="#Grammar-in-Bison">Grammar in Bison</a>:      How we represent grammars for Bison's sake. 
<li><a href="#Semantic-Values">Semantic Values</a>:       Each token or syntactic grouping can have
                           a semantic value (the value of an integer,
                           the name of an identifier, etc.). 
<li><a href="#Semantic-Actions">Semantic Actions</a>:      Each rule can have an action containing C code. 
<li><a href="#GLR-Parsers">GLR Parsers</a>:           Writing parsers for general context-free languages. 
<li><a href="#Locations-Overview">Locations Overview</a>:    Tracking Locations. 
<li><a href="#Bison-Parser">Bison Parser</a>:          What are Bison's input and output,
                           how is the output used? 
<li><a href="#Stages">Stages</a>:                Stages in writing and running Bison grammars. 
<li><a href="#Grammar-Layout">Grammar Layout</a>:        Overall structure of a Bison grammar file.

</li></ul>
<p>Writing <acronym>GLR</acronym> Parsers

</p>
<ul class="menu">
<li><a href="#Simple-GLR-Parsers">Simple GLR Parsers</a>:      Using <acronym>GLR</acronym> parsers on unambiguous grammars. 
<li><a href="#Merging-GLR-Parses">Merging GLR Parses</a>:      Using <acronym>GLR</acronym> parsers to resolve ambiguities. 
<li><a href="#GLR-Semantic-Actions">GLR Semantic Actions</a>:    Deferred semantic actions have special concerns. 
<li><a href="#Compiler-Requirements">Compiler Requirements</a>:   <acronym>GLR</acronym> parsers require a modern C compiler.

</li></ul>
<p>Examples

</p>
<ul class="menu">
<li><a href="#RPN-Calc">RPN Calc</a>:                Reverse polish notation calculator;
                             a first example with no operator precedence. 
<li><a href="#Infix-Calc">Infix Calc</a>:              Infix (algebraic) notation calculator. 
                             Operator precedence is introduced. 
<li><a href="#Simple-Error-Recovery">Simple Error Recovery</a>:   Continuing after syntax errors. 
<li><a href="#Location-Tracking-Calc">Location Tracking Calc</a>:  Demonstrating the use of @<var>n</var> and @$. 
<li><a href="#Multi_002dfunction-Calc">Multi-function Calc</a>:     Calculator with memory and trig functions. 
                             It uses multiple data-types for semantic values. 
<li><a href="#Exercises">Exercises</a>:               Ideas for improving the multi-function calculator.

</li></ul>
<p>Reverse Polish Notation Calculator

</p>
<ul class="menu">
<li><a href="#Rpcalc-Declarations">Rpcalc Declarations</a>:     Prologue (declarations) for rpcalc. 
<li><a href="#Rpcalc-Rules">Rpcalc Rules</a>:            Grammar Rules for rpcalc, with explanation. 
<li><a href="#Rpcalc-Lexer">Rpcalc Lexer</a>:            The lexical analyzer. 
<li><a href="#Rpcalc-Main">Rpcalc Main</a>:             The controlling function. 
<li><a href="#Rpcalc-Error">Rpcalc Error</a>:            The error reporting function. 
<li><a href="#Rpcalc-Generate">Rpcalc Generate</a>:         Running Bison on the grammar file. 
<li><a href="#Rpcalc-Compile">Rpcalc Compile</a>:          Run the C compiler on the output code.

</li></ul>
<p>Grammar Rules for <code>rpcalc</code>

</p>
<ul class="menu">
<li><a href="#Rpcalc-Input">Rpcalc Input</a>
<li><a href="#Rpcalc-Line">Rpcalc Line</a>
<li><a href="#Rpcalc-Expr">Rpcalc Expr</a>

</li></ul>
<p>Location Tracking Calculator: <code>ltcalc</code>

</p>
<ul class="menu">
<li><a href="#Ltcalc-Declarations">Ltcalc Declarations</a>:     Bison and C declarations for ltcalc. 
<li><a href="#Ltcalc-Rules">Ltcalc Rules</a>:            Grammar rules for ltcalc, with explanations. 
<li><a href="#Ltcalc-Lexer">Ltcalc Lexer</a>:            The lexical analyzer.

</li></ul>
<p>Multi-Function Calculator: <code>mfcalc</code>

</p>
<ul class="menu">
<li><a href="#Mfcalc-Declarations">Mfcalc Declarations</a>:     Bison declarations for multi-function calculator. 
<li><a href="#Mfcalc-Rules">Mfcalc Rules</a>:            Grammar rules for the calculator. 
<li><a href="#Mfcalc-Symbol-Table">Mfcalc Symbol Table</a>:     Symbol table management subroutines.

</li></ul>
<p>Bison Grammar Files

</p>
<ul class="menu">
<li><a href="#Grammar-Outline">Grammar Outline</a>:    Overall layout of the grammar file. 
<li><a href="#Symbols">Symbols</a>:            Terminal and nonterminal symbols. 
<li><a href="#Rules">Rules</a>:              How to write grammar rules. 
<li><a href="#Recursion">Recursion</a>:          Writing recursive rules. 
<li><a href="#Semantics">Semantics</a>:          Semantic values and actions. 
<li><a href="#Locations">Locations</a>:          Locations and actions. 
<li><a href="#Declarations">Declarations</a>:       All kinds of Bison declarations are described here. 
<li><a href="#Multiple-Parsers">Multiple Parsers</a>:   Putting more than one Bison parser in one program.

</li></ul>
<p>Outline of a Bison Grammar

</p>
<ul class="menu">
<li><a href="#Prologue">Prologue</a>:               Syntax and usage of the prologue. 
<li><a href="#Prologue-Alternatives">Prologue Alternatives</a>:  Syntax and usage of alternatives to the prologue. 
<li><a href="#Bison-Declarations">Bison Declarations</a>:     Syntax and usage of the Bison declarations section. 
<li><a href="#Grammar-Rules">Grammar Rules</a>:          Syntax and usage of the grammar rules section. 
<li><a href="#Epilogue">Epilogue</a>:               Syntax and usage of the epilogue.

</li></ul>
<p>Defining Language Semantics

</p>
<ul class="menu">
<li><a href="#Value-Type">Value Type</a>:         Specifying one data type for all semantic values. 
<li><a href="#Multiple-Types">Multiple Types</a>:     Specifying several alternative data types. 
<li><a href="#Actions">Actions</a>:            An action is the semantic definition of a grammar rule. 
<li><a href="#Action-Types">Action Types</a>:       Specifying data types for actions to operate on. 
<li><a href="#Mid_002dRule-Actions">Mid-Rule Actions</a>:   Most actions go at the end of a rule. 
                      This says when, why and how to use the exceptional
                        action in the middle of a rule.

</li></ul>
<p>Tracking Locations

</p>
<ul class="menu">
<li><a href="#Location-Type">Location Type</a>:                Specifying a data type for locations. 
<li><a href="#Actions-and-Locations">Actions and Locations</a>:        Using locations in actions. 
<li><a href="#Location-Default-Action">Location Default Action</a>:      Defining a general way to compute locations.

</li></ul>
<p>Bison Declarations

</p>
<ul class="menu">
<li><a href="#Require-Decl">Require Decl</a>:       Requiring a Bison version. 
<li><a href="#Token-Decl">Token Decl</a>:         Declaring terminal symbols. 
<li><a href="#Precedence-Decl">Precedence Decl</a>:    Declaring terminals with precedence and associativity. 
<li><a href="#Union-Decl">Union Decl</a>:         Declaring the set of all semantic value types. 
<li><a href="#Type-Decl">Type Decl</a>:          Declaring the choice of type for a nonterminal symbol. 
<li><a href="#Initial-Action-Decl">Initial Action Decl</a>:   Code run before parsing starts. 
<li><a href="#Destructor-Decl">Destructor Decl</a>:    Declaring how symbols are freed. 
<li><a href="#Expect-Decl">Expect Decl</a>:        Suppressing warnings about parsing conflicts. 
<li><a href="#Start-Decl">Start Decl</a>:         Specifying the start symbol. 
<li><a href="#Pure-Decl">Pure Decl</a>:          Requesting a reentrant parser. 
<li><a href="#Push-Decl">Push Decl</a>:          Requesting a push parser. 
<li><a href="#Decl-Summary">Decl Summary</a>:       Table of all Bison declarations.

</li></ul>
<p>Parser C-Language Interface

</p>
<ul class="menu">
<li><a href="#Parser-Function">Parser Function</a>:          How to call <code>yyparse</code> and what it returns. 
<li><a href="#Push-Parser-Function">Push Parser Function</a>:     How to call <code>yypush_parse</code> and what it returns. 
<li><a href="#Pull-Parser-Function">Pull Parser Function</a>:     How to call <code>yypull_parse</code> and what it returns. 
<li><a href="#Parser-Create-Function">Parser Create Function</a>:   How to call <code>yypstate_new</code> and what it returns. 
<li><a href="#Parser-Delete-Function">Parser Delete Function</a>:   How to call <code>yypstate_delete</code> and what it returns. 
<li><a href="#Lexical">Lexical</a>:                  You must supply a function <code>yylex</code>
                              which reads tokens. 
<li><a href="#Error-Reporting">Error Reporting</a>:          You must supply a function <code>yyerror</code>. 
<li><a href="#Action-Features">Action Features</a>:          Special features for use in actions. 
<li><a href="#Internationalization">Internationalization</a>:     How to let the parser speak in the user's
                              native language.

</li></ul>
<p>The Lexical Analyzer Function <code>yylex</code>

</p>
<ul class="menu">
<li><a href="#Calling-Convention">Calling Convention</a>:   How <code>yyparse</code> calls <code>yylex</code>. 
<li><a href="#Token-Values">Token Values</a>:         How <code>yylex</code> must return the semantic value
                          of the token it has read. 
<li><a href="#Token-Locations">Token Locations</a>:      How <code>yylex</code> must return the text location
                          (line number, etc.) of the token, if the
                          actions want that. 
<li><a href="#Pure-Calling">Pure Calling</a>:         How the calling convention differs in a pure parser
                          (see <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>).

</li></ul>
<p>The Bison Parser Algorithm

</p>
<ul class="menu">
<li><a href="#Lookahead">Lookahead</a>:          Parser looks one token ahead when deciding what to do. 
<li><a href="#Shift_002fReduce">Shift/Reduce</a>:       Conflicts: when either shifting or reduction is valid. 
<li><a href="#Precedence">Precedence</a>:         Operator precedence works by resolving conflicts. 
<li><a href="#Contextual-Precedence">Contextual Precedence</a>:   When an operator's precedence depends on context. 
<li><a href="#Parser-States">Parser States</a>:      The parser is a finite-state-machine with stack. 
<li><a href="#Reduce_002fReduce">Reduce/Reduce</a>:      When two rules are applicable in the same situation. 
<li><a href="#Mystery-Conflicts">Mystery Conflicts</a>:  Reduce/reduce conflicts that look unjustified. 
<li><a href="#Generalized-LR-Parsing">Generalized LR Parsing</a>:   Parsing arbitrary context-free grammars. 
<li><a href="#Memory-Management">Memory Management</a>:  What happens when memory is exhausted.  How to avoid it.

</li></ul>
<p>Operator Precedence

</p>
<ul class="menu">
<li><a href="#Why-Precedence">Why Precedence</a>:     An example showing why precedence is needed. 
<li><a href="#Using-Precedence">Using Precedence</a>:   How to specify precedence in Bison grammars. 
<li><a href="#Precedence-Examples">Precedence Examples</a>:   How these features are used in the previous example. 
<li><a href="#How-Precedence">How Precedence</a>:     How they work.

</li></ul>
<p>Handling Context Dependencies

</p>
<ul class="menu">
<li><a href="#Semantic-Tokens">Semantic Tokens</a>:    Token parsing can depend on the semantic context. 
<li><a href="#Lexical-Tie_002dins">Lexical Tie-ins</a>:    Token parsing can depend on the syntactic context. 
<li><a href="#Tie_002din-Recovery">Tie-in Recovery</a>:    Lexical tie-ins have implications for how
                        error recovery rules must be written.

</li></ul>
<p>Debugging Your Parser

</p>
<ul class="menu">
<li><a href="#Understanding">Understanding</a>:      Understanding the structure of your parser. 
<li><a href="#Tracing">Tracing</a>:            Tracing the execution of your parser.

</li></ul>
<p>Invoking Bison

</p>
<ul class="menu">
<li><a href="#Bison-Options">Bison Options</a>:      All the options described in detail,
                        in alphabetical order by short options. 
<li><a href="#Option-Cross-Key">Option Cross Key</a>:   Alphabetical list of long options. 
<li><a href="#Yacc-Library">Yacc Library</a>:       Yacc-compatible <code>yylex</code> and <code>main</code>.

</li></ul>
<p>Parsers Written In Other Languages

</p>
<ul class="menu">
<li><a href="#C_002b_002b-Parsers">C++ Parsers</a>:                  The interface to generate C++ parser classes
<li><a href="#Java-Parsers">Java Parsers</a>:                 The interface to generate Java parser classes

</li></ul>
<p>C++ Parsers

</p>
<ul class="menu">
<li><a href="#C_002b_002b-Bison-Interface">C++ Bison Interface</a>:          Asking for C++ parser generation
<li><a href="#C_002b_002b-Semantic-Values">C++ Semantic Values</a>:          %union vs. C++
<li><a href="#C_002b_002b-Location-Values">C++ Location Values</a>:          The position and location classes
<li><a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a>:         Instantiating and running the parser
<li><a href="#C_002b_002b-Scanner-Interface">C++ Scanner Interface</a>:        Exchanges between yylex and parse
<li><a href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>:       Demonstrating their use

</li></ul>
<p>A Complete C++ Example

</p>
<ul class="menu">
<li><a href="#Calc_002b_002b-_002d_002d_002d-C_002b_002b-Calculator">Calc++ --- C++ Calculator</a>:    The specifications
<li><a href="#Calc_002b_002b-Parsing-Driver">Calc++ Parsing Driver</a>:        An active parsing context
<li><a href="#Calc_002b_002b-Parser">Calc++ Parser</a>:                A parser class
<li><a href="#Calc_002b_002b-Scanner">Calc++ Scanner</a>:               A pure C++ Flex scanner
<li><a href="#Calc_002b_002b-Top-Level">Calc++ Top Level</a>:             Conducting the band

</li></ul>
<p>Java Parsers

</p>
<ul class="menu">
<li><a href="#Java-Bison-Interface">Java Bison Interface</a>:         Asking for Java parser generation
<li><a href="#Java-Semantic-Values">Java Semantic Values</a>:         %type and %token vs. Java
<li><a href="#Java-Location-Values">Java Location Values</a>:         The position and location classes
<li><a href="#Java-Parser-Interface">Java Parser Interface</a>:        Instantiating and running the parser
<li><a href="#Java-Scanner-Interface">Java Scanner Interface</a>:       Specifying the scanner for the parser
<li><a href="#Java-Action-Features">Java Action Features</a>:         Special features for use in actions
<li><a href="#Java-Differences">Java Differences</a>:             Differences between C/C++ and Java Grammars
<li><a href="#Java-Declarations-Summary">Java Declarations Summary</a>:    List of Bison declarations used with Java

</li></ul>
<p>Frequently Asked Questions

</p>
<ul class="menu">
<li><a href="#Memory-Exhausted">Memory Exhausted</a>:             Breaking the Stack Limits
<li><a href="#How-Can-I-Reset-the-Parser">How Can I Reset the Parser</a>:   <code>yyparse</code> Keeps some State
<li><a href="#Strings-are-Destroyed">Strings are Destroyed</a>:        <code>yylval</code> Loses Track of Strings
<li><a href="#Implementing-Gotos_002fLoops">Implementing Gotos/Loops</a>:     Control Flow in the Calculator
<li><a href="#Multiple-start_002dsymbols">Multiple start-symbols</a>:       Factoring closely related grammars
<li><a href="#Secure_003f-Conform_003f">Secure?  Conform?</a>:            Is Bison <acronym>POSIX</acronym> safe? 
<li><a href="#I-can_0027t-build-Bison">I can't build Bison</a>:          Troubleshooting
<li><a href="#Where-can-I-find-help_003f">Where can I find help?</a>:       Troubleshouting
<li><a href="#Bug-Reports">Bug Reports</a>:                  Troublereporting
<li><a href="#More-Languages">More Languages</a>:               Parsers in C++, Java, and so on
<li><a href="#Beta-Testing">Beta Testing</a>:                 Experimenting development versions
<li><a href="#Mailing-Lists">Mailing Lists</a>:                Meeting other Bison users

</li></ul>
<p>Copying This Manual

</p>
<ul class="menu">
<li><a href="#Copying-This-Manual">Copying This Manual</a>:          License for copying this manual.

   </ul>

<div class="node">
<p><hr>
<a name="Introduction"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Conditions">Conditions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">Introduction</h2>

<p><a name="index-introduction-1"></a>
<dfn>Bison</dfn> is a general-purpose parser generator that converts an
annotated context-free grammar into an <acronym>LALR</acronym>(1) or
<acronym>GLR</acronym> parser for that grammar.  Once you are proficient with
Bison, you can use it to develop a wide range of language parsers, from those
used in simple desk calculators to complex programming languages.

   <p>Bison is upward compatible with Yacc: all properly-written Yacc grammars
ought to work with Bison with no change.  Anyone familiar with Yacc
should be able to use Bison with little trouble.  You need to be fluent in
C or C++ programming in order to use Bison or to understand this manual.

   <p>We begin with tutorial chapters that explain the basic concepts of using
Bison and show three explained examples, each building on the last.  If you
don't know Bison or Yacc, start by reading these chapters.  Reference
chapters follow which describe specific aspects of Bison in detail.

   <p>Bison was written primarily by Robert Corbett; Richard Stallman made it
Yacc-compatible.  Wilfred Hansen of Carnegie Mellon University added
multi-character string literals and other features.

   <p>This edition corresponds to version 2.4.1 of Bison.

<div class="node">
<p><hr>
<a name="Conditions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Copying">Copying</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">Conditions for Using Bison</h2>

<p>The distribution terms for Bison-generated parsers permit using the
parsers in nonfree programs.  Before Bison version 2.2, these extra
permissions applied only when Bison was generating <acronym>LALR</acronym>(1)
parsers in C.  And before Bison version 1.24, Bison-generated
parsers could be used only in programs that were free software.

   <p>The other <acronym>GNU</acronym> programming tools, such as the <acronym>GNU</acronym> C
compiler, have never
had such a requirement.  They could always be used for nonfree
software.  The reason Bison was different was not due to a special
policy decision; it resulted from applying the usual General Public
License to all of the Bison source code.

   <p>The output of the Bison utility&mdash;the Bison parser file&mdash;contains a
verbatim copy of a sizable piece of Bison, which is the code for the
parser's implementation.  (The actions from your grammar are inserted
into this implementation at one point, but most of the rest of the
implementation is not changed.)  When we applied the <acronym>GPL</acronym>
terms to the skeleton code for the parser's implementation,
the effect was to restrict the use of Bison output to free software.

   <p>We didn't change the terms because of sympathy for people who want to
make software proprietary.  <strong>Software should be free.</strong>  But we
concluded that limiting Bison's use to free software was doing little to
encourage people to make other software free.  So we decided to make the
practical conditions for using Bison match the practical conditions for
using the other <acronym>GNU</acronym> tools.

   <p>This exception applies when Bison is generating code for a parser. 
You can tell whether the exception applies to a Bison output file by
inspecting the file for text beginning with &ldquo;As a special
exception<small class="dots">...</small>&rdquo;.  The text spells out the exact terms of the
exception.

<div class="node">
<p><hr>
<a name="Copying"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Concepts">Concepts</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Conditions">Conditions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">GNU GENERAL PUBLIC LICENSE</h2>

<!-- The GNU General Public License. -->
<div align="center">Version 3, 29 June 2007</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2007 Free Software Foundation, Inc. <a href="http://fsf.org/">http://fsf.org/</a>
     
     Everyone is permitted to copy and distribute verbatim copies of this
     license document, but changing it is not allowed.
</pre>
   <h3 class="heading">Preamble</h3>

<p>The GNU General Public License is a free, copyleft license for
software and other kinds of works.

   <p>The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
the GNU General Public License is intended to guarantee your freedom
to share and change all versions of a program&mdash;to make sure it remains
free software for all its users.  We, the Free Software Foundation,
use the GNU General Public License for most of our software; it
applies also to any other work released this way by its authors.  You
can apply it to your programs, too.

   <p>When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

   <p>To protect your rights, we need to prevent others from denying you
these rights or asking you to surrender the rights.  Therefore, you
have certain responsibilities if you distribute copies of the
software, or if you modify it: responsibilities to respect the freedom
of others.

   <p>For example, if you distribute copies of such a program, whether
gratis or for a fee, you must pass on to the recipients the same
freedoms that you received.  You must make sure that they, too,
receive or can get the source code.  And you must show them these
terms so they know their rights.

   <p>Developers that use the GNU GPL protect your rights with two steps:
(1) assert copyright on the software, and (2) offer you this License
giving you legal permission to copy, distribute and/or modify it.

   <p>For the developers' and authors' protection, the GPL clearly explains
that there is no warranty for this free software.  For both users' and
authors' sake, the GPL requires that modified versions be marked as
changed, so that their problems will not be attributed erroneously to
authors of previous versions.

   <p>Some devices are designed to deny users access to install or run
modified versions of the software inside them, although the
manufacturer can do so.  This is fundamentally incompatible with the
aim of protecting users' freedom to change the software.  The
systematic pattern of such abuse occurs in the area of products for
individuals to use, which is precisely where it is most unacceptable. 
Therefore, we have designed this version of the GPL to prohibit the
practice for those products.  If such problems arise substantially in
other domains, we stand ready to extend this provision to those
domains in future versions of the GPL, as needed to protect the
freedom of users.

   <p>Finally, every program is threatened constantly by software patents. 
States should not allow patents to restrict development and use of
software on general-purpose computers, but in those that do, we wish
to avoid the special danger that patents applied to a free program
could make it effectively proprietary.  To prevent this, the GPL
assures that patents cannot be used to render the program non-free.

   <p>The precise terms and conditions for copying, distribution and
modification follow.

<h3 class="heading">TERMS AND CONDITIONS</h3>

     <ol type=1 start=0>
<li>Definitions.

     <p>&ldquo;This License&rdquo; refers to version 3 of the GNU General Public License.

     <p>&ldquo;Copyright&rdquo; also means copyright-like laws that apply to other kinds
of works, such as semiconductor masks.

     <p>&ldquo;The Program&rdquo; refers to any copyrightable work licensed under this
License.  Each licensee is addressed as &ldquo;you&rdquo;.  &ldquo;Licensees&rdquo; and
&ldquo;recipients&rdquo; may be individuals or organizations.

     <p>To &ldquo;modify&rdquo; a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of
an exact copy.  The resulting work is called a &ldquo;modified version&rdquo; of
the earlier work or a work &ldquo;based on&rdquo; the earlier work.

     <p>A &ldquo;covered work&rdquo; means either the unmodified Program or a work based
on the Program.

     <p>To &ldquo;propagate&rdquo; a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

     <p>To &ldquo;convey&rdquo; a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user
through a computer network, with no transfer of a copy, is not
conveying.

     <p>An interactive user interface displays &ldquo;Appropriate Legal Notices&rdquo; to
the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent item in the list meets this criterion.

     <li>Source Code.

     <p>The &ldquo;source code&rdquo; for a work means the preferred form of the work for
making modifications to it.  &ldquo;Object code&rdquo; means any non-source form
of a work.

     <p>A &ldquo;Standard Interface&rdquo; means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

     <p>The &ldquo;System Libraries&rdquo; of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
&ldquo;Major Component&rdquo;, in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

     <p>The &ldquo;Corresponding Source&rdquo; for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

     <p>The Corresponding Source need not include anything that users can
regenerate automatically from other parts of the Corresponding Source.

     <p>The Corresponding Source for a work in source code form is that same
work.

     <li>Basic Permissions.

     <p>All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

     <p>You may make, run and propagate covered works that you do not convey,
without conditions so long as your license otherwise remains in force. 
You may convey covered works to others for the sole purpose of having
them make modifications exclusively for you, or provide you with
facilities for running those works, provided that you comply with the
terms of this License in conveying all material for which you do not
control copyright.  Those thus making or running the covered works for
you must do so exclusively on your behalf, under your direction and
control, on terms that prohibit them from making any copies of your
copyrighted material outside their relationship with you.

     <p>Conveying under any other circumstances is permitted solely under the
conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

     <li>Protecting Users' Legal Rights From Anti-Circumvention Law.

     <p>No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

     <p>When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such
circumvention is effected by exercising rights under this License with
respect to the covered work, and you disclaim any intention to limit
operation or modification of the work as a means of enforcing, against
the work's users, your or third parties' legal rights to forbid
circumvention of technological measures.

     <li>Conveying Verbatim Copies.

     <p>You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

     <p>You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

     <li>Conveying Modified Source Versions.

     <p>You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these
conditions:

          <ol type=a start=1>
<li>The work must carry prominent notices stating that you modified it,
and giving a relevant date.

          <li>The work must carry prominent notices stating that it is released
under this License and any conditions added under section 7.  This
requirement modifies the requirement in section 4 to &ldquo;keep intact all
notices&rdquo;.

          <li>You must license the entire work, as a whole, under this License to
anyone who comes into possession of a copy.  This License will
therefore apply, along with any applicable section 7 additional terms,
to the whole of the work, and all its parts, regardless of how they
are packaged.  This License gives no permission to license the work in
any other way, but it does not invalidate such permission if you have
separately received it.

          <li>If the work has interactive user interfaces, each must display
Appropriate Legal Notices; however, if the Program has interactive
interfaces that do not display Appropriate Legal Notices, your work
need not make them do so.
          </ol>

     <p>A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
&ldquo;aggregate&rdquo; if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

     <li>Conveying Non-Source Forms.

     <p>You may convey a covered work in object code form under the terms of
sections 4 and 5, provided that you also convey the machine-readable
Corresponding Source under the terms of this License, in one of these
ways:

          <ol type=a start=1>
<li>Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by the
Corresponding Source fixed on a durable physical medium customarily
used for software interchange.

          <li>Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by a written
offer, valid for at least three years and valid for as long as you
offer spare parts or customer support for that product model, to give
anyone who possesses the object code either (1) a copy of the
Corresponding Source for all the software in the product that is
covered by this License, on a durable physical medium customarily used
for software interchange, for a price no more than your reasonable
cost of physically performing this conveying of source, or (2) access
to copy the Corresponding Source from a network server at no charge.

          <li>Convey individual copies of the object code with a copy of the written
offer to provide the Corresponding Source.  This alternative is
allowed only occasionally and noncommercially, and only if you
received the object code with such an offer, in accord with subsection
6b.

          <li>Convey the object code by offering access from a designated place
(gratis or for a charge), and offer equivalent access to the
Corresponding Source in the same way through the same place at no
further charge.  You need not require recipients to copy the
Corresponding Source along with the object code.  If the place to copy
the object code is a network server, the Corresponding Source may be
on a different server (operated by you or a third party) that supports
equivalent copying facilities, provided you maintain clear directions
next to the object code saying where to find the Corresponding Source. 
Regardless of what server hosts the Corresponding Source, you remain
obligated to ensure that it is available for as long as needed to
satisfy these requirements.

          <li>Convey the object code using peer-to-peer transmission, provided you
inform other peers where the object code and Corresponding Source of
the work are being offered to the general public at no charge under
subsection 6d.

          </ol>

     <p>A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

     <p>A &ldquo;User Product&rdquo; is either (1) a &ldquo;consumer product&rdquo;, which means any
tangible personal property which is normally used for personal,
family, or household purposes, or (2) anything designed or sold for
incorporation into a dwelling.  In determining whether a product is a
consumer product, doubtful cases shall be resolved in favor of
coverage.  For a particular product received by a particular user,
&ldquo;normally used&rdquo; refers to a typical or common use of that class of
product, regardless of the status of the particular user or of the way
in which the particular user actually uses, or expects or is expected
to use, the product.  A product is a consumer product regardless of
whether the product has substantial commercial, industrial or
non-consumer uses, unless such uses represent the only significant
mode of use of the product.

     <p>&ldquo;Installation Information&rdquo; for a User Product means any methods,
procedures, authorization keys, or other information required to
install and execute modified versions of a covered work in that User
Product from a modified version of its Corresponding Source.  The
information must suffice to ensure that the continued functioning of
the modified object code is in no case prevented or interfered with
solely because modification has been made.

     <p>If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

     <p>The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or
updates for a work that has been modified or installed by the
recipient, or for the User Product in which it has been modified or
installed.  Access to a network may be denied when the modification
itself materially and adversely affects the operation of the network
or violates the rules and protocols for communication across the
network.

     <p>Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

     <li>Additional Terms.

     <p>&ldquo;Additional permissions&rdquo; are terms that supplement the terms of this
License by making exceptions from one or more of its conditions. 
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

     <p>When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

     <p>Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders
of that material) supplement the terms of this License with terms:

          <ol type=a start=1>
<li>Disclaiming warranty or limiting liability differently from the terms
of sections 15 and 16 of this License; or

          <li>Requiring preservation of specified reasonable legal notices or author
attributions in that material or in the Appropriate Legal Notices
displayed by works containing it; or

          <li>Prohibiting misrepresentation of the origin of that material, or
requiring that modified versions of such material be marked in
reasonable ways as different from the original version; or

          <li>Limiting the use for publicity purposes of names of licensors or
authors of the material; or

          <li>Declining to grant rights under trademark law for use of some trade
names, trademarks, or service marks; or

          <li>Requiring indemnification of licensors and authors of that material by
anyone who conveys the material (or modified versions of it) with
contractual assumptions of liability to the recipient, for any
liability that these contractual assumptions directly impose on those
licensors and authors.
          </ol>

     <p>All other non-permissive additional terms are considered &ldquo;further
restrictions&rdquo; within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

     <p>If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

     <p>Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions; the
above requirements apply either way.

     <li>Termination.

     <p>You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

     <p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.

     <p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

     <p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

     <li>Acceptance Not Required for Having Copies.

     <p>You are not required to accept this License in order to receive or run
a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

     <li>Automatic Licensing of Downstream Recipients.

     <p>Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

     <p>An &ldquo;entity transaction&rdquo; is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

     <p>You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

     <li>Patents.

     <p>A &ldquo;contributor&rdquo; is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's &ldquo;contributor version&rdquo;.

     <p>A contributor's &ldquo;essential patent claims&rdquo; are all patent claims owned
or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, &ldquo;control&rdquo; includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

     <p>Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

     <p>In the following three paragraphs, a &ldquo;patent license&rdquo; is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To &ldquo;grant&rdquo; such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

     <p>If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  &ldquo;Knowingly relying&rdquo; means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

     <p>If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

     <p>A patent license is &ldquo;discriminatory&rdquo; if it does not include within the
scope of its coverage, prohibits the exercise of, or is conditioned on
the non-exercise of one or more of the rights that are specifically
granted under this License.  You may not convey a covered work if you
are a party to an arrangement with a third party that is in the
business of distributing software, under which you make payment to the
third party based on the extent of your activity of conveying the
work, and under which the third party grants, to any of the parties
who would receive the covered work from you, a discriminatory patent
license (a) in connection with copies of the covered work conveyed by
you (or copies made from those copies), or (b) primarily for and in
connection with specific products or compilations that contain the
covered work, unless you entered into that arrangement, or that patent
license was granted, prior to 28 March 2007.

     <p>Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

     <li>No Surrender of Others' Freedom.

     <p>If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey
a covered work so as to satisfy simultaneously your obligations under
this License and any other pertinent obligations, then as a
consequence you may not convey it at all.  For example, if you agree
to terms that obligate you to collect a royalty for further conveying
from those to whom you convey the Program, the only way you could
satisfy both those terms and this License would be to refrain entirely
from conveying the Program.

     <li>Use with the GNU Affero General Public License.

     <p>Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU Affero General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the special requirements of the GNU Affero General Public License,
section 13, concerning interaction through a network will apply to the
combination as such.

     <li>Revised Versions of this License.

     <p>The Free Software Foundation may publish revised and/or new versions
of the GNU General Public License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.

     <p>Each version is given a distinguishing version number.  If the Program
specifies that a certain numbered version of the GNU General Public
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that numbered version or
of any later version published by the Free Software Foundation.  If
the Program does not specify a version number of the GNU General
Public License, you may choose any version ever published by the Free
Software Foundation.

     <p>If the Program specifies that a proxy can decide which future versions
of the GNU General Public License can be used, that proxy's public
statement of acceptance of a version permanently authorizes you to
choose that version for the Program.

     <p>Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

     <li>Disclaimer of Warranty.

     <p>THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM &ldquo;AS IS&rdquo; WITHOUT
WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND
PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE
DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR
CORRECTION.

     <li>Limitation of Liability.

     <p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR
CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT
NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR
LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM
TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER
PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

     <li>Interpretation of Sections 15 and 16.

     <p>If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

     </ol>

<h3 class="heading">END OF TERMS AND CONDITIONS</h3>

<h3 class="heading">How to Apply These Terms to Your New Programs</h3>

<p>If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these
terms.

   <p>To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the &ldquo;copyright&rdquo; line and a pointer to where the full notice is found.

<pre class="smallexample">     <var>one line to give the program's name and a brief idea of what it does.</var>
     Copyright (C) <var>year</var> <var>name of author</var>
     
     This program is free software: you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation, either version 3 of the License, or (at
     your option) any later version.
     
     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.
     
     You should have received a copy of the GNU General Public License
     along with this program.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.
</pre>
   <p>Also add information on how to contact you by electronic and paper mail.

   <p>If the program does terminal interaction, make it output a short
notice like this when it starts in an interactive mode:

<pre class="smallexample">     <var>program</var> Copyright (C) <var>year</var> <var>name of author</var>
     This program comes with ABSOLUTELY NO WARRANTY; for details type <span class="samp">show w</span>.
     This is free software, and you are welcome to redistribute it
     under certain conditions; type <span class="samp">show c</span> for details.
</pre>
   <p>The hypothetical commands <span class="samp">show w</span> and <span class="samp">show c</span> should show
the appropriate parts of the General Public License.  Of course, your
program's commands might be different; for a GUI interface, you would
use an &ldquo;about box&rdquo;.

   <p>You should also get your employer (if you work as a programmer) or school,
if any, to sign a &ldquo;copyright disclaimer&rdquo; for the program, if necessary. 
For more information on this, and how to apply and follow the GNU GPL, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.

   <p>The GNU General Public License does not permit incorporating your
program into proprietary programs.  If your program is a subroutine
library, you may consider it more useful to permit linking proprietary
applications with the library.  If this is what you want to do, use
the GNU Lesser General Public License instead of this License.  But
first, please read <a href="http://www.gnu.org/philosophy/why-not-lgpl.html">http://www.gnu.org/philosophy/why-not-lgpl.html</a>.

<div class="node">
<p><hr>
<a name="Concepts"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Examples">Examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copying">Copying</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">1 The Concepts of Bison</h2>

<p>This chapter introduces many of the basic concepts without which the
details of Bison will not make sense.  If you do not already know how to
use Bison or Yacc, we suggest you start by reading this chapter carefully.

<ul class="menu">
<li><a accesskey="1" href="#Language-and-Grammar">Language and Grammar</a>:  Languages and context-free grammars,
                           as mathematical ideas. 
<li><a accesskey="2" href="#Grammar-in-Bison">Grammar in Bison</a>:      How we represent grammars for Bison's sake. 
<li><a accesskey="3" href="#Semantic-Values">Semantic Values</a>:       Each token or syntactic grouping can have
                           a semantic value (the value of an integer,
                           the name of an identifier, etc.). 
<li><a accesskey="4" href="#Semantic-Actions">Semantic Actions</a>:      Each rule can have an action containing C code. 
<li><a accesskey="5" href="#GLR-Parsers">GLR Parsers</a>:           Writing parsers for general context-free languages. 
<li><a accesskey="6" href="#Locations-Overview">Locations Overview</a>:    Tracking Locations. 
<li><a accesskey="7" href="#Bison-Parser">Bison Parser</a>:          What are Bison's input and output,
                           how is the output used? 
<li><a accesskey="8" href="#Stages">Stages</a>:                Stages in writing and running Bison grammars. 
<li><a accesskey="9" href="#Grammar-Layout">Grammar Layout</a>:        Overall structure of a Bison grammar file. 
</ul>

<div class="node">
<p><hr>
<a name="Language-and-Grammar"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Grammar-in-Bison">Grammar in Bison</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.1 Languages and Context-Free Grammars</h3>

<p><a name="index-context_002dfree-grammar-2"></a><a name="index-grammar_002c-context_002dfree-3"></a>In order for Bison to parse a language, it must be described by a
<dfn>context-free grammar</dfn>.  This means that you specify one or more
<dfn>syntactic groupings</dfn> and give rules for constructing them from their
parts.  For example, in the C language, one kind of grouping is called an
`expression'.  One rule for making an expression might be, &ldquo;An expression
can be made of a minus sign and another expression&rdquo;.  Another would be,
&ldquo;An expression can be an integer&rdquo;.  As you can see, rules are often
recursive, but there must be at least one rule which leads out of the
recursion.

   <p><a name="index-_0040acronym_007bBNF_007d-4"></a><a name="index-Backus_002dNaur-form-5"></a>The most common formal system for presenting such rules for humans to read
is <dfn>Backus-Naur Form</dfn> or &ldquo;<acronym>BNF</acronym>&rdquo;, which was developed in
order to specify the language Algol 60.  Any grammar expressed in
<acronym>BNF</acronym> is a context-free grammar.  The input to Bison is
essentially machine-readable <acronym>BNF</acronym>.

   <p><a name="index-_0040acronym_007bLALR_007d_00281_0029-grammars-6"></a><a name="index-_0040acronym_007bLR_007d_00281_0029-grammars-7"></a>There are various important subclasses of context-free grammar.  Although it
can handle almost all context-free grammars, Bison is optimized for what
are called <acronym>LALR</acronym>(1) grammars. 
In brief, in these grammars, it must be possible to
tell how to parse any portion of an input string with just a single
token of lookahead.  Strictly speaking, that is a description of an
<acronym>LR</acronym>(1) grammar, and <acronym>LALR</acronym>(1) involves additional
restrictions that are
hard to explain simply; but it is rare in actual practice to find an
<acronym>LR</acronym>(1) grammar that fails to be <acronym>LALR</acronym>(1). 
See <a href="#Mystery-Conflicts">Mysterious Reduce/Reduce Conflicts</a>, for
more information on this.

   <p><a name="index-_0040acronym_007bGLR_007d-parsing-8"></a><a name="index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing-9"></a><a name="index-ambiguous-grammars-10"></a><a name="index-nondeterministic-parsing-11"></a>
Parsers for <acronym>LALR</acronym>(1) grammars are <dfn>deterministic</dfn>, meaning
roughly that the next grammar rule to apply at any point in the input is
uniquely determined by the preceding input and a fixed, finite portion
(called a <dfn>lookahead</dfn>) of the remaining input.  A context-free
grammar can be <dfn>ambiguous</dfn>, meaning that there are multiple ways to
apply the grammar rules to get the same inputs.  Even unambiguous
grammars can be <dfn>nondeterministic</dfn>, meaning that no fixed
lookahead always suffices to determine the next grammar rule to apply. 
With the proper declarations, Bison is also able to parse these more
general context-free grammars, using a technique known as <acronym>GLR</acronym>
parsing (for Generalized <acronym>LR</acronym>).  Bison's <acronym>GLR</acronym> parsers
are able to handle any context-free grammar for which the number of
possible parses of any given string is finite.

   <p><a name="index-symbols-_0028abstract_0029-12"></a><a name="index-token-13"></a><a name="index-syntactic-grouping-14"></a><a name="index-grouping_002c-syntactic-15"></a>In the formal grammatical rules for a language, each kind of syntactic
unit or grouping is named by a <dfn>symbol</dfn>.  Those which are built by
grouping smaller constructs according to grammatical rules are called
<dfn>nonterminal symbols</dfn>; those which can't be subdivided are called
<dfn>terminal symbols</dfn> or <dfn>token types</dfn>.  We call a piece of input
corresponding to a single terminal symbol a <dfn>token</dfn>, and a piece
corresponding to a single nonterminal symbol a <dfn>grouping</dfn>.

   <p>We can use the C language as an example of what symbols, terminal and
nonterminal, mean.  The tokens of C are identifiers, constants (numeric
and string), and the various keywords, arithmetic operators and
punctuation marks.  So the terminal symbols of a grammar for C include
`identifier', `number', `string', plus one symbol for each keyword,
operator or punctuation mark: `if', `return', `const', `static', `int',
`char', `plus-sign', `open-brace', `close-brace', `comma' and many more. 
(These tokens can be subdivided into characters, but that is a matter of
lexicography, not grammar.)

   <p>Here is a simple C function subdivided into tokens:

<pre class="example">     int             /* <span class="roman">keyword `int'</span> */
     square (int x)  /* <span class="roman">identifier, open-paren, keyword `int', identifier, close-paren</span> */
     {               /* <span class="roman">open-brace</span> */
       return x * x; /* <span class="roman">keyword `return', identifier, asterisk, identifier, semicolon</span> */
     }               /* <span class="roman">close-brace</span> */
</pre>
   <p>The syntactic groupings of C include the expression, the statement, the
declaration, and the function definition.  These are represented in the
grammar of C by nonterminal symbols `expression', `statement',
`declaration' and `function definition'.  The full grammar uses dozens of
additional language constructs, each with its own nonterminal symbol, in
order to express the meanings of these four.  The example above is a
function definition; it contains one declaration, and one statement.  In
the statement, each <span class="samp">x</span> is an expression and so is <span class="samp">x * x</span>.

   <p>Each nonterminal symbol must have grammatical rules showing how it is made
out of simpler constructs.  For example, one kind of C statement is the
<code>return</code> statement; this would be described with a grammar rule which
reads informally as follows:

   <blockquote>
A `statement' can be made of a `return' keyword, an `expression' and a
`semicolon'. 
</blockquote>

<p class="noindent">There would be many other rules for `statement', one for each kind of
statement in C.

   <p><a name="index-start-symbol-16"></a>One nonterminal symbol must be distinguished as the special one which
defines a complete utterance in the language.  It is called the <dfn>start
symbol</dfn>.  In a compiler, this means a complete input program.  In the C
language, the nonterminal symbol `sequence of definitions and declarations'
plays this role.

   <p>For example, <span class="samp">1 + 2</span> is a valid C expression&mdash;a valid part of a C
program&mdash;but it is not valid as an <em>entire</em> C program.  In the
context-free grammar of C, this follows from the fact that `expression' is
not the start symbol.

   <p>The Bison parser reads a sequence of tokens as its input, and groups the
tokens using the grammar rules.  If the input is valid, the end result is
that the entire token sequence reduces to a single grouping whose symbol is
the grammar's start symbol.  If we use a grammar for C, the entire input
must be a `sequence of definitions and declarations'.  If not, the parser
reports a syntax error.

<div class="node">
<p><hr>
<a name="Grammar-in-Bison"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Semantic-Values">Semantic Values</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Language-and-Grammar">Language and Grammar</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.2 From Formal Rules to Bison Input</h3>

<p><a name="index-Bison-grammar-17"></a><a name="index-grammar_002c-Bison-18"></a><a name="index-formal-grammar-19"></a>
A formal grammar is a mathematical construct.  To define the language
for Bison, you must write a file expressing the grammar in Bison syntax:
a <dfn>Bison grammar</dfn> file.  See <a href="#Grammar-File">Bison Grammar Files</a>.

   <p>A nonterminal symbol in the formal grammar is represented in Bison input
as an identifier, like an identifier in C.  By convention, it should be
in lower case, such as <code>expr</code>, <code>stmt</code> or <code>declaration</code>.

   <p>The Bison representation for a terminal symbol is also called a <dfn>token
type</dfn>.  Token types as well can be represented as C-like identifiers.  By
convention, these identifiers should be upper case to distinguish them from
nonterminals: for example, <code>INTEGER</code>, <code>IDENTIFIER</code>, <code>IF</code> or
<code>RETURN</code>.  A terminal symbol that stands for a particular keyword in
the language should be named after that keyword converted to upper case. 
The terminal symbol <code>error</code> is reserved for error recovery. 
See <a href="#Symbols">Symbols</a>.

   <p>A terminal symbol can also be represented as a character literal, just like
a C character constant.  You should do this whenever a token is just a
single character (parenthesis, plus-sign, etc.): use that same character in
a literal as the terminal symbol for that token.

   <p>A third way to represent a terminal symbol is with a C string constant
containing several characters.  See <a href="#Symbols">Symbols</a>, for more information.

   <p>The grammar rules also have an expression in Bison syntax.  For example,
here is the Bison rule for a C <code>return</code> statement.  The semicolon in
quotes is a literal character token, representing part of the C syntax for
the statement; the naked semicolon, and the colon, are Bison punctuation
used in every rule.

<pre class="example">     stmt:   RETURN expr ';'
             ;
</pre>
   <p class="noindent">See <a href="#Rules">Syntax of Grammar Rules</a>.

<div class="node">
<p><hr>
<a name="Semantic-Values"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Semantic-Actions">Semantic Actions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Grammar-in-Bison">Grammar in Bison</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.3 Semantic Values</h3>

<p><a name="index-semantic-value-20"></a><a name="index-value_002c-semantic-21"></a>
A formal grammar selects tokens only by their classifications: for example,
if a rule mentions the terminal symbol `integer constant', it means that
<em>any</em> integer constant is grammatically valid in that position.  The
precise value of the constant is irrelevant to how to parse the input: if
<span class="samp">x+4</span> is grammatical then <span class="samp">x+1</span> or <span class="samp">x+3989</span> is equally
grammatical.

   <p>But the precise value is very important for what the input means once it is
parsed.  A compiler is useless if it fails to distinguish between 4, 1 and
3989 as constants in the program!  Therefore, each token in a Bison grammar
has both a token type and a <dfn>semantic value</dfn>.  See <a href="#Semantics">Defining Language Semantics</a>,
for details.

   <p>The token type is a terminal symbol defined in the grammar, such as
<code>INTEGER</code>, <code>IDENTIFIER</code> or <code>','</code>.  It tells everything
you need to know to decide where the token may validly appear and how to
group it with other tokens.  The grammar rules know nothing about tokens
except their types.

   <p>The semantic value has all the rest of the information about the
meaning of the token, such as the value of an integer, or the name of an
identifier.  (A token such as <code>','</code> which is just punctuation doesn't
need to have any semantic value.)

   <p>For example, an input token might be classified as token type
<code>INTEGER</code> and have the semantic value 4.  Another input token might
have the same token type <code>INTEGER</code> but value 3989.  When a grammar
rule says that <code>INTEGER</code> is allowed, either of these tokens is
acceptable because each is an <code>INTEGER</code>.  When the parser accepts the
token, it keeps track of the token's semantic value.

   <p>Each grouping can also have a semantic value as well as its nonterminal
symbol.  For example, in a calculator, an expression typically has a
semantic value that is a number.  In a compiler for a programming
language, an expression typically has a semantic value that is a tree
structure describing the meaning of the expression.

<div class="node">
<p><hr>
<a name="Semantic-Actions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#GLR-Parsers">GLR Parsers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Semantic-Values">Semantic Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.4 Semantic Actions</h3>

<p><a name="index-semantic-actions-22"></a><a name="index-actions_002c-semantic-23"></a>
In order to be useful, a program must do more than parse input; it must
also produce some output based on the input.  In a Bison grammar, a grammar
rule can have an <dfn>action</dfn> made up of C statements.  Each time the
parser recognizes a match for that rule, the action is executed. 
See <a href="#Actions">Actions</a>.

   <p>Most of the time, the purpose of an action is to compute the semantic value
of the whole construct from the semantic values of its parts.  For example,
suppose we have a rule which says an expression can be the sum of two
expressions.  When the parser recognizes such a sum, each of the
subexpressions has a semantic value which describes how it was built up. 
The action for this rule should create a similar sort of value for the
newly recognized larger expression.

   <p>For example, here is a rule that says an expression can be the sum of
two subexpressions:

<pre class="example">     expr: expr '+' expr   { $$ = $1 + $3; }
             ;
</pre>
   <p class="noindent">The action says how to produce the semantic value of the sum expression
from the values of the two subexpressions.

<div class="node">
<p><hr>
<a name="GLR-Parsers"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Locations-Overview">Locations Overview</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Semantic-Actions">Semantic Actions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.5 Writing <acronym>GLR</acronym> Parsers</h3>

<p><a name="index-_0040acronym_007bGLR_007d-parsing-24"></a><a name="index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing-25"></a><a name="index-_0025glr_002dparser-26"></a><a name="index-conflicts-27"></a><a name="index-shift_002freduce-conflicts-28"></a><a name="index-reduce_002freduce-conflicts-29"></a>
In some grammars, Bison's standard
<acronym>LALR</acronym>(1) parsing algorithm cannot decide whether to apply a
certain grammar rule at a given point.  That is, it may not be able to
decide (on the basis of the input read so far) which of two possible
reductions (applications of a grammar rule) applies, or whether to apply
a reduction or read more of the input and apply a reduction later in the
input.  These are known respectively as <dfn>reduce/reduce</dfn> conflicts
(see <a href="#Reduce_002fReduce">Reduce/Reduce</a>), and <dfn>shift/reduce</dfn> conflicts
(see <a href="#Shift_002fReduce">Shift/Reduce</a>).

   <p>To use a grammar that is not easily modified to be <acronym>LALR</acronym>(1), a
more general parsing algorithm is sometimes necessary.  If you include
<code>%glr-parser</code> among the Bison declarations in your file
(see <a href="#Grammar-Outline">Grammar Outline</a>), the result is a Generalized <acronym>LR</acronym>
(<acronym>GLR</acronym>) parser.  These parsers handle Bison grammars that
contain no unresolved conflicts (i.e., after applying precedence
declarations) identically to <acronym>LALR</acronym>(1) parsers.  However, when
faced with unresolved shift/reduce and reduce/reduce conflicts,
<acronym>GLR</acronym> parsers use the simple expedient of doing both,
effectively cloning the parser to follow both possibilities.  Each of
the resulting parsers can again split, so that at any given time, there
can be any number of possible parses being explored.  The parsers
proceed in lockstep; that is, all of them consume (shift) a given input
symbol before any of them proceed to the next.  Each of the cloned
parsers eventually meets one of two possible fates: either it runs into
a parsing error, in which case it simply vanishes, or it merges with
another parser, because the two of them have reduced the input to an
identical set of symbols.

   <p>During the time that there are multiple parsers, semantic actions are
recorded, but not performed.  When a parser disappears, its recorded
semantic actions disappear as well, and are never performed.  When a
reduction makes two parsers identical, causing them to merge, Bison
records both sets of semantic actions.  Whenever the last two parsers
merge, reverting to the single-parser case, Bison resolves all the
outstanding actions either by precedences given to the grammar rules
involved, or by performing both actions, and then calling a designated
user-defined function on the resulting values to produce an arbitrary
merged result.

<ul class="menu">
<li><a accesskey="1" href="#Simple-GLR-Parsers">Simple GLR Parsers</a>:      Using <acronym>GLR</acronym> parsers on unambiguous grammars. 
<li><a accesskey="2" href="#Merging-GLR-Parses">Merging GLR Parses</a>:      Using <acronym>GLR</acronym> parsers to resolve ambiguities. 
<li><a accesskey="3" href="#GLR-Semantic-Actions">GLR Semantic Actions</a>:    Deferred semantic actions have special concerns. 
<li><a accesskey="4" href="#Compiler-Requirements">Compiler Requirements</a>:   <acronym>GLR</acronym> parsers require a modern C compiler. 
</ul>

<div class="node">
<p><hr>
<a name="Simple-GLR-Parsers"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Merging-GLR-Parses">Merging GLR Parses</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GLR-Parsers">GLR Parsers</a>
<br>
</div>

<h4 class="subsection">1.5.1 Using <acronym>GLR</acronym> on Unambiguous Grammars</h4>

<p><a name="index-_0040acronym_007bGLR_007d-parsing_002c-unambiguous-grammars-30"></a><a name="index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing_002c-unambiguous-grammars-31"></a><a name="index-_0025glr_002dparser-32"></a><a name="index-_0025expect_002drr-33"></a><a name="index-conflicts-34"></a><a name="index-reduce_002freduce-conflicts-35"></a><a name="index-shift_002freduce-conflicts-36"></a>
In the simplest cases, you can use the <acronym>GLR</acronym> algorithm
to parse grammars that are unambiguous, but fail to be <acronym>LALR</acronym>(1). 
Such grammars typically require more than one symbol of lookahead,
or (in rare cases) fall into the category of grammars in which the
<acronym>LALR</acronym>(1) algorithm throws away too much information (they are in
<acronym>LR</acronym>(1), but not <acronym>LALR</acronym>(1), <a href="#Mystery-Conflicts">Mystery Conflicts</a>).

   <p>Consider a problem that
arises in the declaration of enumerated and subrange types in the
programming language Pascal.  Here are some examples:

<pre class="example">     type subrange = lo .. hi;
     type enum = (a, b, c);
</pre>
   <p class="noindent">The original language standard allows only numeric
literals and constant identifiers for the subrange bounds (<span class="samp">lo</span>
and <span class="samp">hi</span>), but Extended Pascal (<acronym>ISO</acronym>/<acronym>IEC</acronym>
10206) and many other
Pascal implementations allow arbitrary expressions there.  This gives
rise to the following situation, containing a superfluous pair of
parentheses:

<pre class="example">     type subrange = (a) .. b;
</pre>
   <p class="noindent">Compare this to the following declaration of an enumerated
type with only one value:

<pre class="example">     type enum = (a);
</pre>
   <p class="noindent">(These declarations are contrived, but they are syntactically
valid, and more-complicated cases can come up in practical programs.)

   <p>These two declarations look identical until the <span class="samp">..</span> token. 
With normal <acronym>LALR</acronym>(1) one-token lookahead it is not
possible to decide between the two forms when the identifier
<span class="samp">a</span> is parsed.  It is, however, desirable
for a parser to decide this, since in the latter case
<span class="samp">a</span> must become a new identifier to represent the enumeration
value, while in the former case <span class="samp">a</span> must be evaluated with its
current meaning, which may be a constant or even a function call.

   <p>You could parse <span class="samp">(a)</span> as an &ldquo;unspecified identifier in parentheses&rdquo;,
to be resolved later, but this typically requires substantial
contortions in both semantic actions and large parts of the
grammar, where the parentheses are nested in the recursive rules for
expressions.

   <p>You might think of using the lexer to distinguish between the two
forms by returning different tokens for currently defined and
undefined identifiers.  But if these declarations occur in a local
scope, and <span class="samp">a</span> is defined in an outer scope, then both forms
are possible&mdash;either locally redefining <span class="samp">a</span>, or using the
value of <span class="samp">a</span> from the outer scope.  So this approach cannot
work.

   <p>A simple solution to this problem is to declare the parser to
use the <acronym>GLR</acronym> algorithm. 
When the <acronym>GLR</acronym> parser reaches the critical state, it
merely splits into two branches and pursues both syntax rules
simultaneously.  Sooner or later, one of them runs into a parsing
error.  If there is a <span class="samp">..</span> token before the next
<span class="samp">;</span>, the rule for enumerated types fails since it cannot
accept <span class="samp">..</span> anywhere; otherwise, the subrange type rule
fails since it requires a <span class="samp">..</span> token.  So one of the branches
fails silently, and the other one continues normally, performing
all the intermediate actions that were postponed during the split.

   <p>If the input is syntactically incorrect, both branches fail and the parser
reports a syntax error as usual.

   <p>The effect of all this is that the parser seems to &ldquo;guess&rdquo; the
correct branch to take, or in other words, it seems to use more
lookahead than the underlying <acronym>LALR</acronym>(1) algorithm actually allows
for.  In this example, <acronym>LALR</acronym>(2) would suffice, but also some cases
that are not <acronym>LALR</acronym>(k) for any k can be handled this way.

   <p>In general, a <acronym>GLR</acronym> parser can take quadratic or cubic worst-case time,
and the current Bison parser even takes exponential time and space
for some grammars.  In practice, this rarely happens, and for many
grammars it is possible to prove that it cannot happen. 
The present example contains only one conflict between two
rules, and the type-declaration context containing the conflict
cannot be nested.  So the number of
branches that can exist at any time is limited by the constant 2,
and the parsing time is still linear.

   <p>Here is a Bison grammar corresponding to the example above.  It
parses a vastly simplified form of Pascal type declarations.

<pre class="example">     %token TYPE DOTDOT ID
     
     %left '+' '-'
     %left '*' '/'
     
     %%
     
     type_decl : TYPE ID '=' type ';'
          ;
     
     type : '(' id_list ')'
          | expr DOTDOT expr
          ;
     
     id_list : ID
          | id_list ',' ID
          ;
     
     expr : '(' expr ')'
          | expr '+' expr
          | expr '-' expr
          | expr '*' expr
          | expr '/' expr
          | ID
          ;
</pre>
   <p>When used as a normal <acronym>LALR</acronym>(1) grammar, Bison correctly complains
about one reduce/reduce conflict.  In the conflicting situation the
parser chooses one of the alternatives, arbitrarily the one
declared first.  Therefore the following correct input is not
recognized:

<pre class="example">     type t = (a) .. b;
</pre>
   <p>The parser can be turned into a <acronym>GLR</acronym> parser, while also telling Bison
to be silent about the one known reduce/reduce conflict, by
adding these two declarations to the Bison input file (before the first
<span class="samp">%%</span>):

<pre class="example">     %glr-parser
     %expect-rr 1
</pre>
   <p class="noindent">No change in the grammar itself is required.  Now the
parser recognizes all valid declarations, according to the
limited syntax above, transparently.  In fact, the user does not even
notice when the parser splits.

   <p>So here we have a case where we can use the benefits of <acronym>GLR</acronym>,
almost without disadvantages.  Even in simple cases like this, however,
there are at least two potential problems to beware.  First, always
analyze the conflicts reported by Bison to make sure that <acronym>GLR</acronym>
splitting is only done where it is intended.  A <acronym>GLR</acronym> parser
splitting inadvertently may cause problems less obvious than an
<acronym>LALR</acronym> parser statically choosing the wrong alternative in a
conflict.  Second, consider interactions with the lexer (see <a href="#Semantic-Tokens">Semantic Tokens</a>) with great care.  Since a split parser consumes tokens without
performing any actions during the split, the lexer cannot obtain
information via parser actions.  Some cases of lexer interactions can be
eliminated by using <acronym>GLR</acronym> to shift the complications from the
lexer to the parser.  You must check the remaining cases for
correctness.

   <p>In our example, it would be safe for the lexer to return tokens based on
their current meanings in some symbol table, because no new symbols are
defined in the middle of a type declaration.  Though it is possible for
a parser to define the enumeration constants as they are parsed, before
the type declaration is completed, it actually makes no difference since
they cannot be used within the same enumerated type declaration.

<div class="node">
<p><hr>
<a name="Merging-GLR-Parses"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#GLR-Semantic-Actions">GLR Semantic Actions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Simple-GLR-Parsers">Simple GLR Parsers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GLR-Parsers">GLR Parsers</a>
<br>
</div>

<h4 class="subsection">1.5.2 Using <acronym>GLR</acronym> to Resolve Ambiguities</h4>

<p><a name="index-_0040acronym_007bGLR_007d-parsing_002c-ambiguous-grammars-37"></a><a name="index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing_002c-ambiguous-grammars-38"></a><a name="index-_0025dprec-39"></a><a name="index-_0025merge-40"></a><a name="index-conflicts-41"></a><a name="index-reduce_002freduce-conflicts-42"></a>
Let's consider an example, vastly simplified from a C++ grammar.

<pre class="example">     %{
       #include &lt;stdio.h&gt;
       #define YYSTYPE char const *
       int yylex (void);
       void yyerror (char const *);
     %}
     
     %token TYPENAME ID
     
     %right '='
     %left '+'
     
     %glr-parser
     
     %%
     
     prog :
          | prog stmt   { printf ("\n"); }
          ;
     
     stmt : expr ';'  %dprec 1
          | decl      %dprec 2
          ;
     
     expr : ID               { printf ("%s ", $$); }
          | TYPENAME '(' expr ')'
                             { printf ("%s &lt;cast&gt; ", $1); }
          | expr '+' expr    { printf ("+ "); }
          | expr '=' expr    { printf ("= "); }
          ;
     
     decl : TYPENAME declarator ';'
                             { printf ("%s &lt;declare&gt; ", $1); }
          | TYPENAME declarator '=' expr ';'
                             { printf ("%s &lt;init-declare&gt; ", $1); }
          ;
     
     declarator : ID         { printf ("\"%s\" ", $1); }
          | '(' declarator ')'
          ;
</pre>
   <p class="noindent">This models a problematic part of the C++ grammar&mdash;the ambiguity between
certain declarations and statements.  For example,

<pre class="example">     T (x) = y+z;
</pre>
   <p class="noindent">parses as either an <code>expr</code> or a <code>stmt</code>
(assuming that <span class="samp">T</span> is recognized as a <code>TYPENAME</code> and
<span class="samp">x</span> as an <code>ID</code>). 
Bison detects this as a reduce/reduce conflict between the rules
<code>expr : ID</code> and <code>declarator : ID</code>, which it cannot resolve at the
time it encounters <code>x</code> in the example above.  Since this is a
<acronym>GLR</acronym> parser, it therefore splits the problem into two parses, one for
each choice of resolving the reduce/reduce conflict. 
Unlike the example from the previous section (see <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a>),
however, neither of these parses &ldquo;dies,&rdquo; because the grammar as it stands is
ambiguous.  One of the parsers eventually reduces <code>stmt : expr ';'</code> and
the other reduces <code>stmt : decl</code>, after which both parsers are in an
identical state: they've seen <span class="samp">prog stmt</span> and have the same unprocessed
input remaining.  We say that these parses have <dfn>merged.</dfn>

   <p>At this point, the <acronym>GLR</acronym> parser requires a specification in the
grammar of how to choose between the competing parses. 
In the example above, the two <code>%dprec</code>
declarations specify that Bison is to give precedence
to the parse that interprets the example as a
<code>decl</code>, which implies that <code>x</code> is a declarator. 
The parser therefore prints

<pre class="example">     "x" y z + T &lt;init-declare&gt;
</pre>
   <p>The <code>%dprec</code> declarations only come into play when more than one
parse survives.  Consider a different input string for this parser:

<pre class="example">     T (x) + y;
</pre>
   <p class="noindent">This is another example of using <acronym>GLR</acronym> to parse an unambiguous
construct, as shown in the previous section (see <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a>). 
Here, there is no ambiguity (this cannot be parsed as a declaration). 
However, at the time the Bison parser encounters <code>x</code>, it does not
have enough information to resolve the reduce/reduce conflict (again,
between <code>x</code> as an <code>expr</code> or a <code>declarator</code>).  In this
case, no precedence declaration is used.  Again, the parser splits
into two, one assuming that <code>x</code> is an <code>expr</code>, and the other
assuming <code>x</code> is a <code>declarator</code>.  The second of these parsers
then vanishes when it sees <code>+</code>, and the parser prints

<pre class="example">     x T &lt;cast&gt; y +
</pre>
   <p>Suppose that instead of resolving the ambiguity, you wanted to see all
the possibilities.  For this purpose, you must merge the semantic
actions of the two possible parsers, rather than choosing one over the
other.  To do so, you could change the declaration of <code>stmt</code> as
follows:

<pre class="example">     stmt : expr ';'  %merge &lt;stmtMerge&gt;
          | decl      %merge &lt;stmtMerge&gt;
          ;
</pre>
   <p class="noindent">and define the <code>stmtMerge</code> function as:

<pre class="example">     static YYSTYPE
     stmtMerge (YYSTYPE x0, YYSTYPE x1)
     {
       printf ("&lt;OR&gt; ");
       return "";
     }
</pre>
   <p class="noindent">with an accompanying forward declaration
in the C declarations at the beginning of the file:

<pre class="example">     %{
       #define YYSTYPE char const *
       static YYSTYPE stmtMerge (YYSTYPE x0, YYSTYPE x1);
     %}
</pre>
   <p class="noindent">With these declarations, the resulting parser parses the first example
as both an <code>expr</code> and a <code>decl</code>, and prints

<pre class="example">     "x" y z + T &lt;init-declare&gt; x T &lt;cast&gt; y z + = &lt;OR&gt;
</pre>
   <p>Bison requires that all of the
productions that participate in any particular merge have identical
<span class="samp">%merge</span> clauses.  Otherwise, the ambiguity would be unresolvable,
and the parser will report an error during any parse that results in
the offending merge.

<div class="node">
<p><hr>
<a name="GLR-Semantic-Actions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Compiler-Requirements">Compiler Requirements</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Merging-GLR-Parses">Merging GLR Parses</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GLR-Parsers">GLR Parsers</a>
<br>
</div>

<h4 class="subsection">1.5.3 GLR Semantic Actions</h4>

<p><a name="index-deferred-semantic-actions-43"></a>By definition, a deferred semantic action is not performed at the same time as
the associated reduction. 
This raises caveats for several Bison features you might use in a semantic
action in a <acronym>GLR</acronym> parser.

   <p><a name="index-yychar-44"></a><a name="index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byychar_007d-45"></a><a name="index-yylval-46"></a><a name="index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byylval_007d-47"></a><a name="index-yylloc-48"></a><a name="index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byylloc_007d-49"></a>In any semantic action, you can examine <code>yychar</code> to determine the type of
the lookahead token present at the time of the associated reduction. 
After checking that <code>yychar</code> is not set to <code>YYEMPTY</code> or <code>YYEOF</code>,
you can then examine <code>yylval</code> and <code>yylloc</code> to determine the
lookahead token's semantic value and location, if any. 
In a nondeferred semantic action, you can also modify any of these variables to
influence syntax analysis. 
See <a href="#Lookahead">Lookahead Tokens</a>.

   <p><a name="index-yyclearin-50"></a><a name="index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byyclearin_007d-51"></a>In a deferred semantic action, it's too late to influence syntax analysis. 
In this case, <code>yychar</code>, <code>yylval</code>, and <code>yylloc</code> are set to
shallow copies of the values they had at the time of the associated reduction. 
For this reason alone, modifying them is dangerous. 
Moreover, the result of modifying them is undefined and subject to change with
future versions of Bison. 
For example, if a semantic action might be deferred, you should never write it
to invoke <code>yyclearin</code> (see <a href="#Action-Features">Action Features</a>) or to attempt to free
memory referenced by <code>yylval</code>.

   <p><a name="index-YYERROR-52"></a><a name="index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007bYYERROR_007d-53"></a>Another Bison feature requiring special consideration is <code>YYERROR</code>
(see <a href="#Action-Features">Action Features</a>), which you can invoke in a semantic action to
initiate error recovery. 
During deterministic <acronym>GLR</acronym> operation, the effect of <code>YYERROR</code> is
the same as its effect in an <acronym>LALR</acronym>(1) parser. 
In a deferred semantic action, its effect is undefined. 
<!-- The effect is probably a syntax error at the split point. -->

   <p>Also, see <a href="#Location-Default-Action">Default Action for Locations</a>, which
describes a special usage of <code>YYLLOC_DEFAULT</code> in <acronym>GLR</acronym> parsers.

<div class="node">
<p><hr>
<a name="Compiler-Requirements"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#GLR-Semantic-Actions">GLR Semantic Actions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#GLR-Parsers">GLR Parsers</a>
<br>
</div>

<h4 class="subsection">1.5.4 Considerations when Compiling <acronym>GLR</acronym> Parsers</h4>

<p><a name="index-_0040code_007binline_007d-54"></a><a name="index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007binline_007d-55"></a>
The <acronym>GLR</acronym> parsers require a compiler for <acronym>ISO</acronym> C89 or
later.  In addition, they use the <code>inline</code> keyword, which is not
C89, but is C99 and is a common extension in pre-C99 compilers.  It is
up to the user of these parsers to handle
portability issues.  For instance, if using Autoconf and the Autoconf
macro <code>AC_C_INLINE</code>, a mere

<pre class="example">     %{
       #include &lt;config.h&gt;
     %}
</pre>
   <p class="noindent">will suffice.  Otherwise, we suggest

<pre class="example">     %{
       #if __STDC_VERSION__ &lt; 199901 &amp;&amp; ! defined __GNUC__ &amp;&amp; ! defined inline
        #define inline
       #endif
     %}
</pre>
   <div class="node">
<p><hr>
<a name="Locations-Overview"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Bison-Parser">Bison Parser</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#GLR-Parsers">GLR Parsers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.6 Locations</h3>

<p><a name="index-location-56"></a><a name="index-textual-location-57"></a><a name="index-location_002c-textual-58"></a>
Many applications, like interpreters or compilers, have to produce verbose
and useful error messages.  To achieve this, one must be able to keep track of
the <dfn>textual location</dfn>, or <dfn>location</dfn>, of each syntactic construct. 
Bison provides a mechanism for handling these locations.

   <p>Each token has a semantic value.  In a similar fashion, each token has an
associated location, but the type of locations is the same for all tokens and
groupings.  Moreover, the output parser is equipped with a default data
structure for storing locations (see <a href="#Locations">Locations</a>, for more details).

   <p>Like semantic values, locations can be reached in actions using a dedicated
set of constructs.  In the example above, the location of the whole grouping
is <code>@$</code>, while the locations of the subexpressions are <code>@1</code> and
<code>@3</code>.

   <p>When a rule is matched, a default action is used to compute the semantic value
of its left hand side (see <a href="#Actions">Actions</a>).  In the same way, another default
action is used for locations.  However, the action for locations is general
enough for most cases, meaning there is usually no need to describe for each
rule how <code>@$</code> should be formed.  When building a new location for a given
grouping, the default behavior of the output parser is to take the beginning
of the first symbol, and the end of the last symbol.

<div class="node">
<p><hr>
<a name="Bison-Parser"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Stages">Stages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Locations-Overview">Locations Overview</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.7 Bison Output: the Parser File</h3>

<p><a name="index-Bison-parser-59"></a><a name="index-Bison-utility-60"></a><a name="index-lexical-analyzer_002c-purpose-61"></a><a name="index-parser-62"></a>
When you run Bison, you give it a Bison grammar file as input.  The output
is a C source file that parses the language described by the grammar. 
This file is called a <dfn>Bison parser</dfn>.  Keep in mind that the Bison
utility and the Bison parser are two distinct programs: the Bison utility
is a program whose output is the Bison parser that becomes part of your
program.

   <p>The job of the Bison parser is to group tokens into groupings according to
the grammar rules&mdash;for example, to build identifiers and operators into
expressions.  As it does this, it runs the actions for the grammar rules it
uses.

   <p>The tokens come from a function called the <dfn>lexical analyzer</dfn> that
you must supply in some fashion (such as by writing it in C).  The Bison
parser calls the lexical analyzer each time it wants a new token.  It
doesn't know what is &ldquo;inside&rdquo; the tokens (though their semantic values
may reflect this).  Typically the lexical analyzer makes the tokens by
parsing characters of text, but Bison does not depend on this. 
See <a href="#Lexical">The Lexical Analyzer Function <code>yylex</code></a>.

   <p>The Bison parser file is C code which defines a function named
<code>yyparse</code> which implements that grammar.  This function does not make
a complete C program: you must supply some additional functions.  One is
the lexical analyzer.  Another is an error-reporting function which the
parser calls to report an error.  In addition, a complete C program must
start with a function called <code>main</code>; you have to provide this, and
arrange for it to call <code>yyparse</code> or the parser will never run. 
See <a href="#Interface">Parser C-Language Interface</a>.

   <p>Aside from the token type names and the symbols in the actions you
write, all symbols defined in the Bison parser file itself
begin with <span class="samp">yy</span> or <span class="samp">YY</span>.  This includes interface functions
such as the lexical analyzer function <code>yylex</code>, the error reporting
function <code>yyerror</code> and the parser function <code>yyparse</code> itself. 
This also includes numerous identifiers used for internal purposes. 
Therefore, you should avoid using C identifiers starting with <span class="samp">yy</span>
or <span class="samp">YY</span> in the Bison grammar file except for the ones defined in
this manual.  Also, you should avoid using the C identifiers
<span class="samp">malloc</span> and <span class="samp">free</span> for anything other than their usual
meanings.

   <p>In some cases the Bison parser file includes system headers, and in
those cases your code should respect the identifiers reserved by those
headers.  On some non-<acronym>GNU</acronym> hosts, <code>&lt;alloca.h&gt;</code>, <code>&lt;malloc.h&gt;</code>,
<code>&lt;stddef.h&gt;</code>, and <code>&lt;stdlib.h&gt;</code> are included as needed to
declare memory allocators and related types.  <code>&lt;libintl.h&gt;</code> is
included if message translation is in use
(see <a href="#Internationalization">Internationalization</a>).  Other system headers may
be included if you define <code>YYDEBUG</code> to a nonzero value
(see <a href="#Tracing">Tracing Your Parser</a>).

<div class="node">
<p><hr>
<a name="Stages"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Grammar-Layout">Grammar Layout</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bison-Parser">Bison Parser</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.8 Stages in Using Bison</h3>

<p><a name="index-stages-in-using-Bison-63"></a><a name="index-using-Bison-64"></a>
The actual language-design process using Bison, from grammar specification
to a working compiler or interpreter, has these parts:

     <ol type=1 start=1>
<li>Formally specify the grammar in a form recognized by Bison
(see <a href="#Grammar-File">Bison Grammar Files</a>).  For each grammatical rule
in the language, describe the action that is to be taken when an
instance of that rule is recognized.  The action is described by a
sequence of C statements.

     <li>Write a lexical analyzer to process input and pass tokens to the parser. 
The lexical analyzer may be written by hand in C (see <a href="#Lexical">The Lexical Analyzer Function <code>yylex</code></a>).  It could also be produced
using Lex, but the use of Lex is not discussed in this manual.

     <li>Write a controlling function that calls the Bison-produced parser.

     <li>Write error-reporting routines.
        </ol>

   <p>To turn this source code as written into a runnable program, you
must follow these steps:

     <ol type=1 start=1>
<li>Run Bison on the grammar to produce the parser.

     <li>Compile the code output by Bison, as well as any other source files.

     <li>Link the object files to produce the finished product.
        </ol>

<div class="node">
<p><hr>
<a name="Grammar-Layout"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Stages">Stages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Concepts">Concepts</a>
<br>
</div>

<h3 class="section">1.9 The Overall Layout of a Bison Grammar</h3>

<p><a name="index-grammar-file-65"></a><a name="index-file-format-66"></a><a name="index-format-of-grammar-file-67"></a><a name="index-layout-of-Bison-grammar-68"></a>
The input file for the Bison utility is a <dfn>Bison grammar file</dfn>.  The
general form of a Bison grammar file is as follows:

<pre class="example">     %{
     <var>Prologue</var>
     %}
     
     <var>Bison declarations</var>
     
     %%
     <var>Grammar rules</var>
     %%
     <var>Epilogue</var>
</pre>
   <p class="noindent">The <span class="samp">%%</span>, <span class="samp">%{</span> and <span class="samp">%}</span> are punctuation that appears
in every Bison grammar file to separate the sections.

   <p>The prologue may define types and variables used in the actions.  You can
also use preprocessor commands to define macros used there, and use
<code>#include</code> to include header files that do any of these things. 
You need to declare the lexical analyzer <code>yylex</code> and the error
printer <code>yyerror</code> here, along with any other global identifiers
used by the actions in the grammar rules.

   <p>The Bison declarations declare the names of the terminal and nonterminal
symbols, and may also describe operator precedence and the data types of
semantic values of various symbols.

   <p>The grammar rules define how to construct each nonterminal symbol from its
parts.

   <p>The epilogue can contain any code you want to use.  Often the
definitions of functions declared in the prologue go here.  In a
simple program, all the rest of the program can go here.

<div class="node">
<p><hr>
<a name="Examples"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Grammar-File">Grammar File</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Concepts">Concepts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">2 Examples</h2>

<p><a name="index-simple-examples-69"></a><a name="index-examples_002c-simple-70"></a>
Now we show and explain three sample programs written using Bison: a
reverse polish notation calculator, an algebraic (infix) notation
calculator, and a multi-function calculator.  All three have been tested
under BSD Unix 4.3; each produces a usable, though limited, interactive
desk-top calculator.

   <p>These examples are simple, but Bison grammars for real programming
languages are written the same way.  You can copy these examples into a
source file to try them.

<ul class="menu">
<li><a accesskey="1" href="#RPN-Calc">RPN Calc</a>:                Reverse polish notation calculator;
                             a first example with no operator precedence. 
<li><a accesskey="2" href="#Infix-Calc">Infix Calc</a>:              Infix (algebraic) notation calculator. 
                             Operator precedence is introduced. 
<li><a accesskey="3" href="#Simple-Error-Recovery">Simple Error Recovery</a>:   Continuing after syntax errors. 
<li><a accesskey="4" href="#Location-Tracking-Calc">Location Tracking Calc</a>:  Demonstrating the use of @<var>n</var> and @$. 
<li><a accesskey="5" href="#Multi_002dfunction-Calc">Multi-function Calc</a>:     Calculator with memory and trig functions. 
                             It uses multiple data-types for semantic values. 
<li><a accesskey="6" href="#Exercises">Exercises</a>:               Ideas for improving the multi-function calculator. 
</ul>

<div class="node">
<p><hr>
<a name="RPN-Calc"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Infix-Calc">Infix Calc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Examples">Examples</a>
<br>
</div>

<h3 class="section">2.1 Reverse Polish Notation Calculator</h3>

<p><a name="index-reverse-polish-notation-71"></a><a name="index-polish-notation-calculator-72"></a><a name="index-_0040code_007brpcalc_007d-73"></a><a name="index-calculator_002c-simple-74"></a>
The first example is that of a simple double-precision <dfn>reverse polish
notation</dfn> calculator (a calculator using postfix operators).  This example
provides a good starting point, since operator precedence is not an issue. 
The second example will illustrate how operator precedence is handled.

   <p>The source code for this calculator is named <span class="file">rpcalc.y</span>.  The
<span class="samp">.y</span> extension is a convention used for Bison input files.

<ul class="menu">
<li><a accesskey="1" href="#Rpcalc-Declarations">Rpcalc Declarations</a>:     Prologue (declarations) for rpcalc. 
<li><a accesskey="2" href="#Rpcalc-Rules">Rpcalc Rules</a>:            Grammar Rules for rpcalc, with explanation. 
<li><a accesskey="3" href="#Rpcalc-Lexer">Rpcalc Lexer</a>:            The lexical analyzer. 
<li><a accesskey="4" href="#Rpcalc-Main">Rpcalc Main</a>:             The controlling function. 
<li><a accesskey="5" href="#Rpcalc-Error">Rpcalc Error</a>:            The error reporting function. 
<li><a accesskey="6" href="#Rpcalc-Generate">Rpcalc Generate</a>:         Running Bison on the grammar file. 
<li><a accesskey="7" href="#Rpcalc-Compile">Rpcalc Compile</a>:          Run the C compiler on the output code. 
</ul>

<div class="node">
<p><hr>
<a name="Rpcalc-Declarations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Rules">Rpcalc Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#RPN-Calc">RPN Calc</a>
<br>
</div>

<h4 class="subsection">2.1.1 Declarations for <code>rpcalc</code></h4>

<p>Here are the C and Bison declarations for the reverse polish notation
calculator.  As in C, comments are placed between <span class="samp">/*...*/</span>.

<pre class="example">     /* Reverse polish notation calculator.  */
     
     %{
       #define YYSTYPE double
       #include &lt;math.h&gt;
       int yylex (void);
       void yyerror (char const *);
     %}
     
     %token NUM
     
     %% /* Grammar rules and actions follow.  */
</pre>
   <p>The declarations section (see <a href="#Prologue">The prologue</a>) contains two
preprocessor directives and two forward declarations.

   <p>The <code>#define</code> directive defines the macro <code>YYSTYPE</code>, thus
specifying the C data type for semantic values of both tokens and
groupings (see <a href="#Value-Type">Data Types of Semantic Values</a>).  The
Bison parser will use whatever type <code>YYSTYPE</code> is defined as; if you
don't define it, <code>int</code> is the default.  Because we specify
<code>double</code>, each token and each expression has an associated value,
which is a floating point number.

   <p>The <code>#include</code> directive is used to declare the exponentiation
function <code>pow</code>.

   <p>The forward declarations for <code>yylex</code> and <code>yyerror</code> are
needed because the C language requires that functions be declared
before they are used.  These functions will be defined in the
epilogue, but the parser calls them so they must be declared in the
prologue.

   <p>The second section, Bison declarations, provides information to Bison
about the token types (see <a href="#Bison-Declarations">The Bison Declarations Section</a>).  Each terminal symbol that is not a
single-character literal must be declared here.  (Single-character
literals normally don't need to be declared.)  In this example, all the
arithmetic operators are designated by single-character literals, so the
only terminal symbol that needs to be declared is <code>NUM</code>, the token
type for numeric constants.

<div class="node">
<p><hr>
<a name="Rpcalc-Rules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Lexer">Rpcalc Lexer</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Declarations">Rpcalc Declarations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#RPN-Calc">RPN Calc</a>
<br>
</div>

<h4 class="subsection">2.1.2 Grammar Rules for <code>rpcalc</code></h4>

<p>Here are the grammar rules for the reverse polish notation calculator.

<pre class="example">     input:    /* empty */
             | input line
     ;
     
     line:     '\n'
             | exp '\n'      { printf ("\t%.10g\n", $1); }
     ;
     
     exp:      NUM           { $$ = $1;           }
             | exp exp '+'   { $$ = $1 + $2;      }
             | exp exp '-'   { $$ = $1 - $2;      }
             | exp exp '*'   { $$ = $1 * $2;      }
             | exp exp '/'   { $$ = $1 / $2;      }
              /* Exponentiation */
             | exp exp '^'   { $$ = pow ($1, $2); }
              /* Unary minus    */
             | exp 'n'       { $$ = -$1;          }
     ;
     %%
</pre>
   <p>The groupings of the rpcalc &ldquo;language&rdquo; defined here are the expression
(given the name <code>exp</code>), the line of input (<code>line</code>), and the
complete input transcript (<code>input</code>).  Each of these nonterminal
symbols has several alternate rules, joined by the vertical bar <span class="samp">|</span>
which is read as &ldquo;or&rdquo;.  The following sections explain what these rules
mean.

   <p>The semantics of the language is determined by the actions taken when a
grouping is recognized.  The actions are the C code that appears inside
braces.  See <a href="#Actions">Actions</a>.

   <p>You must specify these actions in C, but Bison provides the means for
passing semantic values between the rules.  In each action, the
pseudo-variable <code>$$</code> stands for the semantic value for the grouping
that the rule is going to construct.  Assigning a value to <code>$$</code> is the
main job of most actions.  The semantic values of the components of the
rule are referred to as <code>$1</code>, <code>$2</code>, and so on.

<ul class="menu">
<li><a accesskey="1" href="#Rpcalc-Input">Rpcalc Input</a>
<li><a accesskey="2" href="#Rpcalc-Line">Rpcalc Line</a>
<li><a accesskey="3" href="#Rpcalc-Expr">Rpcalc Expr</a>
</ul>

<div class="node">
<p><hr>
<a name="Rpcalc-Input"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Line">Rpcalc Line</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rpcalc-Rules">Rpcalc Rules</a>
<br>
</div>

<h5 class="subsubsection">2.1.2.1 Explanation of <code>input</code></h5>

<p>Consider the definition of <code>input</code>:

<pre class="example">     input:    /* empty */
             | input line
     ;
</pre>
   <p>This definition reads as follows: &ldquo;A complete input is either an empty
string, or a complete input followed by an input line&rdquo;.  Notice that
&ldquo;complete input&rdquo; is defined in terms of itself.  This definition is said
to be <dfn>left recursive</dfn> since <code>input</code> appears always as the
leftmost symbol in the sequence.  See <a href="#Recursion">Recursive Rules</a>.

   <p>The first alternative is empty because there are no symbols between the
colon and the first <span class="samp">|</span>; this means that <code>input</code> can match an
empty string of input (no tokens).  We write the rules this way because it
is legitimate to type <kbd>Ctrl-d</kbd> right after you start the calculator. 
It's conventional to put an empty alternative first and write the comment
<span class="samp">/* empty */</span> in it.

   <p>The second alternate rule (<code>input line</code>) handles all nontrivial input. 
It means, &ldquo;After reading any number of lines, read one more line if
possible.&rdquo;  The left recursion makes this rule into a loop.  Since the
first alternative matches empty input, the loop can be executed zero or
more times.

   <p>The parser function <code>yyparse</code> continues to process input until a
grammatical error is seen or the lexical analyzer says there are no more
input tokens; we will arrange for the latter to happen at end-of-input.

<div class="node">
<p><hr>
<a name="Rpcalc-Line"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Expr">Rpcalc Expr</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Input">Rpcalc Input</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rpcalc-Rules">Rpcalc Rules</a>
<br>
</div>

<h5 class="subsubsection">2.1.2.2 Explanation of <code>line</code></h5>

<p>Now consider the definition of <code>line</code>:

<pre class="example">     line:     '\n'
             | exp '\n'  { printf ("\t%.10g\n", $1); }
     ;
</pre>
   <p>The first alternative is a token which is a newline character; this means
that rpcalc accepts a blank line (and ignores it, since there is no
action).  The second alternative is an expression followed by a newline. 
This is the alternative that makes rpcalc useful.  The semantic value of
the <code>exp</code> grouping is the value of <code>$1</code> because the <code>exp</code> in
question is the first symbol in the alternative.  The action prints this
value, which is the result of the computation the user asked for.

   <p>This action is unusual because it does not assign a value to <code>$$</code>.  As
a consequence, the semantic value associated with the <code>line</code> is
uninitialized (its value will be unpredictable).  This would be a bug if
that value were ever used, but we don't use it: once rpcalc has printed the
value of the user's input line, that value is no longer needed.

<div class="node">
<p><hr>
<a name="Rpcalc-Expr"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Line">Rpcalc Line</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Rpcalc-Rules">Rpcalc Rules</a>
<br>
</div>

<h5 class="subsubsection">2.1.2.3 Explanation of <code>expr</code></h5>

<p>The <code>exp</code> grouping has several rules, one for each kind of expression. 
The first rule handles the simplest expressions: those that are just numbers. 
The second handles an addition-expression, which looks like two expressions
followed by a plus-sign.  The third handles subtraction, and so on.

<pre class="example">     exp:      NUM
             | exp exp '+'     { $$ = $1 + $2;    }
             | exp exp '-'     { $$ = $1 - $2;    }
             ...
             ;
</pre>
   <p>We have used <span class="samp">|</span> to join all the rules for <code>exp</code>, but we could
equally well have written them separately:

<pre class="example">     exp:      NUM ;
     exp:      exp exp '+'     { $$ = $1 + $2;    } ;
     exp:      exp exp '-'     { $$ = $1 - $2;    } ;
             ...
</pre>
   <p>Most of the rules have actions that compute the value of the expression in
terms of the value of its parts.  For example, in the rule for addition,
<code>$1</code> refers to the first component <code>exp</code> and <code>$2</code> refers to
the second one.  The third component, <code>'+'</code>, has no meaningful
associated semantic value, but if it had one you could refer to it as
<code>$3</code>.  When <code>yyparse</code> recognizes a sum expression using this
rule, the sum of the two subexpressions' values is produced as the value of
the entire expression.  See <a href="#Actions">Actions</a>.

   <p>You don't have to give an action for every rule.  When a rule has no
action, Bison by default copies the value of <code>$1</code> into <code>$$</code>. 
This is what happens in the first rule (the one that uses <code>NUM</code>).

   <p>The formatting shown here is the recommended convention, but Bison does
not require it.  You can add or change white space as much as you wish. 
For example, this:

<pre class="example">     exp   : NUM | exp exp '+' {$$ = $1 + $2; } | ... ;
</pre>
   <p class="noindent">means the same thing as this:

<pre class="example">     exp:      NUM
             | exp exp '+'    { $$ = $1 + $2; }
             | ...
     ;
</pre>
   <p class="noindent">The latter, however, is much more readable.

<div class="node">
<p><hr>
<a name="Rpcalc-Lexer"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Main">Rpcalc Main</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Rules">Rpcalc Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#RPN-Calc">RPN Calc</a>
<br>
</div>

<h4 class="subsection">2.1.3 The <code>rpcalc</code> Lexical Analyzer</h4>

<p><a name="index-writing-a-lexical-analyzer-75"></a><a name="index-lexical-analyzer_002c-writing-76"></a>
The lexical analyzer's job is low-level parsing: converting characters
or sequences of characters into tokens.  The Bison parser gets its
tokens by calling the lexical analyzer.  See <a href="#Lexical">The Lexical Analyzer Function <code>yylex</code></a>.

   <p>Only a simple lexical analyzer is needed for the <acronym>RPN</acronym>
calculator.  This
lexical analyzer skips blanks and tabs, then reads in numbers as
<code>double</code> and returns them as <code>NUM</code> tokens.  Any other character
that isn't part of a number is a separate token.  Note that the token-code
for such a single-character token is the character itself.

   <p>The return value of the lexical analyzer function is a numeric code which
represents a token type.  The same text used in Bison rules to stand for
this token type is also a C expression for the numeric code for the type. 
This works in two ways.  If the token type is a character literal, then its
numeric code is that of the character; you can use the same
character literal in the lexical analyzer to express the number.  If the
token type is an identifier, that identifier is defined by Bison as a C
macro whose definition is the appropriate number.  In this example,
therefore, <code>NUM</code> becomes a macro for <code>yylex</code> to use.

   <p>The semantic value of the token (if it has one) is stored into the
global variable <code>yylval</code>, which is where the Bison parser will look
for it.  (The C data type of <code>yylval</code> is <code>YYSTYPE</code>, which was
defined at the beginning of the grammar; see <a href="#Rpcalc-Declarations">Declarations for <code>rpcalc</code></a>.)

   <p>A token type code of zero is returned if the end-of-input is encountered. 
(Bison recognizes any nonpositive value as indicating end-of-input.)

   <p>Here is the code for the lexical analyzer:

<pre class="example">     /* The lexical analyzer returns a double floating point
        number on the stack and the token NUM, or the numeric code
        of the character read if not a number.  It skips all blanks
        and tabs, and returns 0 for end-of-input.  */
     
     #include &lt;ctype.h&gt;
     
     int
     yylex (void)
     {
       int c;
     
       /* Skip white space.  */
       while ((c = getchar ()) == ' ' || c == '\t')
         ;
       /* Process numbers.  */
       if (c == '.' || isdigit (c))
         {
           ungetc (c, stdin);
           scanf ("%lf", &amp;yylval);
           return NUM;
         }
       /* Return end-of-input.  */
       if (c == EOF)
         return 0;
       /* Return a single char.  */
       return c;
     }
</pre>
   <div class="node">
<p><hr>
<a name="Rpcalc-Main"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Error">Rpcalc Error</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Lexer">Rpcalc Lexer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#RPN-Calc">RPN Calc</a>
<br>
</div>

<h4 class="subsection">2.1.4 The Controlling Function</h4>

<p><a name="index-controlling-function-77"></a><a name="index-main-function-in-simple-example-78"></a>
In keeping with the spirit of this example, the controlling function is
kept to the bare minimum.  The only requirement is that it call
<code>yyparse</code> to start the process of parsing.

<pre class="example">     int
     main (void)
     {
       return yyparse ();
     }
</pre>
   <div class="node">
<p><hr>
<a name="Rpcalc-Error"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Generate">Rpcalc Generate</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Main">Rpcalc Main</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#RPN-Calc">RPN Calc</a>
<br>
</div>

<h4 class="subsection">2.1.5 The Error Reporting Routine</h4>

<p><a name="index-error-reporting-routine-79"></a>
When <code>yyparse</code> detects a syntax error, it calls the error reporting
function <code>yyerror</code> to print an error message (usually but not
always <code>"syntax error"</code>).  It is up to the programmer to supply
<code>yyerror</code> (see <a href="#Interface">Parser C-Language Interface</a>), so
here is the definition we will use:

<pre class="example">     #include &lt;stdio.h&gt;
     
     /* Called by yyparse on error.  */
     void
     yyerror (char const *s)
     {
       fprintf (stderr, "%s\n", s);
     }
</pre>
   <p>After <code>yyerror</code> returns, the Bison parser may recover from the error
and continue parsing if the grammar contains a suitable error rule
(see <a href="#Error-Recovery">Error Recovery</a>).  Otherwise, <code>yyparse</code> returns nonzero.  We
have not written any error rules in this example, so any invalid input will
cause the calculator program to exit.  This is not clean behavior for a
real calculator, but it is adequate for the first example.

<div class="node">
<p><hr>
<a name="Rpcalc-Generate"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rpcalc-Compile">Rpcalc Compile</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Error">Rpcalc Error</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#RPN-Calc">RPN Calc</a>
<br>
</div>

<h4 class="subsection">2.1.6 Running Bison to Make the Parser</h4>

<p><a name="index-running-Bison-_0028introduction_0029-80"></a>
Before running Bison to produce a parser, we need to decide how to
arrange all the source code in one or more source files.  For such a
simple example, the easiest thing is to put everything in one file.  The
definitions of <code>yylex</code>, <code>yyerror</code> and <code>main</code> go at the
end, in the epilogue of the file
(see <a href="#Grammar-Layout">The Overall Layout of a Bison Grammar</a>).

   <p>For a large project, you would probably have several source files, and use
<code>make</code> to arrange to recompile them.

   <p>With all the source in a single file, you use the following command to
convert it into a parser file:

<pre class="example">     bison <var>file</var>.y
</pre>
   <p class="noindent">In this example the file was called <span class="file">rpcalc.y</span> (for &ldquo;Reverse Polish
<span class="sc">calc</span>ulator&rdquo;).  Bison produces a file named <var>file</var><span class="file">.tab.c</span>,
removing the <span class="samp">.y</span> from the original file name.  The file output by
Bison contains the source code for <code>yyparse</code>.  The additional
functions in the input file (<code>yylex</code>, <code>yyerror</code> and <code>main</code>)
are copied verbatim to the output.

<div class="node">
<p><hr>
<a name="Rpcalc-Compile"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rpcalc-Generate">Rpcalc Generate</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#RPN-Calc">RPN Calc</a>
<br>
</div>

<h4 class="subsection">2.1.7 Compiling the Parser File</h4>

<p><a name="index-compiling-the-parser-81"></a>
Here is how to compile and run the parser file:

<pre class="example">     # <span class="roman">List files in current directory.</span>
     $ <kbd>ls</kbd>
     rpcalc.tab.c  rpcalc.y
     
     # <span class="roman">Compile the Bison parser.</span>
     # <span class="roman">-lm tells compiler to search math library for </span><code>pow</code><span class="roman">.</span>
     $ <kbd>cc -lm -o rpcalc rpcalc.tab.c</kbd>
     
     # <span class="roman">List files again.</span>
     $ <kbd>ls</kbd>
     rpcalc  rpcalc.tab.c  rpcalc.y
</pre>
   <p>The file <span class="file">rpcalc</span> now contains the executable code.  Here is an
example session using <code>rpcalc</code>.

<pre class="example">     $ <kbd>rpcalc</kbd>
     <kbd>4 9 +</kbd>
     13
     <kbd>3 7 + 3 4 5 *+-</kbd>
     -13
     <kbd>3 7 + 3 4 5 * + - n</kbd>              <span class="roman">Note the unary minus, n</span>
     13
     <kbd>5 6 / 4 n +</kbd>
     -3.166666667
     <kbd>3 4 ^</kbd>                            <span class="roman">Exponentiation</span>
     81
     <kbd>^D</kbd>                               <span class="roman">End-of-file indicator</span>
     $
</pre>
   <div class="node">
<p><hr>
<a name="Infix-Calc"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Simple-Error-Recovery">Simple Error Recovery</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#RPN-Calc">RPN Calc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Examples">Examples</a>
<br>
</div>

<h3 class="section">2.2 Infix Notation Calculator: <code>calc</code></h3>

<p><a name="index-infix-notation-calculator-82"></a><a name="index-_0040code_007bcalc_007d-83"></a><a name="index-calculator_002c-infix-notation-84"></a>
We now modify rpcalc to handle infix operators instead of postfix.  Infix
notation involves the concept of operator precedence and the need for
parentheses nested to arbitrary depth.  Here is the Bison code for
<span class="file">calc.y</span>, an infix desk-top calculator.

<pre class="example">     /* Infix notation calculator.  */
     
     %{
       #define YYSTYPE double
       #include &lt;math.h&gt;
       #include &lt;stdio.h&gt;
       int yylex (void);
       void yyerror (char const *);
     %}
     
     /* Bison declarations.  */
     %token NUM
     %left '-' '+'
     %left '*' '/'
     %left NEG     /* negation--unary minus */
     %right '^'    /* exponentiation */
     
     %% /* The grammar follows.  */
     input:    /* empty */
             | input line
     ;
     
     line:     '\n'
             | exp '\n'  { printf ("\t%.10g\n", $1); }
     ;
     
     exp:      NUM                { $$ = $1;         }
             | exp '+' exp        { $$ = $1 + $3;    }
             | exp '-' exp        { $$ = $1 - $3;    }
             | exp '*' exp        { $$ = $1 * $3;    }
             | exp '/' exp        { $$ = $1 / $3;    }
             | '-' exp  %prec NEG { $$ = -$2;        }
             | exp '^' exp        { $$ = pow ($1, $3); }
             | '(' exp ')'        { $$ = $2;         }
     ;
     %%
</pre>
   <p class="noindent">The functions <code>yylex</code>, <code>yyerror</code> and <code>main</code> can be the
same as before.

   <p>There are two important new features shown in this code.

   <p>In the second section (Bison declarations), <code>%left</code> declares token
types and says they are left-associative operators.  The declarations
<code>%left</code> and <code>%right</code> (right associativity) take the place of
<code>%token</code> which is used to declare a token type name without
associativity.  (These tokens are single-character literals, which
ordinarily don't need to be declared.  We declare them here to specify
the associativity.)

   <p>Operator precedence is determined by the line ordering of the
declarations; the higher the line number of the declaration (lower on
the page or screen), the higher the precedence.  Hence, exponentiation
has the highest precedence, unary minus (<code>NEG</code>) is next, followed
by <span class="samp">*</span> and <span class="samp">/</span>, and so on.  See <a href="#Precedence">Operator Precedence</a>.

   <p>The other important new feature is the <code>%prec</code> in the grammar
section for the unary minus operator.  The <code>%prec</code> simply instructs
Bison that the rule <span class="samp">| '-' exp</span> has the same precedence as
<code>NEG</code>&mdash;in this case the next-to-highest.  See <a href="#Contextual-Precedence">Context-Dependent Precedence</a>.

   <p>Here is a sample run of <span class="file">calc.y</span>:

<pre class="example">     $ <kbd>calc</kbd>
     <kbd>4 + 4.5 - (34/(8*3+-3))</kbd>
     6.880952381
     <kbd>-56 + 2</kbd>
     -54
     <kbd>3 ^ 2</kbd>
     9
</pre>
   <div class="node">
<p><hr>
<a name="Simple-Error-Recovery"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Location-Tracking-Calc">Location Tracking Calc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Infix-Calc">Infix Calc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Examples">Examples</a>
<br>
</div>

<h3 class="section">2.3 Simple Error Recovery</h3>

<p><a name="index-error-recovery_002c-simple-85"></a>
Up to this point, this manual has not addressed the issue of <dfn>error
recovery</dfn>&mdash;how to continue parsing after the parser detects a syntax
error.  All we have handled is error reporting with <code>yyerror</code>. 
Recall that by default <code>yyparse</code> returns after calling
<code>yyerror</code>.  This means that an erroneous input line causes the
calculator program to exit.  Now we show how to rectify this deficiency.

   <p>The Bison language itself includes the reserved word <code>error</code>, which
may be included in the grammar rules.  In the example below it has
been added to one of the alternatives for <code>line</code>:

<pre class="example">     line:     '\n'
             | exp '\n'   { printf ("\t%.10g\n", $1); }
             | error '\n' { yyerrok;                  }
     ;
</pre>
   <p>This addition to the grammar allows for simple error recovery in the
event of a syntax error.  If an expression that cannot be evaluated is
read, the error will be recognized by the third rule for <code>line</code>,
and parsing will continue.  (The <code>yyerror</code> function is still called
upon to print its message as well.)  The action executes the statement
<code>yyerrok</code>, a macro defined automatically by Bison; its meaning is
that error recovery is complete (see <a href="#Error-Recovery">Error Recovery</a>).  Note the
difference between <code>yyerrok</code> and <code>yyerror</code>; neither one is a
misprint.

   <p>This form of error recovery deals with syntax errors.  There are other
kinds of errors; for example, division by zero, which raises an exception
signal that is normally fatal.  A real calculator program must handle this
signal and use <code>longjmp</code> to return to <code>main</code> and resume parsing
input lines; it would also have to discard the rest of the current line of
input.  We won't discuss this issue further because it is not specific to
Bison programs.

<div class="node">
<p><hr>
<a name="Location-Tracking-Calc"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Multi_002dfunction-Calc">Multi-function Calc</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Simple-Error-Recovery">Simple Error Recovery</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Examples">Examples</a>
<br>
</div>

<h3 class="section">2.4 Location Tracking Calculator: <code>ltcalc</code></h3>

<p><a name="index-location-tracking-calculator-86"></a><a name="index-_0040code_007bltcalc_007d-87"></a><a name="index-calculator_002c-location-tracking-88"></a>
This example extends the infix notation calculator with location
tracking.  This feature will be used to improve the error messages.  For
the sake of clarity, this example is a simple integer calculator, since
most of the work needed to use locations will be done in the lexical
analyzer.

<ul class="menu">
<li><a accesskey="1" href="#Ltcalc-Declarations">Ltcalc Declarations</a>:     Bison and C declarations for ltcalc. 
<li><a accesskey="2" href="#Ltcalc-Rules">Ltcalc Rules</a>:            Grammar rules for ltcalc, with explanations. 
<li><a accesskey="3" href="#Ltcalc-Lexer">Ltcalc Lexer</a>:            The lexical analyzer. 
</ul>

<div class="node">
<p><hr>
<a name="Ltcalc-Declarations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Ltcalc-Rules">Ltcalc Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Location-Tracking-Calc">Location Tracking Calc</a>
<br>
</div>

<h4 class="subsection">2.4.1 Declarations for <code>ltcalc</code></h4>

<p>The C and Bison declarations for the location tracking calculator are
the same as the declarations for the infix notation calculator.

<pre class="example">     /* Location tracking calculator.  */
     
     %{
       #define YYSTYPE int
       #include &lt;math.h&gt;
       int yylex (void);
       void yyerror (char const *);
     %}
     
     /* Bison declarations.  */
     %token NUM
     
     %left '-' '+'
     %left '*' '/'
     %left NEG
     %right '^'
     
     %% /* The grammar follows.  */
</pre>
   <p class="noindent">Note there are no declarations specific to locations.  Defining a data
type for storing locations is not needed: we will use the type provided
by default (see <a href="#Location-Type">Data Types of Locations</a>), which is a
four member structure with the following integer fields:
<code>first_line</code>, <code>first_column</code>, <code>last_line</code> and
<code>last_column</code>.  By conventions, and in accordance with the GNU
Coding Standards and common practice, the line and column count both
start at 1.

<div class="node">
<p><hr>
<a name="Ltcalc-Rules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Ltcalc-Lexer">Ltcalc Lexer</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Ltcalc-Declarations">Ltcalc Declarations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Location-Tracking-Calc">Location Tracking Calc</a>
<br>
</div>

<h4 class="subsection">2.4.2 Grammar Rules for <code>ltcalc</code></h4>

<p>Whether handling locations or not has no effect on the syntax of your
language.  Therefore, grammar rules for this example will be very close
to those of the previous example: we will only modify them to benefit
from the new information.

   <p>Here, we will use locations to report divisions by zero, and locate the
wrong expressions or subexpressions.

<pre class="example">     input   : /* empty */
             | input line
     ;
     
     line    : '\n'
             | exp '\n' { printf ("%d\n", $1); }
     ;
     
     exp     : NUM           { $$ = $1; }
             | exp '+' exp   { $$ = $1 + $3; }
             | exp '-' exp   { $$ = $1 - $3; }
             | exp '*' exp   { $$ = $1 * $3; }
             | exp '/' exp
                 {
                   if ($3)
                     $$ = $1 / $3;
                   else
                     {
                       $$ = 1;
                       fprintf (stderr, "%d.%d-%d.%d: division by zero",
                                @3.first_line, @3.first_column,
                                @3.last_line, @3.last_column);
                     }
                 }
             | '-' exp %prec NEG     { $$ = -$2; }
             | exp '^' exp           { $$ = pow ($1, $3); }
             | '(' exp ')'           { $$ = $2; }
</pre>
   <p>This code shows how to reach locations inside of semantic actions, by
using the pseudo-variables <code>@</code><var>n</var> for rule components, and the
pseudo-variable <code>@$</code> for groupings.

   <p>We don't need to assign a value to <code>@$</code>: the output parser does it
automatically.  By default, before executing the C code of each action,
<code>@$</code> is set to range from the beginning of <code>@1</code> to the end
of <code>@</code><var>n</var>, for a rule with <var>n</var> components.  This behavior
can be redefined (see <a href="#Location-Default-Action">Default Action for Locations</a>), and for very specific rules, <code>@$</code> can be computed by
hand.

<div class="node">
<p><hr>
<a name="Ltcalc-Lexer"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Ltcalc-Rules">Ltcalc Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Location-Tracking-Calc">Location Tracking Calc</a>
<br>
</div>

<h4 class="subsection">2.4.3 The <code>ltcalc</code> Lexical Analyzer.</h4>

<p>Until now, we relied on Bison's defaults to enable location
tracking.  The next step is to rewrite the lexical analyzer, and make it
able to feed the parser with the token locations, as it already does for
semantic values.

   <p>To this end, we must take into account every single character of the
input text, to avoid the computed locations of being fuzzy or wrong:

<pre class="example">     int
     yylex (void)
     {
       int c;
     
       /* Skip white space.  */
       while ((c = getchar ()) == ' ' || c == '\t')
         ++yylloc.last_column;
     
       /* Step.  */
       yylloc.first_line = yylloc.last_line;
       yylloc.first_column = yylloc.last_column;
     
       /* Process numbers.  */
       if (isdigit (c))
         {
           yylval = c - '0';
           ++yylloc.last_column;
           while (isdigit (c = getchar ()))
             {
               ++yylloc.last_column;
               yylval = yylval * 10 + c - '0';
             }
           ungetc (c, stdin);
           return NUM;
         }
     
       /* Return end-of-input.  */
       if (c == EOF)
         return 0;
     
       /* Return a single char, and update location.  */
       if (c == '\n')
         {
           ++yylloc.last_line;
           yylloc.last_column = 0;
         }
       else
         ++yylloc.last_column;
       return c;
     }
</pre>
   <p>Basically, the lexical analyzer performs the same processing as before:
it skips blanks and tabs, and reads numbers or single-character tokens. 
In addition, it updates <code>yylloc</code>, the global variable (of type
<code>YYLTYPE</code>) containing the token's location.

   <p>Now, each time this function returns a token, the parser has its number
as well as its semantic value, and its location in the text.  The last
needed change is to initialize <code>yylloc</code>, for example in the
controlling function:

<pre class="example">     int
     main (void)
     {
       yylloc.first_line = yylloc.last_line = 1;
       yylloc.first_column = yylloc.last_column = 0;
       return yyparse ();
     }
</pre>
   <p>Remember that computing locations is not a matter of syntax.  Every
character must be associated to a location update, whether it is in
valid input, in comments, in literal strings, and so on.

<div class="node">
<p><hr>
<a name="Multi_002dfunction-Calc"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Exercises">Exercises</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Location-Tracking-Calc">Location Tracking Calc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Examples">Examples</a>
<br>
</div>

<h3 class="section">2.5 Multi-Function Calculator: <code>mfcalc</code></h3>

<p><a name="index-multi_002dfunction-calculator-89"></a><a name="index-_0040code_007bmfcalc_007d-90"></a><a name="index-calculator_002c-multi_002dfunction-91"></a>
Now that the basics of Bison have been discussed, it is time to move on to
a more advanced problem.  The above calculators provided only five
functions, <span class="samp">+</span>, <span class="samp">-</span>, <span class="samp">*</span>, <span class="samp">/</span> and <span class="samp">^</span>.  It would
be nice to have a calculator that provides other mathematical functions such
as <code>sin</code>, <code>cos</code>, etc.

   <p>It is easy to add new operators to the infix calculator as long as they are
only single-character literals.  The lexical analyzer <code>yylex</code> passes
back all nonnumeric characters as tokens, so new grammar rules suffice for
adding a new operator.  But we want something more flexible: built-in
functions whose syntax has this form:

<pre class="example">     <var>function_name</var> (<var>argument</var>)
</pre>
   <p class="noindent">At the same time, we will add memory to the calculator, by allowing you
to create named variables, store values in them, and use them later. 
Here is a sample session with the multi-function calculator:

<pre class="example">     $ <kbd>mfcalc</kbd>
     <kbd>pi = 3.141592653589</kbd>
     3.1415926536
     <kbd>sin(pi)</kbd>
     0.0000000000
     <kbd>alpha = beta1 = 2.3</kbd>
     2.3000000000
     <kbd>alpha</kbd>
     2.3000000000
     <kbd>ln(alpha)</kbd>
     0.8329091229
     <kbd>exp(ln(beta1))</kbd>
     2.3000000000
     $
</pre>
   <p>Note that multiple assignment and nested function calls are permitted.

<ul class="menu">
<li><a accesskey="1" href="#Mfcalc-Declarations">Mfcalc Declarations</a>:     Bison declarations for multi-function calculator. 
<li><a accesskey="2" href="#Mfcalc-Rules">Mfcalc Rules</a>:            Grammar rules for the calculator. 
<li><a accesskey="3" href="#Mfcalc-Symbol-Table">Mfcalc Symbol Table</a>:     Symbol table management subroutines. 
</ul>

<div class="node">
<p><hr>
<a name="Mfcalc-Declarations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Mfcalc-Rules">Mfcalc Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Multi_002dfunction-Calc">Multi-function Calc</a>
<br>
</div>

<h4 class="subsection">2.5.1 Declarations for <code>mfcalc</code></h4>

<p>Here are the C and Bison declarations for the multi-function calculator.

<pre class="smallexample">     %{
       #include &lt;math.h&gt;  /* For math functions, cos(), sin(), etc.  */
       #include "calc.h"  /* Contains definition of `symrec'.  */
       int yylex (void);
       void yyerror (char const *);
     %}
     %union {
       double    val;   /* For returning numbers.  */
       symrec  *tptr;   /* For returning symbol-table pointers.  */
     }
     %token &lt;val&gt;  NUM        /* Simple double precision number.  */
     %token &lt;tptr&gt; VAR FNCT   /* Variable and Function.  */
     %type  &lt;val&gt;  exp
     
     %right '='
     %left '-' '+'
     %left '*' '/'
     %left NEG     /* negation--unary minus */
     %right '^'    /* exponentiation */
     %% /* The grammar follows.  */
</pre>
   <p>The above grammar introduces only two new features of the Bison language. 
These features allow semantic values to have various data types
(see <a href="#Multiple-Types">More Than One Value Type</a>).

   <p>The <code>%union</code> declaration specifies the entire list of possible types;
this is instead of defining <code>YYSTYPE</code>.  The allowable types are now
double-floats (for <code>exp</code> and <code>NUM</code>) and pointers to entries in
the symbol table.  See <a href="#Union-Decl">The Collection of Value Types</a>.

   <p>Since values can now have various types, it is necessary to associate a
type with each grammar symbol whose semantic value is used.  These symbols
are <code>NUM</code>, <code>VAR</code>, <code>FNCT</code>, and <code>exp</code>.  Their
declarations are augmented with information about their data type (placed
between angle brackets).

   <p>The Bison construct <code>%type</code> is used for declaring nonterminal
symbols, just as <code>%token</code> is used for declaring token types.  We
have not used <code>%type</code> before because nonterminal symbols are
normally declared implicitly by the rules that define them.  But
<code>exp</code> must be declared explicitly so we can specify its value type. 
See <a href="#Type-Decl">Nonterminal Symbols</a>.

<div class="node">
<p><hr>
<a name="Mfcalc-Rules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Mfcalc-Symbol-Table">Mfcalc Symbol Table</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Mfcalc-Declarations">Mfcalc Declarations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Multi_002dfunction-Calc">Multi-function Calc</a>
<br>
</div>

<h4 class="subsection">2.5.2 Grammar Rules for <code>mfcalc</code></h4>

<p>Here are the grammar rules for the multi-function calculator. 
Most of them are copied directly from <code>calc</code>; three rules,
those which mention <code>VAR</code> or <code>FNCT</code>, are new.

<pre class="smallexample">     input:   /* empty */
             | input line
     ;
     
     line:
               '\n'
             | exp '\n'   { printf ("\t%.10g\n", $1); }
             | error '\n' { yyerrok;                  }
     ;
     
     exp:      NUM                { $$ = $1;                         }
             | VAR                { $$ = $1-&gt;value.var;              }
             | VAR '=' exp        { $$ = $3; $1-&gt;value.var = $3;     }
             | FNCT '(' exp ')'   { $$ = (*($1-&gt;value.fnctptr))($3); }
             | exp '+' exp        { $$ = $1 + $3;                    }
             | exp '-' exp        { $$ = $1 - $3;                    }
             | exp '*' exp        { $$ = $1 * $3;                    }
             | exp '/' exp        { $$ = $1 / $3;                    }
             | '-' exp  %prec NEG { $$ = -$2;                        }
             | exp '^' exp        { $$ = pow ($1, $3);               }
             | '(' exp ')'        { $$ = $2;                         }
     ;
     /* End of grammar.  */
     %%
</pre>
   <div class="node">
<p><hr>
<a name="Mfcalc-Symbol-Table"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Mfcalc-Rules">Mfcalc Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Multi_002dfunction-Calc">Multi-function Calc</a>
<br>
</div>

<h4 class="subsection">2.5.3 The <code>mfcalc</code> Symbol Table</h4>

<p><a name="index-symbol-table-example-92"></a>
The multi-function calculator requires a symbol table to keep track of the
names and meanings of variables and functions.  This doesn't affect the
grammar rules (except for the actions) or the Bison declarations, but it
requires some additional C functions for support.

   <p>The symbol table itself consists of a linked list of records.  Its
definition, which is kept in the header <span class="file">calc.h</span>, is as follows.  It
provides for either functions or variables to be placed in the table.

<pre class="smallexample">     /* Function type.  */
     typedef double (*func_t) (double);
     
     /* Data type for links in the chain of symbols.  */
     struct symrec
     {
       char *name;  /* name of symbol */
       int type;    /* type of symbol: either VAR or FNCT */
       union
       {
         double var;      /* value of a VAR */
         func_t fnctptr;  /* value of a FNCT */
       } value;
       struct symrec *next;  /* link field */
     };
     
     typedef struct symrec symrec;
     
     /* The symbol table: a chain of `struct symrec'.  */
     extern symrec *sym_table;
     
     symrec *putsym (char const *, int);
     symrec *getsym (char const *);
</pre>
   <p>The new version of <code>main</code> includes a call to <code>init_table</code>, a
function that initializes the symbol table.  Here it is, and
<code>init_table</code> as well:

<pre class="smallexample">     #include &lt;stdio.h&gt;
     
     /* Called by yyparse on error.  */
     void
     yyerror (char const *s)
     {
       printf ("%s\n", s);
     }
     
     struct init
     {
       char const *fname;
       double (*fnct) (double);
     };
     
     struct init const arith_fncts[] =
     {
       "sin",  sin,
       "cos",  cos,
       "atan", atan,
       "ln",   log,
       "exp",  exp,
       "sqrt", sqrt,
       0, 0
     };
     
     /* The symbol table: a chain of `struct symrec'.  */
     symrec *sym_table;
     
     /* Put arithmetic functions in table.  */
     void
     init_table (void)
     {
       int i;
       symrec *ptr;
       for (i = 0; arith_fncts[i].fname != 0; i++)
         {
           ptr = putsym (arith_fncts[i].fname, FNCT);
           ptr-&gt;value.fnctptr = arith_fncts[i].fnct;
         }
     }
     
     int
     main (void)
     {
       init_table ();
       return yyparse ();
     }
</pre>
   <p>By simply editing the initialization list and adding the necessary include
files, you can add additional functions to the calculator.

   <p>Two important functions allow look-up and installation of symbols in the
symbol table.  The function <code>putsym</code> is passed a name and the type
(<code>VAR</code> or <code>FNCT</code>) of the object to be installed.  The object is
linked to the front of the list, and a pointer to the object is returned. 
The function <code>getsym</code> is passed the name of the symbol to look up.  If
found, a pointer to that symbol is returned; otherwise zero is returned.

<pre class="smallexample">     symrec *
     putsym (char const *sym_name, int sym_type)
     {
       symrec *ptr;
       ptr = (symrec *) malloc (sizeof (symrec));
       ptr-&gt;name = (char *) malloc (strlen (sym_name) + 1);
       strcpy (ptr-&gt;name,sym_name);
       ptr-&gt;type = sym_type;
       ptr-&gt;value.var = 0; /* Set value to 0 even if fctn.  */
       ptr-&gt;next = (struct symrec *)sym_table;
       sym_table = ptr;
       return ptr;
     }
     
     symrec *
     getsym (char const *sym_name)
     {
       symrec *ptr;
       for (ptr = sym_table; ptr != (symrec *) 0;
            ptr = (symrec *)ptr-&gt;next)
         if (strcmp (ptr-&gt;name,sym_name) == 0)
           return ptr;
       return 0;
     }
</pre>
   <p>The function <code>yylex</code> must now recognize variables, numeric values, and
the single-character arithmetic operators.  Strings of alphanumeric
characters with a leading letter are recognized as either variables or
functions depending on what the symbol table says about them.

   <p>The string is passed to <code>getsym</code> for look up in the symbol table.  If
the name appears in the table, a pointer to its location and its type
(<code>VAR</code> or <code>FNCT</code>) is returned to <code>yyparse</code>.  If it is not
already in the table, then it is installed as a <code>VAR</code> using
<code>putsym</code>.  Again, a pointer and its type (which must be <code>VAR</code>) is
returned to <code>yyparse</code>.

   <p>No change is needed in the handling of numeric values and arithmetic
operators in <code>yylex</code>.

<pre class="smallexample">     #include &lt;ctype.h&gt;
     
     int
     yylex (void)
     {
       int c;
     
       /* Ignore white space, get first nonwhite character.  */
       while ((c = getchar ()) == ' ' || c == '\t');
     
       if (c == EOF)
         return 0;
     
       /* Char starts a number =&gt; parse the number.         */
       if (c == '.' || isdigit (c))
         {
           ungetc (c, stdin);
           scanf ("%lf", &amp;yylval.val);
           return NUM;
         }
     
       /* Char starts an identifier =&gt; read the name.       */
       if (isalpha (c))
         {
           symrec *s;
           static char *symbuf = 0;
           static int length = 0;
           int i;
     
           /* Initially make the buffer long enough
              for a 40-character symbol name.  */
           if (length == 0)
             length = 40, symbuf = (char *)malloc (length + 1);
     
           i = 0;
           do
             {
               /* If buffer is full, make it bigger.        */
               if (i == length)
                 {
                   length *= 2;
                   symbuf = (char *) realloc (symbuf, length + 1);
                 }
               /* Add this character to the buffer.         */
               symbuf[i++] = c;
               /* Get another character.                    */
               c = getchar ();
             }
           while (isalnum (c));
     
           ungetc (c, stdin);
           symbuf[i] = '\0';
     
           s = getsym (symbuf);
           if (s == 0)
             s = putsym (symbuf, VAR);
           yylval.tptr = s;
           return s-&gt;type;
         }
     
       /* Any other character is a token by itself.        */
       return c;
     }
</pre>
   <p>This program is both powerful and flexible.  You may easily add new
functions, and it is a simple job to modify this code to install
predefined variables such as <code>pi</code> or <code>e</code> as well.

<div class="node">
<p><hr>
<a name="Exercises"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multi_002dfunction-Calc">Multi-function Calc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Examples">Examples</a>
<br>
</div>

<h3 class="section">2.6 Exercises</h3>

<p><a name="index-exercises-93"></a>
     <ol type=1 start=1>
<li>Add some new functions from <span class="file">math.h</span> to the initialization list.

     <li>Add another array that contains constants and their values.  Then
modify <code>init_table</code> to add these constants to the symbol table. 
It will be easiest to give the constants type <code>VAR</code>.

     <li>Make the program report an error if the user refers to an
uninitialized variable in any way except to store a value in it.
        </ol>

<div class="node">
<p><hr>
<a name="Grammar-File"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Interface">Interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Examples">Examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">3 Bison Grammar Files</h2>

<p>Bison takes as input a context-free grammar specification and produces a
C-language function that recognizes correct instances of the grammar.

   <p>The Bison grammar input file conventionally has a name ending in <span class="samp">.y</span>. 
See <a href="#Invocation">Invoking Bison</a>.

<ul class="menu">
<li><a accesskey="1" href="#Grammar-Outline">Grammar Outline</a>:    Overall layout of the grammar file. 
<li><a accesskey="2" href="#Symbols">Symbols</a>:            Terminal and nonterminal symbols. 
<li><a accesskey="3" href="#Rules">Rules</a>:              How to write grammar rules. 
<li><a accesskey="4" href="#Recursion">Recursion</a>:          Writing recursive rules. 
<li><a accesskey="5" href="#Semantics">Semantics</a>:          Semantic values and actions. 
<li><a accesskey="6" href="#Locations">Locations</a>:          Locations and actions. 
<li><a accesskey="7" href="#Declarations">Declarations</a>:       All kinds of Bison declarations are described here. 
<li><a accesskey="8" href="#Multiple-Parsers">Multiple Parsers</a>:   Putting more than one Bison parser in one program. 
</ul>

<div class="node">
<p><hr>
<a name="Grammar-Outline"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Symbols">Symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.1 Outline of a Bison Grammar</h3>

<p>A Bison grammar file has four main sections, shown here with the
appropriate delimiters:

<pre class="example">     %{
       <var>Prologue</var>
     %}
     
     <var>Bison declarations</var>
     
     %%
     <var>Grammar rules</var>
     %%
     
     <var>Epilogue</var>
</pre>
   <p>Comments enclosed in <span class="samp">/* ... */</span> may appear in any of the sections. 
As a <acronym>GNU</acronym> extension, <span class="samp">//</span> introduces a comment that
continues until end of line.

<ul class="menu">
<li><a accesskey="1" href="#Prologue">Prologue</a>:               Syntax and usage of the prologue. 
<li><a accesskey="2" href="#Prologue-Alternatives">Prologue Alternatives</a>:  Syntax and usage of alternatives to the prologue. 
<li><a accesskey="3" href="#Bison-Declarations">Bison Declarations</a>:     Syntax and usage of the Bison declarations section. 
<li><a accesskey="4" href="#Grammar-Rules">Grammar Rules</a>:          Syntax and usage of the grammar rules section. 
<li><a accesskey="5" href="#Epilogue">Epilogue</a>:               Syntax and usage of the epilogue. 
</ul>

<div class="node">
<p><hr>
<a name="Prologue"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Prologue-Alternatives">Prologue Alternatives</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-Outline">Grammar Outline</a>
<br>
</div>

<h4 class="subsection">3.1.1 The prologue</h4>

<p><a name="index-declarations-section-94"></a><a name="index-Prologue-95"></a><a name="index-declarations-96"></a>
The <var>Prologue</var> section contains macro definitions and declarations
of functions and variables that are used in the actions in the grammar
rules.  These are copied to the beginning of the parser file so that
they precede the definition of <code>yyparse</code>.  You can use
<span class="samp">#include</span> to get the declarations from a header file.  If you
don't need any C declarations, you may omit the <span class="samp">%{</span> and
<span class="samp">%}</span> delimiters that bracket this section.

   <p>The <var>Prologue</var> section is terminated by the first occurrence
of <span class="samp">%}</span> that is outside a comment, a string literal, or a
character constant.

   <p>You may have more than one <var>Prologue</var> section, intermixed with the
<var>Bison declarations</var>.  This allows you to have C and Bison
declarations that refer to each other.  For example, the <code>%union</code>
declaration may use types defined in a header file, and you may wish to
prototype functions that take arguments of type <code>YYSTYPE</code>.  This
can be done with two <var>Prologue</var> blocks, one before and one after the
<code>%union</code> declaration.

<pre class="smallexample">     %{
       #define _GNU_SOURCE
       #include &lt;stdio.h&gt;
       #include "ptypes.h"
     %}
     
     %union {
       long int n;
       tree t;  /* <code>tree</code><span class="roman"> is defined in ptypes.h.</span> */
     }
     
     %{
       static void print_token_value (FILE *, int, YYSTYPE);
       #define YYPRINT(F, N, L) print_token_value (F, N, L)
     %}
     
     ...
</pre>
   <p>When in doubt, it is usually safer to put prologue code before all
Bison declarations, rather than after.  For example, any definitions
of feature test macros like <code>_GNU_SOURCE</code> or
<code>_POSIX_C_SOURCE</code> should appear before all Bison declarations, as
feature test macros can affect the behavior of Bison-generated
<code>#include</code> directives.

<div class="node">
<p><hr>
<a name="Prologue-Alternatives"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Bison-Declarations">Bison Declarations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Prologue">Prologue</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-Outline">Grammar Outline</a>
<br>
</div>

<h4 class="subsection">3.1.2 Prologue Alternatives</h4>

<p><a name="index-Prologue-Alternatives-97"></a>
<a name="index-_0025code-98"></a><a name="index-_0025code-requires-99"></a><a name="index-_0025code-provides-100"></a><a name="index-_0025code-top-101"></a>(The prologue alternatives described here are experimental. 
More user feedback will help to determine whether they should become permanent
features.)

   <p>The functionality of <var>Prologue</var> sections can often be subtle and
inflexible. 
As an alternative, Bison provides a %code directive with an explicit qualifier
field, which identifies the purpose of the code and thus the location(s) where
Bison should generate it. 
For C/C++, the qualifier can be omitted for the default location, or it can be
one of <code>requires</code>, <code>provides</code>, <code>top</code>. 
See <a href="#Decl-Summary">%code</a>.

   <p>Look again at the example of the previous section:

<pre class="smallexample">     %{
       #define _GNU_SOURCE
       #include &lt;stdio.h&gt;
       #include "ptypes.h"
     %}
     
     %union {
       long int n;
       tree t;  /* <code>tree</code><span class="roman"> is defined in ptypes.h.</span> */
     }
     
     %{
       static void print_token_value (FILE *, int, YYSTYPE);
       #define YYPRINT(F, N, L) print_token_value (F, N, L)
     %}
     
     ...
</pre>
   <p class="noindent">Notice that there are two <var>Prologue</var> sections here, but there's a subtle
distinction between their functionality. 
For example, if you decide to override Bison's default definition for
<code>YYLTYPE</code>, in which <var>Prologue</var> section should you write your new
definition? 
You should write it in the first since Bison will insert that code into the
parser source code file <em>before</em> the default <code>YYLTYPE</code> definition. 
In which <var>Prologue</var> section should you prototype an internal function,
<code>trace_token</code>, that accepts <code>YYLTYPE</code> and <code>yytokentype</code> as
arguments? 
You should prototype it in the second since Bison will insert that code
<em>after</em> the <code>YYLTYPE</code> and <code>yytokentype</code> definitions.

   <p>This distinction in functionality between the two <var>Prologue</var> sections is
established by the appearance of the <code>%union</code> between them. 
This behavior raises a few questions. 
First, why should the position of a <code>%union</code> affect definitions related to
<code>YYLTYPE</code> and <code>yytokentype</code>? 
Second, what if there is no <code>%union</code>? 
In that case, the second kind of <var>Prologue</var> section is not available. 
This behavior is not intuitive.

   <p>To avoid this subtle <code>%union</code> dependency, rewrite the example using a
<code>%code top</code> and an unqualified <code>%code</code>. 
Let's go ahead and add the new <code>YYLTYPE</code> definition and the
<code>trace_token</code> prototype at the same time:

<pre class="smallexample">     %code top {
       #define _GNU_SOURCE
       #include &lt;stdio.h&gt;
     
       /* WARNING: The following code really belongs
        * in a `%code requires'; see below.  */
     
       #include "ptypes.h"
       #define YYLTYPE YYLTYPE
       typedef struct YYLTYPE
       {
         int first_line;
         int first_column;
         int last_line;
         int last_column;
         char *filename;
       } YYLTYPE;
     }
     
     %union {
       long int n;
       tree t;  /* <code>tree</code><span class="roman"> is defined in ptypes.h.</span> */
     }
     
     %code {
       static void print_token_value (FILE *, int, YYSTYPE);
       #define YYPRINT(F, N, L) print_token_value (F, N, L)
       static void trace_token (enum yytokentype token, YYLTYPE loc);
     }
     
     ...
</pre>
   <p class="noindent">In this way, <code>%code top</code> and the unqualified <code>%code</code> achieve the same
functionality as the two kinds of <var>Prologue</var> sections, but it's always
explicit which kind you intend. 
Moreover, both kinds are always available even in the absence of <code>%union</code>.

   <p>The <code>%code top</code> block above logically contains two parts. 
The first two lines before the warning need to appear near the top of the
parser source code file. 
The first line after the warning is required by <code>YYSTYPE</code> and thus also
needs to appear in the parser source code file. 
However, if you've instructed Bison to generate a parser header file
(see <a href="#Decl-Summary">%defines</a>), you probably want that line to appear before
the <code>YYSTYPE</code> definition in that header file as well. 
The <code>YYLTYPE</code> definition should also appear in the parser header file to
override the default <code>YYLTYPE</code> definition there.

   <p>In other words, in the <code>%code top</code> block above, all but the first two
lines are dependency code required by the <code>YYSTYPE</code> and <code>YYLTYPE</code>
definitions. 
Thus, they belong in one or more <code>%code requires</code>:

<pre class="smallexample">     %code top {
       #define _GNU_SOURCE
       #include &lt;stdio.h&gt;
     }
     
     %code requires {
       #include "ptypes.h"
     }
     %union {
       long int n;
       tree t;  /* <code>tree</code><span class="roman"> is defined in ptypes.h.</span> */
     }
     
     %code requires {
       #define YYLTYPE YYLTYPE
       typedef struct YYLTYPE
       {
         int first_line;
         int first_column;
         int last_line;
         int last_column;
         char *filename;
       } YYLTYPE;
     }
     
     %code {
       static void print_token_value (FILE *, int, YYSTYPE);
       #define YYPRINT(F, N, L) print_token_value (F, N, L)
       static void trace_token (enum yytokentype token, YYLTYPE loc);
     }
     
     ...
</pre>
   <p class="noindent">Now Bison will insert <code>#include "ptypes.h"</code> and the new <code>YYLTYPE</code>
definition before the Bison-generated <code>YYSTYPE</code> and <code>YYLTYPE</code>
definitions in both the parser source code file and the parser header file. 
(By the same reasoning, <code>%code requires</code> would also be the appropriate
place to write your own definition for <code>YYSTYPE</code>.)

   <p>When you are writing dependency code for <code>YYSTYPE</code> and <code>YYLTYPE</code>, you
should prefer <code>%code requires</code> over <code>%code top</code> regardless of whether
you instruct Bison to generate a parser header file. 
When you are writing code that you need Bison to insert only into the parser
source code file and that has no special need to appear at the top of that
file, you should prefer the unqualified <code>%code</code> over <code>%code top</code>. 
These practices will make the purpose of each block of your code explicit to
Bison and to other developers reading your grammar file. 
Following these practices, we expect the unqualified <code>%code</code> and
<code>%code requires</code> to be the most important of the four <var>Prologue</var>
alternatives.

   <p>At some point while developing your parser, you might decide to provide
<code>trace_token</code> to modules that are external to your parser. 
Thus, you might wish for Bison to insert the prototype into both the parser
header file and the parser source code file. 
Since this function is not a dependency required by <code>YYSTYPE</code> or
<code>YYLTYPE</code>, it doesn't make sense to move its prototype to a
<code>%code requires</code>. 
More importantly, since it depends upon <code>YYLTYPE</code> and <code>yytokentype</code>,
<code>%code requires</code> is not sufficient. 
Instead, move its prototype from the unqualified <code>%code</code> to a
<code>%code provides</code>:

<pre class="smallexample">     %code top {
       #define _GNU_SOURCE
       #include &lt;stdio.h&gt;
     }
     
     %code requires {
       #include "ptypes.h"
     }
     %union {
       long int n;
       tree t;  /* <code>tree</code><span class="roman"> is defined in ptypes.h.</span> */
     }
     
     %code requires {
       #define YYLTYPE YYLTYPE
       typedef struct YYLTYPE
       {
         int first_line;
         int first_column;
         int last_line;
         int last_column;
         char *filename;
       } YYLTYPE;
     }
     
     %code provides {
       void trace_token (enum yytokentype token, YYLTYPE loc);
     }
     
     %code {
       static void print_token_value (FILE *, int, YYSTYPE);
       #define YYPRINT(F, N, L) print_token_value (F, N, L)
     }
     
     ...
</pre>
   <p class="noindent">Bison will insert the <code>trace_token</code> prototype into both the parser header
file and the parser source code file after the definitions for
<code>yytokentype</code>, <code>YYLTYPE</code>, and <code>YYSTYPE</code>.

   <p>The above examples are careful to write directives in an order that reflects
the layout of the generated parser source code and header files:
<code>%code top</code>, <code>%code requires</code>, <code>%code provides</code>, and then
<code>%code</code>. 
While your grammar files may generally be easier to read if you also follow
this order, Bison does not require it. 
Instead, Bison lets you choose an organization that makes sense to you.

   <p>You may declare any of these directives multiple times in the grammar file. 
In that case, Bison concatenates the contained code in declaration order. 
This is the only way in which the position of one of these directives within
the grammar file affects its functionality.

   <p>The result of the previous two properties is greater flexibility in how you may
organize your grammar file. 
For example, you may organize semantic-type-related directives by semantic
type:

<pre class="smallexample">     %code requires { #include "type1.h" }
     %union { type1 field1; }
     %destructor { type1_free ($$); } &lt;field1&gt;
     %printer { type1_print ($$); } &lt;field1&gt;
     
     %code requires { #include "type2.h" }
     %union { type2 field2; }
     %destructor { type2_free ($$); } &lt;field2&gt;
     %printer { type2_print ($$); } &lt;field2&gt;
</pre>
   <p class="noindent">You could even place each of the above directive groups in the rules section of
the grammar file next to the set of rules that uses the associated semantic
type. 
(In the rules section, you must terminate each of those directives with a
semicolon.) 
And you don't have to worry that some directive (like a <code>%union</code>) in the
definitions section is going to adversely affect their functionality in some
counter-intuitive manner just because it comes first. 
Such an organization is not possible using <var>Prologue</var> sections.

   <p>This section has been concerned with explaining the advantages of the four
<var>Prologue</var> alternatives over the original Yacc <var>Prologue</var>. 
However, in most cases when using these directives, you shouldn't need to
think about all the low-level ordering issues discussed here. 
Instead, you should simply use these directives to label each block of your
code according to its purpose and let Bison handle the ordering. 
<code>%code</code> is the most generic label. 
Move code to <code>%code requires</code>, <code>%code provides</code>, or <code>%code top</code>
as needed.

<div class="node">
<p><hr>
<a name="Bison-Declarations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Grammar-Rules">Grammar Rules</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Prologue-Alternatives">Prologue Alternatives</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-Outline">Grammar Outline</a>
<br>
</div>

<h4 class="subsection">3.1.3 The Bison Declarations Section</h4>

<p><a name="index-Bison-declarations-_0028introduction_0029-102"></a><a name="index-declarations_002c-Bison-_0028introduction_0029-103"></a>
The <var>Bison declarations</var> section contains declarations that define
terminal and nonterminal symbols, specify precedence, and so on. 
In some simple grammars you may not need any declarations. 
See <a href="#Declarations">Bison Declarations</a>.

<div class="node">
<p><hr>
<a name="Grammar-Rules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Epilogue">Epilogue</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bison-Declarations">Bison Declarations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-Outline">Grammar Outline</a>
<br>
</div>

<h4 class="subsection">3.1.4 The Grammar Rules Section</h4>

<p><a name="index-grammar-rules-section-104"></a><a name="index-rules-section-for-grammar-105"></a>
The <dfn>grammar rules</dfn> section contains one or more Bison grammar
rules, and nothing else.  See <a href="#Rules">Syntax of Grammar Rules</a>.

   <p>There must always be at least one grammar rule, and the first
<span class="samp">%%</span> (which precedes the grammar rules) may never be omitted even
if it is the first thing in the file.

<div class="node">
<p><hr>
<a name="Epilogue"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Grammar-Rules">Grammar Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-Outline">Grammar Outline</a>
<br>
</div>

<h4 class="subsection">3.1.5 The epilogue</h4>

<p><a name="index-additional-C-code-section-106"></a><a name="index-epilogue-107"></a><a name="index-C-code_002c-section-for-additional-108"></a>
The <var>Epilogue</var> is copied verbatim to the end of the parser file, just as
the <var>Prologue</var> is copied to the beginning.  This is the most convenient
place to put anything that you want to have in the parser file but which need
not come before the definition of <code>yyparse</code>.  For example, the
definitions of <code>yylex</code> and <code>yyerror</code> often go here.  Because
C requires functions to be declared before being used, you often need
to declare functions like <code>yylex</code> and <code>yyerror</code> in the Prologue,
even if you define them in the Epilogue. 
See <a href="#Interface">Parser C-Language Interface</a>.

   <p>If the last section is empty, you may omit the <span class="samp">%%</span> that separates it
from the grammar rules.

   <p>The Bison parser itself contains many macros and identifiers whose names
start with <span class="samp">yy</span> or <span class="samp">YY</span>, so it is a good idea to avoid using
any such names (except those documented in this manual) in the epilogue
of the grammar file.

<div class="node">
<p><hr>
<a name="Symbols"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Rules">Rules</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Grammar-Outline">Grammar Outline</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.2 Symbols, Terminal and Nonterminal</h3>

<p><a name="index-nonterminal-symbol-109"></a><a name="index-terminal-symbol-110"></a><a name="index-token-type-111"></a><a name="index-symbol-112"></a>
<dfn>Symbols</dfn> in Bison grammars represent the grammatical classifications
of the language.

   <p>A <dfn>terminal symbol</dfn> (also known as a <dfn>token type</dfn>) represents a
class of syntactically equivalent tokens.  You use the symbol in grammar
rules to mean that a token in that class is allowed.  The symbol is
represented in the Bison parser by a numeric code, and the <code>yylex</code>
function returns a token type code to indicate what kind of token has
been read.  You don't need to know what the code value is; you can use
the symbol to stand for it.

   <p>A <dfn>nonterminal symbol</dfn> stands for a class of syntactically
equivalent groupings.  The symbol name is used in writing grammar rules. 
By convention, it should be all lower case.

   <p>Symbol names can contain letters, digits (not at the beginning),
underscores and periods.  Periods make sense only in nonterminals.

   <p>There are three ways of writing terminal symbols in the grammar:

     <ul>
<li>A <dfn>named token type</dfn> is written with an identifier, like an
identifier in C.  By convention, it should be all upper case.  Each
such name must be defined with a Bison declaration such as
<code>%token</code>.  See <a href="#Token-Decl">Token Type Names</a>.

     <li><a name="index-character-token-113"></a><a name="index-literal-token-114"></a><a name="index-single_002dcharacter-literal-115"></a>A <dfn>character token type</dfn> (or <dfn>literal character token</dfn>) is
written in the grammar using the same syntax used in C for character
constants; for example, <code>'+'</code> is a character token type.  A
character token type doesn't need to be declared unless you need to
specify its semantic value data type (see <a href="#Value-Type">Data Types of Semantic Values</a>), associativity, or precedence (see <a href="#Precedence">Operator Precedence</a>).

     <p>By convention, a character token type is used only to represent a
token that consists of that particular character.  Thus, the token
type <code>'+'</code> is used to represent the character <span class="samp">+</span> as a
token.  Nothing enforces this convention, but if you depart from it,
your program will confuse other readers.

     <p>All the usual escape sequences used in character literals in C can be
used in Bison as well, but you must not use the null character as a
character literal because its numeric code, zero, signifies
end-of-input (see <a href="#Calling-Convention">Calling Convention for <code>yylex</code></a>).  Also, unlike standard C, trigraphs have no
special meaning in Bison character literals, nor is backslash-newline
allowed.

     <li><a name="index-string-token-116"></a><a name="index-literal-string-token-117"></a><a name="index-multicharacter-literal-118"></a>A <dfn>literal string token</dfn> is written like a C string constant; for
example, <code>"&lt;="</code> is a literal string token.  A literal string token
doesn't need to be declared unless you need to specify its semantic
value data type (see <a href="#Value-Type">Value Type</a>), associativity, or precedence
(see <a href="#Precedence">Precedence</a>).

     <p>You can associate the literal string token with a symbolic name as an
alias, using the <code>%token</code> declaration (see <a href="#Token-Decl">Token Declarations</a>).  If you don't do that, the lexical analyzer has to
retrieve the token number for the literal string token from the
<code>yytname</code> table (see <a href="#Calling-Convention">Calling Convention</a>).

     <p><strong>Warning</strong>: literal string tokens do not work in Yacc.

     <p>By convention, a literal string token is used only to represent a token
that consists of that particular string.  Thus, you should use the token
type <code>"&lt;="</code> to represent the string <span class="samp">&lt;=</span> as a token.  Bison
does not enforce this convention, but if you depart from it, people who
read your program will be confused.

     <p>All the escape sequences used in string literals in C can be used in
Bison as well, except that you must not use a null character within a
string literal.  Also, unlike Standard C, trigraphs have no special
meaning in Bison string literals, nor is backslash-newline allowed.  A
literal string token must contain two or more characters; for a token
containing just one character, use a character token (see above). 
</ul>

   <p>How you choose to write a terminal symbol has no effect on its
grammatical meaning.  That depends only on where it appears in rules and
on when the parser function returns that symbol.

   <p>The value returned by <code>yylex</code> is always one of the terminal
symbols, except that a zero or negative value signifies end-of-input. 
Whichever way you write the token type in the grammar rules, you write
it the same way in the definition of <code>yylex</code>.  The numeric code
for a character token type is simply the positive numeric code of the
character, so <code>yylex</code> can use the identical value to generate the
requisite code, though you may need to convert it to <code>unsigned
char</code> to avoid sign-extension on hosts where <code>char</code> is signed. 
Each named token type becomes a C macro in
the parser file, so <code>yylex</code> can use the name to stand for the code. 
(This is why periods don't make sense in terminal symbols.) 
See <a href="#Calling-Convention">Calling Convention for <code>yylex</code></a>.

   <p>If <code>yylex</code> is defined in a separate file, you need to arrange for the
token-type macro definitions to be available there.  Use the <span class="samp">-d</span>
option when you run Bison, so that it will write these macro definitions
into a separate header file <var>name</var><span class="file">.tab.h</span> which you can include
in the other source files that need it.  See <a href="#Invocation">Invoking Bison</a>.

   <p>If you want to write a grammar that is portable to any Standard C
host, you must use only nonnull character tokens taken from the basic
execution character set of Standard C.  This set consists of the ten
digits, the 52 lower- and upper-case English letters, and the
characters in the following C-language string:

<pre class="example">     "\a\b\t\n\v\f\r !\"#%&amp;'()*+,-./:;&lt;=&gt;?[\\]^_{|}~"
</pre>
   <p>The <code>yylex</code> function and Bison must use a consistent character set
and encoding for character tokens.  For example, if you run Bison in an
<acronym>ASCII</acronym> environment, but then compile and run the resulting
program in an environment that uses an incompatible character set like
<acronym>EBCDIC</acronym>, the resulting program may not work because the tables
generated by Bison will assume <acronym>ASCII</acronym> numeric values for
character tokens.  It is standard practice for software distributions to
contain C source files that were generated by Bison in an
<acronym>ASCII</acronym> environment, so installers on platforms that are
incompatible with <acronym>ASCII</acronym> must rebuild those files before
compiling them.

   <p>The symbol <code>error</code> is a terminal symbol reserved for error recovery
(see <a href="#Error-Recovery">Error Recovery</a>); you shouldn't use it for any other purpose. 
In particular, <code>yylex</code> should never return this value.  The default
value of the error token is 256, unless you explicitly assigned 256 to
one of your tokens with a <code>%token</code> declaration.

<div class="node">
<p><hr>
<a name="Rules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Recursion">Recursion</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Symbols">Symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.3 Syntax of Grammar Rules</h3>

<p><a name="index-rule-syntax-119"></a><a name="index-grammar-rule-syntax-120"></a><a name="index-syntax-of-grammar-rules-121"></a>
A Bison grammar rule has the following general form:

<pre class="example">     <var>result</var>: <var>components</var>...
             ;
</pre>
   <p class="noindent">where <var>result</var> is the nonterminal symbol that this rule describes,
and <var>components</var> are various terminal and nonterminal symbols that
are put together by this rule (see <a href="#Symbols">Symbols</a>).

   <p>For example,

<pre class="example">     exp:      exp '+' exp
             ;
</pre>
   <p class="noindent">says that two groupings of type <code>exp</code>, with a <span class="samp">+</span> token in between,
can be combined into a larger grouping of type <code>exp</code>.

   <p>White space in rules is significant only to separate symbols.  You can add
extra white space as you wish.

   <p>Scattered among the components can be <var>actions</var> that determine
the semantics of the rule.  An action looks like this:

<pre class="example">     {<var>C statements</var>}
</pre>
   <p class="noindent"><a name="index-braced-code-122"></a>This is an example of <dfn>braced code</dfn>, that is, C code surrounded by
braces, much like a compound statement in C.  Braced code can contain
any sequence of C tokens, so long as its braces are balanced.  Bison
does not check the braced code for correctness directly; it merely
copies the code to the output file, where the C compiler can check it.

   <p>Within braced code, the balanced-brace count is not affected by braces
within comments, string literals, or character constants, but it is
affected by the C digraphs <span class="samp">&lt;%</span> and <span class="samp">%&gt;</span> that represent
braces.  At the top level braced code must be terminated by <span class="samp">}</span>
and not by a digraph.  Bison does not look for trigraphs, so if braced
code uses trigraphs you should ensure that they do not affect the
nesting of braces or the boundaries of comments, string literals, or
character constants.

   <p>Usually there is only one action and it follows the components. 
See <a href="#Actions">Actions</a>.

   <p><a name="index-_007c-123"></a>Multiple rules for the same <var>result</var> can be written separately or can
be joined with the vertical-bar character <span class="samp">|</span> as follows:

<pre class="example">     <var>result</var>:    <var>rule1-components</var>...
             | <var>rule2-components</var>...
             ...
             ;
</pre>
   <p class="noindent">They are still considered distinct rules even when joined in this way.

   <p>If <var>components</var> in a rule is empty, it means that <var>result</var> can
match the empty string.  For example, here is how to define a
comma-separated sequence of zero or more <code>exp</code> groupings:

<pre class="example">     expseq:   /* empty */
             | expseq1
             ;
     
     expseq1:  exp
             | expseq1 ',' exp
             ;
</pre>
   <p class="noindent">It is customary to write a comment <span class="samp">/* empty */</span> in each rule
with no components.

<div class="node">
<p><hr>
<a name="Recursion"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Semantics">Semantics</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Rules">Rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.4 Recursive Rules</h3>

<p><a name="index-recursive-rule-124"></a>
A rule is called <dfn>recursive</dfn> when its <var>result</var> nonterminal
appears also on its right hand side.  Nearly all Bison grammars need to
use recursion, because that is the only way to define a sequence of any
number of a particular thing.  Consider this recursive definition of a
comma-separated sequence of one or more expressions:

<pre class="example">     expseq1:  exp
             | expseq1 ',' exp
             ;
</pre>
   <p><a name="index-left-recursion-125"></a><a name="index-right-recursion-126"></a>Since the recursive use of <code>expseq1</code> is the leftmost symbol in the
right hand side, we call this <dfn>left recursion</dfn>.  By contrast, here
the same construct is defined using <dfn>right recursion</dfn>:

<pre class="example">     expseq1:  exp
             | exp ',' expseq1
             ;
</pre>
   <p class="noindent">Any kind of sequence can be defined using either left recursion or right
recursion, but you should always use left recursion, because it can
parse a sequence of any number of elements with bounded stack space. 
Right recursion uses up space on the Bison stack in proportion to the
number of elements in the sequence, because all the elements must be
shifted onto the stack before the rule can be applied even once. 
See <a href="#Algorithm">The Bison Parser Algorithm</a>, for further explanation
of this.

   <p><a name="index-mutual-recursion-127"></a><dfn>Indirect</dfn> or <dfn>mutual</dfn> recursion occurs when the result of the
rule does not appear directly on its right hand side, but does appear
in rules for other nonterminals which do appear on its right hand
side.

   <p>For example:

<pre class="example">     expr:     primary
             | primary '+' primary
             ;
     
     primary:  constant
             | '(' expr ')'
             ;
</pre>
   <p class="noindent">defines two mutually-recursive nonterminals, since each refers to the
other.

<div class="node">
<p><hr>
<a name="Semantics"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Locations">Locations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Recursion">Recursion</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.5 Defining Language Semantics</h3>

<p><a name="index-defining-language-semantics-128"></a><a name="index-language-semantics_002c-defining-129"></a>
The grammar rules for a language determine only the syntax.  The semantics
are determined by the semantic values associated with various tokens and
groupings, and by the actions taken when various groupings are recognized.

   <p>For example, the calculator calculates properly because the value
associated with each expression is the proper number; it adds properly
because the action for the grouping <var>x</var><span class="samp">&nbsp;+&nbsp;</span><var>y</var><!-- /@w --> is to add
the numbers associated with <var>x</var> and <var>y</var>.

<ul class="menu">
<li><a accesskey="1" href="#Value-Type">Value Type</a>:         Specifying one data type for all semantic values. 
<li><a accesskey="2" href="#Multiple-Types">Multiple Types</a>:     Specifying several alternative data types. 
<li><a accesskey="3" href="#Actions">Actions</a>:            An action is the semantic definition of a grammar rule. 
<li><a accesskey="4" href="#Action-Types">Action Types</a>:       Specifying data types for actions to operate on. 
<li><a accesskey="5" href="#Mid_002dRule-Actions">Mid-Rule Actions</a>:   Most actions go at the end of a rule. 
                      This says when, why and how to use the exceptional
                        action in the middle of a rule. 
</ul>

<div class="node">
<p><hr>
<a name="Value-Type"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Multiple-Types">Multiple Types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Semantics">Semantics</a>
<br>
</div>

<h4 class="subsection">3.5.1 Data Types of Semantic Values</h4>

<p><a name="index-semantic-value-type-130"></a><a name="index-value-type_002c-semantic-131"></a><a name="index-data-types-of-semantic-values-132"></a><a name="index-default-data-type-133"></a>
In a simple program it may be sufficient to use the same data type for
the semantic values of all language constructs.  This was true in the
<acronym>RPN</acronym> and infix calculator examples (see <a href="#RPN-Calc">Reverse Polish Notation Calculator</a>).

   <p>Bison normally uses the type <code>int</code> for semantic values if your
program uses the same data type for all language constructs.  To
specify some other type, define <code>YYSTYPE</code> as a macro, like this:

<pre class="example">     #define YYSTYPE double
</pre>
   <p class="noindent"><code>YYSTYPE</code>'s replacement list should be a type name
that does not contain parentheses or square brackets. 
This macro definition must go in the prologue of the grammar file
(see <a href="#Grammar-Outline">Outline of a Bison Grammar</a>).

<div class="node">
<p><hr>
<a name="Multiple-Types"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Actions">Actions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Value-Type">Value Type</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Semantics">Semantics</a>
<br>
</div>

<h4 class="subsection">3.5.2 More Than One Value Type</h4>

<p>In most programs, you will need different data types for different kinds
of tokens and groupings.  For example, a numeric constant may need type
<code>int</code> or <code>long int</code>, while a string constant needs type
<code>char *</code>, and an identifier might need a pointer to an entry in the
symbol table.

   <p>To use more than one data type for semantic values in one parser, Bison
requires you to do two things:

     <ul>
<li>Specify the entire collection of possible data types, either by using the
<code>%union</code> Bison declaration (see <a href="#Union-Decl">The Collection of Value Types</a>), or by using a <code>typedef</code> or a <code>#define</code> to
define <code>YYSTYPE</code> to be a union type whose member names are
the type tags.

     <li>Choose one of those types for each symbol (terminal or nonterminal) for
which semantic values are used.  This is done for tokens with the
<code>%token</code> Bison declaration (see <a href="#Token-Decl">Token Type Names</a>)
and for groupings with the <code>%type</code> Bison declaration (see <a href="#Type-Decl">Nonterminal Symbols</a>). 
</ul>

<div class="node">
<p><hr>
<a name="Actions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Action-Types">Action Types</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multiple-Types">Multiple Types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Semantics">Semantics</a>
<br>
</div>

<h4 class="subsection">3.5.3 Actions</h4>

<p><a name="index-action-134"></a><a name="index-_0024_0024-135"></a><a name="index-_0024_0040var_007bn_007d-136"></a>
An action accompanies a syntactic rule and contains C code to be executed
each time an instance of that rule is recognized.  The task of most actions
is to compute a semantic value for the grouping built by the rule from the
semantic values associated with tokens or smaller groupings.

   <p>An action consists of braced code containing C statements, and can be
placed at any position in the rule;
it is executed at that position.  Most rules have just one action at the
end of the rule, following all the components.  Actions in the middle of
a rule are tricky and used only for special purposes (see <a href="#Mid_002dRule-Actions">Actions in Mid-Rule</a>).

   <p>The C code in an action can refer to the semantic values of the components
matched by the rule with the construct <code>$</code><var>n</var>, which stands for
the value of the <var>n</var>th component.  The semantic value for the grouping
being constructed is <code>$$</code>.  Bison translates both of these
constructs into expressions of the appropriate type when it copies the
actions into the parser file.  <code>$$</code> is translated to a modifiable
lvalue, so it can be assigned to.

   <p>Here is a typical example:

<pre class="example">     exp:    ...
             | exp '+' exp
                 { $$ = $1 + $3; }
</pre>
   <p class="noindent">This rule constructs an <code>exp</code> from two smaller <code>exp</code> groupings
connected by a plus-sign token.  In the action, <code>$1</code> and <code>$3</code>
refer to the semantic values of the two component <code>exp</code> groupings,
which are the first and third symbols on the right hand side of the rule. 
The sum is stored into <code>$$</code> so that it becomes the semantic value of
the addition-expression just recognized by the rule.  If there were a
useful semantic value associated with the <span class="samp">+</span> token, it could be
referred to as <code>$2</code>.

   <p>Note that the vertical-bar character <span class="samp">|</span> is really a rule
separator, and actions are attached to a single rule.  This is a
difference with tools like Flex, for which <span class="samp">|</span> stands for either
&ldquo;or&rdquo;, or &ldquo;the same action as that of the next rule&rdquo;.  In the
following example, the action is triggered only when <span class="samp">b</span> is found:

<pre class="example">     a-or-b: 'a'|'b'   { a_or_b_found = 1; };
</pre>
   <p><a name="index-default-action-137"></a>If you don't specify an action for a rule, Bison supplies a default:
<code>$$&nbsp;=&nbsp;$1</code>.<!-- /@w -->  Thus, the value of the first symbol in the rule
becomes the value of the whole rule.  Of course, the default action is
valid only if the two data types match.  There is no meaningful default
action for an empty rule; every empty rule must have an explicit action
unless the rule's value does not matter.

   <p><code>$</code><var>n</var> with <var>n</var> zero or negative is allowed for reference
to tokens and groupings on the stack <em>before</em> those that match the
current rule.  This is a very risky practice, and to use it reliably
you must be certain of the context in which the rule is applied.  Here
is a case in which you can use this reliably:

<pre class="example">     foo:      expr bar '+' expr  { ... }
             | expr bar '-' expr  { ... }
             ;
     
     bar:      /* empty */
             { previous_expr = $0; }
             ;
</pre>
   <p>As long as <code>bar</code> is used only in the fashion shown here, <code>$0</code>
always refers to the <code>expr</code> which precedes <code>bar</code> in the
definition of <code>foo</code>.

   <p><a name="index-yylval-138"></a>It is also possible to access the semantic value of the lookahead token, if
any, from a semantic action. 
This semantic value is stored in <code>yylval</code>. 
See <a href="#Action-Features">Special Features for Use in Actions</a>.

<div class="node">
<p><hr>
<a name="Action-Types"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Mid_002dRule-Actions">Mid-Rule Actions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Actions">Actions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Semantics">Semantics</a>
<br>
</div>

<h4 class="subsection">3.5.4 Data Types of Values in Actions</h4>

<p><a name="index-action-data-types-139"></a><a name="index-data-types-in-actions-140"></a>
If you have chosen a single data type for semantic values, the <code>$$</code>
and <code>$</code><var>n</var> constructs always have that data type.

   <p>If you have used <code>%union</code> to specify a variety of data types, then you
must declare a choice among these types for each terminal or nonterminal
symbol that can have a semantic value.  Then each time you use <code>$$</code> or
<code>$</code><var>n</var>, its data type is determined by which symbol it refers to
in the rule.  In this example,

<pre class="example">     exp:    ...
             | exp '+' exp
                 { $$ = $1 + $3; }
</pre>
   <p class="noindent"><code>$1</code> and <code>$3</code> refer to instances of <code>exp</code>, so they all
have the data type declared for the nonterminal symbol <code>exp</code>.  If
<code>$2</code> were used, it would have the data type declared for the
terminal symbol <code>'+'</code>, whatever that might be.

   <p>Alternatively, you can specify the data type when you refer to the value,
by inserting <span class="samp">&lt;</span><var>type</var><span class="samp">&gt;</span> after the <span class="samp">$</span> at the beginning of the
reference.  For example, if you have defined types as shown here:

<pre class="example">     %union {
       int itype;
       double dtype;
     }
</pre>
   <p class="noindent">then you can write <code>$&lt;itype&gt;1</code> to refer to the first subunit of the
rule as an integer, or <code>$&lt;dtype&gt;1</code> to refer to it as a double.

<div class="node">
<p><hr>
<a name="Mid_002dRule-Actions"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Action-Types">Action Types</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Semantics">Semantics</a>
<br>
</div>

<h4 class="subsection">3.5.5 Actions in Mid-Rule</h4>

<p><a name="index-actions-in-mid_002drule-141"></a><a name="index-mid_002drule-actions-142"></a>
Occasionally it is useful to put an action in the middle of a rule. 
These actions are written just like usual end-of-rule actions, but they
are executed before the parser even recognizes the following components.

   <p>A mid-rule action may refer to the components preceding it using
<code>$</code><var>n</var>, but it may not refer to subsequent components because
it is run before they are parsed.

   <p>The mid-rule action itself counts as one of the components of the rule. 
This makes a difference when there is another action later in the same rule
(and usually there is another at the end): you have to count the actions
along with the symbols when working out which number <var>n</var> to use in
<code>$</code><var>n</var>.

   <p>The mid-rule action can also have a semantic value.  The action can set
its value with an assignment to <code>$$</code>, and actions later in the rule
can refer to the value using <code>$</code><var>n</var>.  Since there is no symbol
to name the action, there is no way to declare a data type for the value
in advance, so you must use the <span class="samp">$&lt;...&gt;</span><var>n</var> construct to
specify a data type each time you refer to this value.

   <p>There is no way to set the value of the entire rule with a mid-rule
action, because assignments to <code>$$</code> do not have that effect.  The
only way to set the value for the entire rule is with an ordinary action
at the end of the rule.

   <p>Here is an example from a hypothetical compiler, handling a <code>let</code>
statement that looks like <span class="samp">let (</span><var>variable</var><span class="samp">) </span><var>statement</var> and
serves to create a variable named <var>variable</var> temporarily for the
duration of <var>statement</var>.  To parse this construct, we must put
<var>variable</var> into the symbol table while <var>statement</var> is parsed, then
remove it afterward.  Here is how it is done:

<pre class="example">     stmt:   LET '(' var ')'
                     { $&lt;context&gt;$ = push_context ();
                       declare_variable ($3); }
             stmt    { $$ = $6;
                       pop_context ($&lt;context&gt;5); }
</pre>
   <p class="noindent">As soon as <span class="samp">let (</span><var>variable</var><span class="samp">)</span> has been recognized, the first
action is run.  It saves a copy of the current semantic context (the
list of accessible variables) as its semantic value, using alternative
<code>context</code> in the data-type union.  Then it calls
<code>declare_variable</code> to add the new variable to that list.  Once the
first action is finished, the embedded statement <code>stmt</code> can be
parsed.  Note that the mid-rule action is component number 5, so the
<span class="samp">stmt</span> is component number 6.

   <p>After the embedded statement is parsed, its semantic value becomes the
value of the entire <code>let</code>-statement.  Then the semantic value from the
earlier action is used to restore the prior list of variables.  This
removes the temporary <code>let</code>-variable from the list so that it won't
appear to exist while the rest of the program is parsed.

   <p><a name="index-_0025destructor-143"></a><a name="index-discarded-symbols_002c-mid_002drule-actions-144"></a><a name="index-error-recovery_002c-mid_002drule-actions-145"></a>In the above example, if the parser initiates error recovery (see <a href="#Error-Recovery">Error Recovery</a>) while parsing the tokens in the embedded statement <code>stmt</code>,
it might discard the previous semantic context <code>$&lt;context&gt;5</code> without
restoring it. 
Thus, <code>$&lt;context&gt;5</code> needs a destructor (see <a href="#Destructor-Decl">Freeing Discarded Symbols</a>). 
However, Bison currently provides no means to declare a destructor specific to
a particular mid-rule action's semantic value.

   <p>One solution is to bury the mid-rule action inside a nonterminal symbol and to
declare a destructor for that symbol:

<pre class="example">     %type &lt;context&gt; let
     %destructor { pop_context ($$); } let
     
     %%
     
     stmt:  let stmt
                    { $$ = $2;
                      pop_context ($1); }
            ;
     
     let:   LET '(' var ')'
                    { $$ = push_context ();
                      declare_variable ($3); }
            ;
</pre>
   <p class="noindent">Note that the action is now at the end of its rule. 
Any mid-rule action can be converted to an end-of-rule action in this way, and
this is what Bison actually does to implement mid-rule actions.

   <p>Taking action before a rule is completely recognized often leads to
conflicts since the parser must commit to a parse in order to execute the
action.  For example, the following two rules, without mid-rule actions,
can coexist in a working parser because the parser can shift the open-brace
token and look at what follows before deciding whether there is a
declaration or not:

<pre class="example">     compound: '{' declarations statements '}'
             | '{' statements '}'
             ;
</pre>
   <p class="noindent">But when we add a mid-rule action as follows, the rules become nonfunctional:

<pre class="example">     compound: { prepare_for_local_variables (); }
               '{' declarations statements '}'
             | '{' statements '}'
             ;
</pre>
   <p class="noindent">Now the parser is forced to decide whether to run the mid-rule action
when it has read no farther than the open-brace.  In other words, it
must commit to using one rule or the other, without sufficient
information to do it correctly.  (The open-brace token is what is called
the <dfn>lookahead</dfn> token at this time, since the parser is still
deciding what to do about it.  See <a href="#Lookahead">Lookahead Tokens</a>.)

   <p>You might think that you could correct the problem by putting identical
actions into the two rules, like this:

<pre class="example">     compound: { prepare_for_local_variables (); }
               '{' declarations statements '}'
             | { prepare_for_local_variables (); }
               '{' statements '}'
             ;
</pre>
   <p class="noindent">But this does not help, because Bison does not realize that the two actions
are identical.  (Bison never tries to understand the C code in an action.)

   <p>If the grammar is such that a declaration can be distinguished from a
statement by the first token (which is true in C), then one solution which
does work is to put the action after the open-brace, like this:

<pre class="example">     compound: '{' { prepare_for_local_variables (); }
               declarations statements '}'
             | '{' statements '}'
             ;
</pre>
   <p class="noindent">Now the first token of the following declaration or statement,
which would in any case tell Bison which rule to use, can still do so.

   <p>Another solution is to bury the action inside a nonterminal symbol which
serves as a subroutine:

<pre class="example">     subroutine: /* empty */
               { prepare_for_local_variables (); }
             ;
     
     compound: subroutine
               '{' declarations statements '}'
             | subroutine
               '{' statements '}'
             ;
</pre>
   <p class="noindent">Now Bison can execute the action in the rule for <code>subroutine</code> without
deciding which rule for <code>compound</code> it will eventually use.

<div class="node">
<p><hr>
<a name="Locations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Declarations">Declarations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Semantics">Semantics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.6 Tracking Locations</h3>

<p><a name="index-location-146"></a><a name="index-textual-location-147"></a><a name="index-location_002c-textual-148"></a>
Though grammar rules and semantic actions are enough to write a fully
functional parser, it can be useful to process some additional information,
especially symbol locations.

   <p>The way locations are handled is defined by providing a data type, and
actions to take when rules are matched.

<ul class="menu">
<li><a accesskey="1" href="#Location-Type">Location Type</a>:                Specifying a data type for locations. 
<li><a accesskey="2" href="#Actions-and-Locations">Actions and Locations</a>:        Using locations in actions. 
<li><a accesskey="3" href="#Location-Default-Action">Location Default Action</a>:      Defining a general way to compute locations. 
</ul>

<div class="node">
<p><hr>
<a name="Location-Type"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Actions-and-Locations">Actions and Locations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Locations">Locations</a>
<br>
</div>

<h4 class="subsection">3.6.1 Data Type of Locations</h4>

<p><a name="index-data-type-of-locations-149"></a><a name="index-default-location-type-150"></a>
Defining a data type for locations is much simpler than for semantic values,
since all tokens and groupings always use the same type.

   <p>You can specify the type of locations by defining a macro called
<code>YYLTYPE</code>, just as you can specify the semantic value type by
defining a <code>YYSTYPE</code> macro (see <a href="#Value-Type">Value Type</a>). 
When <code>YYLTYPE</code> is not defined, Bison uses a default structure type with
four members:

<pre class="example">     typedef struct YYLTYPE
     {
       int first_line;
       int first_column;
       int last_line;
       int last_column;
     } YYLTYPE;
</pre>
   <p>At the beginning of the parsing, Bison initializes all these fields to 1
for <code>yylloc</code>.

<div class="node">
<p><hr>
<a name="Actions-and-Locations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Location-Default-Action">Location Default Action</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Location-Type">Location Type</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Locations">Locations</a>
<br>
</div>

<h4 class="subsection">3.6.2 Actions and Locations</h4>

<p><a name="index-location-actions-151"></a><a name="index-actions_002c-location-152"></a><a name="index-_0040_0040_0024-153"></a><a name="index-_0040_0040_0040var_007bn_007d-154"></a>
Actions are not only useful for defining language semantics, but also for
describing the behavior of the output parser with locations.

   <p>The most obvious way for building locations of syntactic groupings is very
similar to the way semantic values are computed.  In a given rule, several
constructs can be used to access the locations of the elements being matched. 
The location of the <var>n</var>th component of the right hand side is
<code>@</code><var>n</var>, while the location of the left hand side grouping is
<code>@$</code>.

   <p>Here is a basic example using the default data type for locations:

<pre class="example">     exp:    ...
             | exp '/' exp
                 {
                   @$.first_column = @1.first_column;
                   @$.first_line = @1.first_line;
                   @$.last_column = @3.last_column;
                   @$.last_line = @3.last_line;
                   if ($3)
                     $$ = $1 / $3;
                   else
                     {
                       $$ = 1;
                       fprintf (stderr,
                                "Division by zero, l%d,c%d-l%d,c%d",
                                @3.first_line, @3.first_column,
                                @3.last_line, @3.last_column);
                     }
                 }
</pre>
   <p>As for semantic values, there is a default action for locations that is
run each time a rule is matched.  It sets the beginning of <code>@$</code> to the
beginning of the first symbol, and the end of <code>@$</code> to the end of the
last symbol.

   <p>With this default action, the location tracking can be fully automatic.  The
example above simply rewrites this way:

<pre class="example">     exp:    ...
             | exp '/' exp
                 {
                   if ($3)
                     $$ = $1 / $3;
                   else
                     {
                       $$ = 1;
                       fprintf (stderr,
                                "Division by zero, l%d,c%d-l%d,c%d",
                                @3.first_line, @3.first_column,
                                @3.last_line, @3.last_column);
                     }
                 }
</pre>
   <p><a name="index-yylloc-155"></a>It is also possible to access the location of the lookahead token, if any,
from a semantic action. 
This location is stored in <code>yylloc</code>. 
See <a href="#Action-Features">Special Features for Use in Actions</a>.

<div class="node">
<p><hr>
<a name="Location-Default-Action"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Actions-and-Locations">Actions and Locations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Locations">Locations</a>
<br>
</div>

<h4 class="subsection">3.6.3 Default Action for Locations</h4>

<p><a name="index-YYLLOC_005fDEFAULT-156"></a><a name="index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007bYYLLOC_005fDEFAULT_007d-157"></a>
Actually, actions are not the best place to compute locations.  Since
locations are much more general than semantic values, there is room in
the output parser to redefine the default action to take for each
rule.  The <code>YYLLOC_DEFAULT</code> macro is invoked each time a rule is
matched, before the associated action is run.  It is also invoked
while processing a syntax error, to compute the error's location. 
Before reporting an unresolvable syntactic ambiguity, a <acronym>GLR</acronym>
parser invokes <code>YYLLOC_DEFAULT</code> recursively to compute the location
of that ambiguity.

   <p>Most of the time, this macro is general enough to suppress location
dedicated code from semantic actions.

   <p>The <code>YYLLOC_DEFAULT</code> macro takes three parameters.  The first one is
the location of the grouping (the result of the computation).  When a
rule is matched, the second parameter identifies locations of
all right hand side elements of the rule being matched, and the third
parameter is the size of the rule's right hand side. 
When a <acronym>GLR</acronym> parser reports an ambiguity, which of multiple candidate
right hand sides it passes to <code>YYLLOC_DEFAULT</code> is undefined. 
When processing a syntax error, the second parameter identifies locations
of the symbols that were discarded during error processing, and the third
parameter is the number of discarded symbols.

   <p>By default, <code>YYLLOC_DEFAULT</code> is defined this way:

<pre class="smallexample">     # define YYLLOC_DEFAULT(Current, Rhs, N)                                \
         do                                                                  \
           if (N)                                                            \
             {                                                               \
               (Current).first_line   = YYRHSLOC(Rhs, 1).first_line;         \
               (Current).first_column = YYRHSLOC(Rhs, 1).first_column;       \
               (Current).last_line    = YYRHSLOC(Rhs, N).last_line;          \
               (Current).last_column  = YYRHSLOC(Rhs, N).last_column;        \
             }                                                               \
           else                                                              \
             {                                                               \
               (Current).first_line   = (Current).last_line   =              \
                 YYRHSLOC(Rhs, 0).last_line;                                 \
               (Current).first_column = (Current).last_column =              \
                 YYRHSLOC(Rhs, 0).last_column;                               \
             }                                                               \
         while (0)
</pre>
   <p>where <code>YYRHSLOC (rhs, k)</code> is the location of the <var>k</var>th symbol
in <var>rhs</var> when <var>k</var> is positive, and the location of the symbol
just before the reduction when <var>k</var> and <var>n</var> are both zero.

   <p>When defining <code>YYLLOC_DEFAULT</code>, you should consider that:

     <ul>
<li>All arguments are free of side-effects.  However, only the first one (the
result) should be modified by <code>YYLLOC_DEFAULT</code>.

     <li>For consistency with semantic actions, valid indexes within the
right hand side range from 1 to <var>n</var>.  When <var>n</var> is zero, only 0 is a
valid index, and it refers to the symbol just before the reduction. 
During error processing <var>n</var> is always positive.

     <li>Your macro should parenthesize its arguments, if need be, since the
actual arguments may not be surrounded by parentheses.  Also, your
macro should expand to something that can be used as a single
statement when it is followed by a semicolon. 
</ul>

<div class="node">
<p><hr>
<a name="Declarations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Multiple-Parsers">Multiple Parsers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Locations">Locations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.7 Bison Declarations</h3>

<p><a name="index-declarations_002c-Bison-158"></a><a name="index-Bison-declarations-159"></a>
The <dfn>Bison declarations</dfn> section of a Bison grammar defines the symbols
used in formulating the grammar and the data types of semantic values. 
See <a href="#Symbols">Symbols</a>.

   <p>All token type names (but not single-character literal tokens such as
<code>'+'</code> and <code>'*'</code>) must be declared.  Nonterminal symbols must be
declared if you need to specify which data type to use for the semantic
value (see <a href="#Multiple-Types">More Than One Value Type</a>).

   <p>The first rule in the file also specifies the start symbol, by default. 
If you want some other symbol to be the start symbol, you must declare
it explicitly (see <a href="#Language-and-Grammar">Languages and Context-Free Grammars</a>).

<ul class="menu">
<li><a accesskey="1" href="#Require-Decl">Require Decl</a>:       Requiring a Bison version. 
<li><a accesskey="2" href="#Token-Decl">Token Decl</a>:         Declaring terminal symbols. 
<li><a accesskey="3" href="#Precedence-Decl">Precedence Decl</a>:    Declaring terminals with precedence and associativity. 
<li><a accesskey="4" href="#Union-Decl">Union Decl</a>:         Declaring the set of all semantic value types. 
<li><a accesskey="5" href="#Type-Decl">Type Decl</a>:          Declaring the choice of type for a nonterminal symbol. 
<li><a accesskey="6" href="#Initial-Action-Decl">Initial Action Decl</a>:   Code run before parsing starts. 
<li><a accesskey="7" href="#Destructor-Decl">Destructor Decl</a>:    Declaring how symbols are freed. 
<li><a accesskey="8" href="#Expect-Decl">Expect Decl</a>:        Suppressing warnings about parsing conflicts. 
<li><a accesskey="9" href="#Start-Decl">Start Decl</a>:         Specifying the start symbol. 
<li><a href="#Pure-Decl">Pure Decl</a>:          Requesting a reentrant parser. 
<li><a href="#Push-Decl">Push Decl</a>:          Requesting a push parser. 
<li><a href="#Decl-Summary">Decl Summary</a>:       Table of all Bison declarations. 
</ul>

<div class="node">
<p><hr>
<a name="Require-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Token-Decl">Token Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.1 Require a Version of Bison</h4>

<p><a name="index-version-requirement-160"></a><a name="index-requiring-a-version-of-Bison-161"></a><a name="index-_0025require-162"></a>
You may require the minimum version of Bison to process the grammar.  If
the requirement is not met, <span class="command">bison</span> exits with an error (exit
status 63).

<pre class="example">     %require "<var>version</var>"
</pre>
   <div class="node">
<p><hr>
<a name="Token-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Precedence-Decl">Precedence Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Require-Decl">Require Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.2 Token Type Names</h4>

<p><a name="index-declaring-token-type-names-163"></a><a name="index-token-type-names_002c-declaring-164"></a><a name="index-declaring-literal-string-tokens-165"></a><a name="index-_0025token-166"></a>
The basic way to declare a token type name (terminal symbol) is as follows:

<pre class="example">     %token <var>name</var>
</pre>
   <p>Bison will convert this into a <code>#define</code> directive in
the parser, so that the function <code>yylex</code> (if it is in this file)
can use the name <var>name</var> to stand for this token type's code.

   <p>Alternatively, you can use <code>%left</code>, <code>%right</code>, or
<code>%nonassoc</code> instead of <code>%token</code>, if you wish to specify
associativity and precedence.  See <a href="#Precedence-Decl">Operator Precedence</a>.

   <p>You can explicitly specify the numeric code for a token type by appending
a nonnegative decimal or hexadecimal integer value in the field immediately
following the token name:

<pre class="example">     %token NUM 300
     %token XNUM 0x12d // a GNU extension
</pre>
   <p class="noindent">It is generally best, however, to let Bison choose the numeric codes for
all token types.  Bison will automatically select codes that don't conflict
with each other or with normal characters.

   <p>In the event that the stack type is a union, you must augment the
<code>%token</code> or other token declaration to include the data type
alternative delimited by angle-brackets (see <a href="#Multiple-Types">More Than One Value Type</a>).

   <p>For example:

<pre class="example">     %union {              /* define stack type */
       double val;
       symrec *tptr;
     }
     %token &lt;val&gt; NUM      /* define token NUM and its type */
</pre>
   <p>You can associate a literal string token with a token type name by
writing the literal string at the end of a <code>%token</code>
declaration which declares the name.  For example:

<pre class="example">     %token arrow "=&gt;"
</pre>
   <p class="noindent">For example, a grammar for the C language might specify these names with
equivalent literal string tokens:

<pre class="example">     %token  &lt;operator&gt;  OR      "||"
     %token  &lt;operator&gt;  LE 134  "&lt;="
     %left  OR  "&lt;="
</pre>
   <p class="noindent">Once you equate the literal string and the token name, you can use them
interchangeably in further declarations or the grammar rules.  The
<code>yylex</code> function can use the token name or the literal string to
obtain the token type code number (see <a href="#Calling-Convention">Calling Convention</a>). 
Syntax error messages passed to <code>yyerror</code> from the parser will reference
the literal string instead of the token name.

   <p>The token numbered as 0 corresponds to end of file; the following line
allows for nicer error messages referring to &ldquo;end of file&rdquo; instead
of &ldquo;$end&rdquo;:

<pre class="example">     %token END 0 "end of file"
</pre>
   <div class="node">
<p><hr>
<a name="Precedence-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Union-Decl">Union Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Token-Decl">Token Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.3 Operator Precedence</h4>

<p><a name="index-precedence-declarations-167"></a><a name="index-declaring-operator-precedence-168"></a><a name="index-operator-precedence_002c-declaring-169"></a>
Use the <code>%left</code>, <code>%right</code> or <code>%nonassoc</code> declaration to
declare a token and specify its precedence and associativity, all at
once.  These are called <dfn>precedence declarations</dfn>. 
See <a href="#Precedence">Operator Precedence</a>, for general information on
operator precedence.

   <p>The syntax of a precedence declaration is nearly the same as that of
<code>%token</code>: either

<pre class="example">     %left <var>symbols</var>...
</pre>
   <p class="noindent">or

<pre class="example">     %left &lt;<var>type</var>&gt; <var>symbols</var>...
</pre>
   <p>And indeed any of these declarations serves the purposes of <code>%token</code>. 
But in addition, they specify the associativity and relative precedence for
all the <var>symbols</var>:

     <ul>
<li>The associativity of an operator <var>op</var> determines how repeated uses
of the operator nest: whether <var>x</var> <var>op</var> <var>y</var> <var>op</var>
<var>z</var> is parsed by grouping <var>x</var> with <var>y</var> first or by
grouping <var>y</var> with <var>z</var> first.  <code>%left</code> specifies
left-associativity (grouping <var>x</var> with <var>y</var> first) and
<code>%right</code> specifies right-associativity (grouping <var>y</var> with
<var>z</var> first).  <code>%nonassoc</code> specifies no associativity, which
means that <var>x</var> <var>op</var> <var>y</var> <var>op</var> <var>z</var> is
considered a syntax error.

     <li>The precedence of an operator determines how it nests with other operators. 
All the tokens declared in a single precedence declaration have equal
precedence and nest together according to their associativity. 
When two tokens declared in different precedence declarations associate,
the one declared later has the higher precedence and is grouped first. 
</ul>

   <p>For backward compatibility, there is a confusing difference between the
argument lists of <code>%token</code> and precedence declarations. 
Only a <code>%token</code> can associate a literal string with a token type name. 
A precedence declaration always interprets a literal string as a reference to a
separate token. 
For example:

<pre class="example">     %left  OR "&lt;="         // Does not declare an alias.
     %left  OR 134 "&lt;=" 135 // Declares 134 for OR and 135 for "&lt;=".
</pre>
   <div class="node">
<p><hr>
<a name="Union-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Type-Decl">Type Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Precedence-Decl">Precedence Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.4 The Collection of Value Types</h4>

<p><a name="index-declaring-value-types-170"></a><a name="index-value-types_002c-declaring-171"></a><a name="index-_0025union-172"></a>
The <code>%union</code> declaration specifies the entire collection of
possible data types for semantic values.  The keyword <code>%union</code> is
followed by braced code containing the same thing that goes inside a
<code>union</code> in C.

   <p>For example:

<pre class="example">     %union {
       double val;
       symrec *tptr;
     }
</pre>
   <p class="noindent">This says that the two alternative types are <code>double</code> and <code>symrec
*</code>.  They are given names <code>val</code> and <code>tptr</code>; these names are used
in the <code>%token</code> and <code>%type</code> declarations to pick one of the types
for a terminal or nonterminal symbol (see <a href="#Type-Decl">Nonterminal Symbols</a>).

   <p>As an extension to <acronym>POSIX</acronym>, a tag is allowed after the
<code>union</code>.  For example:

<pre class="example">     %union value {
       double val;
       symrec *tptr;
     }
</pre>
   <p class="noindent">specifies the union tag <code>value</code>, so the corresponding C type is
<code>union value</code>.  If you do not specify a tag, it defaults to
<code>YYSTYPE</code>.

   <p>As another extension to <acronym>POSIX</acronym>, you may specify multiple
<code>%union</code> declarations; their contents are concatenated.  However,
only the first <code>%union</code> declaration can specify a tag.

   <p>Note that, unlike making a <code>union</code> declaration in C, you need not write
a semicolon after the closing brace.

   <p>Instead of <code>%union</code>, you can define and use your own union type
<code>YYSTYPE</code> if your grammar contains at least one
<span class="samp">&lt;</span><var>type</var><span class="samp">&gt;</span> tag.  For example, you can put the following into
a header file <span class="file">parser.h</span>:

<pre class="example">     union YYSTYPE {
       double val;
       symrec *tptr;
     };
     typedef union YYSTYPE YYSTYPE;
</pre>
   <p class="noindent">and then your grammar can use the following
instead of <code>%union</code>:

<pre class="example">     %{
     #include "parser.h"
     %}
     %type &lt;val&gt; expr
     %token &lt;tptr&gt; ID
</pre>
   <div class="node">
<p><hr>
<a name="Type-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Initial-Action-Decl">Initial Action Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Union-Decl">Union Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.5 Nonterminal Symbols</h4>

<p><a name="index-declaring-value-types_002c-nonterminals-173"></a><a name="index-value-types_002c-nonterminals_002c-declaring-174"></a><a name="index-_0025type-175"></a>
When you use <code>%union</code> to specify multiple value types, you must
declare the value type of each nonterminal symbol for which values are
used.  This is done with a <code>%type</code> declaration, like this:

<pre class="example">     %type &lt;<var>type</var>&gt; <var>nonterminal</var>...
</pre>
   <p class="noindent">Here <var>nonterminal</var> is the name of a nonterminal symbol, and
<var>type</var> is the name given in the <code>%union</code> to the alternative
that you want (see <a href="#Union-Decl">The Collection of Value Types</a>).  You
can give any number of nonterminal symbols in the same <code>%type</code>
declaration, if they have the same value type.  Use spaces to separate
the symbol names.

   <p>You can also declare the value type of a terminal symbol.  To do this,
use the same <code>&lt;</code><var>type</var><code>&gt;</code> construction in a declaration for the
terminal symbol.  All kinds of token declarations allow
<code>&lt;</code><var>type</var><code>&gt;</code>.

<div class="node">
<p><hr>
<a name="Initial-Action-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Destructor-Decl">Destructor Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Type-Decl">Type Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.6 Performing Actions before Parsing</h4>

<p><a name="index-_0025initial_002daction-176"></a>
Sometimes your parser needs to perform some initializations before
parsing.  The <code>%initial-action</code> directive allows for such arbitrary
code.

<div class="defun">
&mdash; Directive: <b>%initial-action</b><var> { code }<a name="index-_0025initial_002daction-177"></a></var><br>
<blockquote><p><a name="index-_0025initial_002daction-178"></a>Declare that the braced <var>code</var> must be invoked before parsing each time
<code>yyparse</code> is called.  The <var>code</var> may use <code>$$</code> and
<code>@$</code> &mdash; initial value and location of the lookahead &mdash; and the
<code>%parse-param</code>. 
</p></blockquote></div>

   <p>For instance, if your locations use a file name, you may use

<pre class="example">     %parse-param { char const *file_name };
     %initial-action
     {
       @$.initialize (file_name);
     };
</pre>
   <div class="node">
<p><hr>
<a name="Destructor-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Expect-Decl">Expect Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Initial-Action-Decl">Initial Action Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.7 Freeing Discarded Symbols</h4>

<p><a name="index-freeing-discarded-symbols-179"></a><a name="index-_0025destructor-180"></a><a name="index-_003c_002a_003e-181"></a><a name="index-_003c_003e-182"></a>During error recovery (see <a href="#Error-Recovery">Error Recovery</a>), symbols already pushed
on the stack and tokens coming from the rest of the file are discarded
until the parser falls on its feet.  If the parser runs out of memory,
or if it returns via <code>YYABORT</code> or <code>YYACCEPT</code>, all the
symbols on the stack must be discarded.  Even if the parser succeeds, it
must discard the start symbol.

   <p>When discarded symbols convey heap based information, this memory is
lost.  While this behavior can be tolerable for batch parsers, such as
in traditional compilers, it is unacceptable for programs like shells or
protocol implementations that may parse and execute indefinitely.

   <p>The <code>%destructor</code> directive defines code that is called when a
symbol is automatically discarded.

<div class="defun">
&mdash; Directive: <b>%destructor</b><var> { code } symbols<a name="index-_0025destructor-183"></a></var><br>
<blockquote><p><a name="index-_0025destructor-184"></a>Invoke the braced <var>code</var> whenever the parser discards one of the
<var>symbols</var>. 
Within <var>code</var>, <code>$$</code> designates the semantic value associated
with the discarded symbol, and <code>@$</code> designates its location. 
The additional parser parameters are also available (see <a href="#Parser-Function">The Parser Function <code>yyparse</code></a>).

        <p>When a symbol is listed among <var>symbols</var>, its <code>%destructor</code> is called a
per-symbol <code>%destructor</code>. 
You may also define a per-type <code>%destructor</code> by listing a semantic type
tag among <var>symbols</var>. 
In that case, the parser will invoke this <var>code</var> whenever it discards any
grammar symbol that has that semantic type tag unless that symbol has its own
per-symbol <code>%destructor</code>.

        <p>Finally, you can define two different kinds of default <code>%destructor</code>s. 
(These default forms are experimental. 
More user feedback will help to determine whether they should become permanent
features.) 
You can place each of <code>&lt;*&gt;</code> and <code>&lt;&gt;</code> in the <var>symbols</var> list of
exactly one <code>%destructor</code> declaration in your grammar file. 
The parser will invoke the <var>code</var> associated with one of these whenever it
discards any user-defined grammar symbol that has no per-symbol and no per-type
<code>%destructor</code>. 
The parser uses the <var>code</var> for <code>&lt;*&gt;</code> in the case of such a grammar
symbol for which you have formally declared a semantic type tag (<code>%type</code>
counts as such a declaration, but <code>$&lt;tag&gt;$</code> does not). 
The parser uses the <var>code</var> for <code>&lt;&gt;</code> in the case of such a grammar
symbol that has no declared semantic type tag. 
</p></blockquote></div>

<p class="noindent">For example:

<pre class="smallexample">     %union { char *string; }
     %token &lt;string&gt; STRING1
     %token &lt;string&gt; STRING2
     %type  &lt;string&gt; string1
     %type  &lt;string&gt; string2
     %union { char character; }
     %token &lt;character&gt; CHR
     %type  &lt;character&gt; chr
     %token TAGLESS
     
     %destructor { } &lt;character&gt;
     %destructor { free ($$); } &lt;*&gt;
     %destructor { free ($$); printf ("%d", @$.first_line); } STRING1 string1
     %destructor { printf ("Discarding tagless symbol.\n"); } &lt;&gt;
</pre>
   <p class="noindent">guarantees that, when the parser discards any user-defined symbol that has a
semantic type tag other than <code>&lt;character&gt;</code>, it passes its semantic value
to <code>free</code> by default. 
However, when the parser discards a <code>STRING1</code> or a <code>string1</code>, it also
prints its line number to <code>stdout</code>. 
It performs only the second <code>%destructor</code> in this case, so it invokes
<code>free</code> only once. 
Finally, the parser merely prints a message whenever it discards any symbol,
such as <code>TAGLESS</code>, that has no semantic type tag.

   <p>A Bison-generated parser invokes the default <code>%destructor</code>s only for
user-defined as opposed to Bison-defined symbols. 
For example, the parser will not invoke either kind of default
<code>%destructor</code> for the special Bison-defined symbols <code>$accept</code>,
<code>$undefined</code>, or <code>$end</code> (see <a href="#Table-of-Symbols">Bison Symbols</a>),
none of which you can reference in your grammar. 
It also will not invoke either for the <code>error</code> token (see <a href="#Table-of-Symbols">error</a>), which is always defined by Bison regardless of whether you
reference it in your grammar. 
However, it may invoke one of them for the end token (token 0) if you
redefine it from <code>$end</code> to, for example, <code>END</code>:

<pre class="smallexample">     %token END 0
</pre>
   <p><a name="index-actions-in-mid_002drule-185"></a><a name="index-mid_002drule-actions-186"></a>Finally, Bison will never invoke a <code>%destructor</code> for an unreferenced
mid-rule semantic value (see <a href="#Mid_002dRule-Actions">Actions in Mid-Rule</a>). 
That is, Bison does not consider a mid-rule to have a semantic value if you do
not reference <code>$$</code> in the mid-rule's action or <code>$</code><var>n</var> (where
<var>n</var> is the RHS symbol position of the mid-rule) in any later action in that
rule. 
However, if you do reference either, the Bison-generated parser will invoke the
<code>&lt;&gt;</code> <code>%destructor</code> whenever it discards the mid-rule symbol.

   <pre class="sp">

</pre>

<a name="index-discarded-symbols-187"></a><dfn>Discarded symbols</dfn> are the following:

     <ul>
<li>stacked symbols popped during the first phase of error recovery,
<li>incoming terminals during the second phase of error recovery,
<li>the current lookahead and the entire stack (except the current
right-hand side symbols) when the parser returns immediately, and
<li>the start symbol, when the parser succeeds. 
</ul>

   <p>The parser can <dfn>return immediately</dfn> because of an explicit call to
<code>YYABORT</code> or <code>YYACCEPT</code>, or failed error recovery, or memory
exhaustion.

   <p>Right-hand side symbols of a rule that explicitly triggers a syntax
error via <code>YYERROR</code> are not discarded automatically.  As a rule
of thumb, destructors are invoked only when user actions cannot manage
the memory.

<div class="node">
<p><hr>
<a name="Expect-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Start-Decl">Start Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Destructor-Decl">Destructor Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.8 Suppressing Conflict Warnings</h4>

<p><a name="index-suppressing-conflict-warnings-188"></a><a name="index-preventing-warnings-about-conflicts-189"></a><a name="index-warnings_002c-preventing-190"></a><a name="index-conflicts_002c-suppressing-warnings-of-191"></a><a name="index-_0025expect-192"></a><a name="index-_0025expect_002drr-193"></a>
Bison normally warns if there are any conflicts in the grammar
(see <a href="#Shift_002fReduce">Shift/Reduce Conflicts</a>), but most real grammars
have harmless shift/reduce conflicts which are resolved in a predictable
way and would be difficult to eliminate.  It is desirable to suppress
the warning about these conflicts unless the number of conflicts
changes.  You can do this with the <code>%expect</code> declaration.

   <p>The declaration looks like this:

<pre class="example">     %expect <var>n</var>
</pre>
   <p>Here <var>n</var> is a decimal integer.  The declaration says there should
be <var>n</var> shift/reduce conflicts and no reduce/reduce conflicts. 
Bison reports an error if the number of shift/reduce conflicts differs
from <var>n</var>, or if there are any reduce/reduce conflicts.

   <p>For normal <acronym>LALR</acronym>(1) parsers, reduce/reduce conflicts are more
serious, and should be eliminated entirely.  Bison will always report
reduce/reduce conflicts for these parsers.  With <acronym>GLR</acronym>
parsers, however, both kinds of conflicts are routine; otherwise,
there would be no need to use <acronym>GLR</acronym> parsing.  Therefore, it is
also possible to specify an expected number of reduce/reduce conflicts
in <acronym>GLR</acronym> parsers, using the declaration:

<pre class="example">     %expect-rr <var>n</var>
</pre>
   <p>In general, using <code>%expect</code> involves these steps:

     <ul>
<li>Compile your grammar without <code>%expect</code>.  Use the <span class="samp">-v</span> option
to get a verbose list of where the conflicts occur.  Bison will also
print the number of conflicts.

     <li>Check each of the conflicts to make sure that Bison's default
resolution is what you really want.  If not, rewrite the grammar and
go back to the beginning.

     <li>Add an <code>%expect</code> declaration, copying the number <var>n</var> from the
number which Bison printed.  With <acronym>GLR</acronym> parsers, add an
<code>%expect-rr</code> declaration as well. 
</ul>

   <p>Now Bison will warn you if you introduce an unexpected conflict, but
will keep silent otherwise.

<div class="node">
<p><hr>
<a name="Start-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Pure-Decl">Pure Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Expect-Decl">Expect Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.9 The Start-Symbol</h4>

<p><a name="index-declaring-the-start-symbol-194"></a><a name="index-start-symbol_002c-declaring-195"></a><a name="index-default-start-symbol-196"></a><a name="index-_0025start-197"></a>
Bison assumes by default that the start symbol for the grammar is the first
nonterminal specified in the grammar specification section.  The programmer
may override this restriction with the <code>%start</code> declaration as follows:

<pre class="example">     %start <var>symbol</var>
</pre>
   <div class="node">
<p><hr>
<a name="Pure-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Push-Decl">Push Decl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Start-Decl">Start Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.10 A Pure (Reentrant) Parser</h4>

<p><a name="index-reentrant-parser-198"></a><a name="index-pure-parser-199"></a><a name="index-_0025define-api_002epure-200"></a>
A <dfn>reentrant</dfn> program is one which does not alter in the course of
execution; in other words, it consists entirely of <dfn>pure</dfn> (read-only)
code.  Reentrancy is important whenever asynchronous execution is possible;
for example, a nonreentrant program may not be safe to call from a signal
handler.  In systems with multiple threads of control, a nonreentrant
program must be called only within interlocks.

   <p>Normally, Bison generates a parser which is not reentrant.  This is
suitable for most uses, and it permits compatibility with Yacc.  (The
standard Yacc interfaces are inherently nonreentrant, because they use
statically allocated variables for communication with <code>yylex</code>,
including <code>yylval</code> and <code>yylloc</code>.)

   <p>Alternatively, you can generate a pure, reentrant parser.  The Bison
declaration <code>%define api.pure</code> says that you want the parser to be
reentrant.  It looks like this:

<pre class="example">     %define api.pure
</pre>
   <p>The result is that the communication variables <code>yylval</code> and
<code>yylloc</code> become local variables in <code>yyparse</code>, and a different
calling convention is used for the lexical analyzer function
<code>yylex</code>.  See <a href="#Pure-Calling">Calling Conventions for Pure Parsers</a>, for the details of this.  The variable <code>yynerrs</code>
becomes local in <code>yyparse</code> in pull mode but it becomes a member
of yypstate in push mode.  (see <a href="#Error-Reporting">The Error Reporting Function <code>yyerror</code></a>).  The convention for calling
<code>yyparse</code> itself is unchanged.

   <p>Whether the parser is pure has nothing to do with the grammar rules. 
You can generate either a pure parser or a nonreentrant parser from any
valid grammar.

<div class="node">
<p><hr>
<a name="Push-Decl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Decl-Summary">Decl Summary</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Pure-Decl">Pure Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.11 A Push Parser</h4>

<p><a name="index-push-parser-201"></a><a name="index-push-parser-202"></a><a name="index-_0025define-api_002epush_005fpull-203"></a>
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.)

   <p>A pull parser is called once and it takes control until all its input
is completely parsed.  A push parser, on the other hand, is called
each time a new token is made available.

   <p>A push parser is typically useful when the parser is part of a
main event loop in the client's application.  This is typically
a requirement of a GUI, when the main event loop needs to be triggered
within a certain time period.

   <p>Normally, Bison generates a pull parser. 
The following Bison declaration says that you want the parser to be a push
parser (see <a href="#Decl-Summary">%define api.push_pull</a>):

<pre class="example">     %define api.push_pull "push"
</pre>
   <p>In almost all cases, you want to ensure that your push parser is also
a pure parser (see <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>).  The only
time you should create an impure push parser is to have backwards
compatibility with the impure Yacc pull mode interface.  Unless you know
what you are doing, your declarations should look like this:

<pre class="example">     %define api.pure
     %define api.push_pull "push"
</pre>
   <p>There is a major notable functional difference between the pure push parser
and the impure push parser.  It is acceptable for a pure push parser to have
many parser instances, of the same type of parser, in memory at the same time. 
An impure push parser should only use one parser at a time.

   <p>When a push parser is selected, Bison will generate some new symbols in
the generated parser.  <code>yypstate</code> is a structure that the generated
parser uses to store the parser's state.  <code>yypstate_new</code> is the
function that will create a new parser instance.  <code>yypstate_delete</code>
will free the resources associated with the corresponding parser instance. 
Finally, <code>yypush_parse</code> is the function that should be called whenever a
token is available to provide the parser.  A trivial example
of using a pure push parser would look like this:

<pre class="example">     int status;
     yypstate *ps = yypstate_new ();
     do {
       status = yypush_parse (ps, yylex (), NULL);
     } while (status == YYPUSH_MORE);
     yypstate_delete (ps);
</pre>
   <p>If the user decided to use an impure push parser, a few things about
the generated parser will change.  The <code>yychar</code> variable becomes
a global variable instead of a variable in the <code>yypush_parse</code> function. 
For this reason, the signature of the <code>yypush_parse</code> function is
changed to remove the token as a parameter.  A nonreentrant push parser
example would thus look like this:

<pre class="example">     extern int yychar;
     int status;
     yypstate *ps = yypstate_new ();
     do {
       yychar = yylex ();
       status = yypush_parse (ps);
     } while (status == YYPUSH_MORE);
     yypstate_delete (ps);
</pre>
   <p>That's it. Notice the next token is put into the global variable <code>yychar</code>
for use by the next invocation of the <code>yypush_parse</code> function.

   <p>Bison also supports both the push parser interface along with the pull parser
interface in the same generated parser.  In order to get this functionality,
you should replace the <code>%define api.push_pull "push"</code> declaration with the
<code>%define api.push_pull "both"</code> declaration.  Doing this will create all of
the symbols mentioned earlier along with the two extra symbols, <code>yyparse</code>
and <code>yypull_parse</code>.  <code>yyparse</code> can be used exactly as it normally
would be used.  However, the user should note that it is implemented in the
generated parser by calling <code>yypull_parse</code>. 
This makes the <code>yyparse</code> function that is generated with the
<code>%define api.push_pull "both"</code> declaration slower than the normal
<code>yyparse</code> function.  If the user
calls the <code>yypull_parse</code> function it will parse the rest of the input
stream.  It is possible to <code>yypush_parse</code> tokens to select a subgrammar
and then <code>yypull_parse</code> the rest of the input stream.  If you would like
to switch back and forth between between parsing styles, you would have to
write your own <code>yypull_parse</code> function that knows when to quit looking
for input.  An example of using the <code>yypull_parse</code> function would look
like this:

<pre class="example">     yypstate *ps = yypstate_new ();
     yypull_parse (ps); /* Will call the lexer */
     yypstate_delete (ps);
</pre>
   <p>Adding the <code>%define api.pure</code> declaration does exactly the same thing to
the generated parser with <code>%define api.push_pull "both"</code> as it did for
<code>%define api.push_pull "push"</code>.

<div class="node">
<p><hr>
<a name="Decl-Summary"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Push-Decl">Push Decl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Declarations">Declarations</a>
<br>
</div>

<h4 class="subsection">3.7.12 Bison Declaration Summary</h4>

<p><a name="index-Bison-declaration-summary-204"></a><a name="index-declaration-summary-205"></a><a name="index-summary_002c-Bison-declaration-206"></a>
Here is a summary of the declarations used to define a grammar:

<div class="defun">
&mdash; Directive: <b>%union</b><var><a name="index-_0025union-207"></a></var><br>
<blockquote><p>Declare the collection of data types that semantic values may have
(see <a href="#Union-Decl">The Collection of Value Types</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%token</b><var><a name="index-_0025token-208"></a></var><br>
<blockquote><p>Declare a terminal symbol (token type name) with no precedence
or associativity specified (see <a href="#Token-Decl">Token Type Names</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%right</b><var><a name="index-_0025right-209"></a></var><br>
<blockquote><p>Declare a terminal symbol (token type name) that is right-associative
(see <a href="#Precedence-Decl">Operator Precedence</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%left</b><var><a name="index-_0025left-210"></a></var><br>
<blockquote><p>Declare a terminal symbol (token type name) that is left-associative
(see <a href="#Precedence-Decl">Operator Precedence</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%nonassoc</b><var><a name="index-_0025nonassoc-211"></a></var><br>
<blockquote><p>Declare a terminal symbol (token type name) that is nonassociative
(see <a href="#Precedence-Decl">Operator Precedence</a>). 
Using it in a way that would be associative is a syntax error. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%type</b><var><a name="index-_0025type-212"></a></var><br>
<blockquote><p>Declare the type of semantic values for a nonterminal symbol
(see <a href="#Type-Decl">Nonterminal Symbols</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%start</b><var><a name="index-_0025start-213"></a></var><br>
<blockquote><p>Specify the grammar's start symbol (see <a href="#Start-Decl">The Start-Symbol</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%expect</b><var><a name="index-_0025expect-214"></a></var><br>
<blockquote><p>Declare the expected number of shift-reduce conflicts
(see <a href="#Expect-Decl">Suppressing Conflict Warnings</a>). 
</p></blockquote></div>

   <pre class="sp">

</pre>
In order to change the behavior of <span class="command">bison</span>, use the following
directives:

<div class="defun">
&mdash; Directive: <b>%code</b><var> {code}<a name="index-_0025code-215"></a></var><br>
<blockquote><p><a name="index-_0025code-216"></a>This is the unqualified form of the <code>%code</code> directive. 
It inserts <var>code</var> verbatim at a language-dependent default location in the
output<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>.

        <p><a name="index-Prologue-217"></a>For C/C++, the default location is the parser source code
file after the usual contents of the parser header file. 
Thus, <code>%code</code> replaces the traditional Yacc prologue,
<code>%{</code><var>code</var><code>%}</code>, for most purposes. 
For a detailed discussion, see <a href="#Prologue-Alternatives">Prologue Alternatives</a>.

        <p>For Java, the default location is inside the parser class.

        <p>(Like all the Yacc prologue alternatives, this directive is experimental. 
More user feedback will help to determine whether it should become a permanent
feature.) 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%code</b><var> qualifier {code}<a name="index-_0025code-218"></a></var><br>
<blockquote><p>This is the qualified form of the <code>%code</code> directive. 
If you need to specify location-sensitive verbatim <var>code</var> that does not
belong at the default location selected by the unqualified <code>%code</code> form,
use this form instead.

        <p><var>qualifier</var> identifies the purpose of <var>code</var> and thus the location(s)
where Bison should generate it. 
Not all values of <var>qualifier</var> are available for all target languages:

          <ul>
<li>requires
<a name="index-_0025code-requires-219"></a>
               <ul>
<li>Language(s): C, C++

               <li>Purpose: This is the best place to write dependency code required for
<code>YYSTYPE</code> and <code>YYLTYPE</code>. 
In other words, it's the best place to define types referenced in <code>%union</code>
directives, and it's the best place to override Bison's default <code>YYSTYPE</code>
and <code>YYLTYPE</code> definitions.

               <li>Location(s): The parser header file and the parser source code file
before the Bison-generated <code>YYSTYPE</code> and <code>YYLTYPE</code> definitions. 
</ul>

          <li>provides
<a name="index-_0025code-provides-220"></a>
               <ul>
<li>Language(s): C, C++

               <li>Purpose: This is the best place to write additional definitions and
declarations that should be provided to other modules.

               <li>Location(s): The parser header file and the parser source code file after
the Bison-generated <code>YYSTYPE</code>, <code>YYLTYPE</code>, and token definitions. 
</ul>

          <li>top
<a name="index-_0025code-top-221"></a>
               <ul>
<li>Language(s): C, C++

               <li>Purpose: The unqualified <code>%code</code> or <code>%code requires</code> should
usually be more appropriate than <code>%code top</code>. 
However, occasionally it is necessary to insert code much nearer the top of the
parser source code file. 
For example:

               <pre class="smallexample">                    %code top {
                      #define _GNU_SOURCE
                      #include &lt;stdio.h&gt;
                    }
               </pre>
               <li>Location(s): Near the top of the parser source code file. 
</ul>

          <li>imports
<a name="index-_0025code-imports-222"></a>
               <ul>
<li>Language(s): Java

               <li>Purpose: This is the best place to write Java import directives.

               <li>Location(s): The parser Java file after any Java package directive and
before any class definitions. 
</ul>
          </ul>

        <p>(Like all the Yacc prologue alternatives, this directive is experimental. 
More user feedback will help to determine whether it should become a permanent
feature.)

        <p><a name="index-Prologue-223"></a>For a detailed discussion of how to use <code>%code</code> in place of the
traditional Yacc prologue for C/C++, see <a href="#Prologue-Alternatives">Prologue Alternatives</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%debug</b><var><a name="index-_0025debug-224"></a></var><br>
<blockquote><p>In the parser file, define the macro <code>YYDEBUG</code> to 1 if it is not
already defined, so that the debugging facilities are compiled. 
</p></blockquote></div>
   See <a href="#Tracing">Tracing Your Parser</a>.

<div class="defun">
&mdash; Directive: <b>%define</b><var> variable<a name="index-_0025define-225"></a></var><br>
&mdash; Directive: <b>%define</b><var> variable "value"<a name="index-_0025define-226"></a></var><br>
<blockquote><p>Define a variable to adjust Bison's behavior. 
The possible choices for <var>variable</var>, as well as their meanings, depend on
the selected target language and/or the parser skeleton (see <a href="#Decl-Summary">%language</a>, see <a href="#Decl-Summary">%skeleton</a>).

        <p>Bison will warn if a <var>variable</var> is defined multiple times.

        <p>Omitting <code>"</code><var>value</var><code>"</code> is always equivalent to specifying it as
<code>""</code>.

        <p>Some <var>variable</var>s may be used as Booleans. 
In this case, Bison will complain if the variable definition does not meet one
of the following four conditions:

          <ol type=1 start=1>
<li><code>"</code><var>value</var><code>"</code> is <code>"true"</code>

          <li><code>"</code><var>value</var><code>"</code> is omitted (or is <code>""</code>). 
This is equivalent to <code>"true"</code>.

          <li><code>"</code><var>value</var><code>"</code> is <code>"false"</code>.

          <li><var>variable</var> is never defined. 
In this case, Bison selects a default value, which may depend on the selected
target language and/or parser skeleton.
             </ol>

        <p>Some of the accepted <var>variable</var>s are:

          <ul>
<li>api.pure
<a name="index-_0025define-api_002epure-227"></a>
               <ul>
<li>Language(s): C

               <li>Purpose: Request a pure (reentrant) parser program. 
See <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>.

               <li>Accepted Values: Boolean

               <li>Default Value: <code>"false"</code>
</ul>

          <li>api.push_pull
<a name="index-_0025define-api_002epush_005fpull-228"></a>
               <ul>
<li>Language(s): C (LALR(1) only)

               <li>Purpose: Requests a pull parser, a push parser, or both. 
See <a href="#Push-Decl">A Push Parser</a>. 
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.)

               <li>Accepted Values: <code>"pull"</code>, <code>"push"</code>, <code>"both"</code>

               <li>Default Value: <code>"pull"</code>
</ul>

          <li>lr.keep_unreachable_states
<a name="index-_0025define-lr_002ekeep_005funreachable_005fstates-229"></a>
               <ul>
<li>Language(s): all

               <li>Purpose: Requests that Bison allow unreachable parser states to remain in
the parser tables. 
Bison considers a state to be unreachable if there exists no sequence of
transitions from the start state to that state. 
A state can become unreachable during conflict resolution if Bison disables a
shift action leading to it from a predecessor state. 
Keeping unreachable states is sometimes useful for analysis purposes, but they
are useless in the generated parser.

               <li>Accepted Values: Boolean

               <li>Default Value: <code>"false"</code>

               <li>Caveats:

                    <ul>
<li>Unreachable states may contain conflicts and may use rules not used in
any other state. 
Thus, keeping unreachable states may induce warnings that are irrelevant to
your parser's behavior, and it may eliminate warnings that are relevant. 
Of course, the change in warnings may actually be relevant to a parser table
analysis that wants to keep unreachable states, so this behavior will likely
remain in future Bison releases.

                    <li>While Bison is able to remove unreachable states, it is not guaranteed to
remove other kinds of useless states. 
Specifically, when Bison disables reduce actions during conflict resolution,
some goto actions may become useless, and thus some additional states may
become useless. 
If Bison were to compute which goto actions were useless and then disable those
actions, it could identify such states as unreachable and then remove those
states. 
However, Bison does not compute which goto actions are useless. 
</ul>
               </ul>

          <li>namespace
<a name="index-_0025define-namespace-230"></a>
               <ul>
<li>Languages(s): C++

               <li>Purpose: Specifies the namespace for the parser class. 
For example, if you specify:

               <pre class="smallexample">                    %define namespace "foo::bar"
               </pre>
               <p>Bison uses <code>foo::bar</code> verbatim in references such as:

               <pre class="smallexample">                    foo::bar::parser::semantic_type
               </pre>
               <p>However, to open a namespace, Bison removes any leading <code>::</code> and then
splits on any remaining occurrences:

               <pre class="smallexample">                    namespace foo { namespace bar {
                      class position;
                      class location;
                    } }
               </pre>
               <li>Accepted Values: Any absolute or relative C++ namespace reference without
a trailing <code>"::"</code>. 
For example, <code>"foo"</code> or <code>"::foo::bar"</code>.

               <li>Default Value: The value specified by <code>%name-prefix</code>, which defaults
to <code>yy</code>. 
This usage of <code>%name-prefix</code> is for backward compatibility and can be
confusing since <code>%name-prefix</code> also specifies the textual prefix for the
lexical analyzer function. 
Thus, if you specify <code>%name-prefix</code>, it is best to also specify
<code>%define namespace</code> so that <code>%name-prefix</code> <em>only</em> affects the
lexical analyzer function. 
For example, if you specify:

               <pre class="smallexample">                    %define namespace "foo"
                    %name-prefix "bar::"
               </pre>
               <p>The parser namespace is <code>foo</code> and <code>yylex</code> is referenced as
<code>bar::lex</code>. 
</ul>
          </ul>

        </blockquote></div>

<div class="defun">
&mdash; Directive: <b>%defines</b><var><a name="index-_0025defines-231"></a></var><br>
<blockquote><p>Write a header file containing macro definitions for the token type
names defined in the grammar as well as a few other declarations. 
If the parser output file is named <var>name</var><span class="file">.c</span> then this file
is named <var>name</var><span class="file">.h</span>.

        <p>For C parsers, the output header declares <code>YYSTYPE</code> unless
<code>YYSTYPE</code> is already defined as a macro or you have used a
<code>&lt;</code><var>type</var><code>&gt;</code> tag without using <code>%union</code>. 
Therefore, if you are using a <code>%union</code>
(see <a href="#Multiple-Types">More Than One Value Type</a>) with components that
require other definitions, or if you have defined a <code>YYSTYPE</code> macro
or type definition
(see <a href="#Value-Type">Data Types of Semantic Values</a>), you need to
arrange for these definitions to be propagated to all modules, e.g., by
putting them in a prerequisite header that is included both by your
parser and by any other module that needs <code>YYSTYPE</code>.

        <p>Unless your parser is pure, the output header declares <code>yylval</code>
as an external variable.  See <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>.

        <p>If you have also used locations, the output header declares
<code>YYLTYPE</code> and <code>yylloc</code> using a protocol similar to that of
the <code>YYSTYPE</code> macro and <code>yylval</code>.  See <a href="#Locations">Tracking Locations</a>.

        <p>This output file is normally essential if you wish to put the definition
of <code>yylex</code> in a separate source file, because <code>yylex</code>
typically needs to be able to refer to the above-mentioned declarations
and to the token type codes.  See <a href="#Token-Values">Semantic Values of Tokens</a>.

        <p><a name="index-_0025code-requires-232"></a><a name="index-_0025code-provides-233"></a>If you have declared <code>%code requires</code> or <code>%code provides</code>, the output
header also contains their code. 
See <a href="#Decl-Summary">%code</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%defines</b><var> defines-file<a name="index-_0025defines-234"></a></var><br>
<blockquote><p>Same as above, but save in the file <var>defines-file</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%destructor</b><var><a name="index-_0025destructor-235"></a></var><br>
<blockquote><p>Specify how the parser should reclaim the memory associated to
discarded symbols.  See <a href="#Destructor-Decl">Freeing Discarded Symbols</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%file-prefix</b><var> "prefix"<a name="index-_0025file_002dprefix-236"></a></var><br>
<blockquote><p>Specify a prefix to use for all Bison output file names.  The names are
chosen as if the input file were named <var>prefix</var><span class="file">.y</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%language</b><var> "language"<a name="index-_0025language-237"></a></var><br>
<blockquote><p>Specify the programming language for the generated parser.  Currently
supported languages include C, C++, and Java. 
<var>language</var> is case-insensitive.

        <p>This directive is experimental and its effect may be modified in future
releases. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%locations</b><var><a name="index-_0025locations-238"></a></var><br>
<blockquote><p>Generate the code processing the locations (see <a href="#Action-Features">Special Features for Use in Actions</a>).  This mode is enabled as soon as
the grammar uses the special <span class="samp">@</span><var>n</var> tokens, but if your
grammar does not use it, using <span class="samp">%locations</span> allows for more
accurate syntax error messages. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%name-prefix</b><var> "prefix"<a name="index-_0025name_002dprefix-239"></a></var><br>
<blockquote><p>Rename the external symbols used in the parser so that they start with
<var>prefix</var> instead of <span class="samp">yy</span>.  The precise list of symbols renamed
in C parsers
is <code>yyparse</code>, <code>yylex</code>, <code>yyerror</code>, <code>yynerrs</code>,
<code>yylval</code>, <code>yychar</code>, <code>yydebug</code>, and
(if locations are used) <code>yylloc</code>.  If you use a push parser,
<code>yypush_parse</code>, <code>yypull_parse</code>, <code>yypstate</code>,
<code>yypstate_new</code> and <code>yypstate_delete</code> will
also be renamed.  For example, if you use <span class="samp">%name-prefix "c_"</span>, the
names become <code>c_parse</code>, <code>c_lex</code>, and so on. 
For C++ parsers, see the <code>%define namespace</code> documentation in this
section. 
See <a href="#Multiple-Parsers">Multiple Parsers in the Same Program</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%no-lines</b><var><a name="index-_0025no_002dlines-240"></a></var><br>
<blockquote><p>Don't generate any <code>#line</code> preprocessor commands in the parser
file.  Ordinarily Bison writes these commands in the parser file so that
the C compiler and debuggers will associate errors and object code with
your source file (the grammar file).  This directive causes them to
associate errors with the parser file, treating it an independent source
file in its own right. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%output</b><var> "file"<a name="index-_0025output-241"></a></var><br>
<blockquote><p>Specify <var>file</var> for the parser file. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%pure-parser</b><var><a name="index-_0025pure_002dparser-242"></a></var><br>
<blockquote><p>Deprecated version of <code>%define api.pure</code> (see <a href="#Decl-Summary">%define</a>),
for which Bison is more careful to warn about unreasonable usage. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%require</b><var> "version"<a name="index-_0025require-243"></a></var><br>
<blockquote><p>Require version <var>version</var> or higher of Bison.  See <a href="#Require-Decl">Require a Version of Bison</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%skeleton</b><var> "file"<a name="index-_0025skeleton-244"></a></var><br>
<blockquote><p>Specify the skeleton to use.

     <!-- You probably don't need this option unless you are developing Bison. -->
<!-- You should use @code{%language} if you want to specify the skeleton for a -->
<!-- different language, because it is clearer and because it will always choose the -->
<!-- correct skeleton for non-deterministic or push parsers. -->
<p>If <var>file</var> does not contain a <code>/</code>, <var>file</var> is the name of a skeleton
file in the Bison installation directory. 
If it does, <var>file</var> is an absolute file name or a file name relative to the
directory of the grammar file. 
This is similar to how most shells resolve commands. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%token-table</b><var><a name="index-_0025token_002dtable-245"></a></var><br>
<blockquote><p>Generate an array of token names in the parser file.  The name of the
array is <code>yytname</code>; <code>yytname[</code><var>i</var><code>]</code> is the name of the
token whose internal Bison token code number is <var>i</var>.  The first
three elements of <code>yytname</code> correspond to the predefined tokens
<code>"$end"</code>,
<code>"error"</code>, and <code>"$undefined"</code>; after these come the symbols
defined in the grammar file.

        <p>The name in the table includes all the characters needed to represent
the token in Bison.  For single-character literals and literal
strings, this includes the surrounding quoting characters and any
escape sequences.  For example, the Bison single-character literal
<code>'+'</code> corresponds to a three-character name, represented in C as
<code>"'+'"</code>; and the Bison two-character literal string <code>"\\/"</code>
corresponds to a five-character name, represented in C as
<code>"\"\\\\/\""</code>.

        <p>When you specify <code>%token-table</code>, Bison also generates macro
definitions for macros <code>YYNTOKENS</code>, <code>YYNNTS</code>, and
<code>YYNRULES</code>, and <code>YYNSTATES</code>:

          <dl>
<dt><code>YYNTOKENS</code><dd>The highest token number, plus one. 
<br><dt><code>YYNNTS</code><dd>The number of nonterminal symbols. 
<br><dt><code>YYNRULES</code><dd>The number of grammar rules,
<br><dt><code>YYNSTATES</code><dd>The number of parser states (see <a href="#Parser-States">Parser States</a>). 
</dl>
        </p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%verbose</b><var><a name="index-_0025verbose-246"></a></var><br>
<blockquote><p>Write an extra output file containing verbose descriptions of the
parser states and what is done for each type of lookahead token in
that state.  See <a href="#Understanding">Understanding Your Parser</a>, for more
information. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%yacc</b><var><a name="index-_0025yacc-247"></a></var><br>
<blockquote><p>Pretend the option <span class="option">--yacc</span> was given, i.e., imitate Yacc,
including its naming conventions.  See <a href="#Bison-Options">Bison Options</a>, for more. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Multiple-Parsers"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Declarations">Declarations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Grammar-File">Grammar File</a>
<br>
</div>

<h3 class="section">3.8 Multiple Parsers in the Same Program</h3>

<p>Most programs that use Bison parse only one language and therefore contain
only one Bison parser.  But what if you want to parse more than one
language with the same program?  Then you need to avoid a name conflict
between different definitions of <code>yyparse</code>, <code>yylval</code>, and so on.

   <p>The easy way to do this is to use the option <span class="samp">-p </span><var>prefix</var>
(see <a href="#Invocation">Invoking Bison</a>).  This renames the interface
functions and variables of the Bison parser to start with <var>prefix</var>
instead of <span class="samp">yy</span>.  You can use this to give each parser distinct
names that do not conflict.

   <p>The precise list of symbols renamed is <code>yyparse</code>, <code>yylex</code>,
<code>yyerror</code>, <code>yynerrs</code>, <code>yylval</code>, <code>yylloc</code>,
<code>yychar</code> and <code>yydebug</code>.  If you use a push parser,
<code>yypush_parse</code>, <code>yypull_parse</code>, <code>yypstate</code>,
<code>yypstate_new</code> and <code>yypstate_delete</code> will also be renamed. 
For example, if you use <span class="samp">-p c</span>, the names become <code>cparse</code>,
<code>clex</code>, and so on.

   <p><strong>All the other variables and macros associated with Bison are not
renamed.</strong> These others are not global; there is no conflict if the same
name is used in different parsers.  For example, <code>YYSTYPE</code> is not
renamed, but defining this in different ways in different parsers causes
no trouble (see <a href="#Value-Type">Data Types of Semantic Values</a>).

   <p>The <span class="samp">-p</span> option works by adding macro definitions to the beginning
of the parser source file, defining <code>yyparse</code> as
<var>prefix</var><code>parse</code>, and so on.  This effectively substitutes one
name for the other in the entire parser file.

<div class="node">
<p><hr>
<a name="Interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Algorithm">Algorithm</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Grammar-File">Grammar File</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">4 Parser C-Language Interface</h2>

<p><a name="index-C_002dlanguage-interface-248"></a><a name="index-interface-249"></a>
The Bison parser is actually a C function named <code>yyparse</code>.  Here we
describe the interface conventions of <code>yyparse</code> and the other
functions that it needs to use.

   <p>Keep in mind that the parser uses many C identifiers starting with
<span class="samp">yy</span> and <span class="samp">YY</span> for internal purposes.  If you use such an
identifier (aside from those in this manual) in an action or in epilogue
in the grammar file, you are likely to run into trouble.

<ul class="menu">
<li><a accesskey="1" href="#Parser-Function">Parser Function</a>:          How to call <code>yyparse</code> and what it returns. 
<li><a accesskey="2" href="#Push-Parser-Function">Push Parser Function</a>:     How to call <code>yypush_parse</code> and what it returns. 
<li><a accesskey="3" href="#Pull-Parser-Function">Pull Parser Function</a>:     How to call <code>yypull_parse</code> and what it returns. 
<li><a accesskey="4" href="#Parser-Create-Function">Parser Create Function</a>:   How to call <code>yypstate_new</code> and what it returns. 
<li><a accesskey="5" href="#Parser-Delete-Function">Parser Delete Function</a>:   How to call <code>yypstate_delete</code> and what it returns. 
<li><a accesskey="6" href="#Lexical">Lexical</a>:                  You must supply a function <code>yylex</code>
                              which reads tokens. 
<li><a accesskey="7" href="#Error-Reporting">Error Reporting</a>:          You must supply a function <code>yyerror</code>. 
<li><a accesskey="8" href="#Action-Features">Action Features</a>:          Special features for use in actions. 
<li><a accesskey="9" href="#Internationalization">Internationalization</a>:     How to let the parser speak in the user's
                              native language. 
</ul>

<div class="node">
<p><hr>
<a name="Parser-Function"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Push-Parser-Function">Push Parser Function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.1 The Parser Function <code>yyparse</code></h3>

<p><a name="index-yyparse-250"></a>
You call the function <code>yyparse</code> to cause parsing to occur.  This
function reads tokens, executes actions, and ultimately returns when it
encounters end-of-input or an unrecoverable syntax error.  You can also
write an action which directs <code>yyparse</code> to return immediately
without reading further.

<div class="defun">
&mdash; Function: int <b>yyparse</b> (<var>void</var>)<var><a name="index-yyparse-251"></a></var><br>
<blockquote><p>The value returned by <code>yyparse</code> is 0 if parsing was successful (return
is due to end-of-input).

        <p>The value is 1 if parsing failed because of invalid input, i.e., input
that contains a syntax error or that causes <code>YYABORT</code> to be
invoked.

        <p>The value is 2 if parsing failed due to memory exhaustion. 
</p></blockquote></div>

   <p>In an action, you can cause immediate return from <code>yyparse</code> by using
these macros:

<div class="defun">
&mdash; Macro: <b>YYACCEPT</b><var><a name="index-YYACCEPT-252"></a></var><br>
<blockquote><p><a name="index-YYACCEPT-253"></a>Return immediately with value 0 (to report success). 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYABORT</b><var><a name="index-YYABORT-254"></a></var><br>
<blockquote><p><a name="index-YYABORT-255"></a>Return immediately with value 1 (to report failure). 
</p></blockquote></div>

   <p>If you use a reentrant parser, you can optionally pass additional
parameter information to it in a reentrant way.  To do so, use the
declaration <code>%parse-param</code>:

<div class="defun">
&mdash; Directive: <b>%parse-param</b><var> {argument-declaration}<a name="index-_0025parse_002dparam-256"></a></var><br>
<blockquote><p><a name="index-_0025parse_002dparam-257"></a>Declare that an argument declared by the braced-code
<var>argument-declaration</var> is an additional <code>yyparse</code> argument. 
The <var>argument-declaration</var> is used when declaring
functions or prototypes.  The last identifier in
<var>argument-declaration</var> must be the argument name. 
</p></blockquote></div>

   <p>Here's an example.  Write this in the parser:

<pre class="example">     %parse-param {int *nastiness}
     %parse-param {int *randomness}
</pre>
   <p class="noindent">Then call the parser like this:

<pre class="example">     {
       int nastiness, randomness;
       ...  /* <span class="roman">Store proper data in </span><code>nastiness</code><span class="roman"> and </span><code>randomness</code><span class="roman">.</span>  */
       value = yyparse (&amp;nastiness, &amp;randomness);
       ...
     }
</pre>
   <p class="noindent">In the grammar actions, use expressions like this to refer to the data:

<pre class="example">     exp: ...    { ...; *randomness += 1; ... }
</pre>
   <div class="node">
<p><hr>
<a name="Push-Parser-Function"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Pull-Parser-Function">Pull Parser Function</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parser-Function">Parser Function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.2 The Push Parser Function <code>yypush_parse</code></h3>

<p><a name="index-yypush_005fparse-258"></a>
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.)

   <p>You call the function <code>yypush_parse</code> to parse a single token.  This
function is available if either the <code>%define api.push_pull "push"</code> or
<code>%define api.push_pull "both"</code> declaration is used. 
See <a href="#Push-Decl">A Push Parser</a>.

<div class="defun">
&mdash; Function: int <b>yypush_parse</b> (<var>yypstate *yyps</var>)<var><a name="index-yypush_005fparse-259"></a></var><br>
<blockquote><p>The value returned by <code>yypush_parse</code> is the same as for yyparse with the
following exception.  <code>yypush_parse</code> will return YYPUSH_MORE if more input
is required to finish parsing the grammar. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Pull-Parser-Function"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Parser-Create-Function">Parser Create Function</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Push-Parser-Function">Push Parser Function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.3 The Pull Parser Function <code>yypull_parse</code></h3>

<p><a name="index-yypull_005fparse-260"></a>
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.)

   <p>You call the function <code>yypull_parse</code> to parse the rest of the input
stream.  This function is available if the <code>%define api.push_pull "both"</code>
declaration is used. 
See <a href="#Push-Decl">A Push Parser</a>.

<div class="defun">
&mdash; Function: int <b>yypull_parse</b> (<var>yypstate *yyps</var>)<var><a name="index-yypull_005fparse-261"></a></var><br>
<blockquote><p>The value returned by <code>yypull_parse</code> is the same as for <code>yyparse</code>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Parser-Create-Function"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Parser-Delete-Function">Parser Delete Function</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Pull-Parser-Function">Pull Parser Function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.4 The Parser Create Function <code>yystate_new</code></h3>

<p><a name="index-yypstate_005fnew-262"></a>
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.)

   <p>You call the function <code>yypstate_new</code> to create a new parser instance. 
This function is available if either the <code>%define api.push_pull "push"</code> or
<code>%define api.push_pull "both"</code> declaration is used. 
See <a href="#Push-Decl">A Push Parser</a>.

<div class="defun">
&mdash; Function: yypstate <b>*yypstate_new</b> (<var>void</var>)<var><a name="index-_002ayypstate_005fnew-263"></a></var><br>
<blockquote><p>The fuction will return a valid parser instance if there was memory available
or 0 if no memory was available. 
In impure mode, it will also return 0 if a parser instance is currently
allocated. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Parser-Delete-Function"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Lexical">Lexical</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parser-Create-Function">Parser Create Function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.5 The Parser Delete Function <code>yystate_delete</code></h3>

<p><a name="index-yypstate_005fdelete-264"></a>
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.)

   <p>You call the function <code>yypstate_delete</code> to delete a parser instance. 
function is available if either the <code>%define api.push_pull "push"</code> or
<code>%define api.push_pull "both"</code> declaration is used. 
See <a href="#Push-Decl">A Push Parser</a>.

<div class="defun">
&mdash; Function: void <b>yypstate_delete</b> (<var>yypstate *yyps</var>)<var><a name="index-yypstate_005fdelete-265"></a></var><br>
<blockquote><p>This function will reclaim the memory associated with a parser instance. 
After this call, you should no longer attempt to use the parser instance. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Lexical"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Error-Reporting">Error Reporting</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parser-Delete-Function">Parser Delete Function</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.6 The Lexical Analyzer Function <code>yylex</code></h3>

<p><a name="index-yylex-266"></a><a name="index-lexical-analyzer-267"></a>
The <dfn>lexical analyzer</dfn> function, <code>yylex</code>, recognizes tokens from
the input stream and returns them to the parser.  Bison does not create
this function automatically; you must write it so that <code>yyparse</code> can
call it.  The function is sometimes referred to as a lexical scanner.

   <p>In simple programs, <code>yylex</code> is often defined at the end of the Bison
grammar file.  If <code>yylex</code> is defined in a separate source file, you
need to arrange for the token-type macro definitions to be available there. 
To do this, use the <span class="samp">-d</span> option when you run Bison, so that it will
write these macro definitions into a separate header file
<var>name</var><span class="file">.tab.h</span> which you can include in the other source files
that need it.  See <a href="#Invocation">Invoking Bison</a>.

<ul class="menu">
<li><a accesskey="1" href="#Calling-Convention">Calling Convention</a>:   How <code>yyparse</code> calls <code>yylex</code>. 
<li><a accesskey="2" href="#Token-Values">Token Values</a>:         How <code>yylex</code> must return the semantic value
                          of the token it has read. 
<li><a accesskey="3" href="#Token-Locations">Token Locations</a>:      How <code>yylex</code> must return the text location
                          (line number, etc.) of the token, if the
                          actions want that. 
<li><a accesskey="4" href="#Pure-Calling">Pure Calling</a>:         How the calling convention differs in a pure parser
                          (see <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>). 
</ul>

<div class="node">
<p><hr>
<a name="Calling-Convention"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Token-Values">Token Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Lexical">Lexical</a>
<br>
</div>

<h4 class="subsection">4.6.1 Calling Convention for <code>yylex</code></h4>

<p>The value that <code>yylex</code> returns must be the positive numeric code
for the type of token it has just found; a zero or negative value
signifies end-of-input.

   <p>When a token is referred to in the grammar rules by a name, that name
in the parser file becomes a C macro whose definition is the proper
numeric code for that token type.  So <code>yylex</code> can use the name
to indicate that type.  See <a href="#Symbols">Symbols</a>.

   <p>When a token is referred to in the grammar rules by a character literal,
the numeric code for that character is also the code for the token type. 
So <code>yylex</code> can simply return that character code, possibly converted
to <code>unsigned char</code> to avoid sign-extension.  The null character
must not be used this way, because its code is zero and that
signifies end-of-input.

   <p>Here is an example showing these things:

<pre class="example">     int
     yylex (void)
     {
       ...
       if (c == EOF)    /* Detect end-of-input.  */
         return 0;
       ...
       if (c == '+' || c == '-')
         return c;      /* Assume token type for `+' is '+'.  */
       ...
       return INT;      /* Return the type of the token.  */
       ...
     }
</pre>
   <p class="noindent">This interface has been designed so that the output from the <code>lex</code>
utility can be used without change as the definition of <code>yylex</code>.

   <p>If the grammar uses literal string tokens, there are two ways that
<code>yylex</code> can determine the token type codes for them:

     <ul>
<li>If the grammar defines symbolic token names as aliases for the
literal string tokens, <code>yylex</code> can use these symbolic names like
all others.  In this case, the use of the literal string tokens in
the grammar file has no effect on <code>yylex</code>.

     <li><code>yylex</code> can find the multicharacter token in the <code>yytname</code>
table.  The index of the token in the table is the token type's code. 
The name of a multicharacter token is recorded in <code>yytname</code> with a
double-quote, the token's characters, and another double-quote.  The
token's characters are escaped as necessary to be suitable as input
to Bison.

     <p>Here's code for looking up a multicharacter token in <code>yytname</code>,
assuming that the characters of the token are stored in
<code>token_buffer</code>, and assuming that the token does not contain any
characters like <span class="samp">"</span> that require escaping.

     <pre class="smallexample">          for (i = 0; i &lt; YYNTOKENS; i++)
            {
              if (yytname[i] != 0
                  &amp;&amp; yytname[i][0] == '"'
                  &amp;&amp; ! strncmp (yytname[i] + 1, token_buffer,
                                strlen (token_buffer))
                  &amp;&amp; yytname[i][strlen (token_buffer) + 1] == '"'
                  &amp;&amp; yytname[i][strlen (token_buffer) + 2] == 0)
                break;
            }
     </pre>
     <p>The <code>yytname</code> table is generated only if you use the
<code>%token-table</code> declaration.  See <a href="#Decl-Summary">Decl Summary</a>. 
</ul>

<div class="node">
<p><hr>
<a name="Token-Values"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Token-Locations">Token Locations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Calling-Convention">Calling Convention</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Lexical">Lexical</a>
<br>
</div>

<h4 class="subsection">4.6.2 Semantic Values of Tokens</h4>

<p><a name="index-yylval-268"></a>In an ordinary (nonreentrant) parser, the semantic value of the token must
be stored into the global variable <code>yylval</code>.  When you are using
just one data type for semantic values, <code>yylval</code> has that type. 
Thus, if the type is <code>int</code> (the default), you might write this in
<code>yylex</code>:

<pre class="example">       ...
       yylval = value;  /* Put value onto Bison stack.  */
       return INT;      /* Return the type of the token.  */
       ...
</pre>
   <p>When you are using multiple data types, <code>yylval</code>'s type is a union
made from the <code>%union</code> declaration (see <a href="#Union-Decl">The Collection of Value Types</a>).  So when you store a token's value, you
must use the proper member of the union.  If the <code>%union</code>
declaration looks like this:

<pre class="example">     %union {
       int intval;
       double val;
       symrec *tptr;
     }
</pre>
   <p class="noindent">then the code in <code>yylex</code> might look like this:

<pre class="example">       ...
       yylval.intval = value; /* Put value onto Bison stack.  */
       return INT;            /* Return the type of the token.  */
       ...
</pre>
   <div class="node">
<p><hr>
<a name="Token-Locations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Pure-Calling">Pure Calling</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Token-Values">Token Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Lexical">Lexical</a>
<br>
</div>

<h4 class="subsection">4.6.3 Textual Locations of Tokens</h4>

<p><a name="index-yylloc-269"></a>If you are using the <span class="samp">@</span><var>n</var>-feature (see <a href="#Locations">Tracking Locations</a>) in actions to keep track of the textual locations
of tokens and groupings, then you must provide this information in
<code>yylex</code>.  The function <code>yyparse</code> expects to find the textual
location of a token just parsed in the global variable <code>yylloc</code>. 
So <code>yylex</code> must store the proper data in that variable.

   <p>By default, the value of <code>yylloc</code> is a structure and you need only
initialize the members that are going to be used by the actions.  The
four members are called <code>first_line</code>, <code>first_column</code>,
<code>last_line</code> and <code>last_column</code>.  Note that the use of this
feature makes the parser noticeably slower.

   <p><a name="index-YYLTYPE-270"></a>The data type of <code>yylloc</code> has the name <code>YYLTYPE</code>.

<div class="node">
<p><hr>
<a name="Pure-Calling"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Token-Locations">Token Locations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Lexical">Lexical</a>
<br>
</div>

<h4 class="subsection">4.6.4 Calling Conventions for Pure Parsers</h4>

<p>When you use the Bison declaration <code>%define api.pure</code> to request a
pure, reentrant parser, the global communication variables <code>yylval</code>
and <code>yylloc</code> cannot be used.  (See <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>.)  In such parsers the two global variables are replaced by
pointers passed as arguments to <code>yylex</code>.  You must declare them as
shown here, and pass the information back by storing it through those
pointers.

<pre class="example">     int
     yylex (YYSTYPE *lvalp, YYLTYPE *llocp)
     {
       ...
       *lvalp = value;  /* Put value onto Bison stack.  */
       return INT;      /* Return the type of the token.  */
       ...
     }
</pre>
   <p>If the grammar file does not use the <span class="samp">@</span> constructs to refer to
textual locations, then the type <code>YYLTYPE</code> will not be defined.  In
this case, omit the second argument; <code>yylex</code> will be called with
only one argument.

   <p>If you wish to pass the additional parameter data to <code>yylex</code>, use
<code>%lex-param</code> just like <code>%parse-param</code> (see <a href="#Parser-Function">Parser Function</a>).

<div class="defun">
&mdash; Directive: <b>lex-param</b><var> {argument-declaration}<a name="index-lex_002dparam-271"></a></var><br>
<blockquote><p><a name="index-_0025lex_002dparam-272"></a>Declare that the braced-code <var>argument-declaration</var> is an
additional <code>yylex</code> argument declaration. 
</p></blockquote></div>

   <p>For instance:

<pre class="example">     %parse-param {int *nastiness}
     %lex-param   {int *nastiness}
     %parse-param {int *randomness}
</pre>
   <p class="noindent">results in the following signature:

<pre class="example">     int yylex   (int *nastiness);
     int yyparse (int *nastiness, int *randomness);
</pre>
   <p>If <code>%define api.pure</code> is added:

<pre class="example">     int yylex   (YYSTYPE *lvalp, int *nastiness);
     int yyparse (int *nastiness, int *randomness);
</pre>
   <p class="noindent">and finally, if both <code>%define api.pure</code> and <code>%locations</code> are used:

<pre class="example">     int yylex   (YYSTYPE *lvalp, YYLTYPE *llocp, int *nastiness);
     int yyparse (int *nastiness, int *randomness);
</pre>
   <div class="node">
<p><hr>
<a name="Error-Reporting"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Action-Features">Action Features</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Lexical">Lexical</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.7 The Error Reporting Function <code>yyerror</code></h3>

<p><a name="index-error-reporting-function-273"></a><a name="index-yyerror-274"></a><a name="index-parse-error-275"></a><a name="index-syntax-error-276"></a>
The Bison parser detects a <dfn>syntax error</dfn> or <dfn>parse error</dfn>
whenever it reads a token which cannot satisfy any syntax rule.  An
action in the grammar can also explicitly proclaim an error, using the
macro <code>YYERROR</code> (see <a href="#Action-Features">Special Features for Use in Actions</a>).

   <p>The Bison parser expects to report the error by calling an error
reporting function named <code>yyerror</code>, which you must supply.  It is
called by <code>yyparse</code> whenever a syntax error is found, and it
receives one argument.  For a syntax error, the string is normally
<code>"syntax&nbsp;error"</code><!-- /@w -->.

   <p><a name="index-_0025error_002dverbose-277"></a>If you invoke the directive <code>%error-verbose</code> in the Bison
declarations section (see <a href="#Bison-Declarations">The Bison Declarations Section</a>), then Bison provides a more verbose and specific error message
string instead of just plain <code>"syntax&nbsp;error"</code><!-- /@w -->.

   <p>The parser can detect one other kind of error: memory exhaustion.  This
can happen when the input contains constructions that are very deeply
nested.  It isn't likely you will encounter this, since the Bison
parser normally extends its stack automatically up to a very large limit.  But
if memory is exhausted, <code>yyparse</code> calls <code>yyerror</code> in the usual
fashion, except that the argument string is <code>"memory&nbsp;exhausted"</code><!-- /@w -->.

   <p>In some cases diagnostics like <code>"syntax&nbsp;error"</code><!-- /@w --> are
translated automatically from English to some other language before
they are passed to <code>yyerror</code>.  See <a href="#Internationalization">Internationalization</a>.

   <p>The following definition suffices in simple programs:

<pre class="example">     void
     yyerror (char const *s)
     {
       fprintf (stderr, "%s\n", s);
     }
</pre>
   <p>After <code>yyerror</code> returns to <code>yyparse</code>, the latter will attempt
error recovery if you have written suitable error recovery grammar rules
(see <a href="#Error-Recovery">Error Recovery</a>).  If recovery is impossible, <code>yyparse</code> will
immediately return 1.

   <p>Obviously, in location tracking pure parsers, <code>yyerror</code> should have
an access to the current location. 
This is indeed the case for the <acronym>GLR</acronym>
parsers, but not for the Yacc parser, for historical reasons.  I.e., if
<span class="samp">%locations %define api.pure</span> is passed then the prototypes for
<code>yyerror</code> are:

<pre class="example">     void yyerror (char const *msg);                 /* Yacc parsers.  */
     void yyerror (YYLTYPE *locp, char const *msg);  /* GLR parsers.   */
</pre>
   <p>If <span class="samp">%parse-param {int *nastiness}</span> is used, then:

<pre class="example">     void yyerror (int *nastiness, char const *msg);  /* Yacc parsers.  */
     void yyerror (int *nastiness, char const *msg);  /* GLR parsers.   */
</pre>
   <p>Finally, <acronym>GLR</acronym> and Yacc parsers share the same <code>yyerror</code> calling
convention for absolutely pure parsers, i.e., when the calling
convention of <code>yylex</code> <em>and</em> the calling convention of
<code>%define api.pure</code> are pure. 
I.e.:

<pre class="example">     /* Location tracking.  */
     %locations
     /* Pure yylex.  */
     %define api.pure
     %lex-param   {int *nastiness}
     /* Pure yyparse.  */
     %parse-param {int *nastiness}
     %parse-param {int *randomness}
</pre>
   <p class="noindent">results in the following signatures for all the parser kinds:

<pre class="example">     int yylex (YYSTYPE *lvalp, YYLTYPE *llocp, int *nastiness);
     int yyparse (int *nastiness, int *randomness);
     void yyerror (YYLTYPE *locp,
                   int *nastiness, int *randomness,
                   char const *msg);
</pre>
   <p class="noindent">The prototypes are only indications of how the code produced by Bison
uses <code>yyerror</code>.  Bison-generated code always ignores the returned
value, so <code>yyerror</code> can return any type, including <code>void</code>. 
Also, <code>yyerror</code> can be a variadic function; that is why the
message is always passed last.

   <p>Traditionally <code>yyerror</code> returns an <code>int</code> that is always
ignored, but this is purely for historical reasons, and <code>void</code> is
preferable since it more accurately describes the return type for
<code>yyerror</code>.

   <p><a name="index-yynerrs-278"></a>The variable <code>yynerrs</code> contains the number of syntax errors
reported so far.  Normally this variable is global; but if you
request a pure parser (see <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>)
then it is a local variable which only the actions can access.

<div class="node">
<p><hr>
<a name="Action-Features"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Internationalization">Internationalization</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Error-Reporting">Error Reporting</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.8 Special Features for Use in Actions</h3>

<p><a name="index-summary_002c-action-features-279"></a><a name="index-action-features-summary-280"></a>
Here is a table of Bison constructs, variables and macros that
are useful in actions.

<div class="defun">
&mdash; Variable: <b>$$</b><var><a name="index-_0024_0024-281"></a></var><br>
<blockquote><p>Acts like a variable that contains the semantic value for the
grouping made by the current rule.  See <a href="#Actions">Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$</b><var>n<a name="index-_0024-282"></a></var><br>
<blockquote><p>Acts like a variable that contains the semantic value for the
<var>n</var>th component of the current rule.  See <a href="#Actions">Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$&lt;</b><var>typealt&gt;$<a name="index-_0024_003c-283"></a></var><br>
<blockquote><p>Like <code>$$</code> but specifies alternative <var>typealt</var> in the union
specified by the <code>%union</code> declaration.  See <a href="#Action-Types">Data Types of Values in Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$&lt;</b><var>typealt&gt;n<a name="index-_0024_003c-284"></a></var><br>
<blockquote><p>Like <code>$</code><var>n</var> but specifies alternative <var>typealt</var> in the
union specified by the <code>%union</code> declaration. 
See <a href="#Action-Types">Data Types of Values in Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYABORT;</b><var><a name="index-YYABORT_003b-285"></a></var><br>
<blockquote><p>Return immediately from <code>yyparse</code>, indicating failure. 
See <a href="#Parser-Function">The Parser Function <code>yyparse</code></a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYACCEPT;</b><var><a name="index-YYACCEPT_003b-286"></a></var><br>
<blockquote><p>Return immediately from <code>yyparse</code>, indicating success. 
See <a href="#Parser-Function">The Parser Function <code>yyparse</code></a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYBACKUP</b> (<var>token, value</var>)<var>;<a name="index-YYBACKUP-287"></a></var><br>
<blockquote><p><a name="index-YYBACKUP-288"></a>Unshift a token.  This macro is allowed only for rules that reduce
a single value, and only when there is no lookahead token. 
It is also disallowed in <acronym>GLR</acronym> parsers. 
It installs a lookahead token with token type <var>token</var> and
semantic value <var>value</var>; then it discards the value that was
going to be reduced by this rule.

        <p>If the macro is used when it is not valid, such as when there is
a lookahead token already, then it reports a syntax error with
a message <span class="samp">cannot back up</span> and performs ordinary error
recovery.

        <p>In either case, the rest of the action is not executed. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYEMPTY</b><var><a name="index-YYEMPTY-289"></a></var><br>
<blockquote><p><a name="index-YYEMPTY-290"></a>Value stored in <code>yychar</code> when there is no lookahead token. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYEOF</b><var><a name="index-YYEOF-291"></a></var><br>
<blockquote><p><a name="index-YYEOF-292"></a>Value stored in <code>yychar</code> when the lookahead is the end of the input
stream. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYERROR;</b><var><a name="index-YYERROR_003b-293"></a></var><br>
<blockquote><p><a name="index-YYERROR-294"></a>Cause an immediate syntax error.  This statement initiates error
recovery just as if the parser itself had detected an error; however, it
does not call <code>yyerror</code>, and does not print any message.  If you
want to print an error message, call <code>yyerror</code> explicitly before
the <span class="samp">YYERROR;</span> statement.  See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYRECOVERING</b><var><a name="index-YYRECOVERING-295"></a></var><br>
<blockquote><p><a name="index-YYRECOVERING-296"></a>The expression <code>YYRECOVERING ()</code> yields 1 when the parser
is recovering from a syntax error, and 0 otherwise. 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yychar</b><var><a name="index-yychar-297"></a></var><br>
<blockquote><p>Variable containing either the lookahead token, or <code>YYEOF</code> when the
lookahead is the end of the input stream, or <code>YYEMPTY</code> when no lookahead
has been performed so the next token is not yet known. 
Do not modify <code>yychar</code> in a deferred semantic action (see <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a>). 
See <a href="#Lookahead">Lookahead Tokens</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>yyclearin;</b><var><a name="index-yyclearin_003b-298"></a></var><br>
<blockquote><p>Discard the current lookahead token.  This is useful primarily in
error rules. 
Do not invoke <code>yyclearin</code> in a deferred semantic action (see <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a>). 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>yyerrok;</b><var><a name="index-yyerrok_003b-299"></a></var><br>
<blockquote><p>Resume generating error messages immediately for subsequent syntax
errors.  This is useful primarily in error rules. 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yylloc</b><var><a name="index-yylloc-300"></a></var><br>
<blockquote><p>Variable containing the lookahead token location when <code>yychar</code> is not set
to <code>YYEMPTY</code> or <code>YYEOF</code>. 
Do not modify <code>yylloc</code> in a deferred semantic action (see <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a>). 
See <a href="#Actions-and-Locations">Actions and Locations</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yylval</b><var><a name="index-yylval-301"></a></var><br>
<blockquote><p>Variable containing the lookahead token semantic value when <code>yychar</code> is
not set to <code>YYEMPTY</code> or <code>YYEOF</code>. 
Do not modify <code>yylval</code> in a deferred semantic action (see <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a>). 
See <a href="#Actions">Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Value: <b>@$</b><var><a name="index-_0040_0040_0024-302"></a></var><br>
<blockquote><p><a name="index-_0040_0040_0024-303"></a>Acts like a structure variable containing information on the textual location
of the grouping made by the current rule.  See <a href="#Locations">Tracking Locations</a>.

     <!-- Check if those paragraphs are still useful or not. -->
<!-- @example -->
<!-- struct @{ -->
<!-- int first_line, last_line; -->
<!-- int first_column, last_column; -->
<!-- @}; -->
<!-- @end example -->
<!-- Thus, to get the starting line number of the third component, you would -->
<!-- use @samp{@@3.first_line}. -->
<!-- In order for the members of this structure to contain valid information, -->
<!-- you must make @code{yylex} supply this information about each token. -->
<!-- If you need only certain members, then @code{yylex} need only fill in -->
<!-- those members. -->
<!-- The use of this feature makes the parser noticeably slower. -->
</blockquote></div>

<div class="defun">
&mdash; Value: <b>@</b><var>n</var><var><a name="index-_0040_0040_0040var_007bn_007d-304"></a></var><br>
<blockquote><p><a name="index-_0040_0040_0040var_007bn_007d-305"></a>Acts like a structure variable containing information on the textual location
of the <var>n</var>th component of the current rule.  See <a href="#Locations">Tracking Locations</a>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Internationalization"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Action-Features">Action Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Interface">Interface</a>
<br>
</div>

<h3 class="section">4.9 Parser Internationalization</h3>

<p><a name="index-internationalization-306"></a><a name="index-i18n-307"></a><a name="index-NLS-308"></a><a name="index-gettext-309"></a><a name="index-bison_002dpo-310"></a>
A Bison-generated parser can print diagnostics, including error and
tracing messages.  By default, they appear in English.  However, Bison
also supports outputting diagnostics in the user's native language.  To
make this work, the user should set the usual environment variables. 
See <a href="gettext.html#Users">The User's View (GNU <code>gettext</code> utilities)</a>. 
For example, the shell command <span class="samp">export LC_ALL=fr_CA.UTF-8</span> might
set the user's locale to French Canadian using the <acronym>UTF</acronym>-8
encoding.  The exact set of available locales depends on the user's
installation.

   <p>The maintainer of a package that uses a Bison-generated parser enables
the internationalization of the parser's output through the following
steps.  Here we assume a package that uses <acronym>GNU</acronym> Autoconf and
<acronym>GNU</acronym> Automake.

     <ol type=1 start=1>
<li><a name="index-bison_002di18n_002em4-311"></a>Into the directory containing the <acronym>GNU</acronym> Autoconf macros used
by the package&mdash;often called <span class="file">m4</span>&mdash;copy the
<span class="file">bison-i18n.m4</span> file installed by Bison under
<span class="samp">share/aclocal/bison-i18n.m4</span> in Bison's installation directory. 
For example:

     <pre class="example">          cp /usr/local/share/aclocal/bison-i18n.m4 m4/bison-i18n.m4
     </pre>
     <li><a name="index-BISON_005fI18N-312"></a><a name="index-BISON_005fLOCALEDIR-313"></a><a name="index-YYENABLE_005fNLS-314"></a>In the top-level <span class="file">configure.ac</span>, after the <code>AM_GNU_GETTEXT</code>
invocation, add an invocation of <code>BISON_I18N</code>.  This macro is
defined in the file <span class="file">bison-i18n.m4</span> that you copied earlier.  It
causes <span class="samp">configure</span> to find the value of the
<code>BISON_LOCALEDIR</code> variable, and it defines the source-language
symbol <code>YYENABLE_NLS</code> to enable translations in the
Bison-generated parser.

     <li>In the <code>main</code> function of your program, designate the directory
containing Bison's runtime message catalog, through a call to
<span class="samp">bindtextdomain</span> with domain name <span class="samp">bison-runtime</span>. 
For example:

     <pre class="example">          bindtextdomain ("bison-runtime", BISON_LOCALEDIR);
     </pre>
     <p>Typically this appears after any other call <code>bindtextdomain
(PACKAGE, LOCALEDIR)</code> that your package already has.  Here we rely on
<span class="samp">BISON_LOCALEDIR</span> to be defined as a string through the
<span class="file">Makefile</span>.

     <li>In the <span class="file">Makefile.am</span> that controls the compilation of the <code>main</code>
function, make <span class="samp">BISON_LOCALEDIR</span> available as a C preprocessor macro,
either in <span class="samp">DEFS</span> or in <span class="samp">AM_CPPFLAGS</span>.  For example:

     <pre class="example">          DEFS = @DEFS@ -DBISON_LOCALEDIR='"$(BISON_LOCALEDIR)"'
     </pre>
     <p>or:

     <pre class="example">          AM_CPPFLAGS = -DBISON_LOCALEDIR='"$(BISON_LOCALEDIR)"'
     </pre>
     <li>Finally, invoke the command <span class="command">autoreconf</span> to generate the build
infrastructure.
        </ol>

<div class="node">
<p><hr>
<a name="Algorithm"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Error-Recovery">Error Recovery</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Interface">Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">5 The Bison Parser Algorithm</h2>

<p><a name="index-Bison-parser-algorithm-315"></a><a name="index-algorithm-of-parser-316"></a><a name="index-shifting-317"></a><a name="index-reduction-318"></a><a name="index-parser-stack-319"></a><a name="index-stack_002c-parser-320"></a>
As Bison reads tokens, it pushes them onto a stack along with their
semantic values.  The stack is called the <dfn>parser stack</dfn>.  Pushing a
token is traditionally called <dfn>shifting</dfn>.

   <p>For example, suppose the infix calculator has read <span class="samp">1 + 5 *</span>, with a
<span class="samp">3</span> to come.  The stack will have four elements, one for each token
that was shifted.

   <p>But the stack does not always have an element for each token read.  When
the last <var>n</var> tokens and groupings shifted match the components of a
grammar rule, they can be combined according to that rule.  This is called
<dfn>reduction</dfn>.  Those tokens and groupings are replaced on the stack by a
single grouping whose symbol is the result (left hand side) of that rule. 
Running the rule's action is part of the process of reduction, because this
is what computes the semantic value of the resulting grouping.

   <p>For example, if the infix calculator's parser stack contains this:

<pre class="example">     1 + 5 * 3
</pre>
   <p class="noindent">and the next input token is a newline character, then the last three
elements can be reduced to 15 via the rule:

<pre class="example">     expr: expr '*' expr;
</pre>
   <p class="noindent">Then the stack contains just these three elements:

<pre class="example">     1 + 15
</pre>
   <p class="noindent">At this point, another reduction can be made, resulting in the single value
16.  Then the newline token can be shifted.

   <p>The parser tries, by shifts and reductions, to reduce the entire input down
to a single grouping whose symbol is the grammar's start-symbol
(see <a href="#Language-and-Grammar">Languages and Context-Free Grammars</a>).

   <p>This kind of parser is known in the literature as a bottom-up parser.

<ul class="menu">
<li><a accesskey="1" href="#Lookahead">Lookahead</a>:          Parser looks one token ahead when deciding what to do. 
<li><a accesskey="2" href="#Shift_002fReduce">Shift/Reduce</a>:       Conflicts: when either shifting or reduction is valid. 
<li><a accesskey="3" href="#Precedence">Precedence</a>:         Operator precedence works by resolving conflicts. 
<li><a accesskey="4" href="#Contextual-Precedence">Contextual Precedence</a>:   When an operator's precedence depends on context. 
<li><a accesskey="5" href="#Parser-States">Parser States</a>:      The parser is a finite-state-machine with stack. 
<li><a accesskey="6" href="#Reduce_002fReduce">Reduce/Reduce</a>:      When two rules are applicable in the same situation. 
<li><a accesskey="7" href="#Mystery-Conflicts">Mystery Conflicts</a>:  Reduce/reduce conflicts that look unjustified. 
<li><a accesskey="8" href="#Generalized-LR-Parsing">Generalized LR Parsing</a>:   Parsing arbitrary context-free grammars. 
<li><a accesskey="9" href="#Memory-Management">Memory Management</a>:  What happens when memory is exhausted.  How to avoid it. 
</ul>

<div class="node">
<p><hr>
<a name="Lookahead"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Shift_002fReduce">Shift/Reduce</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.1 Lookahead Tokens</h3>

<p><a name="index-lookahead-token-321"></a>
The Bison parser does <em>not</em> always reduce immediately as soon as the
last <var>n</var> tokens and groupings match a rule.  This is because such a
simple strategy is inadequate to handle most languages.  Instead, when a
reduction is possible, the parser sometimes &ldquo;looks ahead&rdquo; at the next
token in order to decide what to do.

   <p>When a token is read, it is not immediately shifted; first it becomes the
<dfn>lookahead token</dfn>, which is not on the stack.  Now the parser can
perform one or more reductions of tokens and groupings on the stack, while
the lookahead token remains off to the side.  When no more reductions
should take place, the lookahead token is shifted onto the stack.  This
does not mean that all possible reductions have been done; depending on the
token type of the lookahead token, some rules may choose to delay their
application.

   <p>Here is a simple case where lookahead is needed.  These three rules define
expressions which contain binary addition operators and postfix unary
factorial operators (<span class="samp">!</span>), and allow parentheses for grouping.

<pre class="example">     expr:     term '+' expr
             | term
             ;
     
     term:     '(' expr ')'
             | term '!'
             | NUMBER
             ;
</pre>
   <p>Suppose that the tokens <span class="samp">1&nbsp;+&nbsp;2</span><!-- /@w --> have been read and shifted; what
should be done?  If the following token is <span class="samp">)</span>, then the first three
tokens must be reduced to form an <code>expr</code>.  This is the only valid
course, because shifting the <span class="samp">)</span> would produce a sequence of symbols
<code>term&nbsp;')'</code><!-- /@w -->, and no rule allows this.

   <p>If the following token is <span class="samp">!</span>, then it must be shifted immediately so
that <span class="samp">2&nbsp;!</span><!-- /@w --> can be reduced to make a <code>term</code>.  If instead the
parser were to reduce before shifting, <span class="samp">1&nbsp;+&nbsp;2</span><!-- /@w --> would become an
<code>expr</code>.  It would then be impossible to shift the <span class="samp">!</span> because
doing so would produce on the stack the sequence of symbols <code>expr
'!'</code>.  No rule allows that sequence.

   <p><a name="index-yychar-322"></a><a name="index-yylval-323"></a><a name="index-yylloc-324"></a>The lookahead token is stored in the variable <code>yychar</code>. 
Its semantic value and location, if any, are stored in the variables
<code>yylval</code> and <code>yylloc</code>. 
See <a href="#Action-Features">Special Features for Use in Actions</a>.

<div class="node">
<p><hr>
<a name="Shift_002fReduce"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Precedence">Precedence</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Lookahead">Lookahead</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.2 Shift/Reduce Conflicts</h3>

<p><a name="index-conflicts-325"></a><a name="index-shift_002freduce-conflicts-326"></a><a name="index-dangling-_0040code_007belse_007d-327"></a><a name="index-_0040code_007belse_007d_002c-dangling-328"></a>
Suppose we are parsing a language which has if-then and if-then-else
statements, with a pair of rules like this:

<pre class="example">     if_stmt:
               IF expr THEN stmt
             | IF expr THEN stmt ELSE stmt
             ;
</pre>
   <p class="noindent">Here we assume that <code>IF</code>, <code>THEN</code> and <code>ELSE</code> are
terminal symbols for specific keyword tokens.

   <p>When the <code>ELSE</code> token is read and becomes the lookahead token, the
contents of the stack (assuming the input is valid) are just right for
reduction by the first rule.  But it is also legitimate to shift the
<code>ELSE</code>, because that would lead to eventual reduction by the second
rule.

   <p>This situation, where either a shift or a reduction would be valid, is
called a <dfn>shift/reduce conflict</dfn>.  Bison is designed to resolve
these conflicts by choosing to shift, unless otherwise directed by
operator precedence declarations.  To see the reason for this, let's
contrast it with the other alternative.

   <p>Since the parser prefers to shift the <code>ELSE</code>, the result is to attach
the else-clause to the innermost if-statement, making these two inputs
equivalent:

<pre class="example">     if x then if y then win (); else lose;
     
     if x then do; if y then win (); else lose; end;
</pre>
   <p>But if the parser chose to reduce when possible rather than shift, the
result would be to attach the else-clause to the outermost if-statement,
making these two inputs equivalent:

<pre class="example">     if x then if y then win (); else lose;
     
     if x then do; if y then win (); end; else lose;
</pre>
   <p>The conflict exists because the grammar as written is ambiguous: either
parsing of the simple nested if-statement is legitimate.  The established
convention is that these ambiguities are resolved by attaching the
else-clause to the innermost if-statement; this is what Bison accomplishes
by choosing to shift rather than reduce.  (It would ideally be cleaner to
write an unambiguous grammar, but that is very hard to do in this case.) 
This particular ambiguity was first encountered in the specifications of
Algol 60 and is called the &ldquo;dangling <code>else</code>&rdquo; ambiguity.

   <p>To avoid warnings from Bison about predictable, legitimate shift/reduce
conflicts, use the <code>%expect </code><var>n</var> declaration.  There will be no
warning as long as the number of shift/reduce conflicts is exactly <var>n</var>. 
See <a href="#Expect-Decl">Suppressing Conflict Warnings</a>.

   <p>The definition of <code>if_stmt</code> above is solely to blame for the
conflict, but the conflict does not actually appear without additional
rules.  Here is a complete Bison input file that actually manifests the
conflict:

<pre class="example">     %token IF THEN ELSE variable
     %%
     stmt:     expr
             | if_stmt
             ;
     
     if_stmt:
               IF expr THEN stmt
             | IF expr THEN stmt ELSE stmt
             ;
     
     expr:     variable
             ;
</pre>
   <div class="node">
<p><hr>
<a name="Precedence"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Contextual-Precedence">Contextual Precedence</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Shift_002fReduce">Shift/Reduce</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.3 Operator Precedence</h3>

<p><a name="index-operator-precedence-329"></a><a name="index-precedence-of-operators-330"></a>
Another situation where shift/reduce conflicts appear is in arithmetic
expressions.  Here shifting is not always the preferred resolution; the
Bison declarations for operator precedence allow you to specify when to
shift and when to reduce.

<ul class="menu">
<li><a accesskey="1" href="#Why-Precedence">Why Precedence</a>:     An example showing why precedence is needed. 
<li><a accesskey="2" href="#Using-Precedence">Using Precedence</a>:   How to specify precedence in Bison grammars. 
<li><a accesskey="3" href="#Precedence-Examples">Precedence Examples</a>:   How these features are used in the previous example. 
<li><a accesskey="4" href="#How-Precedence">How Precedence</a>:     How they work. 
</ul>

<div class="node">
<p><hr>
<a name="Why-Precedence"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-Precedence">Using Precedence</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence">Precedence</a>
<br>
</div>

<h4 class="subsection">5.3.1 When Precedence is Needed</h4>

<p>Consider the following ambiguous grammar fragment (ambiguous because the
input <span class="samp">1&nbsp;-&nbsp;2&nbsp;*&nbsp;3</span><!-- /@w --> can be parsed in two different ways):

<pre class="example">     expr:     expr '-' expr
             | expr '*' expr
             | expr '&lt;' expr
             | '(' expr ')'
             ...
             ;
</pre>
   <p class="noindent">Suppose the parser has seen the tokens <span class="samp">1</span>, <span class="samp">-</span> and <span class="samp">2</span>;
should it reduce them via the rule for the subtraction operator?  It
depends on the next token.  Of course, if the next token is <span class="samp">)</span>, we
must reduce; shifting is invalid because no single rule can reduce the
token sequence <span class="samp">-&nbsp;2&nbsp;)</span><!-- /@w --> or anything starting with that.  But if
the next token is <span class="samp">*</span> or <span class="samp">&lt;</span>, we have a choice: either
shifting or reduction would allow the parse to complete, but with
different results.

   <p>To decide which one Bison should do, we must consider the results.  If
the next operator token <var>op</var> is shifted, then it must be reduced
first in order to permit another opportunity to reduce the difference. 
The result is (in effect) <span class="samp">1&nbsp;-&nbsp;(2&nbsp;</span><var>op</var><span class="samp">&nbsp;3)</span><!-- /@w -->.  On the other
hand, if the subtraction is reduced before shifting <var>op</var>, the result
is <span class="samp">(1&nbsp;-&nbsp;2)&nbsp;</span><var>op</var><span class="samp">&nbsp;3</span><!-- /@w -->.  Clearly, then, the choice of shift or
reduce should depend on the relative precedence of the operators
<span class="samp">-</span> and <var>op</var>: <span class="samp">*</span> should be shifted first, but not
<span class="samp">&lt;</span>.

   <p><a name="index-associativity-331"></a>What about input such as <span class="samp">1&nbsp;-&nbsp;2&nbsp;-&nbsp;5</span><!-- /@w -->; should this be
<span class="samp">(1&nbsp;-&nbsp;2)&nbsp;-&nbsp;5</span><!-- /@w --> or should it be <span class="samp">1&nbsp;-&nbsp;(2&nbsp;-&nbsp;5)</span><!-- /@w -->?  For most
operators we prefer the former, which is called <dfn>left association</dfn>. 
The latter alternative, <dfn>right association</dfn>, is desirable for
assignment operators.  The choice of left or right association is a
matter of whether the parser chooses to shift or reduce when the stack
contains <span class="samp">1&nbsp;-&nbsp;2</span><!-- /@w --> and the lookahead token is <span class="samp">-</span>: shifting
makes right-associativity.

<div class="node">
<p><hr>
<a name="Using-Precedence"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Precedence-Examples">Precedence Examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Why-Precedence">Why Precedence</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence">Precedence</a>
<br>
</div>

<h4 class="subsection">5.3.2 Specifying Operator Precedence</h4>

<p><a name="index-_0025left-332"></a><a name="index-_0025right-333"></a><a name="index-_0025nonassoc-334"></a>
Bison allows you to specify these choices with the operator precedence
declarations <code>%left</code> and <code>%right</code>.  Each such declaration
contains a list of tokens, which are operators whose precedence and
associativity is being declared.  The <code>%left</code> declaration makes all
those operators left-associative and the <code>%right</code> declaration makes
them right-associative.  A third alternative is <code>%nonassoc</code>, which
declares that it is a syntax error to find the same operator twice &ldquo;in a
row&rdquo;.

   <p>The relative precedence of different operators is controlled by the
order in which they are declared.  The first <code>%left</code> or
<code>%right</code> declaration in the file declares the operators whose
precedence is lowest, the next such declaration declares the operators
whose precedence is a little higher, and so on.

<div class="node">
<p><hr>
<a name="Precedence-Examples"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#How-Precedence">How Precedence</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-Precedence">Using Precedence</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence">Precedence</a>
<br>
</div>

<h4 class="subsection">5.3.3 Precedence Examples</h4>

<p>In our example, we would want the following declarations:

<pre class="example">     %left '&lt;'
     %left '-'
     %left '*'
</pre>
   <p>In a more complete example, which supports other operators as well, we
would declare them in groups of equal precedence.  For example, <code>'+'</code> is
declared with <code>'-'</code>:

<pre class="example">     %left '&lt;' '&gt;' '=' NE LE GE
     %left '+' '-'
     %left '*' '/'
</pre>
   <p class="noindent">(Here <code>NE</code> and so on stand for the operators for &ldquo;not equal&rdquo;
and so on.  We assume that these tokens are more than one character long
and therefore are represented by names, not character literals.)

<div class="node">
<p><hr>
<a name="How-Precedence"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Precedence-Examples">Precedence Examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Precedence">Precedence</a>
<br>
</div>

<h4 class="subsection">5.3.4 How Precedence Works</h4>

<p>The first effect of the precedence declarations is to assign precedence
levels to the terminal symbols declared.  The second effect is to assign
precedence levels to certain rules: each rule gets its precedence from
the last terminal symbol mentioned in the components.  (You can also
specify explicitly the precedence of a rule.  See <a href="#Contextual-Precedence">Context-Dependent Precedence</a>.)

   <p>Finally, the resolution of conflicts works by comparing the precedence
of the rule being considered with that of the lookahead token.  If the
token's precedence is higher, the choice is to shift.  If the rule's
precedence is higher, the choice is to reduce.  If they have equal
precedence, the choice is made based on the associativity of that
precedence level.  The verbose output file made by <span class="samp">-v</span>
(see <a href="#Invocation">Invoking Bison</a>) says how each conflict was
resolved.

   <p>Not all rules and not all tokens have precedence.  If either the rule or
the lookahead token has no precedence, then the default is to shift.

<div class="node">
<p><hr>
<a name="Contextual-Precedence"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Parser-States">Parser States</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Precedence">Precedence</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.4 Context-Dependent Precedence</h3>

<p><a name="index-context_002ddependent-precedence-335"></a><a name="index-unary-operator-precedence-336"></a><a name="index-precedence_002c-context_002ddependent-337"></a><a name="index-precedence_002c-unary-operator-338"></a><a name="index-_0025prec-339"></a>
Often the precedence of an operator depends on the context.  This sounds
outlandish at first, but it is really very common.  For example, a minus
sign typically has a very high precedence as a unary operator, and a
somewhat lower precedence (lower than multiplication) as a binary operator.

   <p>The Bison precedence declarations, <code>%left</code>, <code>%right</code> and
<code>%nonassoc</code>, can only be used once for a given token; so a token has
only one precedence declared in this way.  For context-dependent
precedence, you need to use an additional mechanism: the <code>%prec</code>
modifier for rules.

   <p>The <code>%prec</code> modifier declares the precedence of a particular rule by
specifying a terminal symbol whose precedence should be used for that rule. 
It's not necessary for that symbol to appear otherwise in the rule.  The
modifier's syntax is:

<pre class="example">     %prec <var>terminal-symbol</var>
</pre>
   <p class="noindent">and it is written after the components of the rule.  Its effect is to
assign the rule the precedence of <var>terminal-symbol</var>, overriding
the precedence that would be deduced for it in the ordinary way.  The
altered rule precedence then affects how conflicts involving that rule
are resolved (see <a href="#Precedence">Operator Precedence</a>).

   <p>Here is how <code>%prec</code> solves the problem of unary minus.  First, declare
a precedence for a fictitious terminal symbol named <code>UMINUS</code>.  There
are no tokens of this type, but the symbol serves to stand for its
precedence:

<pre class="example">     ...
     %left '+' '-'
     %left '*'
     %left UMINUS
</pre>
   <p>Now the precedence of <code>UMINUS</code> can be used in specific rules:

<pre class="example">     exp:    ...
             | exp '-' exp
             ...
             | '-' exp %prec UMINUS
</pre>
   <div class="node">
<p><hr>
<a name="Parser-States"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Reduce_002fReduce">Reduce/Reduce</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Contextual-Precedence">Contextual Precedence</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.5 Parser States</h3>

<p><a name="index-finite_002dstate-machine-340"></a><a name="index-parser-state-341"></a><a name="index-state-_0028of-parser_0029-342"></a>
The function <code>yyparse</code> is implemented using a finite-state machine. 
The values pushed on the parser stack are not simply token type codes; they
represent the entire sequence of terminal and nonterminal symbols at or
near the top of the stack.  The current state collects all the information
about previous input which is relevant to deciding what to do next.

   <p>Each time a lookahead token is read, the current parser state together
with the type of lookahead token are looked up in a table.  This table
entry can say, &ldquo;Shift the lookahead token.&rdquo;  In this case, it also
specifies the new parser state, which is pushed onto the top of the
parser stack.  Or it can say, &ldquo;Reduce using rule number <var>n</var>.&rdquo;
This means that a certain number of tokens or groupings are taken off
the top of the stack, and replaced by one grouping.  In other words,
that number of states are popped from the stack, and one new state is
pushed.

   <p>There is one other alternative: the table can say that the lookahead token
is erroneous in the current state.  This causes error processing to begin
(see <a href="#Error-Recovery">Error Recovery</a>).

<div class="node">
<p><hr>
<a name="Reduce_002fReduce"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Mystery-Conflicts">Mystery Conflicts</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Parser-States">Parser States</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.6 Reduce/Reduce Conflicts</h3>

<p><a name="index-reduce_002freduce-conflict-343"></a><a name="index-conflicts_002c-reduce_002freduce-344"></a>
A reduce/reduce conflict occurs if there are two or more rules that apply
to the same sequence of input.  This usually indicates a serious error
in the grammar.

   <p>For example, here is an erroneous attempt to define a sequence
of zero or more <code>word</code> groupings.

<pre class="example">     sequence: /* empty */
                     { printf ("empty sequence\n"); }
             | maybeword
             | sequence word
                     { printf ("added word %s\n", $2); }
             ;
     
     maybeword: /* empty */
                     { printf ("empty maybeword\n"); }
             | word
                     { printf ("single word %s\n", $1); }
             ;
</pre>
   <p class="noindent">The error is an ambiguity: there is more than one way to parse a single
<code>word</code> into a <code>sequence</code>.  It could be reduced to a
<code>maybeword</code> and then into a <code>sequence</code> via the second rule. 
Alternatively, nothing-at-all could be reduced into a <code>sequence</code>
via the first rule, and this could be combined with the <code>word</code>
using the third rule for <code>sequence</code>.

   <p>There is also more than one way to reduce nothing-at-all into a
<code>sequence</code>.  This can be done directly via the first rule,
or indirectly via <code>maybeword</code> and then the second rule.

   <p>You might think that this is a distinction without a difference, because it
does not change whether any particular input is valid or not.  But it does
affect which actions are run.  One parsing order runs the second rule's
action; the other runs the first rule's action and the third rule's action. 
In this example, the output of the program changes.

   <p>Bison resolves a reduce/reduce conflict by choosing to use the rule that
appears first in the grammar, but it is very risky to rely on this.  Every
reduce/reduce conflict must be studied and usually eliminated.  Here is the
proper way to define <code>sequence</code>:

<pre class="example">     sequence: /* empty */
                     { printf ("empty sequence\n"); }
             | sequence word
                     { printf ("added word %s\n", $2); }
             ;
</pre>
   <p>Here is another common error that yields a reduce/reduce conflict:

<pre class="example">     sequence: /* empty */
             | sequence words
             | sequence redirects
             ;
     
     words:    /* empty */
             | words word
             ;
     
     redirects:/* empty */
             | redirects redirect
             ;
</pre>
   <p class="noindent">The intention here is to define a sequence which can contain either
<code>word</code> or <code>redirect</code> groupings.  The individual definitions of
<code>sequence</code>, <code>words</code> and <code>redirects</code> are error-free, but the
three together make a subtle ambiguity: even an empty input can be parsed
in infinitely many ways!

   <p>Consider: nothing-at-all could be a <code>words</code>.  Or it could be two
<code>words</code> in a row, or three, or any number.  It could equally well be a
<code>redirects</code>, or two, or any number.  Or it could be a <code>words</code>
followed by three <code>redirects</code> and another <code>words</code>.  And so on.

   <p>Here are two ways to correct these rules.  First, to make it a single level
of sequence:

<pre class="example">     sequence: /* empty */
             | sequence word
             | sequence redirect
             ;
</pre>
   <p>Second, to prevent either a <code>words</code> or a <code>redirects</code>
from being empty:

<pre class="example">     sequence: /* empty */
             | sequence words
             | sequence redirects
             ;
     
     words:    word
             | words word
             ;
     
     redirects:redirect
             | redirects redirect
             ;
</pre>
   <div class="node">
<p><hr>
<a name="Mystery-Conflicts"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Generalized-LR-Parsing">Generalized LR Parsing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Reduce_002fReduce">Reduce/Reduce</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.7 Mysterious Reduce/Reduce Conflicts</h3>

<p>Sometimes reduce/reduce conflicts can occur that don't look warranted. 
Here is an example:

<pre class="example">     %token ID
     
     %%
     def:    param_spec return_spec ','
             ;
     param_spec:
                  type
             |    name_list ':' type
             ;
     return_spec:
                  type
             |    name ':' type
             ;
     type:        ID
             ;
     name:        ID
             ;
     name_list:
                  name
             |    name ',' name_list
             ;
</pre>
   <p>It would seem that this grammar can be parsed with only a single token
of lookahead: when a <code>param_spec</code> is being read, an <code>ID</code> is
a <code>name</code> if a comma or colon follows, or a <code>type</code> if another
<code>ID</code> follows.  In other words, this grammar is <acronym>LR</acronym>(1).

   <p><a name="index-_0040acronym_007bLR_007d_00281_0029-345"></a><a name="index-_0040acronym_007bLALR_007d_00281_0029-346"></a>However, Bison, like most parser generators, cannot actually handle all
<acronym>LR</acronym>(1) grammars.  In this grammar, two contexts, that after
an <code>ID</code>
at the beginning of a <code>param_spec</code> and likewise at the beginning of
a <code>return_spec</code>, are similar enough that Bison assumes they are the
same.  They appear similar because the same set of rules would be
active&mdash;the rule for reducing to a <code>name</code> and that for reducing to
a <code>type</code>.  Bison is unable to determine at that stage of processing
that the rules would require different lookahead tokens in the two
contexts, so it makes a single parser state for them both.  Combining
the two contexts causes a conflict later.  In parser terminology, this
occurrence means that the grammar is not <acronym>LALR</acronym>(1).

   <p>In general, it is better to fix deficiencies than to document them.  But
this particular deficiency is intrinsically hard to fix; parser
generators that can handle <acronym>LR</acronym>(1) grammars are hard to write
and tend to
produce parsers that are very large.  In practice, Bison is more useful
as it is now.

   <p>When the problem arises, you can often fix it by identifying the two
parser states that are being confused, and adding something to make them
look distinct.  In the above example, adding one rule to
<code>return_spec</code> as follows makes the problem go away:

<pre class="example">     %token BOGUS
     ...
     %%
     ...
     return_spec:
                  type
             |    name ':' type
             /* This rule is never used.  */
             |    ID BOGUS
             ;
</pre>
   <p>This corrects the problem because it introduces the possibility of an
additional active rule in the context after the <code>ID</code> at the beginning of
<code>return_spec</code>.  This rule is not active in the corresponding context
in a <code>param_spec</code>, so the two contexts receive distinct parser states. 
As long as the token <code>BOGUS</code> is never generated by <code>yylex</code>,
the added rule cannot alter the way actual input is parsed.

   <p>In this particular example, there is another way to solve the problem:
rewrite the rule for <code>return_spec</code> to use <code>ID</code> directly
instead of via <code>name</code>.  This also causes the two confusing
contexts to have different sets of active rules, because the one for
<code>return_spec</code> activates the altered rule for <code>return_spec</code>
rather than the one for <code>name</code>.

<pre class="example">     param_spec:
                  type
             |    name_list ':' type
             ;
     return_spec:
                  type
             |    ID ':' type
             ;
</pre>
   <p>For a more detailed exposition of <acronym>LALR</acronym>(1) parsers and parser
generators, please see:
Frank DeRemer and Thomas Pennello, Efficient Computation of
<acronym>LALR</acronym>(1) Look-Ahead Sets, <cite><acronym>ACM</acronym> Transactions on
Programming Languages and Systems</cite>, Vol. 4, No. 4 (October 1982),
pp. 615&ndash;649 <a href="http://doi.acm.org/10.1145/69622.357187">http://doi.acm.org/10.1145/69622.357187</a>.

<div class="node">
<p><hr>
<a name="Generalized-LR-Parsing"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Memory-Management">Memory Management</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Mystery-Conflicts">Mystery Conflicts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.8 Generalized <acronym>LR</acronym> (<acronym>GLR</acronym>) Parsing</h3>

<p><a name="index-_0040acronym_007bGLR_007d-parsing-347"></a><a name="index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing-348"></a><a name="index-ambiguous-grammars-349"></a><a name="index-nondeterministic-parsing-350"></a>
Bison produces <em>deterministic</em> parsers that choose uniquely
when to reduce and which reduction to apply
based on a summary of the preceding input and on one extra token of lookahead. 
As a result, normal Bison handles a proper subset of the family of
context-free languages. 
Ambiguous grammars, since they have strings with more than one possible
sequence of reductions cannot have deterministic parsers in this sense. 
The same is true of languages that require more than one symbol of
lookahead, since the parser lacks the information necessary to make a
decision at the point it must be made in a shift-reduce parser. 
Finally, as previously mentioned (see <a href="#Mystery-Conflicts">Mystery Conflicts</a>),
there are languages where Bison's particular choice of how to
summarize the input seen so far loses necessary information.

   <p>When you use the <span class="samp">%glr-parser</span> declaration in your grammar file,
Bison generates a parser that uses a different algorithm, called
Generalized <acronym>LR</acronym> (or <acronym>GLR</acronym>).  A Bison <acronym>GLR</acronym>
parser uses the same basic
algorithm for parsing as an ordinary Bison parser, but behaves
differently in cases where there is a shift-reduce conflict that has not
been resolved by precedence rules (see <a href="#Precedence">Precedence</a>) or a
reduce-reduce conflict.  When a <acronym>GLR</acronym> parser encounters such a
situation, it
effectively <em>splits</em> into a several parsers, one for each possible
shift or reduction.  These parsers then proceed as usual, consuming
tokens in lock-step.  Some of the stacks may encounter other conflicts
and split further, with the result that instead of a sequence of states,
a Bison <acronym>GLR</acronym> parsing stack is what is in effect a tree of states.

   <p>In effect, each stack represents a guess as to what the proper parse
is.  Additional input may indicate that a guess was wrong, in which case
the appropriate stack silently disappears.  Otherwise, the semantics
actions generated in each stack are saved, rather than being executed
immediately.  When a stack disappears, its saved semantic actions never
get executed.  When a reduction causes two stacks to become equivalent,
their sets of semantic actions are both saved with the state that
results from the reduction.  We say that two stacks are equivalent
when they both represent the same sequence of states,
and each pair of corresponding states represents a
grammar symbol that produces the same segment of the input token
stream.

   <p>Whenever the parser makes a transition from having multiple
states to having one, it reverts to the normal <acronym>LALR</acronym>(1) parsing
algorithm, after resolving and executing the saved-up actions. 
At this transition, some of the states on the stack will have semantic
values that are sets (actually multisets) of possible actions.  The
parser tries to pick one of the actions by first finding one whose rule
has the highest dynamic precedence, as set by the <span class="samp">%dprec</span>
declaration.  Otherwise, if the alternative actions are not ordered by
precedence, but there the same merging function is declared for both
rules by the <span class="samp">%merge</span> declaration,
Bison resolves and evaluates both and then calls the merge function on
the result.  Otherwise, it reports an ambiguity.

   <p>It is possible to use a data structure for the <acronym>GLR</acronym> parsing tree that
permits the processing of any <acronym>LALR</acronym>(1) grammar in linear time (in the
size of the input), any unambiguous (not necessarily
<acronym>LALR</acronym>(1)) grammar in
quadratic worst-case time, and any general (possibly ambiguous)
context-free grammar in cubic worst-case time.  However, Bison currently
uses a simpler data structure that requires time proportional to the
length of the input times the maximum number of stacks required for any
prefix of the input.  Thus, really ambiguous or nondeterministic
grammars can require exponential time and space to process.  Such badly
behaving examples, however, are not generally of practical interest. 
Usually, nondeterminism in a grammar is local&mdash;the parser is &ldquo;in
doubt&rdquo; only for a few tokens at a time.  Therefore, the current data
structure should generally be adequate.  On <acronym>LALR</acronym>(1) portions of a
grammar, in particular, it is only slightly slower than with the default
Bison parser.

   <p>For a more detailed exposition of <acronym>GLR</acronym> parsers, please see: Elizabeth
Scott, Adrian Johnstone and Shamsa Sadaf Hussain, Tomita-Style
Generalised <acronym>LR</acronym> Parsers, Royal Holloway, University of
London, Department of Computer Science, TR-00-12,
<a href="http://www.cs.rhul.ac.uk/research/languages/publications/tomita_style_1.ps">http://www.cs.rhul.ac.uk/research/languages/publications/tomita_style_1.ps</a>,
(2000-12-24).

<div class="node">
<p><hr>
<a name="Memory-Management"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Generalized-LR-Parsing">Generalized LR Parsing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Algorithm">Algorithm</a>
<br>
</div>

<h3 class="section">5.9 Memory Management, and How to Avoid Memory Exhaustion</h3>

<p><a name="index-memory-exhaustion-351"></a><a name="index-memory-management-352"></a><a name="index-stack-overflow-353"></a><a name="index-parser-stack-overflow-354"></a><a name="index-overflow-of-parser-stack-355"></a>
The Bison parser stack can run out of memory if too many tokens are shifted and
not reduced.  When this happens, the parser function <code>yyparse</code>
calls <code>yyerror</code> and then returns 2.

   <p>Because Bison parsers have growing stacks, hitting the upper limit
usually results from using a right recursion instead of a left
recursion, See <a href="#Recursion">Recursive Rules</a>.

   <p><a name="index-YYMAXDEPTH-356"></a>By defining the macro <code>YYMAXDEPTH</code>, you can control how deep the
parser stack can become before memory is exhausted.  Define the
macro with a value that is an integer.  This value is the maximum number
of tokens that can be shifted (and not reduced) before overflow.

   <p>The stack space allowed is not necessarily allocated.  If you specify a
large value for <code>YYMAXDEPTH</code>, the parser normally allocates a small
stack at first, and then makes it bigger by stages as needed.  This
increasing allocation happens automatically and silently.  Therefore,
you do not need to make <code>YYMAXDEPTH</code> painfully small merely to save
space for ordinary inputs that do not need much stack.

   <p>However, do not allow <code>YYMAXDEPTH</code> to be a value so large that
arithmetic overflow could occur when calculating the size of the stack
space.  Also, do not allow <code>YYMAXDEPTH</code> to be less than
<code>YYINITDEPTH</code>.

   <p><a name="index-default-stack-limit-357"></a>The default value of <code>YYMAXDEPTH</code>, if you do not define it, is
10000.

   <p><a name="index-YYINITDEPTH-358"></a>You can control how much stack is allocated initially by defining the
macro <code>YYINITDEPTH</code> to a positive integer.  For the C
<acronym>LALR</acronym>(1) parser, this value must be a compile-time constant
unless you are assuming C99 or some other target language or compiler
that allows variable-length arrays.  The default is 200.

   <p>Do not allow <code>YYINITDEPTH</code> to be greater than <code>YYMAXDEPTH</code>.

<!-- FIXME: C++ output. -->
<p>Because of semantical differences between C and C++, the
<acronym>LALR</acronym>(1) parsers in C produced by Bison cannot grow when compiled
by C++ compilers.  In this precise case (compiling a C parser as C++) you are
suggested to grow <code>YYINITDEPTH</code>.  The Bison maintainers hope to fix
this deficiency in a future release.

<div class="node">
<p><hr>
<a name="Error-Recovery"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Context-Dependency">Context Dependency</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Algorithm">Algorithm</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">6 Error Recovery</h2>

<p><a name="index-error-recovery-359"></a><a name="index-recovery-from-errors-360"></a>
It is not usually acceptable to have a program terminate on a syntax
error.  For example, a compiler should recover sufficiently to parse the
rest of the input file and check it for errors; a calculator should accept
another expression.

   <p>In a simple interactive command parser where each input is one line, it may
be sufficient to allow <code>yyparse</code> to return 1 on error and have the
caller ignore the rest of the input line when that happens (and then call
<code>yyparse</code> again).  But this is inadequate for a compiler, because it
forgets all the syntactic context leading up to the error.  A syntax error
deep within a function in the compiler input should not cause the compiler
to treat the following line like the beginning of a source file.

   <p><a name="index-error-361"></a>You can define how to recover from a syntax error by writing rules to
recognize the special token <code>error</code>.  This is a terminal symbol that
is always defined (you need not declare it) and reserved for error
handling.  The Bison parser generates an <code>error</code> token whenever a
syntax error happens; if you have provided a rule to recognize this token
in the current context, the parse can continue.

   <p>For example:

<pre class="example">     stmnts:  /* empty string */
             | stmnts '\n'
             | stmnts exp '\n'
             | stmnts error '\n'
</pre>
   <p>The fourth rule in this example says that an error followed by a newline
makes a valid addition to any <code>stmnts</code>.

   <p>What happens if a syntax error occurs in the middle of an <code>exp</code>?  The
error recovery rule, interpreted strictly, applies to the precise sequence
of a <code>stmnts</code>, an <code>error</code> and a newline.  If an error occurs in
the middle of an <code>exp</code>, there will probably be some additional tokens
and subexpressions on the stack after the last <code>stmnts</code>, and there
will be tokens to read before the next newline.  So the rule is not
applicable in the ordinary way.

   <p>But Bison can force the situation to fit the rule, by discarding part of
the semantic context and part of the input.  First it discards states
and objects from the stack until it gets back to a state in which the
<code>error</code> token is acceptable.  (This means that the subexpressions
already parsed are discarded, back to the last complete <code>stmnts</code>.) 
At this point the <code>error</code> token can be shifted.  Then, if the old
lookahead token is not acceptable to be shifted next, the parser reads
tokens and discards them until it finds a token which is acceptable.  In
this example, Bison reads and discards input until the next newline so
that the fourth rule can apply.  Note that discarded symbols are
possible sources of memory leaks, see <a href="#Destructor-Decl">Freeing Discarded Symbols</a>, for a means to reclaim this memory.

   <p>The choice of error rules in the grammar is a choice of strategies for
error recovery.  A simple and useful strategy is simply to skip the rest of
the current input line or current statement if an error is detected:

<pre class="example">     stmnt: error ';'  /* On error, skip until ';' is read.  */
</pre>
   <p>It is also useful to recover to the matching close-delimiter of an
opening-delimiter that has already been parsed.  Otherwise the
close-delimiter will probably appear to be unmatched, and generate another,
spurious error message:

<pre class="example">     primary:  '(' expr ')'
             | '(' error ')'
             ...
             ;
</pre>
   <p>Error recovery strategies are necessarily guesses.  When they guess wrong,
one syntax error often leads to another.  In the above example, the error
recovery rule guesses that an error is due to bad input within one
<code>stmnt</code>.  Suppose that instead a spurious semicolon is inserted in the
middle of a valid <code>stmnt</code>.  After the error recovery rule recovers
from the first error, another syntax error will be found straightaway,
since the text following the spurious semicolon is also an invalid
<code>stmnt</code>.

   <p>To prevent an outpouring of error messages, the parser will output no error
message for another syntax error that happens shortly after the first; only
after three consecutive input tokens have been successfully shifted will
error messages resume.

   <p>Note that rules which accept the <code>error</code> token may have actions, just
as any other rules can.

   <p><a name="index-yyerrok-362"></a>You can make error messages resume immediately by using the macro
<code>yyerrok</code> in an action.  If you do this in the error rule's action, no
error messages will be suppressed.  This macro requires no arguments;
<span class="samp">yyerrok;</span> is a valid C statement.

   <p><a name="index-yyclearin-363"></a>The previous lookahead token is reanalyzed immediately after an error.  If
this is unacceptable, then the macro <code>yyclearin</code> may be used to clear
this token.  Write the statement <span class="samp">yyclearin;</span> in the error rule's
action. 
See <a href="#Action-Features">Special Features for Use in Actions</a>.

   <p>For example, suppose that on a syntax error, an error handling routine is
called that advances the input stream to some point where parsing should
once again commence.  The next symbol returned by the lexical scanner is
probably correct.  The previous lookahead token ought to be discarded
with <span class="samp">yyclearin;</span>.

   <p><a name="index-YYRECOVERING-364"></a>The expression <code>YYRECOVERING ()</code> yields 1 when the parser
is recovering from a syntax error, and 0 otherwise. 
Syntax error diagnostics are suppressed while recovering from a syntax
error.

<div class="node">
<p><hr>
<a name="Context-Dependency"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Debugging">Debugging</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Error-Recovery">Error Recovery</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">7 Handling Context Dependencies</h2>

<p>The Bison paradigm is to parse tokens first, then group them into larger
syntactic units.  In many languages, the meaning of a token is affected by
its context.  Although this violates the Bison paradigm, certain techniques
(known as <dfn>kludges</dfn>) may enable you to write Bison parsers for such
languages.

<ul class="menu">
<li><a accesskey="1" href="#Semantic-Tokens">Semantic Tokens</a>:    Token parsing can depend on the semantic context. 
<li><a accesskey="2" href="#Lexical-Tie_002dins">Lexical Tie-ins</a>:    Token parsing can depend on the syntactic context. 
<li><a accesskey="3" href="#Tie_002din-Recovery">Tie-in Recovery</a>:    Lexical tie-ins have implications for how
                        error recovery rules must be written. 
</ul>

   <p>(Actually, &ldquo;kludge&rdquo; means any technique that gets its job done but is
neither clean nor robust.)

<div class="node">
<p><hr>
<a name="Semantic-Tokens"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Lexical-Tie_002dins">Lexical Tie-ins</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Context-Dependency">Context Dependency</a>
<br>
</div>

<h3 class="section">7.1 Semantic Info in Token Types</h3>

<p>The C language has a context dependency: the way an identifier is used
depends on what its current meaning is.  For example, consider this:

<pre class="example">     foo (x);
</pre>
   <p>This looks like a function call statement, but if <code>foo</code> is a typedef
name, then this is actually a declaration of <code>x</code>.  How can a Bison
parser for C decide how to parse this input?

   <p>The method used in <acronym>GNU</acronym> C is to have two different token types,
<code>IDENTIFIER</code> and <code>TYPENAME</code>.  When <code>yylex</code> finds an
identifier, it looks up the current declaration of the identifier in order
to decide which token type to return: <code>TYPENAME</code> if the identifier is
declared as a typedef, <code>IDENTIFIER</code> otherwise.

   <p>The grammar rules can then express the context dependency by the choice of
token type to recognize.  <code>IDENTIFIER</code> is accepted as an expression,
but <code>TYPENAME</code> is not.  <code>TYPENAME</code> can start a declaration, but
<code>IDENTIFIER</code> cannot.  In contexts where the meaning of the identifier
is <em>not</em> significant, such as in declarations that can shadow a
typedef name, either <code>TYPENAME</code> or <code>IDENTIFIER</code> is
accepted&mdash;there is one rule for each of the two token types.

   <p>This technique is simple to use if the decision of which kinds of
identifiers to allow is made at a place close to where the identifier is
parsed.  But in C this is not always so: C allows a declaration to
redeclare a typedef name provided an explicit type has been specified
earlier:

<pre class="example">     typedef int foo, bar;
     int baz (void)
     {
       static bar (bar);      /* <span class="roman">redeclare </span><code>bar</code><span class="roman"> as static variable</span> */
       extern foo foo (foo);  /* <span class="roman">redeclare </span><code>foo</code><span class="roman"> as function</span> */
       return foo (bar);
     }
</pre>
   <p>Unfortunately, the name being declared is separated from the declaration
construct itself by a complicated syntactic structure&mdash;the &ldquo;declarator&rdquo;.

   <p>As a result, part of the Bison parser for C needs to be duplicated, with
all the nonterminal names changed: once for parsing a declaration in
which a typedef name can be redefined, and once for parsing a
declaration in which that can't be done.  Here is a part of the
duplication, with actions omitted for brevity:

<pre class="example">     initdcl:
               declarator maybeasm '='
               init
             | declarator maybeasm
             ;
     
     notype_initdcl:
               notype_declarator maybeasm '='
               init
             | notype_declarator maybeasm
             ;
</pre>
   <p class="noindent">Here <code>initdcl</code> can redeclare a typedef name, but <code>notype_initdcl</code>
cannot.  The distinction between <code>declarator</code> and
<code>notype_declarator</code> is the same sort of thing.

   <p>There is some similarity between this technique and a lexical tie-in
(described next), in that information which alters the lexical analysis is
changed during parsing by other parts of the program.  The difference is
here the information is global, and is used for other purposes in the
program.  A true lexical tie-in has a special-purpose flag controlled by
the syntactic context.

<div class="node">
<p><hr>
<a name="Lexical-Tie_002dins"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Tie_002din-Recovery">Tie-in Recovery</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Semantic-Tokens">Semantic Tokens</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Context-Dependency">Context Dependency</a>
<br>
</div>

<h3 class="section">7.2 Lexical Tie-ins</h3>

<p><a name="index-lexical-tie_002din-365"></a>
One way to handle context-dependency is the <dfn>lexical tie-in</dfn>: a flag
which is set by Bison actions, whose purpose is to alter the way tokens are
parsed.

   <p>For example, suppose we have a language vaguely like C, but with a special
construct <span class="samp">hex (</span><var>hex-expr</var><span class="samp">)</span>.  After the keyword <code>hex</code> comes
an expression in parentheses in which all integers are hexadecimal.  In
particular, the token <span class="samp">a1b</span> must be treated as an integer rather than
as an identifier if it appears in that context.  Here is how you can do it:

<pre class="example">     %{
       int hexflag;
       int yylex (void);
       void yyerror (char const *);
     %}
     %%
     ...
     expr:   IDENTIFIER
             | constant
             | HEX '('
                     { hexflag = 1; }
               expr ')'
                     { hexflag = 0;
                        $$ = $4; }
             | expr '+' expr
                     { $$ = make_sum ($1, $3); }
             ...
             ;
     
     constant:
               INTEGER
             | STRING
             ;
</pre>
   <p class="noindent">Here we assume that <code>yylex</code> looks at the value of <code>hexflag</code>; when
it is nonzero, all integers are parsed in hexadecimal, and tokens starting
with letters are parsed as integers if possible.

   <p>The declaration of <code>hexflag</code> shown in the prologue of the parser file
is needed to make it accessible to the actions (see <a href="#Prologue">The Prologue</a>). 
You must also write the code in <code>yylex</code> to obey the flag.

<div class="node">
<p><hr>
<a name="Tie_002din-Recovery"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Lexical-Tie_002dins">Lexical Tie-ins</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Context-Dependency">Context Dependency</a>
<br>
</div>

<h3 class="section">7.3 Lexical Tie-ins and Error Recovery</h3>

<p>Lexical tie-ins make strict demands on any error recovery rules you have. 
See <a href="#Error-Recovery">Error Recovery</a>.

   <p>The reason for this is that the purpose of an error recovery rule is to
abort the parsing of one construct and resume in some larger construct. 
For example, in C-like languages, a typical error recovery rule is to skip
tokens until the next semicolon, and then start a new statement, like this:

<pre class="example">     stmt:   expr ';'
             | IF '(' expr ')' stmt { ... }
             ...
             error ';'
                     { hexflag = 0; }
             ;
</pre>
   <p>If there is a syntax error in the middle of a <span class="samp">hex (</span><var>expr</var><span class="samp">)</span>
construct, this error rule will apply, and then the action for the
completed <span class="samp">hex (</span><var>expr</var><span class="samp">)</span> will never run.  So <code>hexflag</code> would
remain set for the entire rest of the input, or until the next <code>hex</code>
keyword, causing identifiers to be misinterpreted as integers.

   <p>To avoid this problem the error recovery rule itself clears <code>hexflag</code>.

   <p>There may also be an error recovery rule that works within expressions. 
For example, there could be a rule which applies within parentheses
and skips to the close-parenthesis:

<pre class="example">     expr:   ...
             | '(' expr ')'
                     { $$ = $2; }
             | '(' error ')'
             ...
</pre>
   <p>If this rule acts within the <code>hex</code> construct, it is not going to abort
that construct (since it applies to an inner level of parentheses within
the construct).  Therefore, it should not clear the flag: the rest of
the <code>hex</code> construct should be parsed with the flag still in effect.

   <p>What if there is an error recovery rule which might abort out of the
<code>hex</code> construct or might not, depending on circumstances?  There is no
way you can write the action to determine whether a <code>hex</code> construct is
being aborted or not.  So if you are using a lexical tie-in, you had better
make sure your error recovery rules are not of this kind.  Each rule must
be such that you can be sure that it always will, or always won't, have to
clear the flag.

<!-- ================================================== Debugging Your Parser -->
<div class="node">
<p><hr>
<a name="Debugging"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Invocation">Invocation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Context-Dependency">Context Dependency</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">8 Debugging Your Parser</h2>

<p>Developing a parser can be a challenge, especially if you don't
understand the algorithm (see <a href="#Algorithm">The Bison Parser Algorithm</a>).  Even so, sometimes a detailed description of the automaton
can help (see <a href="#Understanding">Understanding Your Parser</a>), or
tracing the execution of the parser can give some insight on why it
behaves improperly (see <a href="#Tracing">Tracing Your Parser</a>).

<ul class="menu">
<li><a accesskey="1" href="#Understanding">Understanding</a>:      Understanding the structure of your parser. 
<li><a accesskey="2" href="#Tracing">Tracing</a>:            Tracing the execution of your parser. 
</ul>

<div class="node">
<p><hr>
<a name="Understanding"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Tracing">Tracing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Debugging">Debugging</a>
<br>
</div>

<h3 class="section">8.1 Understanding Your Parser</h3>

<p>As documented elsewhere (see <a href="#Algorithm">The Bison Parser Algorithm</a>)
Bison parsers are <dfn>shift/reduce automata</dfn>.  In some cases (much more
frequent than one would hope), looking at this automaton is required to
tune or simply fix a parser.  Bison provides two different
representation of it, either textually or graphically (as a DOT file).

   <p>The textual file is generated when the options <span class="option">--report</span> or
<span class="option">--verbose</span> are specified, see See <a href="#Invocation">Invoking Bison</a>.  Its name is made by removing <span class="samp">.tab.c</span> or <span class="samp">.c</span> from
the parser output file name, and adding <span class="samp">.output</span> instead. 
Therefore, if the input file is <span class="file">foo.y</span>, then the parser file is
called <span class="file">foo.tab.c</span> by default.  As a consequence, the verbose
output file is called <span class="file">foo.output</span>.

   <p>The following grammar file, <span class="file">calc.y</span>, will be used in the sequel:

<pre class="example">     %token NUM STR
     %left '+' '-'
     %left '*'
     %%
     exp: exp '+' exp
        | exp '-' exp
        | exp '*' exp
        | exp '/' exp
        | NUM
        ;
     useless: STR;
     %%
</pre>
   <p><span class="command">bison</span> reports:

<pre class="example">     calc.y: warning: 1 nonterminal and 1 rule useless in grammar
     calc.y:11.1-7: warning: nonterminal useless in grammar: useless
     calc.y:11.10-12: warning: rule useless in grammar: useless: STR
     calc.y: conflicts: 7 shift/reduce
</pre>
   <p>When given <span class="option">--report=state</span>, in addition to <span class="file">calc.tab.c</span>, it
creates a file <span class="file">calc.output</span> with contents detailed below.  The
order of the output and the exact presentation might vary, but the
interpretation is the same.

   <p>The first section includes details on conflicts that were solved thanks
to precedence and/or associativity:

<pre class="example">     Conflict in state 8 between rule 2 and token '+' resolved as reduce.
     Conflict in state 8 between rule 2 and token '-' resolved as reduce.
     Conflict in state 8 between rule 2 and token '*' resolved as shift.
<br><small class="dots">...</small><br>
</pre>
   <p class="noindent">The next section lists states that still have conflicts.

<pre class="example">     State 8 conflicts: 1 shift/reduce
     State 9 conflicts: 1 shift/reduce
     State 10 conflicts: 1 shift/reduce
     State 11 conflicts: 4 shift/reduce
</pre>
   <p class="noindent"><a name="index-token_002c-useless-366"></a><a name="index-useless-token-367"></a><a name="index-nonterminal_002c-useless-368"></a><a name="index-useless-nonterminal-369"></a><a name="index-rule_002c-useless-370"></a><a name="index-useless-rule-371"></a>The next section reports useless tokens, nonterminal and rules.  Useless
nonterminals and rules are removed in order to produce a smaller parser,
but useless tokens are preserved, since they might be used by the
scanner (note the difference between &ldquo;useless&rdquo; and &ldquo;unused&rdquo;
below):

<pre class="example">     Nonterminals useless in grammar:
        useless
     
     Terminals unused in grammar:
        STR
     
     Rules useless in grammar:
     #6     useless: STR;
</pre>
   <p class="noindent">The next section reproduces the exact grammar that Bison used:

<pre class="example">     Grammar
     
       Number, Line, Rule
         0   5 $accept -&gt; exp $end
         1   5 exp -&gt; exp '+' exp
         2   6 exp -&gt; exp '-' exp
         3   7 exp -&gt; exp '*' exp
         4   8 exp -&gt; exp '/' exp
         5   9 exp -&gt; NUM
</pre>
   <p class="noindent">and reports the uses of the symbols:

<pre class="example">     Terminals, with rules where they appear
     
     $end (0) 0
     '*' (42) 3
     '+' (43) 1
     '-' (45) 2
     '/' (47) 4
     error (256)
     NUM (258) 5
     
     Nonterminals, with rules where they appear
     
     $accept (8)
         on left: 0
     exp (9)
         on left: 1 2 3 4 5, on right: 0 1 2 3 4
</pre>
   <p class="noindent"><a name="index-item-372"></a><a name="index-pointed-rule-373"></a><a name="index-rule_002c-pointed-374"></a>Bison then proceeds onto the automaton itself, describing each state
with it set of <dfn>items</dfn>, also known as <dfn>pointed rules</dfn>.  Each
item is a production rule together with a point (marked by <span class="samp">.</span>)
that the input cursor.

<pre class="example">     state 0
     
         $accept  -&gt;  . exp $   (rule 0)
     
         NUM         shift, and go to state 1
     
         exp         go to state 2
</pre>
   <p>This reads as follows: &ldquo;state 0 corresponds to being at the very
beginning of the parsing, in the initial rule, right before the start
symbol (here, <code>exp</code>).  When the parser returns to this state right
after having reduced a rule that produced an <code>exp</code>, the control
flow jumps to state 2.  If there is no such transition on a nonterminal
symbol, and the lookahead is a <code>NUM</code>, then this token is shifted on
the parse stack, and the control flow jumps to state 1.  Any other
lookahead triggers a syntax error.&rdquo;

   <p><a name="index-core_002c-item-set-375"></a><a name="index-item-set-core-376"></a><a name="index-kernel_002c-item-set-377"></a><a name="index-item-set-core-378"></a>Even though the only active rule in state 0 seems to be rule 0, the
report lists <code>NUM</code> as a lookahead token because <code>NUM</code> can be
at the beginning of any rule deriving an <code>exp</code>.  By default Bison
reports the so-called <dfn>core</dfn> or <dfn>kernel</dfn> of the item set, but if
you want to see more detail you can invoke <span class="command">bison</span> with
<span class="option">--report=itemset</span> to list all the items, include those that can
be derived:

<pre class="example">     state 0
     
         $accept  -&gt;  . exp $   (rule 0)
         exp  -&gt;  . exp '+' exp   (rule 1)
         exp  -&gt;  . exp '-' exp   (rule 2)
         exp  -&gt;  . exp '*' exp   (rule 3)
         exp  -&gt;  . exp '/' exp   (rule 4)
         exp  -&gt;  . NUM   (rule 5)
     
         NUM         shift, and go to state 1
     
         exp         go to state 2
</pre>
   <p class="noindent">In the state 1...

<pre class="example">     state 1
     
         exp  -&gt;  NUM .   (rule 5)
     
         $default    reduce using rule 5 (exp)
</pre>
   <p class="noindent">the rule 5, <span class="samp">exp: NUM;</span>, is completed.  Whatever the lookahead token
(<span class="samp">$default</span>), the parser will reduce it.  If it was coming from
state 0, then, after this reduction it will return to state 0, and will
jump to state 2 (<span class="samp">exp: go to state 2</span>).

<pre class="example">     state 2
     
         $accept  -&gt;  exp . $   (rule 0)
         exp  -&gt;  exp . '+' exp   (rule 1)
         exp  -&gt;  exp . '-' exp   (rule 2)
         exp  -&gt;  exp . '*' exp   (rule 3)
         exp  -&gt;  exp . '/' exp   (rule 4)
     
         $           shift, and go to state 3
         '+'         shift, and go to state 4
         '-'         shift, and go to state 5
         '*'         shift, and go to state 6
         '/'         shift, and go to state 7
</pre>
   <p class="noindent">In state 2, the automaton can only shift a symbol.  For instance,
because of the item <span class="samp">exp -&gt; exp . '+' exp</span>, if the lookahead if
<span class="samp">+</span>, it will be shifted on the parse stack, and the automaton
control will jump to state 4, corresponding to the item <span class="samp">exp -&gt; exp
'+' . exp</span>.  Since there is no default action, any other token than
those listed above will trigger a syntax error.

   <p>The state 3 is named the <dfn>final state</dfn>, or the <dfn>accepting
state</dfn>:

<pre class="example">     state 3
     
         $accept  -&gt;  exp $ .   (rule 0)
     
         $default    accept
</pre>
   <p class="noindent">the initial rule is completed (the start symbol and the end
of input were read), the parsing exits successfully.

   <p>The interpretation of states 4 to 7 is straightforward, and is left to
the reader.

<pre class="example">     state 4
     
         exp  -&gt;  exp '+' . exp   (rule 1)
     
         NUM         shift, and go to state 1
     
         exp         go to state 8
     
     state 5
     
         exp  -&gt;  exp '-' . exp   (rule 2)
     
         NUM         shift, and go to state 1
     
         exp         go to state 9
     
     state 6
     
         exp  -&gt;  exp '*' . exp   (rule 3)
     
         NUM         shift, and go to state 1
     
         exp         go to state 10
     
     state 7
     
         exp  -&gt;  exp '/' . exp   (rule 4)
     
         NUM         shift, and go to state 1
     
         exp         go to state 11
</pre>
   <p>As was announced in beginning of the report, <span class="samp">State 8 conflicts:
1 shift/reduce</span>:

<pre class="example">     state 8
     
         exp  -&gt;  exp . '+' exp   (rule 1)
         exp  -&gt;  exp '+' exp .   (rule 1)
         exp  -&gt;  exp . '-' exp   (rule 2)
         exp  -&gt;  exp . '*' exp   (rule 3)
         exp  -&gt;  exp . '/' exp   (rule 4)
     
         '*'         shift, and go to state 6
         '/'         shift, and go to state 7
     
         '/'         [reduce using rule 1 (exp)]
         $default    reduce using rule 1 (exp)
</pre>
   <p>Indeed, there are two actions associated to the lookahead <span class="samp">/</span>:
either shifting (and going to state 7), or reducing rule 1.  The
conflict means that either the grammar is ambiguous, or the parser lacks
information to make the right decision.  Indeed the grammar is
ambiguous, as, since we did not specify the precedence of <span class="samp">/</span>, the
sentence <span class="samp">NUM + NUM / NUM</span> can be parsed as <span class="samp">NUM + (NUM /
NUM)</span>, which corresponds to shifting <span class="samp">/</span>, or as <span class="samp">(NUM + NUM) /
NUM</span>, which corresponds to reducing rule 1.

   <p>Because in <acronym>LALR</acronym>(1) parsing a single decision can be made, Bison
arbitrarily chose to disable the reduction, see <a href="#Shift_002fReduce">Shift/Reduce Conflicts</a>.  Discarded actions are reported in between
square brackets.

   <p>Note that all the previous states had a single possible action: either
shifting the next token and going to the corresponding state, or
reducing a single rule.  In the other cases, i.e., when shifting
<em>and</em> reducing is possible or when <em>several</em> reductions are
possible, the lookahead is required to select the action.  State 8 is
one such state: if the lookahead is <span class="samp">*</span> or <span class="samp">/</span> then the action
is shifting, otherwise the action is reducing rule 1.  In other words,
the first two items, corresponding to rule 1, are not eligible when the
lookahead token is <span class="samp">*</span>, since we specified that <span class="samp">*</span> has higher
precedence than <span class="samp">+</span>.  More generally, some items are eligible only
with some set of possible lookahead tokens.  When run with
<span class="option">--report=lookahead</span>, Bison specifies these lookahead tokens:

<pre class="example">     state 8
     
         exp  -&gt;  exp . '+' exp   (rule 1)
         exp  -&gt;  exp '+' exp .  [$, '+', '-', '/']   (rule 1)
         exp  -&gt;  exp . '-' exp   (rule 2)
         exp  -&gt;  exp . '*' exp   (rule 3)
         exp  -&gt;  exp . '/' exp   (rule 4)
     
         '*'         shift, and go to state 6
         '/'         shift, and go to state 7
     
         '/'         [reduce using rule 1 (exp)]
         $default    reduce using rule 1 (exp)
</pre>
   <p>The remaining states are similar:

<pre class="example">     state 9
     
         exp  -&gt;  exp . '+' exp   (rule 1)
         exp  -&gt;  exp . '-' exp   (rule 2)
         exp  -&gt;  exp '-' exp .   (rule 2)
         exp  -&gt;  exp . '*' exp   (rule 3)
         exp  -&gt;  exp . '/' exp   (rule 4)
     
         '*'         shift, and go to state 6
         '/'         shift, and go to state 7
     
         '/'         [reduce using rule 2 (exp)]
         $default    reduce using rule 2 (exp)
     
     state 10
     
         exp  -&gt;  exp . '+' exp   (rule 1)
         exp  -&gt;  exp . '-' exp   (rule 2)
         exp  -&gt;  exp . '*' exp   (rule 3)
         exp  -&gt;  exp '*' exp .   (rule 3)
         exp  -&gt;  exp . '/' exp   (rule 4)
     
         '/'         shift, and go to state 7
     
         '/'         [reduce using rule 3 (exp)]
         $default    reduce using rule 3 (exp)
     
     state 11
     
         exp  -&gt;  exp . '+' exp   (rule 1)
         exp  -&gt;  exp . '-' exp   (rule 2)
         exp  -&gt;  exp . '*' exp   (rule 3)
         exp  -&gt;  exp . '/' exp   (rule 4)
         exp  -&gt;  exp '/' exp .   (rule 4)
     
         '+'         shift, and go to state 4
         '-'         shift, and go to state 5
         '*'         shift, and go to state 6
         '/'         shift, and go to state 7
     
         '+'         [reduce using rule 4 (exp)]
         '-'         [reduce using rule 4 (exp)]
         '*'         [reduce using rule 4 (exp)]
         '/'         [reduce using rule 4 (exp)]
         $default    reduce using rule 4 (exp)
</pre>
   <p class="noindent">Observe that state 11 contains conflicts not only due to the lack of
precedence of <span class="samp">/</span> with respect to <span class="samp">+</span>, <span class="samp">-</span>, and
<span class="samp">*</span>, but also because the
associativity of <span class="samp">/</span> is not specified.

<div class="node">
<p><hr>
<a name="Tracing"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Understanding">Understanding</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Debugging">Debugging</a>
<br>
</div>

<h3 class="section">8.2 Tracing Your Parser</h3>

<p><a name="index-yydebug-379"></a><a name="index-debugging-380"></a><a name="index-tracing-the-parser-381"></a>
If a Bison grammar compiles properly but doesn't do what you want when it
runs, the <code>yydebug</code> parser-trace feature can help you figure out why.

   <p>There are several means to enable compilation of trace facilities:

     <dl>
<dt>the macro <code>YYDEBUG</code><dd><a name="index-YYDEBUG-382"></a>Define the macro <code>YYDEBUG</code> to a nonzero value when you compile the
parser.  This is compliant with <acronym>POSIX</acronym> Yacc.  You could use
<span class="samp">-DYYDEBUG=1</span> as a compiler option or you could put <span class="samp">#define
YYDEBUG 1</span> in the prologue of the grammar file (see <a href="#Prologue">The Prologue</a>).

     <br><dt>the option <span class="option">-t</span>, <span class="option">--debug</span><dd>Use the <span class="samp">-t</span> option when you run Bison (see <a href="#Invocation">Invoking Bison</a>).  This is <acronym>POSIX</acronym> compliant too.

     <br><dt>the directive <span class="samp">%debug</span><dd><a name="index-_0025debug-383"></a>Add the <code>%debug</code> directive (see <a href="#Decl-Summary">Bison Declaration Summary</a>).  This is a Bison extension, which will prove
useful when Bison will output parsers for languages that don't use a
preprocessor.  Unless <acronym>POSIX</acronym> and Yacc portability matter to
you, this is
the preferred solution. 
</dl>

   <p>We suggest that you always enable the debug option so that debugging is
always possible.

   <p>The trace facility outputs messages with macro calls of the form
<code>YYFPRINTF (stderr, </code><var>format</var><code>, </code><var>args</var><code>)</code> where
<var>format</var> and <var>args</var> are the usual <code>printf</code> format and variadic
arguments.  If you define <code>YYDEBUG</code> to a nonzero value but do not
define <code>YYFPRINTF</code>, <code>&lt;stdio.h&gt;</code> is automatically included
and <code>YYFPRINTF</code> is defined to <code>fprintf</code>.

   <p>Once you have compiled the program with trace facilities, the way to
request a trace is to store a nonzero value in the variable <code>yydebug</code>. 
You can do this by making the C code do it (in <code>main</code>, perhaps), or
you can alter the value with a C debugger.

   <p>Each step taken by the parser when <code>yydebug</code> is nonzero produces a
line or two of trace information, written on <code>stderr</code>.  The trace
messages tell you these things:

     <ul>
<li>Each time the parser calls <code>yylex</code>, what kind of token was read.

     <li>Each time a token is shifted, the depth and complete contents of the
state stack (see <a href="#Parser-States">Parser States</a>).

     <li>Each time a rule is reduced, which rule it is, and the complete contents
of the state stack afterward. 
</ul>

   <p>To make sense of this information, it helps to refer to the listing file
produced by the Bison <span class="samp">-v</span> option (see <a href="#Invocation">Invoking Bison</a>).  This file shows the meaning of each state in terms of
positions in various rules, and also what each state will do with each
possible input token.  As you read the successive trace messages, you
can see that the parser is functioning according to its specification in
the listing file.  Eventually you will arrive at the place where
something undesirable happens, and you will see which parts of the
grammar are to blame.

   <p>The parser file is a C program and you can use C debuggers on it, but it's
not easy to interpret what it is doing.  The parser function is a
finite-state machine interpreter, and aside from the actions it executes
the same code over and over.  Only the values of variables show where in
the grammar it is working.

   <p><a name="index-YYPRINT-384"></a>The debugging information normally gives the token type of each token
read, but not its semantic value.  You can optionally define a macro
named <code>YYPRINT</code> to provide a way to print the value.  If you define
<code>YYPRINT</code>, it should take three arguments.  The parser will pass a
standard I/O stream, the numeric code for the token type, and the token
value (from <code>yylval</code>).

   <p>Here is an example of <code>YYPRINT</code> suitable for the multi-function
calculator (see <a href="#Mfcalc-Declarations">Declarations for <code>mfcalc</code></a>):

<pre class="smallexample">     %{
       static void print_token_value (FILE *, int, YYSTYPE);
       #define YYPRINT(file, type, value) print_token_value (file, type, value)
     %}
     
     ... %% ... %% ...
     
     static void
     print_token_value (FILE *file, int type, YYSTYPE value)
     {
       if (type == VAR)
         fprintf (file, "%s", value.tptr-&gt;name);
       else if (type == NUM)
         fprintf (file, "%d", value.val);
     }
</pre>
   <!-- ================================================= Invoking Bison -->
<div class="node">
<p><hr>
<a name="Invocation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-Languages">Other Languages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Debugging">Debugging</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">9 Invoking Bison</h2>

<p><a name="index-invoking-Bison-385"></a><a name="index-Bison-invocation-386"></a><a name="index-options-for-invoking-Bison-387"></a>
The usual way to invoke Bison is as follows:

<pre class="example">     bison <var>infile</var>
</pre>
   <p>Here <var>infile</var> is the grammar file name, which usually ends in
<span class="samp">.y</span>.  The parser file's name is made by replacing the <span class="samp">.y</span>
with <span class="samp">.tab.c</span> and removing any leading directory.  Thus, the
<span class="samp">bison foo.y</span> file name yields
<span class="file">foo.tab.c</span>, and the <span class="samp">bison hack/foo.y</span> file name yields
<span class="file">foo.tab.c</span>.  It's also possible, in case you are writing
C++ code instead of C in your grammar file, to name it <span class="file">foo.ypp</span>
or <span class="file">foo.y++</span>.  Then, the output files will take an extension like
the given one as input (respectively <span class="file">foo.tab.cpp</span> and
<span class="file">foo.tab.c++</span>). 
This feature takes effect with all options that manipulate file names like
<span class="samp">-o</span> or <span class="samp">-d</span>.

   <p>For example :

<pre class="example">     bison -d <var>infile.yxx</var>
</pre>
   <p class="noindent">will produce <span class="file">infile.tab.cxx</span> and <span class="file">infile.tab.hxx</span>, and

<pre class="example">     bison -d -o <var>output.c++</var> <var>infile.y</var>
</pre>
   <p class="noindent">will produce <span class="file">output.c++</span> and <span class="file">outfile.h++</span>.

   <p>For compatibility with <acronym>POSIX</acronym>, the standard Bison
distribution also contains a shell script called <span class="command">yacc</span> that
invokes Bison with the <span class="option">-y</span> option.

<ul class="menu">
<li><a accesskey="1" href="#Bison-Options">Bison Options</a>:      All the options described in detail,
                        in alphabetical order by short options. 
<li><a accesskey="2" href="#Option-Cross-Key">Option Cross Key</a>:   Alphabetical list of long options. 
<li><a accesskey="3" href="#Yacc-Library">Yacc Library</a>:       Yacc-compatible <code>yylex</code> and <code>main</code>. 
</ul>

<div class="node">
<p><hr>
<a name="Bison-Options"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Option-Cross-Key">Option Cross Key</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invocation">Invocation</a>
<br>
</div>

<h3 class="section">9.1 Bison Options</h3>

<p>Bison supports both traditional single-letter options and mnemonic long
option names.  Long option names are indicated with <span class="samp">--</span> instead of
<span class="samp">-</span>.  Abbreviations for option names are allowed as long as they
are unique.  When a long option takes an argument, like
<span class="samp">--file-prefix</span>, connect the option name and the argument with
<span class="samp">=</span>.

   <p>Here is a list of options that can be used with Bison, alphabetized by
short option.  It is followed by a cross key alphabetized by long
option.

<!-- Please, keep this ordered as in `bison -help'. -->
<p class="noindent">Operations modes:
     <dl>
<dt><span class="option">-h</span><dt><span class="option">--help</span><dd>Print a summary of the command-line options to Bison and exit.

     <br><dt><span class="option">-V</span><dt><span class="option">--version</span><dd>Print the version number of Bison and exit.

     <br><dt><span class="option">--print-localedir</span><dd>Print the name of the directory containing locale-dependent data.

     <br><dt><span class="option">--print-datadir</span><dd>Print the name of the directory containing skeletons and XSLT.

     <br><dt><span class="option">-y</span><dt><span class="option">--yacc</span><dd>Act more like the traditional Yacc command.  This can cause
different diagnostics to be generated, and may change behavior in
other minor ways.  Most importantly, imitate Yacc's output
file name conventions, so that the parser output file is called
<span class="file">y.tab.c</span>, and the other outputs are called <span class="file">y.output</span> and
<span class="file">y.tab.h</span>. 
Also, if generating an <acronym>LALR</acronym>(1) parser in C, generate <code>#define</code>
statements in addition to an <code>enum</code> to associate token numbers with token
names. 
Thus, the following shell script can substitute for Yacc, and the Bison
distribution contains such a script for compatibility with <acronym>POSIX</acronym>:

     <pre class="example">          #! /bin/sh
          bison -y "$@"
     </pre>
     <p>The <span class="option">-y</span>/<span class="option">--yacc</span> option is intended for use with
traditional Yacc grammars.  If your grammar uses a Bison extension
like <span class="samp">%glr-parser</span>, Bison might not be Yacc-compatible even if
this option is specified.

     <br><dt><span class="option">-W</span><dt><span class="option">--warnings</span><dd>Output warnings falling in <var>category</var>.  <var>category</var> can be one
of:
          <dl>
<dt><code>midrule-values</code><dd>Warn about mid-rule values that are set but not used within any of the actions
of the parent rule. 
For example, warn about unused <code>$2</code> in:

          <pre class="example">               exp: '1' { $$ = 1; } '+' exp { $$ = $1 + $4; };
          </pre>
          <p>Also warn about mid-rule values that are used but not set. 
For example, warn about unset <code>$$</code> in the mid-rule action in:

          <pre class="example">                exp: '1' { $1 = 1; } '+' exp { $$ = $2 + $4; };
          </pre>
          <p>These warnings are not enabled by default since they sometimes prove to
be false alarms in existing grammars employing the Yacc constructs
<code>$0</code> or <code>$-</code><var>n</var> (where <var>n</var> is some positive integer).

          <br><dt><code>yacc</code><dd>Incompatibilities with <acronym>POSIX</acronym> Yacc.

          <br><dt><code>all</code><dd>All the warnings. 
<br><dt><code>none</code><dd>Turn off all the warnings. 
<br><dt><code>error</code><dd>Treat warnings as errors. 
</dl>

     <p>A category can be turned off by prefixing its name with <span class="samp">no-</span>.  For
instance, <span class="option">-Wno-syntax</span> will hide the warnings about unused
variables. 
</dl>

<p class="noindent">Tuning the parser:

     <dl>
<dt><span class="option">-t</span><dt><span class="option">--debug</span><dd>In the parser file, define the macro <code>YYDEBUG</code> to 1 if it is not
already defined, so that the debugging facilities are compiled. 
See <a href="#Tracing">Tracing Your Parser</a>.

     <br><dt><span class="option">-L </span><var>language</var><dt><span class="option">--language=</span><var>language</var><dd>Specify the programming language for the generated parser, as if
<code>%language</code> was specified (see <a href="#Decl-Summary">Bison Declaration Summary</a>).  Currently supported languages include C, C++, and Java. 
<var>language</var> is case-insensitive.

     <p>This option is experimental and its effect may be modified in future
releases.

     <br><dt><span class="option">--locations</span><dd>Pretend that <code>%locations</code> was specified.  See <a href="#Decl-Summary">Decl Summary</a>.

     <br><dt><span class="option">-p </span><var>prefix</var><dt><span class="option">--name-prefix=</span><var>prefix</var><dd>Pretend that <code>%name-prefix "</code><var>prefix</var><code>"</code> was specified. 
See <a href="#Decl-Summary">Decl Summary</a>.

     <br><dt><span class="option">-l</span><dt><span class="option">--no-lines</span><dd>Don't put any <code>#line</code> preprocessor commands in the parser file. 
Ordinarily Bison puts them in the parser file so that the C compiler
and debuggers will associate errors with your source file, the
grammar file.  This option causes them to associate errors with the
parser file, treating it as an independent source file in its own right.

     <br><dt><span class="option">-S </span><var>file</var><dt><span class="option">--skeleton=</span><var>file</var><dd>Specify the skeleton to use, similar to <code>%skeleton</code>
(see <a href="#Decl-Summary">Bison Declaration Summary</a>).

     <!-- You probably don't need this option unless you are developing Bison. -->
<!-- You should use @option{-language} if you want to specify the skeleton for a -->
<!-- different language, because it is clearer and because it will always -->
<!-- choose the correct skeleton for non-deterministic or push parsers. -->
<p>If <var>file</var> does not contain a <code>/</code>, <var>file</var> is the name of a skeleton
file in the Bison installation directory. 
If it does, <var>file</var> is an absolute file name or a file name relative to the
current working directory. 
This is similar to how most shells resolve commands.

     <br><dt><span class="option">-k</span><dt><span class="option">--token-table</span><dd>Pretend that <code>%token-table</code> was specified.  See <a href="#Decl-Summary">Decl Summary</a>. 
</dl>

<p class="noindent">Adjust the output:

     <dl>
<dt><span class="option">--defines[=</span><var>file</var><span class="option">]</span><dd>Pretend that <code>%defines</code> was specified, i.e., write an extra output
file containing macro definitions for the token type names defined in
the grammar, as well as a few other declarations.  See <a href="#Decl-Summary">Decl Summary</a>.

     <br><dt><span class="option">-d</span><dd>This is the same as <code>--defines</code> except <code>-d</code> does not accept a
<var>file</var> argument since POSIX Yacc requires that <code>-d</code> can be bundled
with other short options.

     <br><dt><span class="option">-b </span><var>file-prefix</var><dt><span class="option">--file-prefix=</span><var>prefix</var><dd>Pretend that <code>%file-prefix</code> was specified, i.e., specify prefix to use
for all Bison output file names.  See <a href="#Decl-Summary">Decl Summary</a>.

     <br><dt><span class="option">-r </span><var>things</var><dt><span class="option">--report=</span><var>things</var><dd>Write an extra output file containing verbose description of the comma
separated list of <var>things</var> among:

          <dl>
<dt><code>state</code><dd>Description of the grammar, conflicts (resolved and unresolved), and
<acronym>LALR</acronym> automaton.

          <br><dt><code>lookahead</code><dd>Implies <code>state</code> and augments the description of the automaton with
each rule's lookahead set.

          <br><dt><code>itemset</code><dd>Implies <code>state</code> and augments the description of the automaton with
the full set of items for each state, instead of its core only. 
</dl>

     <br><dt><span class="option">--report-file=</span><var>file</var><dd>Specify the <var>file</var> for the verbose description.

     <br><dt><span class="option">-v</span><dt><span class="option">--verbose</span><dd>Pretend that <code>%verbose</code> was specified, i.e., write an extra output
file containing verbose descriptions of the grammar and
parser.  See <a href="#Decl-Summary">Decl Summary</a>.

     <br><dt><span class="option">-o </span><var>file</var><dt><span class="option">--output=</span><var>file</var><dd>Specify the <var>file</var> for the parser file.

     <p>The other output files' names are constructed from <var>file</var> as
described under the <span class="samp">-v</span> and <span class="samp">-d</span> options.

     <br><dt><span class="option">-g[</span><var>file</var><span class="option">]</span><dt><span class="option">--graph[=</span><var>file</var><span class="option">]</span><dd>Output a graphical representation of the <acronym>LALR</acronym>(1) grammar
automaton computed by Bison, in <a href="http://www.graphviz.org/">Graphviz</a>
<a href="http://www.graphviz.org/doc/info/lang.html"><acronym>DOT</acronym></a> format. 
<var>file</var> is optional. 
If omitted and the grammar file is <span class="file">foo.y</span>, the output file will be
<span class="file">foo.dot</span>.

     <br><dt><span class="option">-x[</span><var>file</var><span class="option">]</span><dt><span class="option">--xml[=</span><var>file</var><span class="option">]</span><dd>Output an XML report of the <acronym>LALR</acronym>(1) automaton computed by Bison. 
<var>file</var> is optional. 
If omitted and the grammar file is <span class="file">foo.y</span>, the output file will be
<span class="file">foo.xml</span>. 
(The current XML schema is experimental and may evolve. 
More user feedback will help to stabilize it.) 
</dl>

<div class="node">
<p><hr>
<a name="Option-Cross-Key"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Yacc-Library">Yacc Library</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bison-Options">Bison Options</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invocation">Invocation</a>
<br>
</div>

<h3 class="section">9.2 Option Cross Key</h3>

<!-- FIXME: How about putting the directives too? -->
<p>Here is a list of options, alphabetized by long option, to help you find
the corresponding short option.

   <p><table summary=""><tr align="left"><th valign="top">Long Option </th><th valign="top">Short Option
<br></th></tr><tr align="left"><td valign="top"><span class="option">--debug</span>                         </td><td valign="top"><span class="option">-t</span>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--defines=[</span><var>file</var><span class="option">]</span>          </td><td valign="top">
<br></td></tr><tr align="left"><td valign="top"><span class="option">--file-prefix=</span><var>prefix</var>      </td><td valign="top"><span class="option">-b</span> <var>prefix</var>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--graph=[</span><var>file</var><span class="option">]</span>            </td><td valign="top"><span class="option">-g</span> [<var>file</var>]
<br></td></tr><tr align="left"><td valign="top"><span class="option">--help</span>                          </td><td valign="top"><span class="option">-h</span>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--language=</span><var>language</var>       </td><td valign="top"><span class="option">-L</span> <var>language</var>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--locations</span>                     </td><td valign="top">
<br></td></tr><tr align="left"><td valign="top"><span class="option">--name-prefix=</span><var>prefix</var>      </td><td valign="top"><span class="option">-p</span> <var>prefix</var>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--no-lines</span>                      </td><td valign="top"><span class="option">-l</span>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--output=</span><var>file</var>             </td><td valign="top"><span class="option">-o</span> <var>file</var>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--print-datadir</span>                 </td><td valign="top">
<br></td></tr><tr align="left"><td valign="top"><span class="option">--print-localedir</span>               </td><td valign="top">
<br></td></tr><tr align="left"><td valign="top"><span class="option">--report-file=</span><var>file</var>        </td><td valign="top">
<br></td></tr><tr align="left"><td valign="top"><span class="option">--report=</span><var>things</var>           </td><td valign="top"><span class="option">-r</span> <var>things</var>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--skeleton=</span><var>file</var>           </td><td valign="top"><span class="option">-S</span> <var>file</var>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--token-table</span>                   </td><td valign="top"><span class="option">-k</span>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--verbose</span>                       </td><td valign="top"><span class="option">-v</span>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--version</span>                       </td><td valign="top"><span class="option">-V</span>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--warnings</span>                      </td><td valign="top"><span class="option">-W</span>
<br></td></tr><tr align="left"><td valign="top"><span class="option">--xml=[</span><var>file</var><span class="option">]</span>              </td><td valign="top"><span class="option">-x</span> [<var>file</var>]
<br></td></tr><tr align="left"><td valign="top"><span class="option">--yacc</span>                          </td><td valign="top"><span class="option">-y</span>
   <br></td></tr></table>

<div class="node">
<p><hr>
<a name="Yacc-Library"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Option-Cross-Key">Option Cross Key</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invocation">Invocation</a>
<br>
</div>

<h3 class="section">9.3 Yacc Library</h3>

<p>The Yacc library contains default implementations of the
<code>yyerror</code> and <code>main</code> functions.  These default
implementations are normally not useful, but <acronym>POSIX</acronym> requires
them.  To use the Yacc library, link your program with the
<span class="option">-ly</span> option.  Note that Bison's implementation of the Yacc
library is distributed under the terms of the <acronym>GNU</acronym> General
Public License (see <a href="#Copying">Copying</a>).

   <p>If you use the Yacc library's <code>yyerror</code> function, you should
declare <code>yyerror</code> as follows:

<pre class="example">     int yyerror (char const *);
</pre>
   <p>Bison ignores the <code>int</code> value returned by this <code>yyerror</code>. 
If you use the Yacc library's <code>main</code> function, your
<code>yyparse</code> function should have the following type signature:

<pre class="example">     int yyparse (void);
</pre>
   <!-- ================================================= C++ Bison -->
<div class="node">
<p><hr>
<a name="Other-Languages"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#FAQ">FAQ</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invocation">Invocation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">10 Parsers Written In Other Languages</h2>

<ul class="menu">
<li><a accesskey="1" href="#C_002b_002b-Parsers">C++ Parsers</a>:                  The interface to generate C++ parser classes
<li><a accesskey="2" href="#Java-Parsers">Java Parsers</a>:                 The interface to generate Java parser classes
</ul>

<div class="node">
<p><hr>
<a name="C_002b_002b-Parsers"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Parsers">Java Parsers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Languages">Other Languages</a>
<br>
</div>

<h3 class="section">10.1 C++ Parsers</h3>

<ul class="menu">
<li><a accesskey="1" href="#C_002b_002b-Bison-Interface">C++ Bison Interface</a>:          Asking for C++ parser generation
<li><a accesskey="2" href="#C_002b_002b-Semantic-Values">C++ Semantic Values</a>:          %union vs. C++
<li><a accesskey="3" href="#C_002b_002b-Location-Values">C++ Location Values</a>:          The position and location classes
<li><a accesskey="4" href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a>:         Instantiating and running the parser
<li><a accesskey="5" href="#C_002b_002b-Scanner-Interface">C++ Scanner Interface</a>:        Exchanges between yylex and parse
<li><a accesskey="6" href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>:       Demonstrating their use
</ul>

<div class="node">
<p><hr>
<a name="C_002b_002b-Bison-Interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#C_002b_002b-Semantic-Values">C++ Semantic Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#C_002b_002b-Parsers">C++ Parsers</a>
<br>
</div>

<h4 class="subsection">10.1.1 C++ Bison Interface</h4>

<!--  %skeleton "lalr1.cc" -->
<!--  Always pure -->
<!--  initial action -->
<p>The C++ <acronym>LALR</acronym>(1) parser is selected using the skeleton directive,
<span class="samp">%skeleton "lalr1.c"</span>, or the synonymous command-line option
<span class="option">--skeleton=lalr1.c</span>. 
See <a href="#Decl-Summary">Decl Summary</a>.

   <p>When run, <span class="command">bison</span> will create several entities in the <span class="samp">yy</span>
namespace. 
<a name="index-_0025define-namespace-388"></a>Use the <span class="samp">%define namespace</span> directive to change the namespace name, see
<a href="#Decl-Summary">Decl Summary</a>. 
The various classes are generated in the following files:

     <dl>
<dt><span class="file">position.hh</span><dt><span class="file">location.hh</span><dd>The definition of the classes <code>position</code> and <code>location</code>,
used for location tracking.  See <a href="#C_002b_002b-Location-Values">C++ Location Values</a>.

     <br><dt><span class="file">stack.hh</span><dd>An auxiliary class <code>stack</code> used by the parser.

     <br><dt><var>file</var><span class="file">.hh</span><dt><var>file</var><span class="file">.cc</span><dd>(Assuming the extension of the input file was <span class="samp">.yy</span>.)  The
declaration and implementation of the C++ parser class.  The basename
and extension of these two files follow the same rules as with regular C
parsers (see <a href="#Invocation">Invocation</a>).

     <p>The header is <em>mandatory</em>; you must either pass
<span class="option">-d</span>/<span class="option">--defines</span> to <span class="command">bison</span>, or use the
<span class="samp">%defines</span> directive. 
</dl>

   <p>All these files are documented using Doxygen; run <span class="command">doxygen</span>
for a complete and accurate documentation.

<div class="node">
<p><hr>
<a name="C_002b_002b-Semantic-Values"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#C_002b_002b-Location-Values">C++ Location Values</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#C_002b_002b-Bison-Interface">C++ Bison Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#C_002b_002b-Parsers">C++ Parsers</a>
<br>
</div>

<h4 class="subsection">10.1.2 C++ Semantic Values</h4>

<!--  No objects in unions -->
<!--  YYSTYPE -->
<!--  Printer and destructor -->
<p>The <code>%union</code> directive works as for C, see <a href="#Union-Decl">The Collection of Value Types</a>.  In particular it produces a genuine
<code>union</code><a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a>, which have a few specific features in C++.
     <ul>
<li>The type <code>YYSTYPE</code> is defined but its use is discouraged: rather
you should refer to the parser's encapsulated type
<code>yy::parser::semantic_type</code>. 
<li>Non POD (Plain Old Data) types cannot be used.  C++ forbids any
instance of classes with constructors in unions: only <em>pointers</em>
to such objects are allowed. 
</ul>

   <p>Because objects have to be stored via pointers, memory is not
reclaimed automatically: using the <code>%destructor</code> directive is the
only means to avoid leaks.  See <a href="#Destructor-Decl">Freeing Discarded Symbols</a>.

<div class="node">
<p><hr>
<a name="C_002b_002b-Location-Values"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#C_002b_002b-Semantic-Values">C++ Semantic Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#C_002b_002b-Parsers">C++ Parsers</a>
<br>
</div>

<h4 class="subsection">10.1.3 C++ Location Values</h4>

<!--  %locations -->
<!--  class Position -->
<!--  class Location -->
<!--  %define filename_type "const symbol::Symbol" -->
<p>When the directive <code>%locations</code> is used, the C++ parser supports
location tracking, see <a href="#Locations">Locations Overview</a>.  Two
auxiliary classes define a <code>position</code>, a single point in a file,
and a <code>location</code>, a range composed of a pair of
<code>position</code>s (possibly spanning several files).

<div class="defun">
&mdash; Method on position: std::string* <b>file</b><var><a name="index-file-on-position-389"></a></var><br>
<blockquote><p>The name of the file.  It will always be handled as a pointer, the
parser will never duplicate nor deallocate it.  As an experimental
feature you may change it to <var>type</var><span class="samp">*</span> using <span class="samp">%define
filename_type "</span><var>type</var><span class="samp">"</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on position: unsigned int <b>line</b><var><a name="index-line-on-position-390"></a></var><br>
<blockquote><p>The line, starting at 1. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on position: unsigned int <b>lines</b> (<var>int height = 1</var>)<var><a name="index-lines-on-position-391"></a></var><br>
<blockquote><p>Advance by <var>height</var> lines, resetting the column number. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on position: unsigned int <b>column</b><var><a name="index-column-on-position-392"></a></var><br>
<blockquote><p>The column, starting at 0. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on position: unsigned int <b>columns</b> (<var>int width = 1</var>)<var><a name="index-columns-on-position-393"></a></var><br>
<blockquote><p>Advance by <var>width</var> columns, without changing the line number. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on position: position&amp; <b>operator+=</b> (<var>position&amp; pos, int width</var>)<var><a name="index-operator_002b_003d-on-position-394"></a></var><br>
&mdash; Method on position: position <b>operator+</b> (<var>const position&amp; pos, int width</var>)<var><a name="index-operator_002b-on-position-395"></a></var><br>
&mdash; Method on position: position&amp; <b>operator-=</b> (<var>const position&amp; pos, int width</var>)<var><a name="index-operator_002d_003d-on-position-396"></a></var><br>
&mdash; Method on position: position <b>operator-</b> (<var>position&amp; pos, int width</var>)<var><a name="index-operator_002d-on-position-397"></a></var><br>
<blockquote><p>Various forms of syntactic sugar for <code>columns</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on position: position <b>operator&lt;&lt;</b> (<var>std::ostream o, const position&amp; p</var>)<var><a name="index-operator_003c_003c-on-position-398"></a></var><br>
<blockquote><p>Report <var>p</var> on <var>o</var> like this:
<var>file</var><span class="samp">:</span><var>line</var><span class="samp">.</span><var>column</var>, or
<var>line</var><span class="samp">.</span><var>column</var> if <var>file</var> is null. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on location: position <b>begin</b><var><a name="index-begin-on-location-399"></a></var><br>
&mdash; Method on location: position <b>end</b><var><a name="index-end-on-location-400"></a></var><br>
<blockquote><p>The first, inclusive, position of the range, and the first beyond. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on location: unsigned int <b>columns</b> (<var>int width = 1</var>)<var><a name="index-columns-on-location-401"></a></var><br>
&mdash; Method on location: unsigned int <b>lines</b> (<var>int height = 1</var>)<var><a name="index-lines-on-location-402"></a></var><br>
<blockquote><p>Advance the <code>end</code> position. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on location: location <b>operator+</b> (<var>const location&amp; begin, const location&amp; end</var>)<var><a name="index-operator_002b-on-location-403"></a></var><br>
&mdash; Method on location: location <b>operator+</b> (<var>const location&amp; begin, int width</var>)<var><a name="index-operator_002b-on-location-404"></a></var><br>
&mdash; Method on location: location <b>operator+=</b> (<var>const location&amp; loc, int width</var>)<var><a name="index-operator_002b_003d-on-location-405"></a></var><br>
<blockquote><p>Various forms of syntactic sugar. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on location: void <b>step</b> ()<var><a name="index-step-on-location-406"></a></var><br>
<blockquote><p>Move <code>begin</code> onto <code>end</code>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="C_002b_002b-Parser-Interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#C_002b_002b-Scanner-Interface">C++ Scanner Interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#C_002b_002b-Location-Values">C++ Location Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#C_002b_002b-Parsers">C++ Parsers</a>
<br>
</div>

<h4 class="subsection">10.1.4 C++ Parser Interface</h4>

<!--  define parser_class_name -->
<!--  Ctor -->
<!--  parse, error, set_debug_level, debug_level, set_debug_stream, -->
<!-- debug_stream. -->
<!--  Reporting errors -->
<p>The output files <var>output</var><span class="file">.hh</span> and <var>output</var><span class="file">.cc</span>
declare and define the parser class in the namespace <code>yy</code>.  The
class name defaults to <code>parser</code>, but may be changed using
<span class="samp">%define parser_class_name "</span><var>name</var><span class="samp">"</span>.  The interface of
this class is detailed below.  It can be extended using the
<code>%parse-param</code> feature: its semantics is slightly changed since
it describes an additional member of the parser class, and an
additional argument for its constructor.

<div class="defun">
&mdash; Type of parser: <b>semantic_value_type</b><var><a name="index-semantic_005fvalue_005ftype-407"></a></var><br>
&mdash; Type of parser: <b>location_value_type</b><var><a name="index-location_005fvalue_005ftype-408"></a></var><br>
<blockquote><p>The types for semantics value and locations. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on parser:  <b>parser</b> (<var>type1 arg1, ...</var>)<var><a name="index-parser-on-parser-409"></a></var><br>
<blockquote><p>Build a new parser object.  There are no arguments by default, unless
<span class="samp">%parse-param {</span><var>type1</var> <var>arg1</var><span class="samp">}</span> was used. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on parser: int <b>parse</b> ()<var><a name="index-parse-on-parser-410"></a></var><br>
<blockquote><p>Run the syntactic analysis, and return 0 on success, 1 otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on parser: std::ostream&amp; <b>debug_stream</b> ()<var><a name="index-debug_005fstream-on-parser-411"></a></var><br>
&mdash; Method on parser: void <b>set_debug_stream</b> (<var>std::ostream&amp; o</var>)<var><a name="index-set_005fdebug_005fstream-on-parser-412"></a></var><br>
<blockquote><p>Get or set the stream used for tracing the parsing.  It defaults to
<code>std::cerr</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on parser: debug_level_type <b>debug_level</b> ()<var><a name="index-debug_005flevel-on-parser-413"></a></var><br>
&mdash; Method on parser: void <b>set_debug_level</b> (<var>debug_level l</var>)<var><a name="index-set_005fdebug_005flevel-on-parser-414"></a></var><br>
<blockquote><p>Get or set the tracing level.  Currently its value is either 0, no trace,
or nonzero, full tracing. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on parser: void <b>error</b> (<var>const location_type&amp; l, const std::string&amp; m</var>)<var><a name="index-error-on-parser-415"></a></var><br>
<blockquote><p>The definition for this member function must be supplied by the user:
the parser uses it to report a parser error occurring at <var>l</var>,
described by <var>m</var>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="C_002b_002b-Scanner-Interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#C_002b_002b-Parsers">C++ Parsers</a>
<br>
</div>

<h4 class="subsection">10.1.5 C++ Scanner Interface</h4>

<!--  prefix for yylex. -->
<!--  Pure interface to yylex -->
<!--  %lex-param -->
<p>The parser invokes the scanner by calling <code>yylex</code>.  Contrary to C
parsers, C++ parsers are always pure: there is no point in using the
<code>%define api.pure</code> directive.  Therefore the interface is as follows.

<div class="defun">
&mdash; Method on parser: int <b>yylex</b> (<var>semantic_value_type&amp; yylval, location_type&amp; yylloc, type1 arg1, ...</var>)<var><a name="index-yylex-on-parser-416"></a></var><br>
<blockquote><p>Return the next token.  Its type is the return value, its semantic
value and location being <var>yylval</var> and <var>yylloc</var>.  Invocations of
<span class="samp">%lex-param {</span><var>type1</var> <var>arg1</var><span class="samp">}</span> yield additional arguments. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="A-Complete-C_002b_002b-Example"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#C_002b_002b-Scanner-Interface">C++ Scanner Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#C_002b_002b-Parsers">C++ Parsers</a>
<br>
</div>

<h4 class="subsection">10.1.6 A Complete C++ Example</h4>

<p>This section demonstrates the use of a C++ parser with a simple but
complete example.  This example should be available on your system,
ready to compile, in the directory <dfn>../bison/examples/calc++</dfn>.  It
focuses on the use of Bison, therefore the design of the various C++
classes is very naive: no accessors, no encapsulation of members etc. 
We will use a Lex scanner, and more precisely, a Flex scanner, to
demonstrate the various interaction.  A hand written scanner is
actually easier to interface with.

<ul class="menu">
<li><a accesskey="1" href="#Calc_002b_002b-_002d_002d_002d-C_002b_002b-Calculator">Calc++ --- C++ Calculator</a>:    The specifications
<li><a accesskey="2" href="#Calc_002b_002b-Parsing-Driver">Calc++ Parsing Driver</a>:        An active parsing context
<li><a accesskey="3" href="#Calc_002b_002b-Parser">Calc++ Parser</a>:                A parser class
<li><a accesskey="4" href="#Calc_002b_002b-Scanner">Calc++ Scanner</a>:               A pure C++ Flex scanner
<li><a accesskey="5" href="#Calc_002b_002b-Top-Level">Calc++ Top Level</a>:             Conducting the band
</ul>

<div class="node">
<p><hr>
<a name="Calc_002b_002b-_002d_002d_002d-C_002b_002b-Calculator"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Calc_002b_002b-Parsing-Driver">Calc++ Parsing Driver</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>
<br>
</div>

<h5 class="subsubsection">10.1.6.1 Calc++ &mdash; C++ Calculator</h5>

<p>Of course the grammar is dedicated to arithmetics, a single
expression, possibly preceded by variable assignments.  An
environment containing possibly predefined variables such as
<code>one</code> and <code>two</code>, is exchanged with the parser.  An example
of valid input follows.

<pre class="example">     three := 3
     seven := one + two * three
     seven * seven
</pre>
   <div class="node">
<p><hr>
<a name="Calc_002b_002b-Parsing-Driver"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Calc_002b_002b-Parser">Calc++ Parser</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Calc_002b_002b-_002d_002d_002d-C_002b_002b-Calculator">Calc++ --- C++ Calculator</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>
<br>
</div>

<h5 class="subsubsection">10.1.6.2 Calc++ Parsing Driver</h5>

<!--  An env -->
<!--  A place to store error messages -->
<!--  A place for the result -->
<p>To support a pure interface with the parser (and the scanner) the
technique of the &ldquo;parsing context&rdquo; is convenient: a structure
containing all the data to exchange.  Since, in addition to simply
launch the parsing, there are several auxiliary tasks to execute (open
the file for parsing, instantiate the parser etc.), we recommend
transforming the simple parsing context structure into a fully blown
<dfn>parsing driver</dfn> class.

   <p>The declaration of this driver class, <span class="file">calc++-driver.hh</span>, is as
follows.  The first part includes the CPP guard and imports the
required standard library components, and the declaration of the parser
class.

<!-- file: calc++-driver.hh -->
<pre class="example">     #ifndef CALCXX_DRIVER_HH
     # define CALCXX_DRIVER_HH
     # include &lt;string&gt;
     # include &lt;map&gt;
     # include "calc++-parser.hh"
</pre>
   <p class="noindent">Then comes the declaration of the scanning function.  Flex expects
the signature of <code>yylex</code> to be defined in the macro
<code>YY_DECL</code>, and the C++ parser expects it to be declared.  We can
factor both as follows.

<!-- file: calc++-driver.hh -->
<pre class="example">     // Tell Flex the lexer's prototype ...
     # define YY_DECL                                        \
       yy::calcxx_parser::token_type                         \
       yylex (yy::calcxx_parser::semantic_type* yylval,      \
              yy::calcxx_parser::location_type* yylloc,      \
              calcxx_driver&amp; driver)
     // ... and declare it for the parser's sake.
     YY_DECL;
</pre>
   <p class="noindent">The <code>calcxx_driver</code> class is then declared with its most obvious
members.

<!-- file: calc++-driver.hh -->
<pre class="example">     // Conducting the whole scanning and parsing of Calc++.
     class calcxx_driver
     {
     public:
       calcxx_driver ();
       virtual ~calcxx_driver ();
     
       std::map&lt;std::string, int&gt; variables;
     
       int result;
</pre>
   <p class="noindent">To encapsulate the coordination with the Flex scanner, it is useful to
have two members function to open and close the scanning phase.

<!-- file: calc++-driver.hh -->
<pre class="example">       // Handling the scanner.
       void scan_begin ();
       void scan_end ();
       bool trace_scanning;
</pre>
   <p class="noindent">Similarly for the parser itself.

<!-- file: calc++-driver.hh -->
<pre class="example">       // Run the parser.  Return 0 on success.
       int parse (const std::string&amp; f);
       std::string file;
       bool trace_parsing;
</pre>
   <p class="noindent">To demonstrate pure handling of parse errors, instead of simply
dumping them on the standard error output, we will pass them to the
compiler driver using the following two member functions.  Finally, we
close the class declaration and CPP guard.

<!-- file: calc++-driver.hh -->
<pre class="example">       // Error handling.
       void error (const yy::location&amp; l, const std::string&amp; m);
       void error (const std::string&amp; m);
     };
     #endif // ! CALCXX_DRIVER_HH
</pre>
   <p>The implementation of the driver is straightforward.  The <code>parse</code>
member function deserves some attention.  The <code>error</code> functions
are simple stubs, they should actually register the located error
messages and set error state.

<!-- file: calc++-driver.cc -->
<pre class="example">     #include "calc++-driver.hh"
     #include "calc++-parser.hh"
     
     calcxx_driver::calcxx_driver ()
       : trace_scanning (false), trace_parsing (false)
     {
       variables["one"] = 1;
       variables["two"] = 2;
     }
     
     calcxx_driver::~calcxx_driver ()
     {
     }
     
     int
     calcxx_driver::parse (const std::string &amp;f)
     {
       file = f;
       scan_begin ();
       yy::calcxx_parser parser (*this);
       parser.set_debug_level (trace_parsing);
       int res = parser.parse ();
       scan_end ();
       return res;
     }
     
     void
     calcxx_driver::error (const yy::location&amp; l, const std::string&amp; m)
     {
       std::cerr &lt;&lt; l &lt;&lt; ": " &lt;&lt; m &lt;&lt; std::endl;
     }
     
     void
     calcxx_driver::error (const std::string&amp; m)
     {
       std::cerr &lt;&lt; m &lt;&lt; std::endl;
     }
</pre>
   <div class="node">
<p><hr>
<a name="Calc_002b_002b-Parser"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Calc_002b_002b-Scanner">Calc++ Scanner</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Calc_002b_002b-Parsing-Driver">Calc++ Parsing Driver</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>
<br>
</div>

<h5 class="subsubsection">10.1.6.3 Calc++ Parser</h5>

<p>The parser definition file <span class="file">calc++-parser.yy</span> starts by asking for
the C++ LALR(1) skeleton, the creation of the parser header file, and
specifies the name of the parser class.  Because the C++ skeleton
changed several times, it is safer to require the version you designed
the grammar for.

<!-- file: calc++-parser.yy -->
<pre class="example">     %skeleton "lalr1.cc"                          /*  -*- C++ -*- */
     %require "2.4.1"
     %defines
     %define parser_class_name "calcxx_parser"
</pre>
   <p class="noindent"><a name="index-_0025code-requires-417"></a>Then come the declarations/inclusions needed to define the
<code>%union</code>.  Because the parser uses the parsing driver and
reciprocally, both cannot include the header of the other.  Because the
driver's header needs detailed knowledge about the parser class (in
particular its inner types), it is the parser's header which will simply
use a forward declaration of the driver. 
See <a href="#Decl-Summary">%code</a>.

<!-- file: calc++-parser.yy -->
<pre class="example">     %code requires {
     # include &lt;string&gt;
     class calcxx_driver;
     }
</pre>
   <p class="noindent">The driver is passed by reference to the parser and to the scanner. 
This provides a simple but effective pure interface, not relying on
global variables.

<!-- file: calc++-parser.yy -->
<pre class="example">     // The parsing context.
     %parse-param { calcxx_driver&amp; driver }
     %lex-param   { calcxx_driver&amp; driver }
</pre>
   <p class="noindent">Then we request the location tracking feature, and initialize the
first location's file name.  Afterwards new locations are computed
relatively to the previous locations: the file name will be
automatically propagated.

<!-- file: calc++-parser.yy -->
<pre class="example">     %locations
     %initial-action
     {
       // Initialize the initial location.
       @$.begin.filename = @$.end.filename = &amp;driver.file;
     };
</pre>
   <p class="noindent">Use the two following directives to enable parser tracing and verbose
error messages.

<!-- file: calc++-parser.yy -->
<pre class="example">     %debug
     %error-verbose
</pre>
   <p class="noindent">Semantic values cannot use &ldquo;real&rdquo; objects, but only pointers to
them.

<!-- file: calc++-parser.yy -->
<pre class="example">     // Symbols.
     %union
     {
       int          ival;
       std::string *sval;
     };
</pre>
   <p class="noindent"><a name="index-_0025code-418"></a>The code between <span class="samp">%code {</span> and <span class="samp">}</span> is output in the
<span class="file">*.cc</span> file; it needs detailed knowledge about the driver.

<!-- file: calc++-parser.yy -->
<pre class="example">     %code {
     # include "calc++-driver.hh"
     }
</pre>
   <p class="noindent">The token numbered as 0 corresponds to end of file; the following line
allows for nicer error messages referring to &ldquo;end of file&rdquo; instead
of &ldquo;$end&rdquo;.  Similarly user friendly named are provided for each
symbol.  Note that the tokens names are prefixed by <code>TOKEN_</code> to
avoid name clashes.

<!-- file: calc++-parser.yy -->
<pre class="example">     %token        END      0 "end of file"
     %token        ASSIGN     ":="
     %token &lt;sval&gt; IDENTIFIER "identifier"
     %token &lt;ival&gt; NUMBER     "number"
     %type  &lt;ival&gt; exp
</pre>
   <p class="noindent">To enable memory deallocation during error recovery, use
<code>%destructor</code>.

<!-- FIXME: Document %printer, and mention that it takes a braced-code operand. -->
<!-- file: calc++-parser.yy -->
<pre class="example">     %printer    { debug_stream () &lt;&lt; *$$; } "identifier"
     %destructor { delete $$; } "identifier"
     
     %printer    { debug_stream () &lt;&lt; $$; } &lt;ival&gt;
</pre>
   <p class="noindent">The grammar itself is straightforward.

<!-- file: calc++-parser.yy -->
<pre class="example">     %%
     %start unit;
     unit: assignments exp  { driver.result = $2; };
     
     assignments: assignments assignment {}
                | /* Nothing.  */        {};
     
     assignment:
          "identifier" ":=" exp
            { driver.variables[*$1] = $3; delete $1; };
     
     %left '+' '-';
     %left '*' '/';
     exp: exp '+' exp   { $$ = $1 + $3; }
        | exp '-' exp   { $$ = $1 - $3; }
        | exp '*' exp   { $$ = $1 * $3; }
        | exp '/' exp   { $$ = $1 / $3; }
        | "identifier"  { $$ = driver.variables[*$1]; delete $1; }
        | "number"      { $$ = $1; };
     %%
</pre>
   <p class="noindent">Finally the <code>error</code> member function registers the errors to the
driver.

<!-- file: calc++-parser.yy -->
<pre class="example">     void
     yy::calcxx_parser::error (const yy::calcxx_parser::location_type&amp; l,
                               const std::string&amp; m)
     {
       driver.error (l, m);
     }
</pre>
   <div class="node">
<p><hr>
<a name="Calc_002b_002b-Scanner"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Calc_002b_002b-Top-Level">Calc++ Top Level</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Calc_002b_002b-Parser">Calc++ Parser</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>
<br>
</div>

<h5 class="subsubsection">10.1.6.4 Calc++ Scanner</h5>

<p>The Flex scanner first includes the driver declaration, then the
parser's to get the set of defined tokens.

<!-- file: calc++-scanner.ll -->
<pre class="example">     %{                                            /* -*- C++ -*- */
     # include &lt;cstdlib&gt;
     # include &lt;errno.h&gt;
     # include &lt;limits.h&gt;
     # include &lt;string&gt;
     # include "calc++-driver.hh"
     # include "calc++-parser.hh"
     
     /* Work around an incompatibility in flex (at least versions
        2.5.31 through 2.5.33): it generates code that does
        not conform to C89.  See Debian bug 333231
        &lt;http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=333231&gt;.  */
     # undef yywrap
     # define yywrap() 1
     
     /* By default yylex returns int, we use token_type.
        Unfortunately yyterminate by default returns 0, which is
        not of token_type.  */
     #define yyterminate() return token::END
     %}
</pre>
   <p class="noindent">Because there is no <code>#include</code>-like feature we don't need
<code>yywrap</code>, we don't need <code>unput</code> either, and we parse an
actual file, this is not an interactive session with the user. 
Finally we enable the scanner tracing features.

<!-- file: calc++-scanner.ll -->
<pre class="example">     %option noyywrap nounput batch debug
</pre>
   <p class="noindent">Abbreviations allow for more readable rules.

<!-- file: calc++-scanner.ll -->
<pre class="example">     id    [a-zA-Z][a-zA-Z_0-9]*
     int   [0-9]+
     blank [ \t]
</pre>
   <p class="noindent">The following paragraph suffices to track locations accurately.  Each
time <code>yylex</code> is invoked, the begin position is moved onto the end
position.  Then when a pattern is matched, the end position is
advanced of its width.  In case it matched ends of lines, the end
cursor is adjusted, and each time blanks are matched, the begin cursor
is moved onto the end cursor to effectively ignore the blanks
preceding tokens.  Comments would be treated equally.

<!-- file: calc++-scanner.ll -->
<pre class="example">     %{
     # define YY_USER_ACTION  yylloc-&gt;columns (yyleng);
     %}
     %%
     %{
       yylloc-&gt;step ();
     %}
     {blank}+   yylloc-&gt;step ();
     [\n]+      yylloc-&gt;lines (yyleng); yylloc-&gt;step ();
</pre>
   <p class="noindent">The rules are simple, just note the use of the driver to report errors. 
It is convenient to use a typedef to shorten
<code>yy::calcxx_parser::token::identifier</code> into
<code>token::identifier</code> for instance.

<!-- file: calc++-scanner.ll -->
<pre class="example">     %{
       typedef yy::calcxx_parser::token token;
     %}
                /* Convert ints to the actual type of tokens.  */
     [-+*/]     return yy::calcxx_parser::token_type (yytext[0]);
     ":="       return token::ASSIGN;
     {int}      {
       errno = 0;
       long n = strtol (yytext, NULL, 10);
       if (! (INT_MIN &lt;= n &amp;&amp; n &lt;= INT_MAX &amp;&amp; errno != ERANGE))
         driver.error (*yylloc, "integer is out of range");
       yylval-&gt;ival = n;
       return token::NUMBER;
     }
     {id}       yylval-&gt;sval = new std::string (yytext); return token::IDENTIFIER;
     .          driver.error (*yylloc, "invalid character");
     %%
</pre>
   <p class="noindent">Finally, because the scanner related driver's member function depend
on the scanner's data, it is simpler to implement them in this file.

<!-- file: calc++-scanner.ll -->
<pre class="example">     void
     calcxx_driver::scan_begin ()
     {
       yy_flex_debug = trace_scanning;
       if (file == "-")
         yyin = stdin;
       else if (!(yyin = fopen (file.c_str (), "r")))
         {
           error (std::string ("cannot open ") + file);
           exit (1);
         }
     }
     
     void
     calcxx_driver::scan_end ()
     {
       fclose (yyin);
     }
</pre>
   <div class="node">
<p><hr>
<a name="Calc_002b_002b-Top-Level"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Calc_002b_002b-Scanner">Calc++ Scanner</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#A-Complete-C_002b_002b-Example">A Complete C++ Example</a>
<br>
</div>

<h5 class="subsubsection">10.1.6.5 Calc++ Top Level</h5>

<p>The top level file, <span class="file">calc++.cc</span>, poses no problem.

<!-- file: calc++.cc -->
<pre class="example">     #include &lt;iostream&gt;
     #include "calc++-driver.hh"
     
     int
     main (int argc, char *argv[])
     {
       calcxx_driver driver;
       for (++argv; argv[0]; ++argv)
         if (*argv == std::string ("-p"))
           driver.trace_parsing = true;
         else if (*argv == std::string ("-s"))
           driver.trace_scanning = true;
         else if (!driver.parse (*argv))
           std::cout &lt;&lt; driver.result &lt;&lt; std::endl;
     }
</pre>
   <div class="node">
<p><hr>
<a name="Java-Parsers"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#C_002b_002b-Parsers">C++ Parsers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-Languages">Other Languages</a>
<br>
</div>

<h3 class="section">10.2 Java Parsers</h3>

<ul class="menu">
<li><a accesskey="1" href="#Java-Bison-Interface">Java Bison Interface</a>:         Asking for Java parser generation
<li><a accesskey="2" href="#Java-Semantic-Values">Java Semantic Values</a>:         %type and %token vs. Java
<li><a accesskey="3" href="#Java-Location-Values">Java Location Values</a>:         The position and location classes
<li><a accesskey="4" href="#Java-Parser-Interface">Java Parser Interface</a>:        Instantiating and running the parser
<li><a accesskey="5" href="#Java-Scanner-Interface">Java Scanner Interface</a>:       Specifying the scanner for the parser
<li><a accesskey="6" href="#Java-Action-Features">Java Action Features</a>:         Special features for use in actions
<li><a accesskey="7" href="#Java-Differences">Java Differences</a>:             Differences between C/C++ and Java Grammars
<li><a accesskey="8" href="#Java-Declarations-Summary">Java Declarations Summary</a>:    List of Bison declarations used with Java
</ul>

<div class="node">
<p><hr>
<a name="Java-Bison-Interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Semantic-Values">Java Semantic Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.1 Java Bison Interface</h4>

<!--  %language "Java" -->
<p>(The current Java interface is experimental and may evolve. 
More user feedback will help to stabilize it.)

   <p>The Java parser skeletons are selected using the <code>%language "Java"</code>
directive or the <span class="option">-L java</span>/<span class="option">--language=java</span> option.

<!-- FIXME: Documented bug. -->
<p>When generating a Java parser, <code>bison </code><var>basename</var><code>.y</code> will create
a single Java source file named <var>basename</var><span class="file">.java</span>.  Using an
input file without a <span class="file">.y</span> suffix is currently broken.  The basename
of the output file can be changed by the <code>%file-prefix</code> directive
or the <span class="option">-p</span>/<span class="option">--name-prefix</span> option.  The entire output file
name can be changed by the <code>%output</code> directive or the
<span class="option">-o</span>/<span class="option">--output</span> option.  The output file contains a single
class for the parser.

   <p>You can create documentation for generated parsers using Javadoc.

   <p>Contrary to C parsers, Java parsers do not use global variables; the
state of the parser is always local to an instance of the parser class. 
Therefore, all Java parsers are &ldquo;pure&rdquo;, and the <code>%pure-parser</code>
and <code>%define api.pure</code> directives does not do anything when used in
Java.

   <p>Push parsers are currently unsupported in Java and <code>%define
api.push_pull</code> have no effect.

   <p><acronym>GLR</acronym> parsers are currently unsupported in Java.  Do not use the
<code>glr-parser</code> directive.

   <p>No header file can be generated for Java parsers.  Do not use the
<code>%defines</code> directive or the <span class="option">-d</span>/<span class="option">--defines</span> options.

<!-- FIXME: Possible code change. -->
<p>Currently, support for debugging and verbose errors are always compiled
in.  Thus the <code>%debug</code> and <code>%token-table</code> directives and the
<span class="option">-t</span>/<span class="option">--debug</span> and <span class="option">-k</span>/<span class="option">--token-table</span>
options have no effect.  This may change in the future to eliminate
unused code in the generated parser, so use <code>%debug</code> and
<code>%verbose-error</code> explicitly if needed.  Also, in the future the
<code>%token-table</code> directive might enable a public interface to
access the token names and codes.

<div class="node">
<p><hr>
<a name="Java-Semantic-Values"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Location-Values">Java Location Values</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Java-Bison-Interface">Java Bison Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.2 Java Semantic Values</h4>

<!--  No %union, specify type in %type/%token. -->
<!--  YYSTYPE -->
<!--  Printer and destructor -->
<p>There is no <code>%union</code> directive in Java parsers.  Instead, the
semantic values' types (class names) should be specified in the
<code>%type</code> or <code>%token</code> directive:

<pre class="example">     %type &lt;Expression&gt; expr assignment_expr term factor
     %type &lt;Integer&gt; number
</pre>
   <p>By default, the semantic stack is declared to have <code>Object</code> members,
which means that the class types you specify can be of any class. 
To improve the type safety of the parser, you can declare the common
superclass of all the semantic values using the <code>%define stype</code>
directive.  For example, after the following declaration:

<pre class="example">     %define stype "ASTNode"
</pre>
   <p class="noindent">any <code>%type</code> or <code>%token</code> specifying a semantic type which
is not a subclass of ASTNode, will cause a compile-time error.

<!-- FIXME: Documented bug. -->
<p>Types used in the directives may be qualified with a package name. 
Primitive data types are accepted for Java version 1.5 or later.  Note
that in this case the autoboxing feature of Java 1.5 will be used. 
Generic types may not be used; this is due to a limitation in the
implementation of Bison, and may change in future releases.

   <p>Java parsers do not support <code>%destructor</code>, since the language
adopts garbage collection.  The parser will try to hold references
to semantic values for as little time as needed.

   <p>Java parsers do not support <code>%printer</code>, as <code>toString()</code>
can be used to print the semantic values.  This however may change
(in a backwards-compatible way) in future versions of Bison.

<div class="node">
<p><hr>
<a name="Java-Location-Values"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Parser-Interface">Java Parser Interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Java-Semantic-Values">Java Semantic Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.3 Java Location Values</h4>

<!--  %locations -->
<!--  class Position -->
<!--  class Location -->
<p>When the directive <code>%locations</code> is used, the Java parser
supports location tracking, see <a href="#Locations">Locations Overview</a>. 
An auxiliary user-defined class defines a <dfn>position</dfn>, a single point
in a file; Bison itself defines a class representing a <dfn>location</dfn>,
a range composed of a pair of positions (possibly spanning several
files).  The location class is an inner class of the parser; the name
is <code>Location</code> by default, and may also be renamed using
<code>%define location_type "</code><var>class-name</var>.

   <p>The location class treats the position as a completely opaque value. 
By default, the class name is <code>Position</code>, but this can be changed
with <code>%define position_type "</code><var>class-name</var><code>"</code>.  This class must
be supplied by the user.

<div class="defun">
&mdash; Instance Variable of Location: Position <b>begin</b><var><a name="index-begin-of-Location-419"></a></var><br>
&mdash; Instance Variable of Location: Position <b>end</b><var><a name="index-end-of-Location-420"></a></var><br>
<blockquote><p>The first, inclusive, position of the range, and the first beyond. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor on Location:  <b>Location</b> (<var>Position loc</var>)<var><a name="index-Location-on-Location-421"></a></var><br>
<blockquote><p>Create a <code>Location</code> denoting an empty range located at a given point. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor on Location:  <b>Location</b> (<var>Position begin, Position end</var>)<var><a name="index-Location-on-Location-422"></a></var><br>
<blockquote><p>Create a <code>Location</code> from the endpoints of the range. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on Location: String <b>toString</b> ()<var><a name="index-toString-on-Location-423"></a></var><br>
<blockquote><p>Prints the range represented by the location.  For this to work
properly, the position class should override the <code>equals</code> and
<code>toString</code> methods appropriately. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Java-Parser-Interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Scanner-Interface">Java Scanner Interface</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Java-Location-Values">Java Location Values</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.4 Java Parser Interface</h4>

<!--  define parser_class_name -->
<!--  Ctor -->
<!--  parse, error, set_debug_level, debug_level, set_debug_stream, -->
<!-- debug_stream. -->
<!--  Reporting errors -->
<p>The name of the generated parser class defaults to <code>YYParser</code>.  The
<code>YY</code> prefix may be changed using the <code>%name-prefix</code> directive
or the <span class="option">-p</span>/<span class="option">--name-prefix</span> option.  Alternatively, use
<code>%define parser_class_name "</code><var>name</var><code>"</code> to give a custom name to
the class.  The interface of this class is detailed below.

   <p>By default, the parser class has package visibility.  A declaration
<code>%define public</code> will change to public visibility.  Remember that,
according to the Java language specification, the name of the <span class="file">.java</span>
file should match the name of the class in this case.  Similarly, you can
use <code>abstract</code>, <code>final</code> and <code>strictfp</code> with the
<code>%define</code> declaration to add other modifiers to the parser class.

   <p>The Java package name of the parser class can be specified using the
<code>%define package</code> directive.  The superclass and the implemented
interfaces of the parser class can be specified with the <code>%define
extends</code> and <code>%define implements</code> directives.

   <p>The parser class defines an inner class, <code>Location</code>, that is used
for location tracking (see <a href="#Java-Location-Values">Java Location Values</a>), and a inner
interface, <code>Lexer</code> (see <a href="#Java-Scanner-Interface">Java Scanner Interface</a>).  Other than
these inner class/interface, and the members described in the interface
below, all the other members and fields are preceded with a <code>yy</code> or
<code>YY</code> prefix to avoid clashes with user code.

<!-- FIXME: The following constants and variables are still undocumented: -->
<!-- @code{bisonVersion}, @code{bisonSkeleton} and @code{errorVerbose}. -->
<p>The parser class can be extended using the <code>%parse-param</code>
directive. Each occurrence of the directive will add a <code>protected
final</code> field to the parser class, and an argument to its constructor,
which initialize them automatically.

   <p>Token names defined by <code>%token</code> and the predefined <code>EOF</code> token
name are added as constant fields to the parser class.

<div class="defun">
&mdash; Constructor on YYParser:  <b>YYParser</b> (<var>lex_param, <small class="dots">...</small>, parse_param, <small class="dots">...</small></var>)<var><a name="index-YYParser-on-YYParser-424"></a></var><br>
<blockquote><p>Build a new parser object with embedded <code>%code lexer</code>.  There are
no parameters, unless <code>%parse-param</code>s and/or <code>%lex-param</code>s are
used. 
</p></blockquote></div>

<div class="defun">
&mdash; Constructor on YYParser:  <b>YYParser</b> (<var>Lexer lexer, parse_param, <small class="dots">...</small></var>)<var><a name="index-YYParser-on-YYParser-425"></a></var><br>
<blockquote><p>Build a new parser object using the specified scanner.  There are no
additional parameters unless <code>%parse-param</code>s are used.

        <p>If the scanner is defined by <code>%code lexer</code>, this constructor is
declared <code>protected</code> and is called automatically with a scanner
created with the correct <code>%lex-param</code>s. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on YYParser: boolean <b>parse</b> ()<var><a name="index-parse-on-YYParser-426"></a></var><br>
<blockquote><p>Run the syntactic analysis, and return <code>true</code> on success,
<code>false</code> otherwise. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on YYParser: boolean <b>recovering</b> ()<var><a name="index-recovering-on-YYParser-427"></a></var><br>
<blockquote><p>During the syntactic analysis, return <code>true</code> if recovering
from a syntax error. 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on YYParser: java.io.PrintStream <b>getDebugStream</b> ()<var><a name="index-getDebugStream-on-YYParser-428"></a></var><br>
&mdash; Method on YYParser: void <b>setDebugStream</b> (<var>java.io.printStream o</var>)<var><a name="index-setDebugStream-on-YYParser-429"></a></var><br>
<blockquote><p>Get or set the stream used for tracing the parsing.  It defaults to
<code>System.err</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on YYParser: int <b>getDebugLevel</b> ()<var><a name="index-getDebugLevel-on-YYParser-430"></a></var><br>
&mdash; Method on YYParser: void <b>setDebugLevel</b> (<var>int l</var>)<var><a name="index-setDebugLevel-on-YYParser-431"></a></var><br>
<blockquote><p>Get or set the tracing level.  Currently its value is either 0, no trace,
or nonzero, full tracing. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Java-Scanner-Interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Action-Features">Java Action Features</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Java-Parser-Interface">Java Parser Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.5 Java Scanner Interface</h4>

<!--  %code lexer -->
<!--  %lex-param -->
<!--  Lexer interface -->
<p>There are two possible ways to interface a Bison-generated Java parser
with a scanner: the scanner may be defined by <code>%code lexer</code>, or
defined elsewhere.  In either case, the scanner has to implement the
<code>Lexer</code> inner interface of the parser class.

   <p>In the first case, the body of the scanner class is placed in
<code>%code lexer</code> blocks.  If you want to pass parameters from the
parser constructor to the scanner constructor, specify them with
<code>%lex-param</code>; they are passed before <code>%parse-param</code>s to the
constructor.

   <p>In the second case, the scanner has to implement the <code>Lexer</code> interface,
which is defined within the parser class (e.g., <code>YYParser.Lexer</code>). 
The constructor of the parser object will then accept an object
implementing the interface; <code>%lex-param</code> is not used in this
case.

   <p>In both cases, the scanner has to implement the following methods.

<div class="defun">
&mdash; Method on Lexer: void <b>yyerror</b> (<var>Location loc, String msg</var>)<var><a name="index-yyerror-on-Lexer-432"></a></var><br>
<blockquote><p>This method is defined by the user to emit an error message.  The first
parameter is omitted if location tracking is not active.  Its type can be
changed using <code>%define location_type "</code><var>class-name</var><code>".</code>
</p></blockquote></div>

<div class="defun">
&mdash; Method on Lexer: int <b>yylex</b> ()<var><a name="index-yylex-on-Lexer-433"></a></var><br>
<blockquote><p>Return the next token.  Its type is the return value, its semantic
value and location are saved and returned by the ther methods in the
interface.

        <p>Use <code>%define lex_throws</code> to specify any uncaught exceptions. 
Default is <code>java.io.IOException</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Method on Lexer: Position <b>getStartPos</b> ()<var><a name="index-getStartPos-on-Lexer-434"></a></var><br>
&mdash; Method on Lexer: Position <b>getEndPos</b> ()<var><a name="index-getEndPos-on-Lexer-435"></a></var><br>
<blockquote><p>Return respectively the first position of the last token that
<code>yylex</code> returned, and the first position beyond it.  These
methods are not needed unless location tracking is active.

        <p>The return type can be changed using <code>%define position_type
"</code><var>class-name</var><code>".</code>
</p></blockquote></div>

<div class="defun">
&mdash; Method on Lexer: Object <b>getLVal</b> ()<var><a name="index-getLVal-on-Lexer-436"></a></var><br>
<blockquote><p>Return the semantical value of the last token that yylex returned.

        <p>The return type can be changed using <code>%define stype
"</code><var>class-name</var><code>".</code>
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Java-Action-Features"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Differences">Java Differences</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Java-Scanner-Interface">Java Scanner Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.6 Special Features for Use in Java Actions</h4>

<p>The following special constructs can be uses in Java actions. 
Other analogous C action features are currently unavailable for Java.

   <p>Use <code>%define throws</code> to specify any uncaught exceptions from parser
actions, and initial actions specified by <code>%initial-action</code>.

<div class="defun">
&mdash; Variable: <b>$</b><var>n<a name="index-_0024-437"></a></var><br>
<blockquote><p>The semantic value for the <var>n</var>th component of the current rule. 
This may not be assigned to. 
See <a href="#Java-Semantic-Values">Java Semantic Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$&lt;</b><var>typealt&gt;n<a name="index-_0024_003c-438"></a></var><br>
<blockquote><p>Like <code>$</code><var>n</var> but specifies a alternative type <var>typealt</var>. 
See <a href="#Java-Semantic-Values">Java Semantic Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$$</b><var><a name="index-_0024_0024-439"></a></var><br>
<blockquote><p>The semantic value for the grouping made by the current rule.  As a
value, this is in the base type (<code>Object</code> or as specified by
<code>%define stype</code>) as in not cast to the declared subtype because
casts are not allowed on the left-hand side of Java assignments. 
Use an explicit Java cast if the correct subtype is needed. 
See <a href="#Java-Semantic-Values">Java Semantic Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$&lt;</b><var>typealt&gt;$<a name="index-_0024_003c-440"></a></var><br>
<blockquote><p>Same as <code>$$</code> since Java always allow assigning to the base type. 
Perhaps we should use this and <code>$&lt;&gt;$</code> for the value and <code>$$</code>
for setting the value but there is currently no easy way to distinguish
these constructs. 
See <a href="#Java-Semantic-Values">Java Semantic Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>@</b><var>n</var><var><a name="index-_0040_0040_0040var_007bn_007d-441"></a></var><br>
<blockquote><p>The location information of the <var>n</var>th component of the current rule. 
This may not be assigned to. 
See <a href="#Java-Location-Values">Java Location Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>@$</b><var><a name="index-_0040_0040_0024-442"></a></var><br>
<blockquote><p>The location information of the grouping made by the current rule. 
See <a href="#Java-Location-Values">Java Location Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Statement: <b>return YYABORT;</b><var><a name="index-return-YYABORT_003b-443"></a></var><br>
<blockquote><p>Return immediately from the parser, indicating failure. 
See <a href="#Java-Parser-Interface">Java Parser Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Statement: <b>return YYACCEPT;</b><var><a name="index-return-YYACCEPT_003b-444"></a></var><br>
<blockquote><p>Return immediately from the parser, indicating success. 
See <a href="#Java-Parser-Interface">Java Parser Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Statement: <b>return YYERROR;</b><var><a name="index-return-YYERROR_003b-445"></a></var><br>
<blockquote><p>Start error recovery without printing an error message. 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Statement: <b>return YYFAIL;</b><var><a name="index-return-YYFAIL_003b-446"></a></var><br>
<blockquote><p>Print an error message and start error recovery. 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: boolean <b>recovering</b> ()<var><a name="index-recovering-447"></a></var><br>
<blockquote><p>Return whether error recovery is being done. In this state, the parser
reads token until it reaches a known state, and then restarts normal
operation. 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: protected void <b>yyerror</b> (<var>String msg</var>)<var><a name="index-yyerror-448"></a></var><br>
&mdash; Function: protected void <b>yyerror</b> (<var>Position pos, String msg</var>)<var><a name="index-yyerror-449"></a></var><br>
&mdash; Function: protected void <b>yyerror</b> (<var>Location loc, String msg</var>)<var><a name="index-yyerror-450"></a></var><br>
<blockquote><p>Print an error message using the <code>yyerror</code> method of the scanner
instance in use. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Java-Differences"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Java-Declarations-Summary">Java Declarations Summary</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Java-Action-Features">Java Action Features</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.7 Differences between C/C++ and Java Grammars</h4>

<p>The different structure of the Java language forces several differences
between C/C++ grammars, and grammars designed for Java parsers.  This
section summarizes these differences.

     <ul>
<li>Java lacks a preprocessor, so the <code>YYERROR</code>, <code>YYACCEPT</code>,
<code>YYABORT</code> symbols (see <a href="#Table-of-Symbols">Table of Symbols</a>) cannot obviously be
macros.  Instead, they should be preceded by <code>return</code> when they
appear in an action.  The actual definition of these symbols is
opaque to the Bison grammar, and it might change in the future.  The
only meaningful operation that you can do, is to return them. 
See see <a href="#Java-Action-Features">Java Action Features</a>.

     <p>Note that of these three symbols, only <code>YYACCEPT</code> and
<code>YYABORT</code> will cause a return from the <code>yyparse</code>
method<a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>.

     <li>Java lacks unions, so <code>%union</code> has no effect.  Instead, semantic
values have a common base type: <code>Object</code> or as specified by
<code>%define stype</code>.  Angle backets on <code>%token</code>, <code>type</code>,
<code>$</code><var>n</var> and <code>$$</code> specify subtypes rather than fields of
an union.  The type of <code>$$</code>, even with angle brackets, is the base
type since Java casts are not allow on the left-hand side of assignments. 
Also, <code>$</code><var>n</var> and <code>@</code><var>n</var> are not allowed on the
left-hand side of assignments. See see <a href="#Java-Semantic-Values">Java Semantic Values</a> and
see <a href="#Java-Action-Features">Java Action Features</a>.

     <li>The prolog declarations have a different meaning than in C/C++ code.
          <dl>
<dt><code>%code imports</code><dd>blocks are placed at the beginning of the Java source code.  They may
include copyright notices.  For a <code>package</code> declarations, it is
suggested to use <code>%define package</code> instead.

          <br><dt>unqualified <code>%code</code><dd>blocks are placed inside the parser class.

          <br><dt><code>%code lexer</code><dd>blocks, if specified, should include the implementation of the
scanner.  If there is no such block, the scanner can be any class
that implements the appropriate interface (see see <a href="#Java-Scanner-Interface">Java Scanner Interface</a>). 
</dl>

     <p>Other <code>%code</code> blocks are not supported in Java parsers. 
In particular, <code>%{ ... %}</code> blocks should not be used
and may give an error in future versions of Bison.

     <p>The epilogue has the same meaning as in C/C++ code and it can
be used to define other classes used by the parser <em>outside</em>
the parser class. 
</ul>

<div class="node">
<p><hr>
<a name="Java-Declarations-Summary"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Java-Differences">Java Differences</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Java-Parsers">Java Parsers</a>
<br>
</div>

<h4 class="subsection">10.2.8 Java Declarations Summary</h4>

<p>This summary only include declarations specific to Java or have special
meaning when used in a Java parser.

<div class="defun">
&mdash; Directive: <b>%language "Java"</b><var><a name="index-_0025language-_0022Java_0022-451"></a></var><br>
<blockquote><p>Generate a Java class for the parser. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%lex-param</b><var> {type name}<a name="index-_0025lex_002dparam-452"></a></var><br>
<blockquote><p>A parameter for the lexer class defined by <code>%code lexer</code>
<em>only</em>, added as parameters to the lexer constructor and the parser
constructor that <em>creates</em> a lexer.  Default is none. 
See <a href="#Java-Scanner-Interface">Java Scanner Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%name-prefix</b><var> "prefix"<a name="index-_0025name_002dprefix-453"></a></var><br>
<blockquote><p>The prefix of the parser class name <var>prefix</var><code>Parser</code> if
<code>%define parser_class_name</code> is not used.  Default is <code>YY</code>. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%parse-param</b><var> {type name}<a name="index-_0025parse_002dparam-454"></a></var><br>
<blockquote><p>A parameter for the parser class added as parameters to constructor(s)
and as fields initialized by the constructor(s).  Default is none. 
See <a href="#Java-Parser-Interface">Java Parser Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%token</b><var> &lt;type&gt; token <small class="dots">...</small><a name="index-_0025token-455"></a></var><br>
<blockquote><p>Declare tokens.  Note that the angle brackets enclose a Java <em>type</em>. 
See <a href="#Java-Semantic-Values">Java Semantic Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%type</b><var> &lt;type&gt; nonterminal <small class="dots">...</small><a name="index-_0025type-456"></a></var><br>
<blockquote><p>Declare the type of nonterminals.  Note that the angle brackets enclose
a Java <em>type</em>. 
See <a href="#Java-Semantic-Values">Java Semantic Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%code</b><var> { code <small class="dots">...</small> }<a name="index-_0025code-457"></a></var><br>
<blockquote><p>Code appended to the inside of the parser class. 
See <a href="#Java-Differences">Java Differences</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%code imports</b><var> { code <small class="dots">...</small> }<a name="index-_0025code-imports-458"></a></var><br>
<blockquote><p>Code inserted just after the <code>package</code> declaration. 
See <a href="#Java-Differences">Java Differences</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%code lexer</b><var> { code <small class="dots">...</small> }<a name="index-_0025code-lexer-459"></a></var><br>
<blockquote><p>Code added to the body of a inner lexer class within the parser class. 
See <a href="#Java-Scanner-Interface">Java Scanner Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%%</b><var> code <small class="dots">...</small><a name="index-_0025_0025-460"></a></var><br>
<blockquote><p>Code (after the second <code>%%</code>) appended to the end of the file,
<em>outside</em> the parser class. 
See <a href="#Java-Differences">Java Differences</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%</b><var>{ code <small class="dots">...</small> %}<a name="index-_0025-461"></a></var><br>
<blockquote><p>Not supported.  Use <code>%code import</code> instead. 
See <a href="#Java-Differences">Java Differences</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define abstract</b><var><a name="index-_0025define-abstract-462"></a></var><br>
<blockquote><p>Whether the parser class is declared <code>abstract</code>.  Default is false. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define extends</b><var> "superclass"<a name="index-_0025define-extends-463"></a></var><br>
<blockquote><p>The superclass of the parser class.  Default is none. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define final</b><var><a name="index-_0025define-final-464"></a></var><br>
<blockquote><p>Whether the parser class is declared <code>final</code>.  Default is false. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define implements</b><var> "interfaces"<a name="index-_0025define-implements-465"></a></var><br>
<blockquote><p>The implemented interfaces of the parser class, a comma-separated list. 
Default is none. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define lex_throws</b><var> "exceptions"<a name="index-_0025define-lex_005fthrows-466"></a></var><br>
<blockquote><p>The exceptions thrown by the <code>yylex</code> method of the lexer, a
comma-separated list.  Default is <code>java.io.IOException</code>. 
See <a href="#Java-Scanner-Interface">Java Scanner Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define location_type</b><var> "class"<a name="index-_0025define-location_005ftype-467"></a></var><br>
<blockquote><p>The name of the class used for locations (a range between two
positions).  This class is generated as an inner class of the parser
class by <span class="command">bison</span>.  Default is <code>Location</code>. 
See <a href="#Java-Location-Values">Java Location Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define package</b><var> "package"<a name="index-_0025define-package-468"></a></var><br>
<blockquote><p>The package to put the parser class in.  Default is none. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define parser_class_name</b><var> "name"<a name="index-_0025define-parser_005fclass_005fname-469"></a></var><br>
<blockquote><p>The name of the parser class.  Default is <code>YYParser</code> or
<var>name-prefix</var><code>Parser</code>. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define position_type</b><var> "class"<a name="index-_0025define-position_005ftype-470"></a></var><br>
<blockquote><p>The name of the class used for positions. This class must be supplied by
the user.  Default is <code>Position</code>. 
See <a href="#Java-Location-Values">Java Location Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define public</b><var><a name="index-_0025define-public-471"></a></var><br>
<blockquote><p>Whether the parser class is declared <code>public</code>.  Default is false. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define stype</b><var> "class"<a name="index-_0025define-stype-472"></a></var><br>
<blockquote><p>The base type of semantic values.  Default is <code>Object</code>. 
See <a href="#Java-Semantic-Values">Java Semantic Values</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define strictfp</b><var><a name="index-_0025define-strictfp-473"></a></var><br>
<blockquote><p>Whether the parser class is declared <code>strictfp</code>.  Default is false. 
See <a href="#Java-Bison-Interface">Java Bison Interface</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define throws</b><var> "exceptions"<a name="index-_0025define-throws-474"></a></var><br>
<blockquote><p>The exceptions thrown by user-supplied parser actions and
<code>%initial-action</code>, a comma-separated list.  Default is none. 
See <a href="#Java-Parser-Interface">Java Parser Interface</a>. 
</p></blockquote></div>

<!-- ================================================= FAQ -->
<div class="node">
<p><hr>
<a name="FAQ"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Table-of-Symbols">Table of Symbols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-Languages">Other Languages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">11 Frequently Asked Questions</h2>

<p><a name="index-frequently-asked-questions-475"></a><a name="index-questions-476"></a>
Several questions about Bison come up occasionally.  Here some of them
are addressed.

<ul class="menu">
<li><a accesskey="1" href="#Memory-Exhausted">Memory Exhausted</a>:             Breaking the Stack Limits
<li><a accesskey="2" href="#How-Can-I-Reset-the-Parser">How Can I Reset the Parser</a>:   <code>yyparse</code> Keeps some State
<li><a accesskey="3" href="#Strings-are-Destroyed">Strings are Destroyed</a>:        <code>yylval</code> Loses Track of Strings
<li><a accesskey="4" href="#Implementing-Gotos_002fLoops">Implementing Gotos/Loops</a>:     Control Flow in the Calculator
<li><a accesskey="5" href="#Multiple-start_002dsymbols">Multiple start-symbols</a>:       Factoring closely related grammars
<li><a accesskey="6" href="#Secure_003f-Conform_003f">Secure?  Conform?</a>:            Is Bison <acronym>POSIX</acronym> safe? 
<li><a accesskey="7" href="#I-can_0027t-build-Bison">I can't build Bison</a>:          Troubleshooting
<li><a accesskey="8" href="#Where-can-I-find-help_003f">Where can I find help?</a>:       Troubleshouting
<li><a accesskey="9" href="#Bug-Reports">Bug Reports</a>:                  Troublereporting
<li><a href="#More-Languages">More Languages</a>:               Parsers in C++, Java, and so on
<li><a href="#Beta-Testing">Beta Testing</a>:                 Experimenting development versions
<li><a href="#Mailing-Lists">Mailing Lists</a>:                Meeting other Bison users
</ul>

<div class="node">
<p><hr>
<a name="Memory-Exhausted"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#How-Can-I-Reset-the-Parser">How Can I Reset the Parser</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.1 Memory Exhausted</h3>

<pre class="display">     My parser returns with error with a <span class="samp">memory exhausted</span>
     message.  What can I do?
</pre>
   <p>This question is already addressed elsewhere, See <a href="#Recursion">Recursive Rules</a>.

<div class="node">
<p><hr>
<a name="How-Can-I-Reset-the-Parser"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Strings-are-Destroyed">Strings are Destroyed</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Memory-Exhausted">Memory Exhausted</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.2 How Can I Reset the Parser</h3>

<p>The following phenomenon has several symptoms, resulting in the
following typical questions:

<pre class="display">     I invoke <code>yyparse</code> several times, and on correct input it works
     properly; but when a parse error is found, all the other calls fail
     too.  How can I reset the error flag of <code>yyparse</code>?
</pre>
   <p class="noindent">or

<pre class="display">     My parser includes support for an <span class="samp">#include</span>-like feature, in
     which case I run <code>yyparse</code> from <code>yyparse</code>.  This fails
     although I did specify <code>%define api.pure</code>.
</pre>
   <p>These problems typically come not from Bison itself, but from
Lex-generated scanners.  Because these scanners use large buffers for
speed, they might not notice a change of input file.  As a
demonstration, consider the following source file,
<span class="file">first-line.l</span>:

<pre class="verbatim">
%{
#include &lt;stdio.h>
#include &lt;stdlib.h>
%}
%%
.*\n    ECHO; return 1;
%%
int
yyparse (char const *file)
{
  yyin = fopen (file, "r");
  if (!yyin)
    exit (2);
  /* One token only.  */
  yylex ();
  if (fclose (yyin) != 0)
    exit (3);
  return 0;
}

int
main (void)
{
  yyparse ("input");
  yyparse ("input");
  return 0;
}
</pre>

<p class="noindent">If the file <span class="file">input</span> contains

<pre class="verbatim">
input:1: Hello,
input:2: World!
</pre>

<p class="noindent">then instead of getting the first line twice, you get:

<pre class="example">     $ <kbd>flex -ofirst-line.c first-line.l</kbd>
     $ <kbd>gcc  -ofirst-line   first-line.c -ll</kbd>
     $ <kbd>./first-line</kbd>
     input:1: Hello,
     input:2: World!
</pre>
   <p>Therefore, whenever you change <code>yyin</code>, you must tell the
Lex-generated scanner to discard its current buffer and switch to the
new one.  This depends upon your implementation of Lex; see its
documentation for more.  For Flex, it suffices to call
<span class="samp">YY_FLUSH_BUFFER</span> after each change to <code>yyin</code>.  If your
Flex-generated scanner needs to read from several input streams to
handle features like include files, you might consider using Flex
functions like <span class="samp">yy_switch_to_buffer</span> that manipulate multiple
input buffers.

   <p>If your Flex-generated scanner uses start conditions (see <a href="flex.html#Start-conditions">Start conditions (The Flex Manual)</a>), you might
also want to reset the scanner's state, i.e., go back to the initial
start condition, through a call to <span class="samp">BEGIN (0)</span>.

<div class="node">
<p><hr>
<a name="Strings-are-Destroyed"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Implementing-Gotos_002fLoops">Implementing Gotos/Loops</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#How-Can-I-Reset-the-Parser">How Can I Reset the Parser</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.3 Strings are Destroyed</h3>

<pre class="display">     My parser seems to destroy old strings, or maybe it loses track of
     them.  Instead of reporting <span class="samp">"foo", "bar"</span>, it reports
     <span class="samp">"bar", "bar"</span>, or even <span class="samp">"foo\nbar", "bar"</span>.
</pre>
   <p>This error is probably the single most frequent &ldquo;bug report&rdquo; sent to
Bison lists, but is only concerned with a misunderstanding of the role
of the scanner.  Consider the following Lex code:

<pre class="verbatim">
%{
#include &lt;stdio.h>
char *yylval = NULL;
%}
%%
.*    yylval = yytext; return 1;
\n    /* IGNORE */
%%
int
main ()
{
  /* Similar to using $1, $2 in a Bison action.  */
  char *fst = (yylex (), yylval);
  char *snd = (yylex (), yylval);
  printf ("\"%s\", \"%s\"\n", fst, snd);
  return 0;
}
</pre>

   <p>If you compile and run this code, you get:

<pre class="example">     $ <kbd>flex -osplit-lines.c split-lines.l</kbd>
     $ <kbd>gcc  -osplit-lines   split-lines.c -ll</kbd>
     $ <kbd>printf 'one\ntwo\n' | ./split-lines</kbd>
     "one
     two", "two"
</pre>
   <p class="noindent">this is because <code>yytext</code> is a buffer provided for <em>reading</em>
in the action, but if you want to keep it, you have to duplicate it
(e.g., using <code>strdup</code>).  Note that the output may depend on how
your implementation of Lex handles <code>yytext</code>.  For instance, when
given the Lex compatibility option <span class="option">-l</span> (which triggers the
option <span class="samp">%array</span>) Flex generates a different behavior:

<pre class="example">     $ <kbd>flex -l -osplit-lines.c split-lines.l</kbd>
     $ <kbd>gcc     -osplit-lines   split-lines.c -ll</kbd>
     $ <kbd>printf 'one\ntwo\n' | ./split-lines</kbd>
     "two", "two"
</pre>
   <div class="node">
<p><hr>
<a name="Implementing-Gotos_002fLoops"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Multiple-start_002dsymbols">Multiple start-symbols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Strings-are-Destroyed">Strings are Destroyed</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.4 Implementing Gotos/Loops</h3>

<pre class="display">     My simple calculator supports variables, assignments, and functions,
     but how can I implement gotos, or loops?
</pre>
   <p>Although very pedagogical, the examples included in the document blur
the distinction to make between the parser&mdash;whose job is to recover
the structure of a text and to transmit it to subsequent modules of
the program&mdash;and the processing (such as the execution) of this
structure.  This works well with so called straight line programs,
i.e., precisely those that have a straightforward execution model:
execute simple instructions one after the others.

   <p><a name="index-abstract-syntax-tree-477"></a><a name="index-_0040acronym_007bAST_007d-478"></a>If you want a richer model, you will probably need to use the parser
to construct a tree that does represent the structure it has
recovered; this tree is usually called the <dfn>abstract syntax tree</dfn>,
or <dfn><acronym>AST</acronym></dfn> for short.  Then, walking through this tree,
traversing it in various ways, will enable treatments such as its
execution or its translation, which will result in an interpreter or a
compiler.

   <p>This topic is way beyond the scope of this manual, and the reader is
invited to consult the dedicated literature.

<div class="node">
<p><hr>
<a name="Multiple-start_002dsymbols"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Secure_003f-Conform_003f">Secure? Conform?</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Implementing-Gotos_002fLoops">Implementing Gotos/Loops</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.5 Multiple start-symbols</h3>

<pre class="display">     I have several closely related grammars, and I would like to share their
     implementations.  In fact, I could use a single grammar but with
     multiple entry points.
</pre>
   <p>Bison does not support multiple start-symbols, but there is a very
simple means to simulate them.  If <code>foo</code> and <code>bar</code> are the two
pseudo start-symbols, then introduce two new tokens, say
<code>START_FOO</code> and <code>START_BAR</code>, and use them as switches from the
real start-symbol:

<pre class="example">     %token START_FOO START_BAR;
     %start start;
     start: START_FOO foo
          | START_BAR bar;
</pre>
   <p>These tokens prevents the introduction of new conflicts.  As far as the
parser goes, that is all that is needed.

   <p>Now the difficult part is ensuring that the scanner will send these
tokens first.  If your scanner is hand-written, that should be
straightforward.  If your scanner is generated by Lex, them there is
simple means to do it: recall that anything between <span class="samp">%{ ... %}</span>
after the first <code>%%</code> is copied verbatim in the top of the generated
<code>yylex</code> function.  Make sure a variable <code>start_token</code> is
available in the scanner (e.g., a global variable or using
<code>%lex-param</code> etc.), and use the following:

<pre class="example">       /* <span class="roman">Prologue.</span>  */
     %%
     %{
       if (start_token)
         {
           int t = start_token;
           start_token = 0;
           return t;
         }
     %}
       /* <span class="roman">The rules.</span>  */
</pre>
   <div class="node">
<p><hr>
<a name="Secure_003f-Conform_003f"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#I-can_0027t-build-Bison">I can't build Bison</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multiple-start_002dsymbols">Multiple start-symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.6 Secure?  Conform?</h3>

<pre class="display">     Is Bison secure?  Does it conform to POSIX?
</pre>
   <p>If you're looking for a guarantee or certification, we don't provide it. 
However, Bison is intended to be a reliable program that conforms to the
<acronym>POSIX</acronym> specification for Yacc.  If you run into problems,
please send us a bug report.

<div class="node">
<p><hr>
<a name="I-can_0027t-build-Bison"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Where-can-I-find-help_003f">Where can I find help?</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Secure_003f-Conform_003f">Secure? Conform?</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.7 I can't build Bison</h3>

<pre class="display">     I can't build Bison because <span class="command">make</span> complains that
     <code>msgfmt</code> is not found.
     What should I do?
</pre>
   <p>Like most GNU packages with internationalization support, that feature
is turned on by default.  If you have problems building in the <span class="file">po</span>
subdirectory, it indicates that your system's internationalization
support is lacking.  You can re-configure Bison with
<span class="option">--disable-nls</span> to turn off this support, or you can install GNU
gettext from <a href="ftp://ftp.gnu.org/gnu/gettext/">ftp://ftp.gnu.org/gnu/gettext/</a> and re-configure
Bison.  See the file <span class="file">ABOUT-NLS</span> for more information.

<div class="node">
<p><hr>
<a name="Where-can-I-find-help_003f"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Bug-Reports">Bug Reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#I-can_0027t-build-Bison">I can't build Bison</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.8 Where can I find help?</h3>

<pre class="display">     I'm having trouble using Bison.  Where can I find help?
</pre>
   <p>First, read this fine manual.  Beyond that, you can send mail to
<a href="mailto:help-bison@gnu.org">help-bison@gnu.org</a>.  This mailing list is intended to be
populated with people who are willing to answer questions about using
and installing Bison.  Please keep in mind that (most of) the people on
the list have aspects of their lives which are not related to Bison (!),
so you may not receive an answer to your question right away.  This can
be frustrating, but please try not to honk them off; remember that any
help they provide is purely voluntary and out of the kindness of their
hearts.

<div class="node">
<p><hr>
<a name="Bug-Reports"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#More-Languages">More Languages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Where-can-I-find-help_003f">Where can I find help?</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.9 Bug Reports</h3>

<pre class="display">     I found a bug.  What should I include in the bug report?
</pre>
   <p>Before you send a bug report, make sure you are using the latest
version.  Check <a href="ftp://ftp.gnu.org/pub/gnu/bison/">ftp://ftp.gnu.org/pub/gnu/bison/</a> or one of its
mirrors.  Be sure to include the version number in your bug report.  If
the bug is present in the latest version but not in a previous version,
try to determine the most recent version which did not contain the bug.

   <p>If the bug is parser-related, you should include the smallest grammar
you can which demonstrates the bug.  The grammar file should also be
complete (i.e., I should be able to run it through Bison without having
to edit or add anything).  The smaller and simpler the grammar, the
easier it will be to fix the bug.

   <p>Include information about your compilation environment, including your
operating system's name and version and your compiler's name and
version.  If you have trouble compiling, you should also include a
transcript of the build session, starting with the invocation of
`configure'.  Depending on the nature of the bug, you may be asked to
send additional files as well (such as `config.h' or `config.cache').

   <p>Patches are most welcome, but not required.  That is, do not hesitate to
send a bug report just because you can not provide a fix.

   <p>Send bug reports to <a href="mailto:bug-bison@gnu.org">bug-bison@gnu.org</a>.

<div class="node">
<p><hr>
<a name="More-Languages"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Beta-Testing">Beta Testing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bug-Reports">Bug Reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.10 More Languages</h3>

<pre class="display">     Will Bison ever have C++ and Java support?  How about <var>insert your
     favorite language here</var>?
</pre>
   <p>C++ and Java support is there now, and is documented.  We'd love to add other
languages; contributions are welcome.

<div class="node">
<p><hr>
<a name="Beta-Testing"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Mailing-Lists">Mailing Lists</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#More-Languages">More Languages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.11 Beta Testing</h3>

<pre class="display">     What is involved in being a beta tester?
</pre>
   <p>It's not terribly involved.  Basically, you would download a test
release, compile it, and use it to build and run a parser or two.  After
that, you would submit either a bug report or a message saying that
everything is okay.  It is important to report successes as well as
failures because test releases eventually become mainstream releases,
but only if they are adequately tested.  If no one tests, development is
essentially halted.

   <p>Beta testers are particularly needed for operating systems to which the
developers do not have easy access.  They currently have easy access to
recent GNU/Linux and Solaris versions.  Reports about other operating
systems are especially welcome.

<div class="node">
<p><hr>
<a name="Mailing-Lists"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Beta-Testing">Beta Testing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#FAQ">FAQ</a>
<br>
</div>

<h3 class="section">11.12 Mailing Lists</h3>

<pre class="display">     How do I join the help-bison and bug-bison mailing lists?
</pre>
   <p>See <a href="http://lists.gnu.org/">http://lists.gnu.org/</a>.

<!-- ================================================= Table of Symbols -->
<div class="node">
<p><hr>
<a name="Table-of-Symbols"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Glossary">Glossary</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#FAQ">FAQ</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix A Bison Symbols</h2>

<p><a name="index-Bison-symbols_002c-table-of-479"></a><a name="index-symbols-in-Bison_002c-table-of-480"></a>

<div class="defun">
&mdash; Variable: <b>@$</b><var><a name="index-_0040_0040_0024-481"></a></var><br>
<blockquote><p>In an action, the location of the left-hand side of the rule. 
See <a href="#Locations">Locations Overview</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>@</b><var>n</var><var><a name="index-_0040_0040_0040var_007bn_007d-482"></a></var><br>
<blockquote><p>In an action, the location of the <var>n</var>-th symbol of the right-hand
side of the rule.  See <a href="#Locations">Locations Overview</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$$</b><var><a name="index-_0024_0024-483"></a></var><br>
<blockquote><p>In an action, the semantic value of the left-hand side of the rule. 
See <a href="#Actions">Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>$</b><var>n<a name="index-_0024-484"></a></var><br>
<blockquote><p>In an action, the semantic value of the <var>n</var>-th symbol of the
right-hand side of the rule.  See <a href="#Actions">Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Delimiter: <b>%%</b><var><a name="index-_0025_0025-485"></a></var><br>
<blockquote><p>Delimiter used to separate the grammar rule section from the
Bison declarations section or the epilogue. 
See <a href="#Grammar-Layout">The Overall Layout of a Bison Grammar</a>. 
</p></blockquote></div>

<!-- Don't insert spaces, or check the DVI output. -->
<div class="defun">
&mdash; Delimiter: <b>%</b><var>{code%}<a name="index-_0025-486"></a></var><br>
<blockquote><p>All code listed between <span class="samp">%{</span> and <span class="samp">%}</span> is copied directly to
the output file uninterpreted.  Such code forms the prologue of the input
file.  See <a href="#Grammar-Outline">Outline of a Bison Grammar</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Construct: <b>/*</b><var><small class="dots">...</small>*/<a name="index-_002f_002a-487"></a></var><br>
<blockquote><p>Comment delimiters, as in C. 
</p></blockquote></div>

<div class="defun">
&mdash; Delimiter: <b>:</b><var><a name="index-_003a-488"></a></var><br>
<blockquote><p>Separates a rule's result from its components.  See <a href="#Rules">Syntax of Grammar Rules</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Delimiter: <b>;</b><var><a name="index-_003b-489"></a></var><br>
<blockquote><p>Terminates a rule.  See <a href="#Rules">Syntax of Grammar Rules</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Delimiter: <b>|</b><var><a name="index-_007c-490"></a></var><br>
<blockquote><p>Separates alternate rules for the same result nonterminal. 
See <a href="#Rules">Syntax of Grammar Rules</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>&lt;*&gt;</b><var><a name="index-_003c_002a_003e-491"></a></var><br>
<blockquote><p>Used to define a default tagged <code>%destructor</code> or default tagged
<code>%printer</code>.

        <p>This feature is experimental. 
More user feedback will help to determine whether it should become a permanent
feature.

        <p>See <a href="#Destructor-Decl">Freeing Discarded Symbols</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>&lt;&gt;</b><var><a name="index-_003c_003e-492"></a></var><br>
<blockquote><p>Used to define a default tagless <code>%destructor</code> or default tagless
<code>%printer</code>.

        <p>This feature is experimental. 
More user feedback will help to determine whether it should become a permanent
feature.

        <p>See <a href="#Destructor-Decl">Freeing Discarded Symbols</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Symbol: <b>$accept</b><var><a name="index-_0024accept-493"></a></var><br>
<blockquote><p>The predefined nonterminal whose only rule is <span class="samp">$accept: </span><var>start</var><span class="samp">
$end</span>, where <var>start</var> is the start symbol.  See <a href="#Start-Decl">The Start-Symbol</a>.  It cannot be used in the grammar. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%code</b><var> {code}<a name="index-_0025code-494"></a></var><br>
&mdash; Directive: <b>%code</b><var> qualifier {code}<a name="index-_0025code-495"></a></var><br>
<blockquote><p>Insert <var>code</var> verbatim into output parser source. 
See <a href="#Decl-Summary">%code</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%debug</b><var><a name="index-_0025debug-496"></a></var><br>
<blockquote><p>Equip the parser for debugging.  See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%debug</b><var><a name="index-_0025debug-497"></a></var><br>
<blockquote><p>Equip the parser for debugging.  See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%define</b><var> define-variable<a name="index-_0025define-498"></a></var><br>
&mdash; Directive: <b>%define</b><var> define-variable value<a name="index-_0025define-499"></a></var><br>
<blockquote><p>Define a variable to adjust Bison's behavior. 
See <a href="#Decl-Summary">%define</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%defines</b><var><a name="index-_0025defines-500"></a></var><br>
<blockquote><p>Bison declaration to create a header file meant for the scanner. 
See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%defines</b><var> defines-file<a name="index-_0025defines-501"></a></var><br>
<blockquote><p>Same as above, but save in the file <var>defines-file</var>. 
See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%destructor</b><var><a name="index-_0025destructor-502"></a></var><br>
<blockquote><p>Specify how the parser should reclaim the memory associated to
discarded symbols.  See <a href="#Destructor-Decl">Freeing Discarded Symbols</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%dprec</b><var><a name="index-_0025dprec-503"></a></var><br>
<blockquote><p>Bison declaration to assign a precedence to a rule that is used at parse
time to resolve reduce/reduce conflicts.  See <a href="#GLR-Parsers">Writing <acronym>GLR</acronym> Parsers</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Symbol: <b>$end</b><var><a name="index-_0024end-504"></a></var><br>
<blockquote><p>The predefined token marking the end of the token stream.  It cannot be
used in the grammar. 
</p></blockquote></div>

<div class="defun">
&mdash; Symbol: <b>error</b><var><a name="index-error-505"></a></var><br>
<blockquote><p>A token name reserved for error recovery.  This token may be used in
grammar rules so as to allow the Bison parser to recognize an error in
the grammar without halting the process.  In effect, a sentence
containing an error may be recognized as valid.  On a syntax error, the
token <code>error</code> becomes the current lookahead token.  Actions
corresponding to <code>error</code> are then executed, and the lookahead
token is reset to the token that originally caused the violation. 
See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%error-verbose</b><var><a name="index-_0025error_002dverbose-506"></a></var><br>
<blockquote><p>Bison declaration to request verbose, specific error message strings
when <code>yyerror</code> is called. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%file-prefix</b><var> "prefix"<a name="index-_0025file_002dprefix-507"></a></var><br>
<blockquote><p>Bison declaration to set the prefix of the output files.  See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%glr-parser</b><var><a name="index-_0025glr_002dparser-508"></a></var><br>
<blockquote><p>Bison declaration to produce a <acronym>GLR</acronym> parser.  See <a href="#GLR-Parsers">Writing <acronym>GLR</acronym> Parsers</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%initial-action</b><var><a name="index-_0025initial_002daction-509"></a></var><br>
<blockquote><p>Run user code before parsing.  See <a href="#Initial-Action-Decl">Performing Actions before Parsing</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%language</b><var><a name="index-_0025language-510"></a></var><br>
<blockquote><p>Specify the programming language for the generated parser. 
See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%left</b><var><a name="index-_0025left-511"></a></var><br>
<blockquote><p>Bison declaration to assign left associativity to token(s). 
See <a href="#Precedence-Decl">Operator Precedence</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%lex-param</b><var> {argument-declaration}<a name="index-_0025lex_002dparam-512"></a></var><br>
<blockquote><p>Bison declaration to specifying an additional parameter that
<code>yylex</code> should accept.  See <a href="#Pure-Calling">Calling Conventions for Pure Parsers</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%merge</b><var><a name="index-_0025merge-513"></a></var><br>
<blockquote><p>Bison declaration to assign a merging function to a rule.  If there is a
reduce/reduce conflict with a rule having the same merging function, the
function is applied to the two semantic values to get a single result. 
See <a href="#GLR-Parsers">Writing <acronym>GLR</acronym> Parsers</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%name-prefix</b><var> "prefix"<a name="index-_0025name_002dprefix-514"></a></var><br>
<blockquote><p>Bison declaration to rename the external symbols.  See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%no-lines</b><var><a name="index-_0025no_002dlines-515"></a></var><br>
<blockquote><p>Bison declaration to avoid generating <code>#line</code> directives in the
parser file.  See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%nonassoc</b><var><a name="index-_0025nonassoc-516"></a></var><br>
<blockquote><p>Bison declaration to assign nonassociativity to token(s). 
See <a href="#Precedence-Decl">Operator Precedence</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%output</b><var> "file"<a name="index-_0025output-517"></a></var><br>
<blockquote><p>Bison declaration to set the name of the parser file.  See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%parse-param</b><var> {argument-declaration}<a name="index-_0025parse_002dparam-518"></a></var><br>
<blockquote><p>Bison declaration to specifying an additional parameter that
<code>yyparse</code> should accept.  See <a href="#Parser-Function">The Parser Function <code>yyparse</code></a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%prec</b><var><a name="index-_0025prec-519"></a></var><br>
<blockquote><p>Bison declaration to assign a precedence to a specific rule. 
See <a href="#Contextual-Precedence">Context-Dependent Precedence</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%pure-parser</b><var><a name="index-_0025pure_002dparser-520"></a></var><br>
<blockquote><p>Deprecated version of <code>%define api.pure</code> (see <a href="#Decl-Summary">%define</a>),
for which Bison is more careful to warn about unreasonable usage. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%require</b><var> "version"<a name="index-_0025require-521"></a></var><br>
<blockquote><p>Require version <var>version</var> or higher of Bison.  See <a href="#Require-Decl">Require a Version of Bison</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%right</b><var><a name="index-_0025right-522"></a></var><br>
<blockquote><p>Bison declaration to assign right associativity to token(s). 
See <a href="#Precedence-Decl">Operator Precedence</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%skeleton</b><var><a name="index-_0025skeleton-523"></a></var><br>
<blockquote><p>Specify the skeleton to use; usually for development. 
See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%start</b><var><a name="index-_0025start-524"></a></var><br>
<blockquote><p>Bison declaration to specify the start symbol.  See <a href="#Start-Decl">The Start-Symbol</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%token</b><var><a name="index-_0025token-525"></a></var><br>
<blockquote><p>Bison declaration to declare token(s) without specifying precedence. 
See <a href="#Token-Decl">Token Type Names</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%token-table</b><var><a name="index-_0025token_002dtable-526"></a></var><br>
<blockquote><p>Bison declaration to include a token name table in the parser file. 
See <a href="#Decl-Summary">Decl Summary</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%type</b><var><a name="index-_0025type-527"></a></var><br>
<blockquote><p>Bison declaration to declare nonterminals.  See <a href="#Type-Decl">Nonterminal Symbols</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Symbol: <b>$undefined</b><var><a name="index-_0024undefined-528"></a></var><br>
<blockquote><p>The predefined token onto which all undefined values returned by
<code>yylex</code> are mapped.  It cannot be used in the grammar, rather, use
<code>error</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Directive: <b>%union</b><var><a name="index-_0025union-529"></a></var><br>
<blockquote><p>Bison declaration to specify several possible data types for semantic
values.  See <a href="#Union-Decl">The Collection of Value Types</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYABORT</b><var><a name="index-YYABORT-530"></a></var><br>
<blockquote><p>Macro to pretend that an unrecoverable syntax error has occurred, by
making <code>yyparse</code> return 1 immediately.  The error reporting
function <code>yyerror</code> is not called.  See <a href="#Parser-Function">The Parser Function <code>yyparse</code></a>.

        <p>For Java parsers, this functionality is invoked using <code>return YYABORT;</code>
instead. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYACCEPT</b><var><a name="index-YYACCEPT-531"></a></var><br>
<blockquote><p>Macro to pretend that a complete utterance of the language has been
read, by making <code>yyparse</code> return 0 immediately. 
See <a href="#Parser-Function">The Parser Function <code>yyparse</code></a>.

        <p>For Java parsers, this functionality is invoked using <code>return YYACCEPT;</code>
instead. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYBACKUP</b><var><a name="index-YYBACKUP-532"></a></var><br>
<blockquote><p>Macro to discard a value from the parser stack and fake a lookahead
token.  See <a href="#Action-Features">Special Features for Use in Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yychar</b><var><a name="index-yychar-533"></a></var><br>
<blockquote><p>External integer variable that contains the integer value of the
lookahead token.  (In a pure parser, it is a local variable within
<code>yyparse</code>.)  Error-recovery rule actions may examine this variable. 
See <a href="#Action-Features">Special Features for Use in Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yyclearin</b><var><a name="index-yyclearin-534"></a></var><br>
<blockquote><p>Macro used in error-recovery rule actions.  It clears the previous
lookahead token.  See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYDEBUG</b><var><a name="index-YYDEBUG-535"></a></var><br>
<blockquote><p>Macro to define to equip the parser with tracing code.  See <a href="#Tracing">Tracing Your Parser</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yydebug</b><var><a name="index-yydebug-536"></a></var><br>
<blockquote><p>External integer variable set to zero by default.  If <code>yydebug</code>
is given a nonzero value, the parser will output information on input
symbols and parser action.  See <a href="#Tracing">Tracing Your Parser</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>yyerrok</b><var><a name="index-yyerrok-537"></a></var><br>
<blockquote><p>Macro to cause parser to recover immediately to its normal mode
after a syntax error.  See <a href="#Error-Recovery">Error Recovery</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYERROR</b><var><a name="index-YYERROR-538"></a></var><br>
<blockquote><p>Macro to pretend that a syntax error has just been detected: call
<code>yyerror</code> and then perform normal error recovery if possible
(see <a href="#Error-Recovery">Error Recovery</a>), or (if recovery is impossible) make
<code>yyparse</code> return 1.  See <a href="#Error-Recovery">Error Recovery</a>.

        <p>For Java parsers, this functionality is invoked using <code>return YYERROR;</code>
instead. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>yyerror</b><var><a name="index-yyerror-539"></a></var><br>
<blockquote><p>User-supplied function to be called by <code>yyparse</code> on error. 
See <a href="#Error-Reporting">The Error Reporting Function <code>yyerror</code></a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYERROR_VERBOSE</b><var><a name="index-YYERROR_005fVERBOSE-540"></a></var><br>
<blockquote><p>An obsolete macro that you define with <code>#define</code> in the prologue
to request verbose, specific error message strings
when <code>yyerror</code> is called.  It doesn't matter what definition you
use for <code>YYERROR_VERBOSE</code>, just whether you define it.  Using
<code>%error-verbose</code> is preferred. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYINITDEPTH</b><var><a name="index-YYINITDEPTH-541"></a></var><br>
<blockquote><p>Macro for specifying the initial size of the parser stack. 
See <a href="#Memory-Management">Memory Management</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>yylex</b><var><a name="index-yylex-542"></a></var><br>
<blockquote><p>User-supplied lexical analyzer function, called with no arguments to get
the next token.  See <a href="#Lexical">The Lexical Analyzer Function <code>yylex</code></a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYLEX_PARAM</b><var><a name="index-YYLEX_005fPARAM-543"></a></var><br>
<blockquote><p>An obsolete macro for specifying an extra argument (or list of extra
arguments) for <code>yyparse</code> to pass to <code>yylex</code>.  The use of this
macro is deprecated, and is supported only for Yacc like parsers. 
See <a href="#Pure-Calling">Calling Conventions for Pure Parsers</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yylloc</b><var><a name="index-yylloc-544"></a></var><br>
<blockquote><p>External variable in which <code>yylex</code> should place the line and column
numbers associated with a token.  (In a pure parser, it is a local
variable within <code>yyparse</code>, and its address is passed to
<code>yylex</code>.) 
You can ignore this variable if you don't use the <span class="samp">@</span> feature in the
grammar actions. 
See <a href="#Token-Locations">Textual Locations of Tokens</a>. 
In semantic actions, it stores the location of the lookahead token. 
See <a href="#Actions-and-Locations">Actions and Locations</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: <b>YYLTYPE</b><var><a name="index-YYLTYPE-545"></a></var><br>
<blockquote><p>Data type of <code>yylloc</code>; by default, a structure with four
members.  See <a href="#Location-Type">Data Types of Locations</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yylval</b><var><a name="index-yylval-546"></a></var><br>
<blockquote><p>External variable in which <code>yylex</code> should place the semantic
value associated with a token.  (In a pure parser, it is a local
variable within <code>yyparse</code>, and its address is passed to
<code>yylex</code>.) 
See <a href="#Token-Values">Semantic Values of Tokens</a>. 
In semantic actions, it stores the semantic value of the lookahead token. 
See <a href="#Actions">Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYMAXDEPTH</b><var><a name="index-YYMAXDEPTH-547"></a></var><br>
<blockquote><p>Macro for specifying the maximum size of the parser stack.  See <a href="#Memory-Management">Memory Management</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>yynerrs</b><var><a name="index-yynerrs-548"></a></var><br>
<blockquote><p>Global variable which Bison increments each time it reports a syntax error. 
(In a pure parser, it is a local variable within <code>yyparse</code>. In a
pure push parser, it is a member of yypstate.) 
See <a href="#Error-Reporting">The Error Reporting Function <code>yyerror</code></a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>yyparse</b><var><a name="index-yyparse-549"></a></var><br>
<blockquote><p>The parser function produced by Bison; call this function to start
parsing.  See <a href="#Parser-Function">The Parser Function <code>yyparse</code></a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>yypstate_delete</b><var><a name="index-yypstate_005fdelete-550"></a></var><br>
<blockquote><p>The function to delete a parser instance, produced by Bison in push mode;
call this function to delete the memory associated with a parser. 
See <a href="#Parser-Delete-Function">The Parser Delete Function <code>yypstate_delete</code></a>. 
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.) 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>yypstate_new</b><var><a name="index-yypstate_005fnew-551"></a></var><br>
<blockquote><p>The function to create a parser instance, produced by Bison in push mode;
call this function to create a new parser. 
See <a href="#Parser-Create-Function">The Parser Create Function <code>yypstate_new</code></a>. 
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.) 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>yypull_parse</b><var><a name="index-yypull_005fparse-552"></a></var><br>
<blockquote><p>The parser function produced by Bison in push mode; call this function to
parse the rest of the input stream. 
See <a href="#Pull-Parser-Function">The Pull Parser Function <code>yypull_parse</code></a>. 
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.) 
</p></blockquote></div>

<div class="defun">
&mdash; Function: <b>yypush_parse</b><var><a name="index-yypush_005fparse-553"></a></var><br>
<blockquote><p>The parser function produced by Bison in push mode; call this function to
parse a single token.  See <a href="#Push-Parser-Function">The Push Parser Function <code>yypush_parse</code></a>. 
(The current push parsing interface is experimental and may evolve. 
More user feedback will help to stabilize it.) 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYPARSE_PARAM</b><var><a name="index-YYPARSE_005fPARAM-554"></a></var><br>
<blockquote><p>An obsolete macro for specifying the name of a parameter that
<code>yyparse</code> should accept.  The use of this macro is deprecated, and
is supported only for Yacc like parsers.  See <a href="#Pure-Calling">Calling Conventions for Pure Parsers</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYRECOVERING</b><var><a name="index-YYRECOVERING-555"></a></var><br>
<blockquote><p>The expression <code>YYRECOVERING ()</code> yields 1 when the parser
is recovering from a syntax error, and 0 otherwise. 
See <a href="#Action-Features">Special Features for Use in Actions</a>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>YYSTACK_USE_ALLOCA</b><var><a name="index-YYSTACK_005fUSE_005fALLOCA-556"></a></var><br>
<blockquote><p>Macro used to control the use of <code>alloca</code> when the C
<acronym>LALR</acronym>(1) parser needs to extend its stacks.  If defined to 0,
the parser will use <code>malloc</code> to extend its stacks.  If defined to
1, the parser will use <code>alloca</code>.  Values other than 0 and 1 are
reserved for future Bison extensions.  If not defined,
<code>YYSTACK_USE_ALLOCA</code> defaults to 0.

        <p>In the all-too-common case where your code may run on a host with a
limited stack and with unreliable stack-overflow checking, you should
set <code>YYMAXDEPTH</code> to a value that cannot possibly result in
unchecked stack overflow on any of your target hosts when
<code>alloca</code> is called.  You can inspect the code that Bison
generates in order to determine the proper numeric values.  This will
require some expertise in low-level implementation details. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: <b>YYSTYPE</b><var><a name="index-YYSTYPE-557"></a></var><br>
<blockquote><p>Data type of semantic values; <code>int</code> by default. 
See <a href="#Value-Type">Data Types of Semantic Values</a>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Glossary"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Copying-This-Manual">Copying This Manual</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Table-of-Symbols">Table of Symbols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix B Glossary</h2>

<p><a name="index-glossary-558"></a>
     <dl>
<dt>Backus-Naur Form (<acronym>BNF</acronym>; also called &ldquo;Backus Normal Form&rdquo;)<dd>Formal method of specifying context-free grammars originally proposed
by John Backus, and slightly improved by Peter Naur in his 1960-01-02
committee document contributing to what became the Algol 60 report. 
See <a href="#Language-and-Grammar">Languages and Context-Free Grammars</a>.

     <br><dt>Context-free grammars<dd>Grammars specified as rules that can be applied regardless of context. 
Thus, if there is a rule which says that an integer can be used as an
expression, integers are allowed <em>anywhere</em> an expression is
permitted.  See <a href="#Language-and-Grammar">Languages and Context-Free Grammars</a>.

     <br><dt>Dynamic allocation<dd>Allocation of memory that occurs during execution, rather than at
compile time or on entry to a function.

     <br><dt>Empty string<dd>Analogous to the empty set in set theory, the empty string is a
character string of length zero.

     <br><dt>Finite-state stack machine<dd>A &ldquo;machine&rdquo; that has discrete states in which it is said to exist at
each instant in time.  As input to the machine is processed, the
machine moves from state to state as specified by the logic of the
machine.  In the case of the parser, the input is the language being
parsed, and the states correspond to various stages in the grammar
rules.  See <a href="#Algorithm">The Bison Parser Algorithm</a>.

     <br><dt>Generalized <acronym>LR</acronym> (<acronym>GLR</acronym>)<dd>A parsing algorithm that can handle all context-free grammars, including those
that are not <acronym>LALR</acronym>(1).  It resolves situations that Bison's
usual <acronym>LALR</acronym>(1)
algorithm cannot by effectively splitting off multiple parsers, trying all
possible parsers, and discarding those that fail in the light of additional
right context.  See <a href="#Generalized-LR-Parsing">Generalized <acronym>LR</acronym> Parsing</a>.

     <br><dt>Grouping<dd>A language construct that is (in general) grammatically divisible;
for example, `expression' or `declaration' in C. 
See <a href="#Language-and-Grammar">Languages and Context-Free Grammars</a>.

     <br><dt>Infix operator<dd>An arithmetic operator that is placed between the operands on which it
performs some operation.

     <br><dt>Input stream<dd>A continuous flow of data between devices or programs.

     <br><dt>Language construct<dd>One of the typical usage schemas of the language.  For example, one of
the constructs of the C language is the <code>if</code> statement. 
See <a href="#Language-and-Grammar">Languages and Context-Free Grammars</a>.

     <br><dt>Left associativity<dd>Operators having left associativity are analyzed from left to right:
<span class="samp">a+b+c</span> first computes <span class="samp">a+b</span> and then combines with
<span class="samp">c</span>.  See <a href="#Precedence">Operator Precedence</a>.

     <br><dt>Left recursion<dd>A rule whose result symbol is also its first component symbol; for
example, <span class="samp">expseq1 : expseq1 ',' exp;</span>.  See <a href="#Recursion">Recursive Rules</a>.

     <br><dt>Left-to-right parsing<dd>Parsing a sentence of a language by analyzing it token by token from
left to right.  See <a href="#Algorithm">The Bison Parser Algorithm</a>.

     <br><dt>Lexical analyzer (scanner)<dd>A function that reads an input stream and returns tokens one by one. 
See <a href="#Lexical">The Lexical Analyzer Function <code>yylex</code></a>.

     <br><dt>Lexical tie-in<dd>A flag, set by actions in the grammar rules, which alters the way
tokens are parsed.  See <a href="#Lexical-Tie_002dins">Lexical Tie-ins</a>.

     <br><dt>Literal string token<dd>A token which consists of two or more fixed characters.  See <a href="#Symbols">Symbols</a>.

     <br><dt>Lookahead token<dd>A token already read but not yet shifted.  See <a href="#Lookahead">Lookahead Tokens</a>.

     <br><dt><acronym>LALR</acronym>(1)<dd>The class of context-free grammars that Bison (like most other parser
generators) can handle; a subset of <acronym>LR</acronym>(1).  See <a href="#Mystery-Conflicts">Mysterious Reduce/Reduce Conflicts</a>.

     <br><dt><acronym>LR</acronym>(1)<dd>The class of context-free grammars in which at most one token of
lookahead is needed to disambiguate the parsing of any piece of input.

     <br><dt>Nonterminal symbol<dd>A grammar symbol standing for a grammatical construct that can
be expressed through rules in terms of smaller constructs; in other
words, a construct that is not a token.  See <a href="#Symbols">Symbols</a>.

     <br><dt>Parser<dd>A function that recognizes valid sentences of a language by analyzing
the syntax structure of a set of tokens passed to it from a lexical
analyzer.

     <br><dt>Postfix operator<dd>An arithmetic operator that is placed after the operands upon which it
performs some operation.

     <br><dt>Reduction<dd>Replacing a string of nonterminals and/or terminals with a single
nonterminal, according to a grammar rule.  See <a href="#Algorithm">The Bison Parser Algorithm</a>.

     <br><dt>Reentrant<dd>A reentrant subprogram is a subprogram which can be in invoked any
number of times in parallel, without interference between the various
invocations.  See <a href="#Pure-Decl">A Pure (Reentrant) Parser</a>.

     <br><dt>Reverse polish notation<dd>A language in which all operators are postfix operators.

     <br><dt>Right recursion<dd>A rule whose result symbol is also its last component symbol; for
example, <span class="samp">expseq1: exp ',' expseq1;</span>.  See <a href="#Recursion">Recursive Rules</a>.

     <br><dt>Semantics<dd>In computer languages, the semantics are specified by the actions
taken for each instance of the language, i.e., the meaning of
each statement.  See <a href="#Semantics">Defining Language Semantics</a>.

     <br><dt>Shift<dd>A parser is said to shift when it makes the choice of analyzing
further input from the stream rather than reducing immediately some
already-recognized rule.  See <a href="#Algorithm">The Bison Parser Algorithm</a>.

     <br><dt>Single-character literal<dd>A single character that is recognized and interpreted as is. 
See <a href="#Grammar-in-Bison">From Formal Rules to Bison Input</a>.

     <br><dt>Start symbol<dd>The nonterminal symbol that stands for a complete valid utterance in
the language being parsed.  The start symbol is usually listed as the
first nonterminal symbol in a language specification. 
See <a href="#Start-Decl">The Start-Symbol</a>.

     <br><dt>Symbol table<dd>A data structure where symbol names and associated data are stored
during parsing to allow for recognition and use of existing
information in repeated uses of a symbol.  See <a href="#Multi_002dfunction-Calc">Multi-function Calc</a>.

     <br><dt>Syntax error<dd>An error encountered during parsing of an input stream due to invalid
syntax.  See <a href="#Error-Recovery">Error Recovery</a>.

     <br><dt>Token<dd>A basic, grammatically indivisible unit of a language.  The symbol
that describes a token in the grammar is a terminal symbol. 
The input of the Bison parser is a stream of tokens which comes from
the lexical analyzer.  See <a href="#Symbols">Symbols</a>.

     <br><dt>Terminal symbol<dd>A grammar symbol that has no rules in the grammar and therefore is
grammatically indivisible.  The piece of text it represents is a token. 
See <a href="#Language-and-Grammar">Languages and Context-Free Grammars</a>. 
</dl>

<div class="node">
<p><hr>
<a name="Copying-This-Manual"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Index">Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Glossary">Glossary</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix C Copying This Manual</h2>

<!-- The GNU Free Documentation License. -->
<div align="center">Version 1.2, November 2002</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2000,2001,2002 Free Software Foundation, Inc.
     51 Franklin St, Fifth Floor, Boston, MA  02110-1301, USA
     
     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.
</pre>
     <ol type=1 start=0>
<li>PREAMBLE

     <p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <dfn>free</dfn> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially. 
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.

     <p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.

     <p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.

     <li>APPLICABILITY AND DEFINITIONS

     <p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.

     <p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.

     <p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document's overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.

     <p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.

     <p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.

     <p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent. 
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.

     <p>Examples of suitable formats for Transparent copies include plain
<span class="sc">ascii</span> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.

     <p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text.

     <p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.

     <p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.

     <li>VERBATIM COPYING

     <p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.

     <p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.

     <li>COPYING IN QUANTITY

     <p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document's license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition. 
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.

     <p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.

     <p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material. 
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.

     <p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.

     <li>MODIFICATIONS

     <p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:

          <ol type=A start=1>
<li>Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

          <li>List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

          <li>State on the Title page the name of the publisher of the
Modified Version, as the publisher.

          <li>Preserve all the copyright notices of the Document.

          <li>Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

          <li>Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

          <li>Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document's license notice.

          <li>Include an unaltered copy of this License.

          <li>Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

          <li>Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section. 
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

          <li>For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

          <li>Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

          <li>Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

          <li>Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

          <li>Preserve any Warranty Disclaimers.
          </ol>

     <p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice. 
These titles must be distinct from any other section titles.

     <p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.

     <p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.

     <p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.

     <li>COMBINING DOCUMENTS

     <p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.

     <p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number. 
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.

     <p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;

     <li>COLLECTIONS OF DOCUMENTS

     <p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.

     <p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.

     <li>AGGREGATION WITH INDEPENDENT WORKS

     <p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation's users beyond what the individual works permit. 
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.

     <p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document's Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form. 
Otherwise they must appear on printed covers that bracket the whole
aggregate.

     <li>TRANSLATION

     <p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4. 
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.

     <p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.

     <li>TERMINATION

     <p>You may not copy, modify, sublicense, or distribute the Document except
as expressly provided for under this License.  Any other attempt to
copy, modify, sublicense or distribute the Document is void, and will
automatically terminate your rights under this License.  However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.

     <li>FUTURE REVISIONS OF THIS LICENSE

     <p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.

     <p>Each version of the License is given a distinguishing version number. 
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.
        </ol>

<h3 class="heading">ADDENDUM: How to use this License for your documents</h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:

<pre class="smallexample">       Copyright (C)  <var>year</var>  <var>your name</var>.
       Permission is granted to copy, distribute and/or modify this document
       under the terms of the GNU Free Documentation License, Version 1.2
       or any later version published by the Free Software Foundation;
       with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
       Texts.  A copy of the license is included in the section entitled ``GNU
       Free Documentation License''.
</pre>
   <p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with<small class="dots">...</small>Texts.&rdquo; line with this:

<pre class="smallexample">         with the Invariant Sections being <var>list their titles</var>, with
         the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
         being <var>list</var>.
</pre>
   <p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.

   <p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.

<!-- Local Variables: -->
<!-- ispell-local-pdict: "ispell-dict" -->
<!-- End: -->
<div class="node">
<p><hr>
<a name="Index"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copying-This-Manual">Copying This Manual</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">Index</h2>

<ul class="index-cp" compact>
<li><a href="#index-_0024-282"><code>$</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-_0024-484"><code>$</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0024-437"><code>$</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-_0024_0024-281"><code>$$</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-_0024_0024-439"><code>$$</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-_0024_0024-135"><code>$$</code></a>: <a href="#Actions">Actions</a></li>
<li><a href="#index-_0024_0024-483"><code>$$</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0024_003c-440"><code>$&lt;</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-_0024_003c-283"><code>$&lt;</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-_0024accept-493"><code>$accept</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0024end-504"><code>$end</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0024_0040var_007bn_007d-136"><code>$</code><var>n</var></a>: <a href="#Actions">Actions</a></li>
<li><a href="#index-_0024undefined-528"><code>$undefined</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025-486"><code>%</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025-461"><code>%</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025_0025-460"><code>%%</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025_0025-485"><code>%%</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025code-98"><code>%code</code></a>: <a href="#Prologue-Alternatives">Prologue Alternatives</a></li>
<li><a href="#index-_0025code-494"><code>%code</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025code-215"><code>%code</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025code-457"><code>%code</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025code-218"><code>%code</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025code-495"><code>%code</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025code-216"><code>%code</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025code-418"><code>%code</code></a>: <a href="#Calc_002b_002b-Parser">Calc++ Parser</a></li>
<li><a href="#index-_0025code-imports-458"><code>%code imports</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025code-imports-222"><code>%code imports</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025code-lexer-459"><code>%code lexer</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025code-provides-220"><code>%code provides</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025code-provides-100"><code>%code provides</code></a>: <a href="#Prologue-Alternatives">Prologue Alternatives</a></li>
<li><a href="#index-_0025code-requires-232"><code>%code requires</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025code-requires-417"><code>%code requires</code></a>: <a href="#Calc_002b_002b-Parser">Calc++ Parser</a></li>
<li><a href="#index-_0025code-requires-99"><code>%code requires</code></a>: <a href="#Prologue-Alternatives">Prologue Alternatives</a></li>
<li><a href="#index-_0025code-top-221"><code>%code top</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025code-top-101"><code>%code top</code></a>: <a href="#Prologue-Alternatives">Prologue Alternatives</a></li>
<li><a href="#index-_0025debug-383"><code>%debug</code></a>: <a href="#Tracing">Tracing</a></li>
<li><a href="#index-_0025debug-497"><code>%debug</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025debug-224"><code>%debug</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025define-499"><code>%define</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025define-226"><code>%define</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025define-498"><code>%define</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025define-abstract-462"><code>%define abstract</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-api_002epure-227"><code>%define api.pure</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025define-api_002epure-200"><code>%define api.pure</code></a>: <a href="#Pure-Decl">Pure Decl</a></li>
<li><a href="#index-_0025define-api_002epush_005fpull-228"><code>%define api.push_pull</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025define-api_002epush_005fpull-203"><code>%define api.push_pull</code></a>: <a href="#Push-Decl">Push Decl</a></li>
<li><a href="#index-_0025define-extends-463"><code>%define extends</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-final-464"><code>%define final</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-implements-465"><code>%define implements</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-lex_005fthrows-466"><code>%define lex_throws</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-location_005ftype-467"><code>%define location_type</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-lr_002ekeep_005funreachable_005fstates-229"><code>%define lr.keep_unreachable_states</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025define-namespace-230"><code>%define namespace</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025define-namespace-388"><code>%define namespace</code></a>: <a href="#C_002b_002b-Bison-Interface">C++ Bison Interface</a></li>
<li><a href="#index-_0025define-package-468"><code>%define package</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-parser_005fclass_005fname-469"><code>%define parser_class_name</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-position_005ftype-470"><code>%define position_type</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-public-471"><code>%define public</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-strictfp-473"><code>%define strictfp</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-stype-472"><code>%define stype</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025define-throws-474"><code>%define throws</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025defines-501"><code>%defines</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025defines-231"><code>%defines</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025defines-500"><code>%defines</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025destructor-235"><code>%destructor</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025destructor-184"><code>%destructor</code></a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-_0025destructor-502"><code>%destructor</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025destructor-143"><code>%destructor</code></a>: <a href="#Mid_002dRule-Actions">Mid-Rule Actions</a></li>
<li><a href="#index-_0025destructor-183"><code>%destructor</code></a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-_0025dprec-39"><code>%dprec</code></a>: <a href="#Merging-GLR-Parses">Merging GLR Parses</a></li>
<li><a href="#index-_0025dprec-503"><code>%dprec</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025error_002dverbose-277"><code>%error-verbose</code></a>: <a href="#Error-Reporting">Error Reporting</a></li>
<li><a href="#index-_0025error_002dverbose-506"><code>%error-verbose</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025expect-192"><code>%expect</code></a>: <a href="#Expect-Decl">Expect Decl</a></li>
<li><a href="#index-_0025expect-214"><code>%expect</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025expect_002drr-33"><code>%expect-rr</code></a>: <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a></li>
<li><a href="#index-_0025expect_002drr-193"><code>%expect-rr</code></a>: <a href="#Expect-Decl">Expect Decl</a></li>
<li><a href="#index-_0025file_002dprefix-507"><code>%file-prefix</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025file_002dprefix-236"><code>%file-prefix</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025glr_002dparser-26"><code>%glr-parser</code></a>: <a href="#GLR-Parsers">GLR Parsers</a></li>
<li><a href="#index-_0025glr_002dparser-32"><code>%glr-parser</code></a>: <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a></li>
<li><a href="#index-_0025glr_002dparser-508"><code>%glr-parser</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025initial_002daction-176"><code>%initial-action</code></a>: <a href="#Initial-Action-Decl">Initial Action Decl</a></li>
<li><a href="#index-_0025initial_002daction-509"><code>%initial-action</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025initial_002daction-178"><code>%initial-action</code></a>: <a href="#Initial-Action-Decl">Initial Action Decl</a></li>
<li><a href="#index-_0025language-510"><code>%language</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025language-237"><code>%language</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025language-_0022Java_0022-451"><code>%language &quot;Java&quot;</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025left-210"><code>%left</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025left-332"><code>%left</code></a>: <a href="#Using-Precedence">Using Precedence</a></li>
<li><a href="#index-_0025left-511"><code>%left</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025lex_002dparam-512"><code>%lex-param</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025lex_002dparam-272"><code>%lex-param</code></a>: <a href="#Pure-Calling">Pure Calling</a></li>
<li><a href="#index-_0025lex_002dparam-452"><code>%lex-param</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025locations-238"><code>%locations</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025merge-513"><code>%merge</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025merge-40"><code>%merge</code></a>: <a href="#Merging-GLR-Parses">Merging GLR Parses</a></li>
<li><a href="#index-_0025name_002dprefix-453"><code>%name-prefix</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025name_002dprefix-239"><code>%name-prefix</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025name_002dprefix-514"><code>%name-prefix</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025no_002dlines-240"><code>%no-lines</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025no_002dlines-515"><code>%no-lines</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025nonassoc-334"><code>%nonassoc</code></a>: <a href="#Using-Precedence">Using Precedence</a></li>
<li><a href="#index-_0025nonassoc-516"><code>%nonassoc</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025nonassoc-211"><code>%nonassoc</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025output-241"><code>%output</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025output-517"><code>%output</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025parse_002dparam-257"><code>%parse-param</code></a>: <a href="#Parser-Function">Parser Function</a></li>
<li><a href="#index-_0025parse_002dparam-518"><code>%parse-param</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025parse_002dparam-454"><code>%parse-param</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025prec-519"><code>%prec</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025prec-339"><code>%prec</code></a>: <a href="#Contextual-Precedence">Contextual Precedence</a></li>
<li><a href="#index-_0025pure_002dparser-242"><code>%pure-parser</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025pure_002dparser-520"><code>%pure-parser</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025require-162"><code>%require</code></a>: <a href="#Require-Decl">Require Decl</a></li>
<li><a href="#index-_0025require-521"><code>%require</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025require-243"><code>%require</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025right-333"><code>%right</code></a>: <a href="#Using-Precedence">Using Precedence</a></li>
<li><a href="#index-_0025right-522"><code>%right</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025right-209"><code>%right</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025skeleton-523"><code>%skeleton</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025skeleton-244"><code>%skeleton</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025start-197"><code>%start</code></a>: <a href="#Start-Decl">Start Decl</a></li>
<li><a href="#index-_0025start-213"><code>%start</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025start-524"><code>%start</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025token-525"><code>%token</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025token-455"><code>%token</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025token-166"><code>%token</code></a>: <a href="#Token-Decl">Token Decl</a></li>
<li><a href="#index-_0025token-208"><code>%token</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025token_002dtable-526"><code>%token-table</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025token_002dtable-245"><code>%token-table</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025type-527"><code>%type</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025type-175"><code>%type</code></a>: <a href="#Type-Decl">Type Decl</a></li>
<li><a href="#index-_0025type-212"><code>%type</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025type-456"><code>%type</code></a>: <a href="#Java-Declarations-Summary">Java Declarations Summary</a></li>
<li><a href="#index-_0025union-172"><code>%union</code></a>: <a href="#Union-Decl">Union Decl</a></li>
<li><a href="#index-_0025union-529"><code>%union</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0025union-207"><code>%union</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025verbose-246"><code>%verbose</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_0025yacc-247"><code>%yacc</code></a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-_002ayypstate_005fnew-263"><code>*yypstate_new</code></a>: <a href="#Parser-Create-Function">Parser Create Function</a></li>
<li><a href="#index-_002f_002a-487"><code>/*</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_003a-488"><code>:</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_003b-489"><code>;</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_003c_002a_003e-181"><code>&lt;*&gt;</code></a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-_003c_002a_003e-491"><code>&lt;*&gt;</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_003c_003e-182"><code>&lt;&gt;</code></a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-_003c_003e-492"><code>&lt;&gt;</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0040_0040_0024-303"><code>@$</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-_0040_0040_0024-481"><code>@$</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0040_0040_0024-442"><code>@$</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-_0040_0040_0024-302"><code>@$</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-_0040_0040_0024-153"><code>@$</code></a>: <a href="#Actions-and-Locations">Actions and Locations</a></li>
<li><a href="#index-_0040_0040_0040var_007bn_007d-154"><code>@</code><var>n</var></a>: <a href="#Actions-and-Locations">Actions and Locations</a></li>
<li><a href="#index-_0040_0040_0040var_007bn_007d-482"><code>@</code><var>n</var></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_0040_0040_0040var_007bn_007d-305"><code>@</code><var>n</var></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-_0040_0040_0040var_007bn_007d-441"><code>@</code><var>n</var></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-abstract-syntax-tree-477">abstract syntax tree</a>: <a href="#Implementing-Gotos_002fLoops">Implementing Gotos/Loops</a></li>
<li><a href="#index-action-134">action</a>: <a href="#Actions">Actions</a></li>
<li><a href="#index-action-data-types-139">action data types</a>: <a href="#Action-Types">Action Types</a></li>
<li><a href="#index-action-features-summary-280">action features summary</a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-actions-in-mid_002drule-141">actions in mid-rule</a>: <a href="#Mid_002dRule-Actions">Mid-Rule Actions</a></li>
<li><a href="#index-actions-in-mid_002drule-185">actions in mid-rule</a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-actions_002c-location-152">actions, location</a>: <a href="#Actions-and-Locations">Actions and Locations</a></li>
<li><a href="#index-actions_002c-semantic-23">actions, semantic</a>: <a href="#Semantic-Actions">Semantic Actions</a></li>
<li><a href="#index-additional-C-code-section-106">additional C code section</a>: <a href="#Epilogue">Epilogue</a></li>
<li><a href="#index-algorithm-of-parser-316">algorithm of parser</a>: <a href="#Algorithm">Algorithm</a></li>
<li><a href="#index-ambiguous-grammars-10">ambiguous grammars</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-ambiguous-grammars-349">ambiguous grammars</a>: <a href="#Generalized-LR-Parsing">Generalized LR Parsing</a></li>
<li><a href="#index-associativity-331">associativity</a>: <a href="#Why-Precedence">Why Precedence</a></li>
<li><a href="#index-_0040acronym_007bAST_007d-478"><acronym>AST</acronym></a>: <a href="#Implementing-Gotos_002fLoops">Implementing Gotos/Loops</a></li>
<li><a href="#index-Backus_002dNaur-form-5">Backus-Naur form</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-begin-of-Location-419"><code>begin of Location</code></a>: <a href="#Java-Location-Values">Java Location Values</a></li>
<li><a href="#index-begin-on-location-399"><code>begin on location</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-Bison-declaration-summary-204">Bison declaration summary</a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-Bison-declarations-159">Bison declarations</a>: <a href="#Declarations">Declarations</a></li>
<li><a href="#index-Bison-declarations-_0028introduction_0029-102">Bison declarations (introduction)</a>: <a href="#Bison-Declarations">Bison Declarations</a></li>
<li><a href="#index-Bison-grammar-17">Bison grammar</a>: <a href="#Grammar-in-Bison">Grammar in Bison</a></li>
<li><a href="#index-Bison-invocation-386">Bison invocation</a>: <a href="#Invocation">Invocation</a></li>
<li><a href="#index-Bison-parser-59">Bison parser</a>: <a href="#Bison-Parser">Bison Parser</a></li>
<li><a href="#index-Bison-parser-algorithm-315">Bison parser algorithm</a>: <a href="#Algorithm">Algorithm</a></li>
<li><a href="#index-Bison-symbols_002c-table-of-479">Bison symbols, table of</a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-Bison-utility-60">Bison utility</a>: <a href="#Bison-Parser">Bison Parser</a></li>
<li><a href="#index-bison_002di18n_002em4-311">bison-i18n.m4</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-bison_002dpo-310">bison-po</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-BISON_005fI18N-312"><code>BISON_I18N</code></a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-BISON_005fLOCALEDIR-313"><code>BISON_LOCALEDIR</code></a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-_0040acronym_007bBNF_007d-4"><acronym>BNF</acronym></a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-braced-code-122">braced code</a>: <a href="#Rules">Rules</a></li>
<li><a href="#index-C-code_002c-section-for-additional-108">C code, section for additional</a>: <a href="#Epilogue">Epilogue</a></li>
<li><a href="#index-C_002dlanguage-interface-248">C-language interface</a>: <a href="#Interface">Interface</a></li>
<li><a href="#index-_0040code_007bcalc_007d-83"><code>calc</code></a>: <a href="#Infix-Calc">Infix Calc</a></li>
<li><a href="#index-calculator_002c-infix-notation-84">calculator, infix notation</a>: <a href="#Infix-Calc">Infix Calc</a></li>
<li><a href="#index-calculator_002c-location-tracking-88">calculator, location tracking</a>: <a href="#Location-Tracking-Calc">Location Tracking Calc</a></li>
<li><a href="#index-calculator_002c-multi_002dfunction-91">calculator, multi-function</a>: <a href="#Multi_002dfunction-Calc">Multi-function Calc</a></li>
<li><a href="#index-calculator_002c-simple-74">calculator, simple</a>: <a href="#RPN-Calc">RPN Calc</a></li>
<li><a href="#index-character-token-113">character token</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-column-on-position-392"><code>column on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-columns-on-location-401"><code>columns on location</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-columns-on-position-393"><code>columns on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-compiling-the-parser-81">compiling the parser</a>: <a href="#Rpcalc-Compile">Rpcalc Compile</a></li>
<li><a href="#index-conflicts-27">conflicts</a>: <a href="#GLR-Parsers">GLR Parsers</a></li>
<li><a href="#index-conflicts-325">conflicts</a>: <a href="#Shift_002fReduce">Shift/Reduce</a></li>
<li><a href="#index-conflicts-34">conflicts</a>: <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a></li>
<li><a href="#index-conflicts-41">conflicts</a>: <a href="#Merging-GLR-Parses">Merging GLR Parses</a></li>
<li><a href="#index-conflicts_002c-reduce_002freduce-344">conflicts, reduce/reduce</a>: <a href="#Reduce_002fReduce">Reduce/Reduce</a></li>
<li><a href="#index-conflicts_002c-suppressing-warnings-of-191">conflicts, suppressing warnings of</a>: <a href="#Expect-Decl">Expect Decl</a></li>
<li><a href="#index-context_002ddependent-precedence-335">context-dependent precedence</a>: <a href="#Contextual-Precedence">Contextual Precedence</a></li>
<li><a href="#index-context_002dfree-grammar-2">context-free grammar</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-controlling-function-77">controlling function</a>: <a href="#Rpcalc-Main">Rpcalc Main</a></li>
<li><a href="#index-core_002c-item-set-375">core, item set</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-dangling-_0040code_007belse_007d-327">dangling <code>else</code></a>: <a href="#Shift_002fReduce">Shift/Reduce</a></li>
<li><a href="#index-data-type-of-locations-149">data type of locations</a>: <a href="#Location-Type">Location Type</a></li>
<li><a href="#index-data-types-in-actions-140">data types in actions</a>: <a href="#Action-Types">Action Types</a></li>
<li><a href="#index-data-types-of-semantic-values-132">data types of semantic values</a>: <a href="#Value-Type">Value Type</a></li>
<li><a href="#index-debug_005flevel-on-parser-413"><code>debug_level on parser</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-debug_005fstream-on-parser-411"><code>debug_stream on parser</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-debugging-380">debugging</a>: <a href="#Tracing">Tracing</a></li>
<li><a href="#index-declaration-summary-205">declaration summary</a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-declarations-96">declarations</a>: <a href="#Prologue">Prologue</a></li>
<li><a href="#index-declarations-section-94">declarations section</a>: <a href="#Prologue">Prologue</a></li>
<li><a href="#index-declarations_002c-Bison-158">declarations, Bison</a>: <a href="#Declarations">Declarations</a></li>
<li><a href="#index-declarations_002c-Bison-_0028introduction_0029-103">declarations, Bison (introduction)</a>: <a href="#Bison-Declarations">Bison Declarations</a></li>
<li><a href="#index-declaring-literal-string-tokens-165">declaring literal string tokens</a>: <a href="#Token-Decl">Token Decl</a></li>
<li><a href="#index-declaring-operator-precedence-168">declaring operator precedence</a>: <a href="#Precedence-Decl">Precedence Decl</a></li>
<li><a href="#index-declaring-the-start-symbol-194">declaring the start symbol</a>: <a href="#Start-Decl">Start Decl</a></li>
<li><a href="#index-declaring-token-type-names-163">declaring token type names</a>: <a href="#Token-Decl">Token Decl</a></li>
<li><a href="#index-declaring-value-types-170">declaring value types</a>: <a href="#Union-Decl">Union Decl</a></li>
<li><a href="#index-declaring-value-types_002c-nonterminals-173">declaring value types, nonterminals</a>: <a href="#Type-Decl">Type Decl</a></li>
<li><a href="#index-default-action-137">default action</a>: <a href="#Actions">Actions</a></li>
<li><a href="#index-default-data-type-133">default data type</a>: <a href="#Value-Type">Value Type</a></li>
<li><a href="#index-default-location-type-150">default location type</a>: <a href="#Location-Type">Location Type</a></li>
<li><a href="#index-default-stack-limit-357">default stack limit</a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-default-start-symbol-196">default start symbol</a>: <a href="#Start-Decl">Start Decl</a></li>
<li><a href="#index-deferred-semantic-actions-43">deferred semantic actions</a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-defining-language-semantics-128">defining language semantics</a>: <a href="#Semantics">Semantics</a></li>
<li><a href="#index-discarded-symbols-187">discarded symbols</a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-discarded-symbols_002c-mid_002drule-actions-144">discarded symbols, mid-rule actions</a>: <a href="#Mid_002dRule-Actions">Mid-Rule Actions</a></li>
<li><a href="#index-_0040code_007belse_007d_002c-dangling-328"><code>else</code>, dangling</a>: <a href="#Shift_002fReduce">Shift/Reduce</a></li>
<li><a href="#index-end-of-Location-420"><code>end of Location</code></a>: <a href="#Java-Location-Values">Java Location Values</a></li>
<li><a href="#index-end-on-location-400"><code>end on location</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-epilogue-107">epilogue</a>: <a href="#Epilogue">Epilogue</a></li>
<li><a href="#index-error-505"><code>error</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-error-361"><code>error</code></a>: <a href="#Error-Recovery">Error Recovery</a></li>
<li><a href="#index-error-on-parser-415"><code>error on parser</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-error-recovery-359">error recovery</a>: <a href="#Error-Recovery">Error Recovery</a></li>
<li><a href="#index-error-recovery_002c-mid_002drule-actions-145">error recovery, mid-rule actions</a>: <a href="#Mid_002dRule-Actions">Mid-Rule Actions</a></li>
<li><a href="#index-error-recovery_002c-simple-85">error recovery, simple</a>: <a href="#Simple-Error-Recovery">Simple Error Recovery</a></li>
<li><a href="#index-error-reporting-function-273">error reporting function</a>: <a href="#Error-Reporting">Error Reporting</a></li>
<li><a href="#index-error-reporting-routine-79">error reporting routine</a>: <a href="#Rpcalc-Error">Rpcalc Error</a></li>
<li><a href="#index-examples_002c-simple-70">examples, simple</a>: <a href="#Examples">Examples</a></li>
<li><a href="#index-exercises-93">exercises</a>: <a href="#Exercises">Exercises</a></li>
<li><a href="#index-file-format-66">file format</a>: <a href="#Grammar-Layout">Grammar Layout</a></li>
<li><a href="#index-file-on-position-389"><code>file on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-finite_002dstate-machine-340">finite-state machine</a>: <a href="#Parser-States">Parser States</a></li>
<li><a href="#index-formal-grammar-19">formal grammar</a>: <a href="#Grammar-in-Bison">Grammar in Bison</a></li>
<li><a href="#index-format-of-grammar-file-67">format of grammar file</a>: <a href="#Grammar-Layout">Grammar Layout</a></li>
<li><a href="#index-freeing-discarded-symbols-179">freeing discarded symbols</a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-frequently-asked-questions-475">frequently asked questions</a>: <a href="#FAQ">FAQ</a></li>
<li><a href="#index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing-25">generalized <acronym>LR</acronym> (<acronym>GLR</acronym>) parsing</a>: <a href="#GLR-Parsers">GLR Parsers</a></li>
<li><a href="#index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing-9">generalized <acronym>LR</acronym> (<acronym>GLR</acronym>) parsing</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing-348">generalized <acronym>LR</acronym> (<acronym>GLR</acronym>) parsing</a>: <a href="#Generalized-LR-Parsing">Generalized LR Parsing</a></li>
<li><a href="#index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing_002c-ambiguous-grammars-38">generalized <acronym>LR</acronym> (<acronym>GLR</acronym>) parsing, ambiguous grammars</a>: <a href="#Merging-GLR-Parses">Merging GLR Parses</a></li>
<li><a href="#index-generalized-_0040acronym_007bLR_007d-_0028_0040acronym_007bGLR_007d_0029-parsing_002c-unambiguous-grammars-31">generalized <acronym>LR</acronym> (<acronym>GLR</acronym>) parsing, unambiguous grammars</a>: <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a></li>
<li><a href="#index-getDebugLevel-on-YYParser-430"><code>getDebugLevel on YYParser</code></a>: <a href="#Java-Parser-Interface">Java Parser Interface</a></li>
<li><a href="#index-getDebugStream-on-YYParser-428"><code>getDebugStream on YYParser</code></a>: <a href="#Java-Parser-Interface">Java Parser Interface</a></li>
<li><a href="#index-getEndPos-on-Lexer-435"><code>getEndPos on Lexer</code></a>: <a href="#Java-Scanner-Interface">Java Scanner Interface</a></li>
<li><a href="#index-getLVal-on-Lexer-436"><code>getLVal on Lexer</code></a>: <a href="#Java-Scanner-Interface">Java Scanner Interface</a></li>
<li><a href="#index-getStartPos-on-Lexer-434"><code>getStartPos on Lexer</code></a>: <a href="#Java-Scanner-Interface">Java Scanner Interface</a></li>
<li><a href="#index-gettext-309">gettext</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-glossary-558">glossary</a>: <a href="#Glossary">Glossary</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007binline_007d-55"><acronym>GLR</acronym> parsers and <code>inline</code></a>: <a href="#Compiler-Requirements">Compiler Requirements</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byychar_007d-45"><acronym>GLR</acronym> parsers and <code>yychar</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byyclearin_007d-51"><acronym>GLR</acronym> parsers and <code>yyclearin</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007bYYERROR_007d-53"><acronym>GLR</acronym> parsers and <code>YYERROR</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byylloc_007d-49"><acronym>GLR</acronym> parsers and <code>yylloc</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007bYYLLOC_005fDEFAULT_007d-157"><acronym>GLR</acronym> parsers and <code>YYLLOC_DEFAULT</code></a>: <a href="#Location-Default-Action">Location Default Action</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsers-and-_0040code_007byylval_007d-47"><acronym>GLR</acronym> parsers and <code>yylval</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsing-24"><acronym>GLR</acronym> parsing</a>: <a href="#GLR-Parsers">GLR Parsers</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsing-8"><acronym>GLR</acronym> parsing</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsing-347"><acronym>GLR</acronym> parsing</a>: <a href="#Generalized-LR-Parsing">Generalized LR Parsing</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsing_002c-ambiguous-grammars-37"><acronym>GLR</acronym> parsing, ambiguous grammars</a>: <a href="#Merging-GLR-Parses">Merging GLR Parses</a></li>
<li><a href="#index-_0040acronym_007bGLR_007d-parsing_002c-unambiguous-grammars-30"><acronym>GLR</acronym> parsing, unambiguous grammars</a>: <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a></li>
<li><a href="#index-grammar-file-65">grammar file</a>: <a href="#Grammar-Layout">Grammar Layout</a></li>
<li><a href="#index-grammar-rule-syntax-120">grammar rule syntax</a>: <a href="#Rules">Rules</a></li>
<li><a href="#index-grammar-rules-section-104">grammar rules section</a>: <a href="#Grammar-Rules">Grammar Rules</a></li>
<li><a href="#index-grammar_002c-Bison-18">grammar, Bison</a>: <a href="#Grammar-in-Bison">Grammar in Bison</a></li>
<li><a href="#index-grammar_002c-context_002dfree-3">grammar, context-free</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-grouping_002c-syntactic-15">grouping, syntactic</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-i18n-307">i18n</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-infix-notation-calculator-82">infix notation calculator</a>: <a href="#Infix-Calc">Infix Calc</a></li>
<li><a href="#index-_0040code_007binline_007d-54"><code>inline</code></a>: <a href="#Compiler-Requirements">Compiler Requirements</a></li>
<li><a href="#index-interface-249">interface</a>: <a href="#Interface">Interface</a></li>
<li><a href="#index-internationalization-306">internationalization</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-introduction-1">introduction</a>: <a href="#Introduction">Introduction</a></li>
<li><a href="#index-invoking-Bison-385">invoking Bison</a>: <a href="#Invocation">Invocation</a></li>
<li><a href="#index-item-372">item</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-item-set-core-376">item set core</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-kernel_002c-item-set-377">kernel, item set</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-_0040acronym_007bLALR_007d_00281_0029-346"><acronym>LALR</acronym>(1)</a>: <a href="#Mystery-Conflicts">Mystery Conflicts</a></li>
<li><a href="#index-_0040acronym_007bLALR_007d_00281_0029-grammars-6"><acronym>LALR</acronym>(1) grammars</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-language-semantics_002c-defining-129">language semantics, defining</a>: <a href="#Semantics">Semantics</a></li>
<li><a href="#index-layout-of-Bison-grammar-68">layout of Bison grammar</a>: <a href="#Grammar-Layout">Grammar Layout</a></li>
<li><a href="#index-left-recursion-125">left recursion</a>: <a href="#Recursion">Recursion</a></li>
<li><a href="#index-lex_002dparam-271"><code>lex-param</code></a>: <a href="#Pure-Calling">Pure Calling</a></li>
<li><a href="#index-lexical-analyzer-267">lexical analyzer</a>: <a href="#Lexical">Lexical</a></li>
<li><a href="#index-lexical-analyzer_002c-purpose-61">lexical analyzer, purpose</a>: <a href="#Bison-Parser">Bison Parser</a></li>
<li><a href="#index-lexical-analyzer_002c-writing-76">lexical analyzer, writing</a>: <a href="#Rpcalc-Lexer">Rpcalc Lexer</a></li>
<li><a href="#index-lexical-tie_002din-365">lexical tie-in</a>: <a href="#Lexical-Tie_002dins">Lexical Tie-ins</a></li>
<li><a href="#index-line-on-position-390"><code>line on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-lines-on-location-402"><code>lines on location</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-lines-on-position-391"><code>lines on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-literal-string-token-117">literal string token</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-literal-token-114">literal token</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-location-56">location</a>: <a href="#Locations-Overview">Locations Overview</a></li>
<li><a href="#index-location-146">location</a>: <a href="#Locations">Locations</a></li>
<li><a href="#index-location-actions-151">location actions</a>: <a href="#Actions-and-Locations">Actions and Locations</a></li>
<li><a href="#index-Location-on-Location-421"><code>Location on Location</code></a>: <a href="#Java-Location-Values">Java Location Values</a></li>
<li><a href="#index-location-tracking-calculator-86">location tracking calculator</a>: <a href="#Location-Tracking-Calc">Location Tracking Calc</a></li>
<li><a href="#index-location_002c-textual-58">location, textual</a>: <a href="#Locations-Overview">Locations Overview</a></li>
<li><a href="#index-location_002c-textual-148">location, textual</a>: <a href="#Locations">Locations</a></li>
<li><a href="#index-location_005fvalue_005ftype-408"><code>location_value_type</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-lookahead-token-321">lookahead token</a>: <a href="#Lookahead">Lookahead</a></li>
<li><a href="#index-_0040acronym_007bLR_007d_00281_0029-345"><acronym>LR</acronym>(1)</a>: <a href="#Mystery-Conflicts">Mystery Conflicts</a></li>
<li><a href="#index-_0040acronym_007bLR_007d_00281_0029-grammars-7"><acronym>LR</acronym>(1) grammars</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-_0040code_007bltcalc_007d-87"><code>ltcalc</code></a>: <a href="#Location-Tracking-Calc">Location Tracking Calc</a></li>
<li><a href="#index-main-function-in-simple-example-78">main function in simple example</a>: <a href="#Rpcalc-Main">Rpcalc Main</a></li>
<li><a href="#index-memory-exhaustion-351">memory exhaustion</a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-memory-management-352">memory management</a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-_0040code_007bmfcalc_007d-90"><code>mfcalc</code></a>: <a href="#Multi_002dfunction-Calc">Multi-function Calc</a></li>
<li><a href="#index-mid_002drule-actions-142">mid-rule actions</a>: <a href="#Mid_002dRule-Actions">Mid-Rule Actions</a></li>
<li><a href="#index-mid_002drule-actions-186">mid-rule actions</a>: <a href="#Destructor-Decl">Destructor Decl</a></li>
<li><a href="#index-multi_002dfunction-calculator-89">multi-function calculator</a>: <a href="#Multi_002dfunction-Calc">Multi-function Calc</a></li>
<li><a href="#index-multicharacter-literal-118">multicharacter literal</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-mutual-recursion-127">mutual recursion</a>: <a href="#Recursion">Recursion</a></li>
<li><a href="#index-NLS-308">NLS</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-nondeterministic-parsing-11">nondeterministic parsing</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-nondeterministic-parsing-350">nondeterministic parsing</a>: <a href="#Generalized-LR-Parsing">Generalized LR Parsing</a></li>
<li><a href="#index-nonterminal-symbol-109">nonterminal symbol</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-nonterminal_002c-useless-368">nonterminal, useless</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-operator-precedence-329">operator precedence</a>: <a href="#Precedence">Precedence</a></li>
<li><a href="#index-operator-precedence_002c-declaring-169">operator precedence, declaring</a>: <a href="#Precedence-Decl">Precedence Decl</a></li>
<li><a href="#index-operator_002b-on-location-403"><code>operator+ on location</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-operator_002b-on-position-395"><code>operator+ on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-operator_002b_003d-on-location-405"><code>operator+= on location</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-operator_002b_003d-on-position-394"><code>operator+= on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-operator_002d-on-position-397"><code>operator- on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-operator_002d_003d-on-position-396"><code>operator-= on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-operator_003c_003c-on-position-398"><code>operator&lt;&lt; on position</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-options-for-invoking-Bison-387">options for invoking Bison</a>: <a href="#Invocation">Invocation</a></li>
<li><a href="#index-overflow-of-parser-stack-355">overflow of parser stack</a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-parse-error-275">parse error</a>: <a href="#Error-Reporting">Error Reporting</a></li>
<li><a href="#index-parse-on-parser-410"><code>parse on parser</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-parse-on-YYParser-426"><code>parse on YYParser</code></a>: <a href="#Java-Parser-Interface">Java Parser Interface</a></li>
<li><a href="#index-parser-62">parser</a>: <a href="#Bison-Parser">Bison Parser</a></li>
<li><a href="#index-parser-on-parser-409"><code>parser on parser</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-parser-stack-319">parser stack</a>: <a href="#Algorithm">Algorithm</a></li>
<li><a href="#index-parser-stack-overflow-354">parser stack overflow</a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-parser-state-341">parser state</a>: <a href="#Parser-States">Parser States</a></li>
<li><a href="#index-pointed-rule-373">pointed rule</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-polish-notation-calculator-72">polish notation calculator</a>: <a href="#RPN-Calc">RPN Calc</a></li>
<li><a href="#index-precedence-declarations-167">precedence declarations</a>: <a href="#Precedence-Decl">Precedence Decl</a></li>
<li><a href="#index-precedence-of-operators-330">precedence of operators</a>: <a href="#Precedence">Precedence</a></li>
<li><a href="#index-precedence_002c-context_002ddependent-337">precedence, context-dependent</a>: <a href="#Contextual-Precedence">Contextual Precedence</a></li>
<li><a href="#index-precedence_002c-unary-operator-338">precedence, unary operator</a>: <a href="#Contextual-Precedence">Contextual Precedence</a></li>
<li><a href="#index-preventing-warnings-about-conflicts-189">preventing warnings about conflicts</a>: <a href="#Expect-Decl">Expect Decl</a></li>
<li><a href="#index-Prologue-223">Prologue</a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-Prologue-95">Prologue</a>: <a href="#Prologue">Prologue</a></li>
<li><a href="#index-Prologue-217">Prologue</a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-Prologue-Alternatives-97">Prologue Alternatives</a>: <a href="#Prologue-Alternatives">Prologue Alternatives</a></li>
<li><a href="#index-pure-parser-199">pure parser</a>: <a href="#Pure-Decl">Pure Decl</a></li>
<li><a href="#index-push-parser-201">push parser</a>: <a href="#Push-Decl">Push Decl</a></li>
<li><a href="#index-questions-476">questions</a>: <a href="#FAQ">FAQ</a></li>
<li><a href="#index-recovering-447"><code>recovering</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-recovering-on-YYParser-427"><code>recovering on YYParser</code></a>: <a href="#Java-Parser-Interface">Java Parser Interface</a></li>
<li><a href="#index-recovery-from-errors-360">recovery from errors</a>: <a href="#Error-Recovery">Error Recovery</a></li>
<li><a href="#index-recursive-rule-124">recursive rule</a>: <a href="#Recursion">Recursion</a></li>
<li><a href="#index-reduce_002freduce-conflict-343">reduce/reduce conflict</a>: <a href="#Reduce_002fReduce">Reduce/Reduce</a></li>
<li><a href="#index-reduce_002freduce-conflicts-35">reduce/reduce conflicts</a>: <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a></li>
<li><a href="#index-reduce_002freduce-conflicts-29">reduce/reduce conflicts</a>: <a href="#GLR-Parsers">GLR Parsers</a></li>
<li><a href="#index-reduce_002freduce-conflicts-42">reduce/reduce conflicts</a>: <a href="#Merging-GLR-Parses">Merging GLR Parses</a></li>
<li><a href="#index-reduction-318">reduction</a>: <a href="#Algorithm">Algorithm</a></li>
<li><a href="#index-reentrant-parser-198">reentrant parser</a>: <a href="#Pure-Decl">Pure Decl</a></li>
<li><a href="#index-requiring-a-version-of-Bison-161">requiring a version of Bison</a>: <a href="#Require-Decl">Require Decl</a></li>
<li><a href="#index-return-YYABORT_003b-443"><code>return YYABORT;</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-return-YYACCEPT_003b-444"><code>return YYACCEPT;</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-return-YYERROR_003b-445"><code>return YYERROR;</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-return-YYFAIL_003b-446"><code>return YYFAIL;</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-reverse-polish-notation-71">reverse polish notation</a>: <a href="#RPN-Calc">RPN Calc</a></li>
<li><a href="#index-right-recursion-126">right recursion</a>: <a href="#Recursion">Recursion</a></li>
<li><a href="#index-_0040code_007brpcalc_007d-73"><code>rpcalc</code></a>: <a href="#RPN-Calc">RPN Calc</a></li>
<li><a href="#index-rule-syntax-119">rule syntax</a>: <a href="#Rules">Rules</a></li>
<li><a href="#index-rule_002c-pointed-374">rule, pointed</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-rule_002c-useless-370">rule, useless</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-rules-section-for-grammar-105">rules section for grammar</a>: <a href="#Grammar-Rules">Grammar Rules</a></li>
<li><a href="#index-running-Bison-_0028introduction_0029-80">running Bison (introduction)</a>: <a href="#Rpcalc-Generate">Rpcalc Generate</a></li>
<li><a href="#index-semantic-actions-22">semantic actions</a>: <a href="#Semantic-Actions">Semantic Actions</a></li>
<li><a href="#index-semantic-value-20">semantic value</a>: <a href="#Semantic-Values">Semantic Values</a></li>
<li><a href="#index-semantic-value-type-130">semantic value type</a>: <a href="#Value-Type">Value Type</a></li>
<li><a href="#index-semantic_005fvalue_005ftype-407"><code>semantic_value_type</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-set_005fdebug_005flevel-on-parser-414"><code>set_debug_level on parser</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-set_005fdebug_005fstream-on-parser-412"><code>set_debug_stream on parser</code></a>: <a href="#C_002b_002b-Parser-Interface">C++ Parser Interface</a></li>
<li><a href="#index-setDebugLevel-on-YYParser-431"><code>setDebugLevel on YYParser</code></a>: <a href="#Java-Parser-Interface">Java Parser Interface</a></li>
<li><a href="#index-setDebugStream-on-YYParser-429"><code>setDebugStream on YYParser</code></a>: <a href="#Java-Parser-Interface">Java Parser Interface</a></li>
<li><a href="#index-shift_002freduce-conflicts-36">shift/reduce conflicts</a>: <a href="#Simple-GLR-Parsers">Simple GLR Parsers</a></li>
<li><a href="#index-shift_002freduce-conflicts-28">shift/reduce conflicts</a>: <a href="#GLR-Parsers">GLR Parsers</a></li>
<li><a href="#index-shift_002freduce-conflicts-326">shift/reduce conflicts</a>: <a href="#Shift_002fReduce">Shift/Reduce</a></li>
<li><a href="#index-shifting-317">shifting</a>: <a href="#Algorithm">Algorithm</a></li>
<li><a href="#index-simple-examples-69">simple examples</a>: <a href="#Examples">Examples</a></li>
<li><a href="#index-single_002dcharacter-literal-115">single-character literal</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-stack-overflow-353">stack overflow</a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-stack_002c-parser-320">stack, parser</a>: <a href="#Algorithm">Algorithm</a></li>
<li><a href="#index-stages-in-using-Bison-63">stages in using Bison</a>: <a href="#Stages">Stages</a></li>
<li><a href="#index-start-symbol-16">start symbol</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-start-symbol_002c-declaring-195">start symbol, declaring</a>: <a href="#Start-Decl">Start Decl</a></li>
<li><a href="#index-state-_0028of-parser_0029-342">state (of parser)</a>: <a href="#Parser-States">Parser States</a></li>
<li><a href="#index-step-on-location-406"><code>step on location</code></a>: <a href="#C_002b_002b-Location-Values">C++ Location Values</a></li>
<li><a href="#index-string-token-116">string token</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-summary_002c-action-features-279">summary, action features</a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-summary_002c-Bison-declaration-206">summary, Bison declaration</a>: <a href="#Decl-Summary">Decl Summary</a></li>
<li><a href="#index-suppressing-conflict-warnings-188">suppressing conflict warnings</a>: <a href="#Expect-Decl">Expect Decl</a></li>
<li><a href="#index-symbol-112">symbol</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-symbol-table-example-92">symbol table example</a>: <a href="#Mfcalc-Symbol-Table">Mfcalc Symbol Table</a></li>
<li><a href="#index-symbols-_0028abstract_0029-12">symbols (abstract)</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-symbols-in-Bison_002c-table-of-480">symbols in Bison, table of</a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-syntactic-grouping-14">syntactic grouping</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-syntax-error-276">syntax error</a>: <a href="#Error-Reporting">Error Reporting</a></li>
<li><a href="#index-syntax-of-grammar-rules-121">syntax of grammar rules</a>: <a href="#Rules">Rules</a></li>
<li><a href="#index-terminal-symbol-110">terminal symbol</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-textual-location-57">textual location</a>: <a href="#Locations-Overview">Locations Overview</a></li>
<li><a href="#index-textual-location-147">textual location</a>: <a href="#Locations">Locations</a></li>
<li><a href="#index-token-13">token</a>: <a href="#Language-and-Grammar">Language and Grammar</a></li>
<li><a href="#index-token-type-111">token type</a>: <a href="#Symbols">Symbols</a></li>
<li><a href="#index-token-type-names_002c-declaring-164">token type names, declaring</a>: <a href="#Token-Decl">Token Decl</a></li>
<li><a href="#index-token_002c-useless-366">token, useless</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-toString-on-Location-423"><code>toString on Location</code></a>: <a href="#Java-Location-Values">Java Location Values</a></li>
<li><a href="#index-tracing-the-parser-381">tracing the parser</a>: <a href="#Tracing">Tracing</a></li>
<li><a href="#index-unary-operator-precedence-336">unary operator precedence</a>: <a href="#Contextual-Precedence">Contextual Precedence</a></li>
<li><a href="#index-useless-nonterminal-369">useless nonterminal</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-useless-rule-371">useless rule</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-useless-token-367">useless token</a>: <a href="#Understanding">Understanding</a></li>
<li><a href="#index-using-Bison-64">using Bison</a>: <a href="#Stages">Stages</a></li>
<li><a href="#index-value-type_002c-semantic-131">value type, semantic</a>: <a href="#Value-Type">Value Type</a></li>
<li><a href="#index-value-types_002c-declaring-171">value types, declaring</a>: <a href="#Union-Decl">Union Decl</a></li>
<li><a href="#index-value-types_002c-nonterminals_002c-declaring-174">value types, nonterminals, declaring</a>: <a href="#Type-Decl">Type Decl</a></li>
<li><a href="#index-value_002c-semantic-21">value, semantic</a>: <a href="#Semantic-Values">Semantic Values</a></li>
<li><a href="#index-version-requirement-160">version requirement</a>: <a href="#Require-Decl">Require Decl</a></li>
<li><a href="#index-warnings_002c-preventing-190">warnings, preventing</a>: <a href="#Expect-Decl">Expect Decl</a></li>
<li><a href="#index-writing-a-lexical-analyzer-75">writing a lexical analyzer</a>: <a href="#Rpcalc-Lexer">Rpcalc Lexer</a></li>
<li><a href="#index-YYABORT-255"><code>YYABORT</code></a>: <a href="#Parser-Function">Parser Function</a></li>
<li><a href="#index-YYABORT-530"><code>YYABORT</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYABORT-254"><code>YYABORT</code></a>: <a href="#Parser-Function">Parser Function</a></li>
<li><a href="#index-YYABORT_003b-285"><code>YYABORT;</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYACCEPT-252"><code>YYACCEPT</code></a>: <a href="#Parser-Function">Parser Function</a></li>
<li><a href="#index-YYACCEPT-531"><code>YYACCEPT</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYACCEPT_003b-286"><code>YYACCEPT;</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYBACKUP-287"><code>YYBACKUP</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYBACKUP-532"><code>YYBACKUP</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYBACKUP-288"><code>YYBACKUP</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-yychar-533"><code>yychar</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yychar-44"><code>yychar</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-yychar-322"><code>yychar</code></a>: <a href="#Lookahead">Lookahead</a></li>
<li><a href="#index-yychar-297"><code>yychar</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-yyclearin-534"><code>yyclearin</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yyclearin-363"><code>yyclearin</code></a>: <a href="#Error-Recovery">Error Recovery</a></li>
<li><a href="#index-yyclearin-50"><code>yyclearin</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-yyclearin_003b-298"><code>yyclearin;</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYDEBUG-382"><code>YYDEBUG</code></a>: <a href="#Tracing">Tracing</a></li>
<li><a href="#index-yydebug-379"><code>yydebug</code></a>: <a href="#Tracing">Tracing</a></li>
<li><a href="#index-yydebug-536"><code>yydebug</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYDEBUG-535"><code>YYDEBUG</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYEMPTY-290"><code>YYEMPTY</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYENABLE_005fNLS-314"><code>YYENABLE_NLS</code></a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-YYEOF-291"><code>YYEOF</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-yyerrok-362"><code>yyerrok</code></a>: <a href="#Error-Recovery">Error Recovery</a></li>
<li><a href="#index-yyerrok-537"><code>yyerrok</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yyerrok_003b-299"><code>yyerrok;</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-yyerror-449"><code>yyerror</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-yyerror-274"><code>yyerror</code></a>: <a href="#Error-Reporting">Error Reporting</a></li>
<li><a href="#index-YYERROR-294"><code>YYERROR</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-yyerror-539"><code>yyerror</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYERROR-538"><code>YYERROR</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYERROR-52"><code>YYERROR</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-yyerror-450"><code>yyerror</code></a>: <a href="#Java-Action-Features">Java Action Features</a></li>
<li><a href="#index-yyerror-on-Lexer-432"><code>yyerror on Lexer</code></a>: <a href="#Java-Scanner-Interface">Java Scanner Interface</a></li>
<li><a href="#index-YYERROR_003b-293"><code>YYERROR;</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYERROR_005fVERBOSE-540"><code>YYERROR_VERBOSE</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYINITDEPTH-541"><code>YYINITDEPTH</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYINITDEPTH-358"><code>YYINITDEPTH</code></a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-yylex-542"><code>yylex</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yylex-266"><code>yylex</code></a>: <a href="#Lexical">Lexical</a></li>
<li><a href="#index-yylex-on-Lexer-433"><code>yylex on Lexer</code></a>: <a href="#Java-Scanner-Interface">Java Scanner Interface</a></li>
<li><a href="#index-yylex-on-parser-416"><code>yylex on parser</code></a>: <a href="#C_002b_002b-Scanner-Interface">C++ Scanner Interface</a></li>
<li><a href="#index-YYLEX_005fPARAM-543"><code>YYLEX_PARAM</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yylloc-155"><code>yylloc</code></a>: <a href="#Actions-and-Locations">Actions and Locations</a></li>
<li><a href="#index-yylloc-269"><code>yylloc</code></a>: <a href="#Token-Locations">Token Locations</a></li>
<li><a href="#index-yylloc-544"><code>yylloc</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yylloc-324"><code>yylloc</code></a>: <a href="#Lookahead">Lookahead</a></li>
<li><a href="#index-yylloc-48"><code>yylloc</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-yylloc-300"><code>yylloc</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYLLOC_005fDEFAULT-156"><code>YYLLOC_DEFAULT</code></a>: <a href="#Location-Default-Action">Location Default Action</a></li>
<li><a href="#index-YYLTYPE-545"><code>YYLTYPE</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYLTYPE-270"><code>YYLTYPE</code></a>: <a href="#Token-Locations">Token Locations</a></li>
<li><a href="#index-yylval-301"><code>yylval</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-yylval-46"><code>yylval</code></a>: <a href="#GLR-Semantic-Actions">GLR Semantic Actions</a></li>
<li><a href="#index-yylval-323"><code>yylval</code></a>: <a href="#Lookahead">Lookahead</a></li>
<li><a href="#index-yylval-268"><code>yylval</code></a>: <a href="#Token-Values">Token Values</a></li>
<li><a href="#index-yylval-138"><code>yylval</code></a>: <a href="#Actions">Actions</a></li>
<li><a href="#index-yylval-546"><code>yylval</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYMAXDEPTH-547"><code>YYMAXDEPTH</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYMAXDEPTH-356"><code>YYMAXDEPTH</code></a>: <a href="#Memory-Management">Memory Management</a></li>
<li><a href="#index-yynerrs-278"><code>yynerrs</code></a>: <a href="#Error-Reporting">Error Reporting</a></li>
<li><a href="#index-yynerrs-548"><code>yynerrs</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yyparse-250"><code>yyparse</code></a>: <a href="#Parser-Function">Parser Function</a></li>
<li><a href="#index-yyparse-549"><code>yyparse</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYPARSE_005fPARAM-554"><code>YYPARSE_PARAM</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYParser-on-YYParser-424"><code>YYParser on YYParser</code></a>: <a href="#Java-Parser-Interface">Java Parser Interface</a></li>
<li><a href="#index-YYPRINT-384"><code>YYPRINT</code></a>: <a href="#Tracing">Tracing</a></li>
<li><a href="#index-yypstate_005fdelete-265"><code>yypstate_delete</code></a>: <a href="#Parser-Delete-Function">Parser Delete Function</a></li>
<li><a href="#index-yypstate_005fdelete-550"><code>yypstate_delete</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yypstate_005fnew-262"><code>yypstate_new</code></a>: <a href="#Parser-Create-Function">Parser Create Function</a></li>
<li><a href="#index-yypstate_005fnew-551"><code>yypstate_new</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yypull_005fparse-552"><code>yypull_parse</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yypull_005fparse-260"><code>yypull_parse</code></a>: <a href="#Pull-Parser-Function">Pull Parser Function</a></li>
<li><a href="#index-yypush_005fparse-553"><code>yypush_parse</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-yypush_005fparse-259"><code>yypush_parse</code></a>: <a href="#Push-Parser-Function">Push Parser Function</a></li>
<li><a href="#index-YYRECOVERING-364"><code>YYRECOVERING</code></a>: <a href="#Error-Recovery">Error Recovery</a></li>
<li><a href="#index-YYRECOVERING-555"><code>YYRECOVERING</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYRECOVERING-296"><code>YYRECOVERING</code></a>: <a href="#Action-Features">Action Features</a></li>
<li><a href="#index-YYSTACK_005fUSE_005fALLOCA-556"><code>YYSTACK_USE_ALLOCA</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-YYSTYPE-557"><code>YYSTYPE</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_007c-490"><code>|</code></a>: <a href="#Table-of-Symbols">Table of Symbols</a></li>
<li><a href="#index-_007c-123"><code>|</code></a>: <a href="#Rules">Rules</a></li>
   </ul><div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> The default location is actually skeleton-dependent;
  writers of non-standard skeletons however should choose the default location
  consistently with the behavior of the standard Bison skeletons.</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> In the future techniques to allow complex types
within pseudo-unions (similar to Boost variants) might be implemented to
alleviate these issues.</p>

   <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> Java parsers include the actions in a separate
method than <code>yyparse</code> in order to have an intuitive syntax that
corresponds to these C macros.</p>

   <p><hr></div>

</body></html>

