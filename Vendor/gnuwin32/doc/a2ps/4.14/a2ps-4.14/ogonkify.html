<html lang="en">
<head>
<title>Ogonkify</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Ogonkify">
<meta name="generator" content="makeinfo 4.7">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc { font-variant:small-caps }
  span.roman { font-family: serif; font-weight: normal; } 
--></style>
</head>
<body>
<h1 class="settitle">Ogonkify</h1>
<div class="node">
<p><hr>
<a name="Top"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#License">License</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dir">(dir)</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>
<br>
</div>

<h2 class="unnumbered">The Ogonkify package</h2>

<p>The Ogonkify package contains two programs: a utility for adding
composite characters to fonts in a semi-automatic fashion, and a program
for converting PS output &mdash; notably Netscape and Mosaic output &mdash; to use
these fonts.

<ul class="menu">
<li><a accesskey="1" href="#License">License</a>:                      Your rights and my polite requests
<li><a accesskey="2" href="#Using-Ogonkify">Using Ogonkify</a>:               How to use Ogonkify
<li><a accesskey="3" href="#Adding-new-characters">Adding new characters</a>:        How to add new characters to the fonts
<li><a accesskey="4" href="#Reaching-the-author">Reaching the author</a>:          Addresses
</ul>

<div class="node">
<p><hr>
<a name="License"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-Ogonkify">Using Ogonkify</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">1 The McKornik Jr. Public License</h2>

<p>This program is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation; either version 3 of the License, or (at your
option) any later version.

   <p>In particular, this program is provided as is, without any warranty, not
even of any kind.  It might (or might not) do what it is supposed to do,
it might (or might not) destroy your printer, and it might (or might
not) be useful to you.  In any case, you are on your own.

   <p>This program is written in Perl.  While stronger people find reading
Perl code character-building, it should not be shown to people in their
formative years.  The author will not accept any responsibility for any
moral grief caused.

   <p>I would like to ask you <em>not</em> to distribute the generated fonts
without including a pointer to the original AFMs and the rest of the
code.  Furthermore, please notify me if you decide to include this code
in a larger piece of software.

   <p>If you find this software useful, local goodies, makowiec, beer from
Zywiec, postcards from exotic places and all sorts of things are
accepted.

<div class="node">
<p><hr>
<a name="Using-Ogonkify"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Adding-new-characters">Adding new characters</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#License">License</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">2 Using Ogonkify</h2>

<p>This chapter describes the various uses of Ogonkify.

<ul class="menu">
<li><a accesskey="1" href="#Ghostscript">Ghostscript</a>:                  Viewing with ghostscript
<li><a accesskey="2" href="#Standard-Applications">Standard Applications</a>:        Using the package with standard applications
<li><a accesskey="3" href="#a2ps">a2ps</a>:                         Printing with a2ps
<li><a accesskey="4" href="#genscript">genscript</a>:                    Printing with genscript
</ul>

<div class="node">
<p><hr>
<a name="Ghostscript"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Standard-Applications">Standard Applications</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-Ogonkify">Using Ogonkify</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-Ogonkify">Using Ogonkify</a>
<br>
</div>

<h3 class="section">2.1 Viewing with Ghostscript</h3>

<p>Due to a bug in some versions of ghostscript, in order to view the
output of Ogonkify you may need to run ghostscript with the
<code>-dNOPLATFONTS</code> option, as in

<pre class="example">     gs -dNOPLATFONTS foo.ps
</pre>
   <p class="noindent">or in

<pre class="example">     ghostview -arguments -dNOPLATFONTS foo.ps
</pre>
   <p>See the <code>gs(1)</code> and <code>ghostview(1)</code> manual pages for more
details.

<div class="node">
<p><hr>
<a name="Standard-Applications"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#a2ps">a2ps</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Ghostscript">Ghostscript</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-Ogonkify">Using Ogonkify</a>
<br>
</div>

<h3 class="section">2.2 Printing from Standard Applications</h3>

<p>The main use of Ogonkify is to allow various standard applications to
print in various languages.  As of this writing, the <code>ogonkify</code>
script knows how to handle Netscape, Mosaic, the mail printer MP,
StarOffice, and ApplixWare.  Its usage is described in full detail in
the <code>ogonkify(1)</code> manual page.

<div class="node">
<p><hr>
<a name="a2ps"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#genscript">genscript</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Standard-Applications">Standard Applications</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-Ogonkify">Using Ogonkify</a>
<br>
</div>

<h3 class="section">2.3 Printing with a2ps</h3>

<p><code>a2ps</code> is a PostScript formatter with pretty-printing capabilities. 
Starting with version 4.7.21, it automatically uses Ogonkify,
which is distributed with it. See <a href="a2ps.html#Top">a2ps manual (a2ps manual)</a>.

   <p><code>a2ps</code> can be obtained from:

<pre class="example">     &lt;URL:http://www-stud.enst.fr/~demaille/a2ps.html&gt;
</pre>
   <div class="node">
<p><hr>
<a name="genscript"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#a2ps">a2ps</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-Ogonkify">Using Ogonkify</a>
<br>
</div>

<h3 class="section">2.4 Printing with GNU Enscript</h3>

<p>GNU Enscript is a program for printing text files on PostScript printers
written by Markku Rossi and distributed with other GNU software.  You
will find it on any mirror carrying GNU software.

   <p>GNU Enscript is one of the few programs that allow the user to select
the encoding of the files he wants to print, and correctly reencoding
the fonts it uses .  In order to obtain information about the characters
available in a font, it uses AFM files.

   <p>If you are only interested in printing in Courier, you might want to
simply use the IBM Courier fonts and the AFM files provided with them. 
However, you may also want to use the output of Ogonkify; for
printing in Times and Helvetica, this is the only solution.

   <p>Here are installation procedures for using the fonts generated by the
<code>instogonki</code> script with <code>genscript</code>.  They assume that
<code>genscript</code> is properly installed, and that you know which
<code>genscript.cfg</code> file it reads.

     <ol type=1 start=1>

     <li>In the directory <code>$PFADIR</code>, type
     <pre class="example">          % mkafmmap *.afm
     </pre>
     <p>(the <code>mkafmmap</code> program is installed with GNU Enscript).

     <li>In the <code>genscript.cfg</code> file, add your <code>$PFADIR</code> directory
to the AFMPath.
        </ol>

<p class="noindent">You can now print with the composite characters.  Example:
<pre class="example">     % genscript -X latin2 -f Times-Roman-Ogonki@12 \
                 -o wierszyk.ps wierszyk.txt
</pre>
   <p>or
<pre class="example">     % genscript -X latin2 -f Helvetica-Ogonki@12 \
                 -o wierszyk.ps wierszyk.txt
</pre>
   <div class="node">
<p><hr>
<a name="Adding-new-characters"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Reaching-the-author">Reaching the author</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-Ogonkify">Using Ogonkify</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">3 Adding new characters</h2>

<p>This chapter attempts to explain how to extend Ogonkify to handle
supplementary characters.

<ul class="menu">
<li><a accesskey="1" href="#Composite-background">Composite background</a>:         Background about composite characters
<li><a accesskey="2" href="#AFM-files">AFM files</a>:                    Non-orthodox use of Adobe Font Metric files
<li><a accesskey="3" href="#Generated-fonts">Generated fonts</a>:              Fonts with composite characters
<li><a accesskey="4" href="#Composite-usage">Composite usage</a>:              Usage of the script `composeglyphs'
<li><a accesskey="5" href="#Composite-example">Composite example</a>:            A step-by-step example
</ul>

<div class="node">
<p><hr>
<a name="Composite-background"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#AFM-files">AFM files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Adding-new-characters">Adding new characters</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Adding-new-characters">Adding new characters</a>
<br>
</div>

<h3 class="section">3.1 Background</h3>

<p>A typical Type 1 font for the latin alphabet contains &ldquo;pure&rdquo;
characters, such a <code>A</code> or <code>acute</code>, and composite characters,
such as <code>Aacute</code>, which are composed of the <code>A</code> character, and
the <code>acute</code> character using the Type 1 <code>seac</code> operator.

   <p>Unfortunately, most fonts do not contain all the characters in the ISO
Latin-2 character set.  In particular, most of the Polish characters
(with the exception of <code>oacute</code> and <code>Oacute</code>) are usually
missing (a notable exception is IBM Courier &mdash; not Adobe Courier &mdash;
which contains many useful glyphs).  However, the components of those
glyphs are present.  It should not be difficult to add the
characters we need if the necessary tools were available<small class="dots">...</small> At least
four methods could be used:

<p class="noindent">i) Do not change the original font, but do overstriking for individual
characters (e.g. typeset an <code>a</code>, then move backwards and typeset an
<code>ogonek</code> for <code>aogonek</code>).  This method is widely used, for
instance by TeX.

<p class="noindent">ii) Parse the <code>PFA</code> or <code>PFB</code> file containing the font
program for a Type 1 font, and generate a new <code>PFA</code> containing the
composite characters.  This should not be too difficult (<code>PFA</code>
parsers are freely available), but would require that users have the
<code>PFA</code> files corresponding to the fonts they use, which is often
not the case. Furthermore, I believe that it would violate the license
of the fonts.  I am not quite sure what to make of the following:
<blockquote>
Adobe Systems' Type 1 font programs are licensed for use on one or
more devices (depending on the terms of particular licenses). 
These licenses would permit the use of a licensed program in a
system that translates a Type 1 font program to some other format
in the process of rendering, as long as a copy of the program
(even in translated form) is not produced.
     <div align="right"><cite>Adobe Type 1 Font Format</cite>, p. 7, Adobe Systems Inc.
        </div>
   </blockquote>

<p class="noindent">iii) Download the original font, and add to its Charstrings dictionary
the supplementary characters using PostScript.  This would not violate
the license agreement as the modified font would exist only in the
printer.  However, many PostScript interpreters do not allow tampering
with Type 1 font dictionaries.  Copy protection, as always, only bothers
honest users.

<p class="noindent">iv) Create a new Type 3 font dictionary which draws characters by
using the characters in the original font.  This has the benefits of
working and being legal.  I expected it to be quite inefficient, but
found it to be reasonably fast.

   <p>The <code>composite.ps</code> file contained in this distribution, and the
accompanying perl program <code>composeglyphs</code>, follow scheme (iv).  The
following sections describe them in more detail, including information
on extending the code to create other composite characters.

   <blockquote>
<strong>Please note:</strong> our usage of the word &ldquo;composite&rdquo; has noting to
do with Adobe's notion of &ldquo;composite fonts&rdquo;.  This is a bug. 
</blockquote>

   <blockquote>
<strong>Please note:</strong> a Polish typographer would be appalled to see that
we consider the &ldquo;ogonek&rdquo; as a diacritical mark, and thus harm the
integrity of the two letters that all Poles love.  Indeed, in a proper
Polish font, the tail of <code>aogonek</code> would have a different shape
than that of <code>eogonek</code>.  Considering however the poor availability
of fonts with the needed characters, we do not currently have the luxury
to whine about such esthetic problems. 
</blockquote>

<div class="node">
<p><hr>
<a name="AFM-files"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Generated-fonts">Generated fonts</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Composite-background">Composite background</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Adding-new-characters">Adding new characters</a>
<br>
</div>

<h3 class="section">3.2 Non-orthodox uses of Adobe Font Metrics files</h3>

<p>Information about the fonts comes from <dfn>Adobe Font Metrics</dfn> (AFM)
files.  Much more information is in AFMs then usually known; in
particular, the encoding vector can be derived from the AFM, and AFMs
contain the composite character information.  Therefore, a program could
generate the needed font &mdash; encoding vector and everything included &mdash;
from the AFMs.

   <p>In order to simplify the handling of AFM information, we use three
different AFMs on every run of the program: (i) an AFM with the encoding
vector to use, (ii) the AFM of the original font, and (iii) an AFM with
supplementary composite character information.  The latter will usually
have to be supplied by the user.  It is needed because AFMs provided
with Type 1 fonts usually only contain composite information about the
characters already in the font (in fact, the Adobe documentation does
not make it quite clear whether it is legal to insert composite
information about characters not already in the font into an AFM).

<div class="node">
<p><hr>
<a name="Generated-fonts"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Composite-usage">Composite usage</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#AFM-files">AFM files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Adding-new-characters">Adding new characters</a>
<br>
</div>

<h3 class="section">3.3 Fonts with composite characters</h3>

<p>The generated font contains (i) the characters that were in the original
font, and (ii) the characters which were not in the original font but
for which composite information was provided.  AFM files for the
generated fonts are generated too, which means that the fonts can be
used with most applications.  Furthermore, they can be reencoded, just
like any well-behaved PostScript font.

   <p>In order to maintain compatibility with PostScript Level 1, every
composed font must be based on a base encoding vector, and characters
can only be composed from components in that vector.  Thus, in order
to build <code>Nacute</code> from <code>N</code> and <code>acute</code>, both <code>N</code> and
<code>acute</code> must be in the base vector.

   <p>However, as the base vector is only ever used internally, much liberty
can be taken when designing it.  In particular, it doesn't need to be
compatible with any other vector, and there is no reason to avoid the
control character range.  The base encoding vector that I use is called
<code>OgonkiEncoding</code>; it is based on Latin-2, but contains all the
characters of <code>StandardEncoding</code> (although in strange places).

   <p>There is a limitation on the composite information that can be used. 
In particular, the only composite entries used are of the form:

<pre class="example">     CC ... 2 ; PCC x 0 0 ; PCC ' ... ; ...
</pre>
   <p class="noindent">In plain words, there must be exactly two characters to compose, the
first character must be set at the origin, and the width of the
composite character is taken to be that of the first character.  This
limitation is easy to lift, and I will generalize the code if you send
me AFMs that do not obey this convention (I have never seen any, and,
indeed, this is the format required by the Type 1 <code>seac</code> operator). 
AFMs that do not obey it are (hopefully) gracefully handled (you should
see warnings about <code>CC</code> entries being ignored).

<div class="node">
<p><hr>
<a name="Composite-usage"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Composite-example">Composite example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Generated-fonts">Generated fonts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Adding-new-characters">Adding new characters</a>
<br>
</div>

<h3 class="section">3.4 Usage of the composite script</h3>

<p>The <code>composeglyphs</code> script can be run to generate either an encoding
vector or a new font.  It is a perl script, and only reformats the data;
the real magic is in the file <code>composite.ps</code>.

   <p>In order to generate an encoding vector from a suitable AFM,
<code>composeglyphs</code> is run as follows:

<pre class="example">     % composeglyphs -e latin2.afm -E latin2.enc
</pre>
   <p class="noindent">which will generate the file <code>latin2.enc</code> from the AFM file
<code>latin2.afm</code> (this is the default).  Any AFM file is suitable as
input, but most AFMs do not contain all the possible characters of an
encoding vector (the missing ones will be replaced by <code>.notdef</code>).

   <p>In order to generate a font program, more input must be provided:

<pre class="example">     % composeglyphs -i ptmr.afm -c ptmr-c.afm \
                     -o ptmr-o.ps -n Times-Roman-Ogonki \
                     -a ptmr-o.afm \
                     -e ogonki.afm -t adobe.afm
</pre>
   <p class="noindent">where <code>-i</code> specifies the AFM of the original font, <code>-c</code>
supplementary composite character information, <code>-o</code> the font
program to generate, <code>-n</code> the name of the new font, <code>-a</code> the
name of the AFM file to generate, <code>-e</code> the base encoding AFM to
use, and <code>-t</code> the target encoding.

   <p>The file <code>makecomp</code> contains a shell script (run by the
installation program) which generates fonts with composite characters
for the Times, Courier and Helvetica families from the supplementary
AFMs <code>*-c.afm</code>.

<div class="node">
<p><hr>
<a name="Composite-example"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Composite-usage">Composite usage</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Adding-new-characters">Adding new characters</a>
<br>
</div>

<h3 class="section">3.5 A step-by-step example</h3>

<p>Assume that you want to add the <code>ccaron</code> and <code>Ccaron</code>
characters to the Times-Roman font.  Start from similar characters
already present in the base Times-Roman font &mdash; for example,
<code>zcaron</code> and <code>Zcaron</code>.  Take the corresponding <dfn>composite
character</dfn> (<code>CC</code>) line from the <code>ptmr.afm</code> file:

<pre class="example">     CC zcaron 2 ; PCC z 0 0 ; PCC caron 55 0 ;
</pre>
   <p class="noindent">and insert it into the <code>ptmr-c.afm</code> file, changing the names
of the characters thus:

<pre class="example">     CC ccaron 2 ; PCC c 0 0 ; PCC caron 55 0 ;
</pre>
   <p class="noindent">This line can be used as a starting point.  Execute <code>./instogonki</code>,
typeset some text with the new character, and fine-tune the last set of
coordinates (<code>55 0</code>).

   <p>If you create new AFMs or modify the existing ones, please send me a
copy so that I can include them in the distribution.

<div class="node">
<p><hr>
<a name="Reaching-the-author"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Adding-new-characters">Adding new characters</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">4 Reaching the author</h2>

<p>This manual and most of the Ogonkify package were written by Juliusz
Chroboczek, &lt;jec@dcs.ed.ac.uk&gt;.

   <p>My current snail-mail address is:
<pre class="display">     Juliusz Chroboczek
     Department of Computer Science
     Mayfield Road
     Edinburgh EH9 3JZ
     Scotland, United Kingdom
     tel. +44/131/650-5163
     fax. +44/131/667-7209
</pre>
   <!-- @contents -->
</body></html>

