<html lang="en">
<head>
<title>Libtool</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Libtool">
<meta name="generator" content="makeinfo 4.7">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc { font-variant:small-caps }
  span.roman { font-family: serif; font-weight: normal; } 
--></style>
</head>
<body>
This file documents GNU Libtool 1.5.26

   <p>Copyright (C) 1996-2003, 2005-2007 Free Software Foundation, Inc.

   <p>Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.2
or any later version published by the Free Software Foundation;
with no Invariant Sections, with no Front-Cover Texts,
and with no Back-Cover Texts.  A copy of the license is included in
the section entitled "GNU Free Documentation License".

<!-- Put everything in one index (arbitrarily chosen to be the concept index). -->
<div class="node">
<p><hr>
<a name="Top"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction">Introduction</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#dir">(dir)</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>
<br>
</div>

<!-- node-name,  next,  previous,  up -->
<h2 class="unnumbered">Shared library support for GNU</h2>

<p>This file documents GNU Libtool, a script that allows package developers
to provide generic shared library support.  This edition documents
version 1.5.26.

   <p>See <a href="#Reporting-bugs">Reporting bugs</a>, for information on how to report problems with
libtool.

<ul class="menu">
<li><a accesskey="1" href="#Introduction">Introduction</a>:                 What the heck is libtool? 
<li><a accesskey="2" href="#Libtool-paradigm">Libtool paradigm</a>:             How libtool's view of libraries is different. 
<li><a accesskey="3" href="#Using-libtool">Using libtool</a>:                Example of using libtool to build libraries. 
<li><a accesskey="4" href="#Invoking-libtool">Invoking libtool</a>:             Running the <code>libtool</code> script. 
<li><a accesskey="5" href="#Integrating-libtool">Integrating libtool</a>:          Using libtool in your own packages. 
<li><a accesskey="6" href="#Versioning">Versioning</a>:                   Using library interface versions. 
<li><a accesskey="7" href="#Library-tips">Library tips</a>:                 Tips for library interface design. 
<li><a accesskey="8" href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a>:   Libraries that depend on other libraries. 
<li><a accesskey="9" href="#Dlopened-modules">Dlopened modules</a>:             <code>dlopen</code>ing libtool-created libraries. 
<li><a href="#Using-libltdl">Using libltdl</a>:                Libtool's portable <code>dlopen</code> wrapper library. 
<li><a href="#Other-languages">Other languages</a>:              Using libtool without a C compiler. 
<li><a href="#Troubleshooting">Troubleshooting</a>:              When libtool doesn't work as advertised. 
<li><a href="#Maintaining">Maintaining</a>:                  Information used by the libtool maintainer. 
<li><a href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>:  License for this manual. 
<li><a href="#Index">Index</a>:                        Full index.

</li></ul>
<p>Introduction

</p>
<ul class="menu">
<li><a href="#Motivation">Motivation</a>:                   Why does GNU need a libtool? 
<li><a href="#Issues">Issues</a>:                       The problems that need to be addressed. 
<li><a href="#Other-implementations">Other implementations</a>:        How other people have solved these issues. 
<li><a href="#Postmortem">Postmortem</a>:                   Learning from past difficulties.

</li></ul>
<p>Using libtool

</p>
<ul class="menu">
<li><a href="#Creating-object-files">Creating object files</a>:        Compiling object files for libraries. 
<li><a href="#Linking-libraries">Linking libraries</a>:            Creating libraries from object files. 
<li><a href="#Linking-executables">Linking executables</a>:          Linking object files against libtool libraries. 
<li><a href="#Debugging-executables">Debugging executables</a>:        Running GDB on libtool-generated programs. 
<li><a href="#Installing-libraries">Installing libraries</a>:         Making libraries available to users. 
<li><a href="#Installing-executables">Installing executables</a>:       Making programs available to users. 
<li><a href="#Static-libraries">Static libraries</a>:             When shared libraries are not wanted.

</li></ul>
<p>Invoking <code>libtool</code>

</p>
<ul class="menu">
<li><a href="#Compile-mode">Compile mode</a>:                 Creating library object files. 
<li><a href="#Link-mode">Link mode</a>:                    Generating executables and libraries. 
<li><a href="#Execute-mode">Execute mode</a>:                 Debugging libtool-generated programs. 
<li><a href="#Install-mode">Install mode</a>:                 Making libraries and executables public. 
<li><a href="#Finish-mode">Finish mode</a>:                  Completing a library installation. 
<li><a href="#Uninstall-mode">Uninstall mode</a>:               Removing installed executables and libraries. 
<li><a href="#Clean-mode">Clean mode</a>:                   Removing uninstalled executables and libraries.

</li></ul>
<p>Integrating libtool with your package

</p>
<ul class="menu">
<li><a href="#Makefile-rules">Makefile rules</a>:               Writing <span class="file">Makefile</span> rules for libtool. 
<li><a href="#Using-Automake">Using Automake</a>:               Automatically supporting libtool. 
<li><a href="#Configuring">Configuring</a>:                  Configuring libtool for a host system. 
<li><a href="#Distributing">Distributing</a>:                 What files to distribute with your package. 
<li><a href="#Static_002donly-libraries">Static-only libraries</a>:        Sometimes shared libraries are just a pain.

</li></ul>
<p>Configuring libtool

</p>
<ul class="menu">
<li><a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a>:              Configuring <code>libtool</code> in <span class="file">configure.in</span>. 
<li><a href="#Configure-notes">Configure notes</a>:              Platform-specific notes for configuration.

</li></ul>
<p>Including libtool in your package

</p>
<ul class="menu">
<li><a href="#Invoking-libtoolize">Invoking libtoolize</a>:          <code>libtoolize</code> command line options. 
<li><a href="#Autoconf-_002eo-macros">Autoconf .o macros</a>:           Autoconf macros that set object file names.

</li></ul>
<p>Library interface versions

</p>
<ul class="menu">
<li><a href="#Interfaces">Interfaces</a>:                   What are library interfaces? 
<li><a href="#Libtool-versioning">Libtool versioning</a>:           Libtool's versioning system. 
<li><a href="#Updating-version-info">Updating version info</a>:        Changing version information before releases. 
<li><a href="#Release-numbers">Release numbers</a>:              Breaking binary compatibility for aesthetics.

</li></ul>
<p>Tips for interface design

</p>
<ul class="menu">
<li><a href="#C-header-files">C header files</a>:               How to write portable include files.

</li></ul>
<p>Dlopened modules

</p>
<ul class="menu">
<li><a href="#Building-modules">Building modules</a>:             Creating dlopenable objects and libraries. 
<li><a href="#Dlpreopening">Dlpreopening</a>:                 Dlopening that works on static platforms. 
<li><a href="#Finding-the-dlname">Finding the dlname</a>:           Choosing the right file to <code>dlopen</code>. 
<li><a href="#Dlopen-issues">Dlopen issues</a>:                Unresolved problems that need your attention.

</li></ul>
<p>Using libltdl

</p>
<ul class="menu">
<li><a href="#Libltdl-interface">Libltdl interface</a>:            How to use libltdl in your programs. 
<li><a href="#Modules-for-libltdl">Modules for libltdl</a>:          Creating modules that can be <code>dlopen</code>ed. 
<li><a href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a>: 	Registering callbacks for multi-thread safety. 
<li><a href="#User-defined-module-data">User defined module data</a>:     Associating data with loaded modules. 
<li><a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a>:   Creating user defined module loaders. 
<li><a href="#Distributing-libltdl">Distributing libltdl</a>:         How to distribute libltdl with your package.

</li></ul>
<p>Using libtool with other languages

</p>
<ul class="menu">
<li><a href="#C_002b_002b-libraries">C++ libraries</a>:                Writing libraries for C++
<li><a href="#Tags">Tags</a>:                         Tags

</li></ul>
<p>Troubleshooting

</p>
<ul class="menu">
<li><a href="#Libtool-test-suite">Libtool test suite</a>:           Libtool's self-tests. 
<li><a href="#Reporting-bugs">Reporting bugs</a>:               How to report problems with libtool.

</li></ul>
<p>The libtool test suite

</p>
<ul class="menu">
<li><a href="#Test-descriptions">Test descriptions</a>:            The contents of the test suite. 
<li><a href="#When-tests-fail">When tests fail</a>:              What to do when a test fails.

</li></ul>
<p>Maintenance notes for libtool

</p>
<ul class="menu">
<li><a href="#New-ports">New ports</a>:                    How to port libtool to new systems. 
<li><a href="#Tested-platforms">Tested platforms</a>:             When libtool was last tested. 
<li><a href="#Platform-quirks">Platform quirks</a>:              Information about different library systems. 
<li><a href="#libtool-script-contents">libtool script contents</a>:      Configuration information that libtool uses. 
<li><a href="#Cheap-tricks">Cheap tricks</a>:                 Making libtool maintainership easier.

</li></ul>
<p>Porting libtool to new systems

</p>
<ul class="menu">
<li><a href="#Information-sources">Information sources</a>:          Where to find relevant documentation
<li><a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a>:   Implementation details explained

</li></ul>
<p>Platform quirks

</p>
<ul class="menu">
<li><a href="#References">References</a>:                   Finding more information. 
<li><a href="#Compilers">Compilers</a>:                    Creating object files from source files. 
<li><a href="#Reloadable-objects">Reloadable objects</a>:           Binding object files together. 
<li><a href="#Multiple-dependencies">Multiple dependencies</a>: 	Removing duplicate dependent libraries. 
<li><a href="#Archivers">Archivers</a>:                    Programs that create static archives.

   </ul>

<div class="node">
<p><hr>
<a name="Introduction"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Libtool-paradigm">Libtool paradigm</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">1 Introduction</h2>

<p>In the past, if a source code package developer wanted to take advantage
of the power of shared libraries, he needed to write custom support code
for each platform on which his package ran.  He also had to design a
configuration interface so that the package installer could choose what sort of
libraries were built.

   <p>GNU Libtool simplifies the developer's job by encapsulating both the
platform-specific dependencies, and the user interface, in a single
script.  GNU Libtool is designed so that the complete functionality of
each host type is available via a generic interface, but nasty quirks
are hidden from the programmer.

   <p>GNU Libtool's consistent interface is reassuring<small class="dots">...</small> users don't need
to read obscure documentation in order to have their favorite source
package build shared libraries.  They just run your package
<code>configure</code> script (or equivalent), and libtool does all the dirty
work.

   <p>There are several examples throughout this document.  All assume the
same environment: we want to build a library, <span class="file">libhello</span>, in a
generic way.

   <p><span class="file">libhello</span> could be a shared library, a static library, or
both<small class="dots">...</small> whatever is available on the host system, as long as libtool
has been ported to it.

   <p>This chapter explains the original design philosophy of libtool.  Feel
free to skip to the next chapter, unless you are interested in history,
or want to write code to extend libtool in a consistent way.

<ul class="menu">
<li><a accesskey="1" href="#Motivation">Motivation</a>:                   Why does GNU need a libtool? 
<li><a accesskey="2" href="#Issues">Issues</a>:                       The problems that need to be addressed. 
<li><a accesskey="3" href="#Other-implementations">Other implementations</a>:        How other people have solved these issues. 
<li><a accesskey="4" href="#Postmortem">Postmortem</a>:                   Learning from past difficulties. 
</ul>

<div class="node">
<p><hr>
<a name="Motivation"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Issues">Issues</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.1 Motivation for writing libtool</h3>

<p><a name="index-motivation-for-writing-libtool-1"></a><a name="index-design-philosophy-2"></a>Since early 1995, several different GNU developers have recognized the
importance of having shared library support for their packages.  The
primary motivation for such a change is to encourage modularity and
reuse of code (both conceptually and physically) in GNU programs.

   <p>Such a demand means that the way libraries are built in GNU packages
needs to be general, to allow for any library type the package installer
might want.  The problem is compounded by the absence of a standard
procedure for creating shared libraries on different platforms.

   <p>The following sections outline the major issues facing shared library
support in GNU, and how shared library support could be standardized
with libtool.

   <p><a name="index-specifications-for-libtool-3"></a><a name="index-libtool-specifications-4"></a>The following specifications were used in developing and evaluating this
system:

     <ol type=1 start=1>
<li>The system must be as elegant as possible.

     <li>The system must be fully integrated with the GNU Autoconf and Automake
utilities, so that it will be easy for GNU maintainers to use.  However,
the system must not require these tools, so that it can be used by
non-GNU packages.

     <li>Portability to other (non-GNU) architectures and tools is desirable.
        </ol>

<div class="node">
<p><hr>
<a name="Issues"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-implementations">Other implementations</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Motivation">Motivation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.2 Implementation issues</h3>

<p><a name="index-tricky-design-issues-5"></a><a name="index-design-issues-6"></a>The following issues need to be addressed in any reusable shared library
system, specifically libtool:

     <ol type=1 start=1>
<li>The package installer should be able to control what sort of libraries
are built.

     <li>It can be tricky to run dynamically linked programs whose libraries have
not yet been installed.  <code>LD_LIBRARY_PATH</code> must be set properly (if
it is supported), or programs fail to run.

     <li>The system must operate consistently even on hosts which don't support
shared libraries.

     <li>The commands required to build shared libraries may differ wildly from
host to host.  These need to be determined at configure time in
a consistent way.

     <li>It is not always obvious with which suffix a shared library should be
installed.  This makes it difficult for <span class="file">Makefile</span> rules, since they
generally assume that file names are the same from host to host.

     <li>The system needs a simple library version number abstraction, so that
shared libraries can be upgraded in place.  The programmer should be
informed how to design the interfaces to the library to maximize binary
compatibility.

     <li>The install <span class="file">Makefile</span> target should warn the package installer to set
the proper environment variables (<code>LD_LIBRARY_PATH</code> or equivalent),
or run <code>ldconfig</code>.
        </ol>

<div class="node">
<p><hr>
<a name="Other-implementations"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Postmortem">Postmortem</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Issues">Issues</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.3 Other implementations</h3>

<p>Even before libtool was developed, many free software packages built and
installed their own shared libraries.  At first, these packages were
examined to avoid reinventing existing features.

   <p>Now it is clear that none of these packages have documented the details
of shared library systems that libtool requires.  So, other packages
have been more or less abandoned as influences.

<div class="node">
<p><hr>
<a name="Postmortem"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-implementations">Other implementations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>
<br>
</div>

<h3 class="section">1.4 A postmortem analysis of other implementations</h3>

<p><a name="index-other-implementations_002c-flaws-in-7"></a><a name="index-reusability-of-library-systems-8"></a>In all fairness, each of the implementations that were examined do the
job that they were intended to do, for a number of different host
systems.  However, none of these solutions seem to function well as a
generalized, reusable component.

   <p><a name="index-complexity-of-library-systems-9"></a>Most were too complex to use (much less modify) without understanding
exactly what the implementation does, and they were generally not
documented.

   <p>The main difficulty is that different vendors have different views of
what libraries are, and none of the packages which were examined seemed
to be confident enough to settle on a single paradigm that just
<em>works</em>.

   <p>Ideally, libtool would be a standard that would be implemented as series
of extensions and modifications to existing library systems to make them
work consistently.  However, it is not an easy task to convince
operating system developers to mend their evil ways, and people want to
build shared libraries right now, even on buggy, broken, confused
operating systems.

   <p>For this reason, libtool was designed as an independent shell script. 
It isolates the problems and inconsistencies in library building that
plague <span class="file">Makefile</span> writers by wrapping the compiler suite on
different platforms with a consistent, powerful interface.

   <p>With luck, libtool will be useful to and used by the GNU community, and
that the lessons that were learned in writing it will be taken up by
designers of future library systems.

<div class="node">
<p><hr>
<a name="Libtool-paradigm"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-libtool">Using libtool</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">2 The libtool paradigm</h2>

<p>At first, libtool was designed to support an arbitrary number of library
object types.  After libtool was ported to more platforms, a new
paradigm gradually developed for describing the relationship between
libraries and programs.

   <p><a name="index-definition-of-libraries-10"></a><a name="index-libraries_002c-definition-of-11"></a>In summary, &ldquo;libraries are programs with multiple entry points, and
more formally defined interfaces.&rdquo;

   <p>Version 0.7 of libtool was a complete redesign and rewrite of libtool to
reflect this new paradigm.  So far, it has proved to be successful:
libtool is simpler and more useful than before.

   <p>The best way to introduce the libtool paradigm is to contrast it with
the paradigm of existing library systems, with examples from each.  It
is a new way of thinking, so it may take a little time to absorb, but
when you understand it, the world becomes simpler.

<div class="node">
<p><hr>
<a name="Using-libtool"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Invoking-libtool">Invoking libtool</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Libtool-paradigm">Libtool paradigm</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">3 Using libtool</h2>

<p><a name="index-examples-of-using-libtool-12"></a><a name="index-libtool-examples-13"></a>It makes little sense to talk about using libtool in your own packages
until you have seen how it makes your life simpler.  The examples in
this chapter introduce the main features of libtool by comparing the
standard library building procedure to libtool's operation on two
different platforms:

     <dl>
<dt><span class="samp">a23</span><dd>An Ultrix 4.2 platform with only static libraries.

     <br><dt><span class="samp">burger</span><dd>A NetBSD/i386 1.2 platform with shared libraries. 
</dl>

   <p>You can follow these examples on your own platform, using the
preconfigured libtool script that was installed with libtool
(see <a href="#Configuring">Configuring</a>).

   <p>Source files for the following examples are taken from the <span class="file">demo</span>
subdirectory of the libtool distribution.  Assume that we are building a
library, <span class="file">libhello</span>, out of the files <span class="file">foo.c</span> and
<span class="file">hello.c</span>.

   <p>Note that the <span class="file">foo.c</span> source file uses the <code>cos</code> math library
function, which is usually found in the standalone math library, and not
the C library (see <a href="libc.html#Trig-Functions">Trigonometric Functions (The GNU C Library Reference Manual)</a>).  So, we need to add <kbd>-lm</kbd> to
the end of the link line whenever we link <span class="file">foo.o</span> or <span class="file">foo.lo</span>
into an executable or a library (see <a href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a>).

   <p>The same rule applies whenever you use functions that don't appear in
the standard C library<small class="dots">...</small> you need to add the appropriate
<kbd>-l</kbd><var>name</var> flag to the end of the link line when you link
against those objects.

   <p>After we have built that library, we want to create a program by linking
<span class="file">main.o</span> against <span class="file">libhello</span>.

<ul class="menu">
<li><a accesskey="1" href="#Creating-object-files">Creating object files</a>:        Compiling object files for libraries. 
<li><a accesskey="2" href="#Linking-libraries">Linking libraries</a>:            Creating libraries from object files. 
<li><a accesskey="3" href="#Linking-executables">Linking executables</a>:          Linking object files against libtool libraries. 
<li><a accesskey="4" href="#Debugging-executables">Debugging executables</a>:        Running GDB on libtool-generated programs. 
<li><a accesskey="5" href="#Installing-libraries">Installing libraries</a>:         Making libraries available to users. 
<li><a accesskey="6" href="#Installing-executables">Installing executables</a>:       Making programs available to users. 
<li><a accesskey="7" href="#Static-libraries">Static libraries</a>:             When shared libraries are not wanted. 
</ul>

<div class="node">
<p><hr>
<a name="Creating-object-files"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Linking-libraries">Linking libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libtool">Using libtool</a>
<br>
</div>

<h3 class="section">3.1 Creating object files</h3>

<p><a name="index-compiling-object-files-14"></a><a name="index-object-files_002c-compiling-15"></a>To create an object file from a source file, the compiler is invoked
with the `-c' flag (and any other desired flags):

<pre class="example">     burger$ <kbd>gcc -g -O -c main.c</kbd>
     burger$
</pre>
   <p>The above compiler command produces an object file, <span class="file">main.o</span>, from
the source file <span class="file">main.c</span>.

   <p>For most library systems, creating object files that become part of a
static library is as simple as creating object files that are linked to
form an executable:

<pre class="example">     burger$ <kbd>gcc -g -O -c foo.c</kbd>
     burger$ <kbd>gcc -g -O -c hello.c</kbd>
     burger$
</pre>
   <p><a name="index-position_002dindependent-code-16"></a><a name="index-PIC-_0028position_002dindependent-code_0029-17"></a>Shared libraries, however, may only be built from
<dfn>position-independent code</dfn> (PIC).  So, special flags must be passed
to the compiler to tell it to generate PIC rather than the standard
position-dependent code.

   <p><a name="index-library-object-file-18"></a><a name="index-_0040samp_007b_002elo_007d-files-19"></a><a name="index-object-files_002c-library-20"></a>Since this is a library implementation detail, libtool hides the
complexity of PIC compiler flags by using separate library object files
(which end in <span class="samp">.lo</span> instead of <span class="samp">.o</span>).  On systems without shared
libraries (or without special PIC compiler flags), these library object
files are identical to &ldquo;standard&rdquo; object files.

   <p>To create library object files for <span class="file">foo.c</span> and <span class="file">hello.c</span>,
simply invoke libtool with the standard compilation command as
arguments (see <a href="#Compile-mode">Compile mode</a>):

<pre class="example">     a23$ <kbd>libtool --mode=compile gcc -g -O -c foo.c</kbd>
     gcc -g -O -c foo.c
     echo timestamp &gt; foo.lo
     a23$ <kbd>libtool --mode=compile gcc -g -O -c hello.c</kbd>
     gcc -g -O -c hello.c
     echo timestamp &gt; hello.lo
     a23$
</pre>
   <p>Note that libtool creates two files for each invocation.  The <span class="samp">.lo</span>
file is a library object, which may be built into a shared library, and
the <span class="samp">.o</span> file is a standard object file.  On <span class="samp">a23</span>, the
library objects are just timestamps, because only static libraries are
supported.

   <p>On shared library systems, libtool automatically inserts the PIC
generation flags into the compilation command, so that the library
object and the standard object differ:

<pre class="example">     burger$ <kbd>libtool --mode=compile gcc -g -O -c foo.c</kbd>
     gcc -g -O -c -fPIC -DPIC foo.c
     mv -f foo.o foo.lo
     gcc -g -O -c foo.c &gt;/dev/null 2&gt;&amp;1
     burger$ <kbd>libtool --mode=compile gcc -g -O -c hello.c</kbd>
     gcc -g -O -c -fPIC -DPIC hello.c
     mv -f hello.o hello.lo
     gcc -g -O -c hello.c &gt;/dev/null 2&gt;&amp;1
     burger$
</pre>
   <p>Notice that the second run of GCC has its output discarded.  This is
done so that compiler warnings aren't annoyingly duplicated.

<div class="node">
<p><hr>
<a name="Linking-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Linking-executables">Linking executables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Creating-object-files">Creating object files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libtool">Using libtool</a>
<br>
</div>

<h3 class="section">3.2 Linking libraries</h3>

<p><a name="index-ar-21"></a>Without libtool, the programmer would invoke the <code>ar</code> command to
create a static library:

<pre class="example">     burger$ <kbd>ar cru libhello.a hello.o foo.o</kbd>
     burger$
</pre>
   <p><a name="index-ranlib-22"></a>But of course, that would be too simple, so many systems require that
you run the <code>ranlib</code> command on the resulting library (to give it
better karma, or something):

<pre class="example">     burger$ <kbd>ranlib libhello.a</kbd>
     burger$
</pre>
   <p>It seems more natural to use the C compiler for this task, given
libtool's &ldquo;libraries are programs&rdquo; approach.  So, on platforms without
shared libraries, libtool simply acts as a wrapper for the system
<code>ar</code> (and possibly <code>ranlib</code>) commands.

   <p><a name="index-libtool-libraries-23"></a><a name="index-_0040samp_007b_002ela_007d-files-24"></a>Again, the libtool library name differs from the standard name (it has a
<span class="samp">.la</span> suffix instead of a <span class="samp">.a</span> suffix).  The arguments to libtool are
the same ones you would use to produce an executable named
<span class="file">libhello.la</span> with your compiler (see <a href="#Link-mode">Link mode</a>):

<pre class="example">     a23$ <kbd>libtool --mode=link gcc -g -O -o libhello.la foo.o hello.o</kbd>
     libtool: cannot build libtool library `libhello.la' from non-libtool \
                     objects
     a23$
</pre>
   <p>Aha!  Libtool caught a common error<small class="dots">...</small> trying to build a library
from standard objects instead of library objects.  This doesn't matter
for static libraries, but on shared library systems, it is of great
importance.

   <p>So, let's try again, this time with the library object files.  Remember
also that we need to add <kbd>-lm</kbd> to the link command line because
<span class="file">foo.c</span> uses the <code>cos</code> math library function (see <a href="#Using-libtool">Using libtool</a>).

   <p>Another complication in building shared libraries is that we need to
specify the path to the directory in which they (eventually) will be
installed (in this case, <span class="file">/usr/local/lib</span>)<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a>:

<pre class="example">     a23$ <kbd>libtool --mode=link gcc -g -O -o libhello.la foo.lo hello.lo \
                     -rpath /usr/local/lib -lm</kbd>
     mkdir .libs
     ar cru .libs/libhello.a foo.o hello.o
     ranlib .libs/libhello.a
     creating libhello.la
     a23$
</pre>
   <p>Now, let's try the same trick on the shared library platform:

<pre class="example">     burger$ <kbd>libtool --mode=link gcc -g -O -o libhello.la foo.lo hello.lo \
                     -rpath /usr/local/lib -lm</kbd>
     mkdir .libs
     ld -Bshareable -o .libs/libhello.so.0.0 foo.lo hello.lo -lm
     ar cru .libs/libhello.a foo.o hello.o
     ranlib .libs/libhello.a
     creating libhello.la
     burger$
</pre>
   <p>Now that's significantly cooler<small class="dots">...</small> libtool just ran an obscure
<code>ld</code> command to create a shared library, as well as the static
library.

   <p><a name="index-_0040file_007b_0040value_007bobjdir_007d_007d-subdirectory-25"></a>Note how libtool creates extra files in the <span class="file">.libs</span>
subdirectory, rather than the current directory.  This feature is to
make it easier to clean up the build directory, and to help ensure that
other programs fail horribly if you accidentally forget to use libtool
when you should.

<div class="node">
<p><hr>
<a name="Linking-executables"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Debugging-executables">Debugging executables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Linking-libraries">Linking libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libtool">Using libtool</a>
<br>
</div>

<h3 class="section">3.3 Linking executables</h3>

<p><a name="index-linking-against-installed-libraries-26"></a>If you choose at this point to <dfn>install</dfn> the library (put it in a
permanent location) before linking executables against it, then you
don't need to use libtool to do the linking.  Simply use the appropriate
<span class="samp">-L</span> and <span class="samp">-l</span> flags to specify the library's location.

   <p><a name="index-buggy-system-linkers-27"></a>Some system linkers insist on encoding the full directory name of each
shared library in the resulting executable.  Libtool has to work around
this misfeature by special magic to ensure that only permanent directory
names are put into installed executables.

   <p><a name="index-security-problems-with-buggy-linkers-28"></a><a name="index-bugs_002c-subtle-ones-caused-by-buggy-linkers-29"></a>The importance of this bug must not be overlooked: it won't cause
programs to crash in obvious ways.  It creates a security hole,
and possibly even worse, if you are modifying the library source code
after you have installed the package, you will change the behaviour of
the installed programs!

   <p>So, if you want to link programs against the library before you install
it, you must use libtool to do the linking.

   <p><a name="index-linking-against-uninstalled-libraries-30"></a>Here's the old way of linking against an uninstalled library:

<pre class="example">     burger$ <kbd>gcc -g -O -o hell.old main.o libhello.a -lm</kbd>
     burger$
</pre>
   <p>Libtool's way is almost the same<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a>
(see <a href="#Link-mode">Link mode</a>):

<pre class="example">     a23$ <kbd>libtool --mode=link gcc -g -O -o hell main.o libhello.la -lm</kbd>
     gcc -g -O -o hell main.o ./.libs/libhello.a -lm
     a23$
</pre>
   <p>That looks too simple to be true.  All libtool did was transform
<span class="file">libhello.la</span> to <span class="file">./.libs/libhello.a</span>, but remember
that <span class="samp">a23</span> has no shared libraries.

   <p>On <span class="samp">burger</span> the situation is different:

<pre class="example">     burger$ <kbd>libtool --mode=link gcc -g -O -o hell main.o libhello.la -lm</kbd>
     gcc -g -O -o .libs/hell main.o -L./.libs -R/usr/local/lib -lhello -lm
     creating hell
     burger$
</pre>
   <p><a name="index-linking-with-installed-libtool-libraries-31"></a>
Now assume <span class="file">libhello.la</span> had already been installed, and you want
to link a new program with it.  You could figure out where it lives by
yourself, then run:

<pre class="example">     burger$ <kbd>gcc -g -O -o test test.o -L/usr/local/lib -lhello</kbd>
</pre>
   <p>However, unless <span class="file">/usr/local/lib</span> is in the standard library search
path, you won't be able to run <code>test</code>.  However, if you use libtool
to link the already-installed libtool library, it will do The Right
Thing (TM) for you:

<pre class="example">     burger$ <kbd>libtool --mode=link gcc -g -O -o test \
                     test.o /usr/local/lib/libhello.la</kbd>
     gcc -g -O -o .libs/test test.o -Wl,--rpath
     -Wl,/usr/local/lib /usr/local/lib/libhello.a -lm
     creating test
     burger$
</pre>
   <p>Note that libtool added the necessary run-time path flag, as well as
<span class="samp">-lm</span>, the library libhello.la depended upon.  Nice, huh?

   <p><a name="index-wrapper-scripts-for-programs-32"></a><a name="index-program-wrapper-scripts-33"></a>Notice that the executable, <code>hell</code>, was actually created in the
<span class="file">.libs</span> subdirectory.  Then, a wrapper script was created
in the current directory.

   <p>Since libtool created a wrapper script, you should use libtool to
install it and debug it too.  However, since the program does not depend
on any uninstalled libtool library, it is probably usable even without
the wrapper script.  Libtool could probably be made smarter to avoid the
creation of the wrapper script in this case, but this is left as an
exercise for the reader.

   <p>On NetBSD 1.2, libtool encodes the installation directory of
<span class="file">libhello</span>, by using the <span class="samp">-R/usr/local/lib</span> compiler flag. 
Then, the wrapper script guarantees that the executable finds the
correct shared library (the one in <span class="file">./.libs</span>) until it is
properly installed.

   <p>Let's compare the two different programs:

<pre class="example">     burger$ <kbd>time ./hell.old</kbd>
     Welcome to GNU Hell!
     ** This is not GNU Hello.  There is no built-in mail reader. **
             0.21 real         0.02 user         0.08 sys
     burger$ <kbd>time ./hell</kbd>
     Welcome to GNU Hell!
     ** This is not GNU Hello.  There is no built-in mail reader. **
             0.63 real         0.09 user         0.59 sys
     burger$
</pre>
   <p>The wrapper script takes significantly longer to execute, but at least
the results are correct, even though the shared library hasn't been
installed yet.

   <p>So, what about all the space savings that shared libraries are supposed
to yield?

<pre class="example">     burger$ <kbd>ls -l hell.old libhello.a</kbd>
     -rwxr-xr-x  1 gord  gord  15481 Nov 14 12:11 hell.old
     -rw-r--r--  1 gord  gord   4274 Nov 13 18:02 libhello.a
     burger$ <kbd>ls -l .libs/hell .libs/libhello.*</kbd>
     -rwxr-xr-x  1 gord  gord  11647 Nov 14 12:10 .libs/hell
     -rw-r--r--  1 gord  gord   4274 Nov 13 18:44 .libs/libhello.a
     -rwxr-xr-x  1 gord  gord  12205 Nov 13 18:44 .libs/libhello.so.0.0
     burger$
</pre>
   <p>Well, that sucks.  Maybe I should just scrap this project and take up
basket weaving.

   <p>Actually, it just proves an important point: shared libraries incur
overhead because of their (relative) complexity.  In this situation, the
price of being dynamic is eight kilobytes, and the payoff is about four
kilobytes.  So, having a shared <span class="file">libhello</span> won't be an advantage
until we link it against at least a few more programs.

<div class="node">
<p><hr>
<a name="Debugging-executables"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Installing-libraries">Installing libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Linking-executables">Linking executables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libtool">Using libtool</a>
<br>
</div>

<h3 class="section">3.4 Debugging executables</h3>

<p>If <span class="file">hell</span> was a complicated program, you would certainly want to
test and debug it before installing it on your system.  In the above
section, you saw how the libtool wrapper script makes it possible to run
the program directly, but unfortunately, this mechanism interferes with
the debugger:

<pre class="example">     burger$ <kbd>gdb hell</kbd>
     GDB is free software and you are welcome to distribute copies of it
      under certain conditions; type "show copying" to see the conditions.
     There is no warranty for GDB; type "show warranty" for details.
     GDB 4.16 (i386-unknown-netbsd), (C) 1996 Free Software Foundation, Inc.
     
     "hell": not in executable format: File format not recognized
     
     (gdb) <kbd>quit</kbd>
     burger$
</pre>
   <p>Sad.  It doesn't work because GDB doesn't know where the executable
lives.  So, let's try again, by invoking GDB directly on the executable:

<pre class="example">     burger$ <kbd>gdb .libs/hell</kbd>
     trick:/home/src/libtool/demo$ gdb .libs/hell
     GDB is free software and you are welcome to distribute copies of it
      under certain conditions; type "show copying" to see the conditions.
     There is no warranty for GDB; type "show warranty" for details.
     GDB 4.16 (i386-unknown-netbsd), (C) 1996 Free Software Foundation, Inc.
     (gdb) <kbd>break main</kbd>
     Breakpoint 1 at 0x8048547: file main.c, line 29.
     (gdb) <kbd>run</kbd>
     Starting program: /home/src/libtool/demo/.libs/hell
     /home/src/libtool/demo/.libs/hell: can't load library 'libhello.so.2'
     
     Program exited with code 020.
     (gdb) <kbd>quit</kbd>
     burger$
</pre>
   <p>Argh.  Now GDB complains because it cannot find the shared library that
<span class="file">hell</span> is linked against.  So, we must use libtool in order to
properly set the library path and run the debugger.  Fortunately, we can
forget all about the <span class="file">.libs</span> directory, and just run it on
the executable wrapper (see <a href="#Execute-mode">Execute mode</a>):

<pre class="example">     burger$ <kbd>libtool --mode=execute gdb hell</kbd>
     GDB is free software and you are welcome to distribute copies of it
      under certain conditions; type "show copying" to see the conditions.
     There is no warranty for GDB; type "show warranty" for details.
     GDB 4.16 (i386-unknown-netbsd), (C) 1996 Free Software Foundation, Inc.
     (gdb) <kbd>break main</kbd>
     Breakpoint 1 at 0x8048547: file main.c, line 29.
     (gdb) <kbd>run</kbd>
     Starting program: /home/src/libtool/demo/.libs/hell
     
     Breakpoint 1, main (argc=1, argv=0xbffffc40) at main.c:29
     29	  printf ("Welcome to GNU Hell!\n");
     (gdb) <kbd>quit</kbd>
     The program is running.  Quit anyway (and kill it)? (y or n) <kbd>y</kbd>
     burger$
</pre>
   <div class="node">
<p><hr>
<a name="Installing-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Installing-executables">Installing executables</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Debugging-executables">Debugging executables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libtool">Using libtool</a>
<br>
</div>

<h3 class="section">3.5 Installing libraries</h3>

<p><a name="index-strip-34"></a>Installing libraries on a non-libtool system is quite
straightforward<small class="dots">...</small> just copy them into place:<a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>

   <p><a name="index-su-35"></a>
<pre class="example">     burger$ <kbd>su</kbd>
     Password: <kbd>********</kbd>
     burger# <kbd>cp libhello.a /usr/local/lib/libhello.a</kbd>
     burger#
</pre>
   <p>Oops, don't forget the <code>ranlib</code> command:

<pre class="example">     burger# <kbd>ranlib /usr/local/lib/libhello.a</kbd>
     burger#
</pre>
   <p><a name="index-install-36"></a>Libtool installation is quite simple, as well.  Just use the
<code>install</code> or <code>cp</code> command that you normally would
(see <a href="#Install-mode">Install mode</a>):

<pre class="example">     a23# <kbd>libtool --mode=install cp libhello.la /usr/local/lib/libhello.la</kbd>
     cp libhello.la /usr/local/lib/libhello.la
     cp .libs/libhello.a /usr/local/lib/libhello.a
     ranlib /usr/local/lib/libhello.a
     a23#
</pre>
   <p>Note that the libtool library <span class="file">libhello.la</span> is also installed, to
help libtool with uninstallation (see <a href="#Uninstall-mode">Uninstall mode</a>) and linking
(see <a href="#Linking-executables">Linking executables</a>) and to help programs with dlopening
(see <a href="#Dlopened-modules">Dlopened modules</a>).

   <p>Here is the shared library example:

<pre class="example">     burger# <kbd>libtool --mode=install install -c libhello.la \
                     /usr/local/lib/libhello.la</kbd>
     install -c .libs/libhello.so.0.0 /usr/local/lib/libhello.so.0.0
     install -c libhello.la /usr/local/lib/libhello.la
     install -c .libs/libhello.a /usr/local/lib/libhello.a
     ranlib /usr/local/lib/libhello.a
     burger#
</pre>
   <p><a name="index-stripping-libraries-37"></a><a name="index-libraries_002c-stripping-38"></a>It is safe to specify the <span class="samp">-s</span> (strip symbols) flag if you use a
BSD-compatible install program when installing libraries. 
Libtool will either ignore the <span class="samp">-s</span> flag, or will run a program
that will strip only debugging and compiler symbols from the library.

   <p>Once the libraries have been put in place, there may be some additional
configuration that you need to do before using them.  First, you must
make sure that where the library is installed actually agrees with the
<span class="samp">-rpath</span> flag you used to build it.

   <p><a name="index-postinstallation-39"></a><a name="index-installation_002c-finishing-40"></a><a name="index-libraries_002c-finishing-installation-41"></a>Then, running <span class="samp">libtool -n --mode=finish </span><var>libdir</var> can give you
further hints on what to do (see <a href="#Finish-mode">Finish mode</a>):

<pre class="example">     burger# <kbd>libtool -n --mode=finish /usr/local/lib</kbd>
     PATH="$PATH:/sbin" ldconfig -m /usr/local/lib
     -----------------------------------------------------------------
     Libraries have been installed in:
        /usr/local/lib
     
     To link against installed libraries in a given directory, LIBDIR,
     you must use the `-LLIBDIR' flag during linking.
     
      You will also need to do one of the following:
        - add LIBDIR to the `LD_LIBRARY_PATH' environment variable
          during execution
        - add LIBDIR to the `LD_RUN_PATH' environment variable
          during linking
        - use the `-RLIBDIR' linker flag
     
     See any operating system documentation about shared libraries for
     more information, such as the ld and ld.so manual pages.
     -----------------------------------------------------------------
     burger#
</pre>
   <p>After you have completed these steps, you can go on to begin using the
installed libraries.  You may also install any executables that depend
on libraries you created.

<div class="node">
<p><hr>
<a name="Installing-executables"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Static-libraries">Static libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing-libraries">Installing libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libtool">Using libtool</a>
<br>
</div>

<h3 class="section">3.6 Installing executables</h3>

<p>If you used libtool to link any executables against uninstalled libtool
libraries (see <a href="#Linking-executables">Linking executables</a>), you need to use libtool to
install the executables after the libraries have been installed
(see <a href="#Installing-libraries">Installing libraries</a>).

   <p>So, for our Ultrix example, we would run:

<pre class="example">     a23# libtool install -c hell /usr/local/bin/hell
     install -c hell /usr/local/bin/hell
     a23#
</pre>
   <p>On shared library systems, libtool just ignores the wrapper script and
installs the correct binary:

<pre class="example">     burger# libtool install -c hell /usr/local/bin/hell
     install -c .libs/hell /usr/local/bin/hell
     burger#
</pre>
   <div class="node">
<p><hr>
<a name="Static-libraries"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Installing-executables">Installing executables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libtool">Using libtool</a>
<br>
</div>

<h3 class="section">3.7 Linking static libraries</h3>

<p><a name="index-static-linking-42"></a><a name="index-convenience-libraries-43"></a>Why return to <code>ar</code> and <code>ranlib</code> silliness when you've had a
taste of libtool?  Well, sometimes it is desirable to create a static
archive that can never be shared.  The most frequent case is when you
have a set of object files that you use to build several different
programs.  You can create a &ldquo;convenience library&rdquo; out of those
objects, and link programs with the library, instead of listing all
object files for every program.  This technique is often used to
overcome GNU automake's lack of support for linking object files built
from sources in other directories, because it supports linking with
libraries from other directories.  This limitation applies to GNU
automake up to release 1.4; newer releases should support sources in
other directories.

   <p>If you just want to link this convenience library into programs, then
you could just ignore libtool entirely, and use the old <code>ar</code> and
<code>ranlib</code> commands (or the corresponding GNU automake
<span class="samp">_LIBRARIES</span> rules).  You can even install a convenience library
(but you probably don't want to) using libtool:

<pre class="example">     burger$ <kbd>libtool --mode=install ./install-sh -c libhello.a \
                     /local/lib/libhello.a</kbd>
     ./install-sh -c libhello.a /local/lib/libhello.a
     ranlib /local/lib/libhello.a
     burger$
</pre>
   <p>Using libtool for static library installation protects your library from
being accidentally stripped (if the installer used the <span class="samp">-s</span> flag),
as well as automatically running the correct <code>ranlib</code> command.

   <p>But libtool libraries are more than just collections of object files:
they can also carry library dependency information, which old archives
do not.  If you want to create a libtool static convenience library, you
can omit the <span class="samp">-rpath</span> flag and use <span class="samp">-static</span> to indicate that
you're only interested in a static library.  When you link a program
with such a library, libtool will actually link all object files and
dependency libraries into the program.

   <p>If you omit both <span class="samp">-rpath</span> and <span class="samp">-static</span>, libtool will create a
convenience library that can be used to create other libtool
libraries, even shared ones.  Just like in the static case, the library
behaves as an alias to a set of object files and dependency libraries,
but in this case the object files are suitable for inclusion in shared
libraries.  But be careful not to link a single convenience library,
directly or indirectly, into a single program or library, otherwise you
may get errors about symbol redefinitions.

   <p>When GNU automake is used, you should use <code>noinst_LTLIBRARIES</code>
instead of <code>lib_LTLIBRARIES</code> for convenience libraries, so that
the <span class="samp">-rpath</span> option is not passed when they are linked.

   <p>As a rule of thumb, link a libtool convenience library into at most one
libtool library, and never into a program, and link libtool static
convenience libraries only into programs, and only if you need to carry
library dependency information to the user of the static convenience
library.

   <p><a name="index-standalone-binaries-44"></a>Another common situation where static linking is desirable is in
creating a standalone binary.  Use libtool to do the linking and add the
<span class="samp">-all-static</span> flag.

<div class="node">
<p><hr>
<a name="Invoking-libtool"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Integrating-libtool">Integrating libtool</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-libtool">Using libtool</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">4 Invoking <code>libtool</code></h2>

<p><a name="index-libtool-45"></a><a name="index-libtool-command-options-46"></a><a name="index-options_002c-libtool-command-47"></a><a name="index-command-options_002c-libtool-48"></a>
The <code>libtool</code> program has the following synopsis:

<pre class="example">     libtool [<var>option</var>]... [<var>mode-arg</var>]...
</pre>
   <p class="noindent">and accepts the following options:

     <dl>
<dt><span class="samp">--config</span><dd>Display libtool configuration variables and exit.

     <br><dt><span class="samp">--debug</span><dd>Dump a trace of shell script execution to standard output.  This
produces a lot of output, so you may wish to pipe it to <code>less</code> (or
<code>more</code>) or redirect to a file.

     <br><dt><span class="samp">-n</span><dt><span class="samp">--dry-run</span><dd>Don't create, modify, or delete any files, just show what commands would
be executed by libtool.

     <br><dt><span class="samp">--features</span><dd>Display basic configuration options.  This provides a way for packages
to determine whether shared or static libraries will be built.

     <br><dt><span class="samp">--tag=</span><var>tag</var><dd>Use configuration variables from tag <var>tag</var> (see <a href="#Tags">Tags</a>).

     <br><dt><span class="samp">--preserve-dup-deps</span><dd>Do not remove duplicate dependencies in libraries.  When building packages
with static libraries, the libraries may depend circularly on each other
(shared libs can too, but for those it doesn't matter), so there are
situations, where -la -lb -la is required, and the second -la may not be
stripped or the link will fail.  In cases where these duplications are
required, this option will preserve them, only stripping the libraries
that libtool knows it can safely.

     <br><dt><span class="samp">--finish</span><dd>Same as <span class="samp">--mode=finish</span>.

     <br><dt><span class="samp">--help</span><dd>Display a help message and exit.  If <span class="samp">--mode=</span><var>mode</var> is
specified, then detailed help for <var>mode</var> is
displayed.

     <br><dt><span class="samp">--mode=</span><var>mode</var><dd>Use <var>mode</var> as the operation mode.  If not specified, an attempt is
made to infer the operation mode from the <var>mode-args</var>.  Not specifying
the <var>mode</var> is currently deprecated, as there are too many situations
where it is not possible to guess.  Future versions of Libtool will require
that <var>mode</var> be explicitly set.

     <p><var>mode</var> must be set to one of the following:

          <dl>
<dt><span class="samp">compile</span><dd>Compile a source file into a libtool object.

          <br><dt><span class="samp">execute</span><dd>Automatically set the library path so that another program can use
uninstalled libtool-generated programs or libraries.

          <br><dt><span class="samp">finish</span><dd>Complete the installation of libtool libraries on the system.

          <br><dt><span class="samp">install</span><dd>Install libraries or executables.

          <br><dt><span class="samp">link</span><dd>Create a library or an executable.

          <br><dt><span class="samp">uninstall</span><dd>Delete installed libraries or executables.

          <br><dt><span class="samp">clean</span><dd>Delete uninstalled libraries or executables. 
</dl>

     <br><dt><span class="samp">--version</span><dd>Print libtool version information and exit. 
</dl>

   <p>The <var>mode-args</var> are a variable number of arguments, depending on the
selected operation mode.  In general, each <var>mode-arg</var> is interpreted
by programs libtool invokes, rather than libtool itself.

<ul class="menu">
<li><a accesskey="1" href="#Compile-mode">Compile mode</a>:                 Creating library object files. 
<li><a accesskey="2" href="#Link-mode">Link mode</a>:                    Generating executables and libraries. 
<li><a accesskey="3" href="#Execute-mode">Execute mode</a>:                 Debugging libtool-generated programs. 
<li><a accesskey="4" href="#Install-mode">Install mode</a>:                 Making libraries and executables public. 
<li><a accesskey="5" href="#Finish-mode">Finish mode</a>:                  Completing a library installation. 
<li><a accesskey="6" href="#Uninstall-mode">Uninstall mode</a>:               Removing installed executables and libraries. 
<li><a accesskey="7" href="#Clean-mode">Clean mode</a>:                   Removing uninstalled executables and libraries. 
</ul>

<div class="node">
<p><hr>
<a name="Compile-mode"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Link-mode">Link mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-libtool">Invoking libtool</a>
<br>
</div>

<h3 class="section">4.1 Compile mode</h3>

<p><a name="index-mode_002c-compile-49"></a><a name="index-compile-mode-50"></a>
For <dfn>compile</dfn> mode, <var>mode-args</var> is a compiler command to be used
in creating a `standard' object file.  These arguments should begin with
the name of the C compiler, and contain the <span class="samp">-c</span> compiler flag so
that only an object file is created.

   <p>Libtool determines the name of the output file by removing the directory
component from the source file name, then substituting the source code
suffix (e.g. <span class="samp">.c</span> for C source code) with the library object suffix,
<span class="samp">.lo</span>.

   <p>If shared libraries are being built, any necessary PIC generation flags
are substituted into the compilation command.  You can pass link specific
flags to the compiler driver using <span class="samp">-XCClinker </span><var>flag</var> or pass
linker flags with <span class="samp">-Wl,</span><var>flag</var> and <span class="samp">-Xlinker </span><var>flag</var>. 
You can also pass compile specific flags using <span class="samp">-Wc,</span><var>flag</var>
and <span class="samp">-Xcompiler </span><var>flag</var>.

   <p>If both PIC and non-PIC objects are being built, libtool will normally
suppress the compiler output for the PIC object compilation to save
showing very similar, if not identical duplicate output for each
object.  If the <span class="samp">-no-suppress</span> option is given in compile mode,
libtool will show the compiler output for both objects.

   <p>If the <span class="samp">-static</span> option is given, then a <span class="samp">.o</span> file is built,
even if libtool was configured with <span class="samp">--disable-static</span>.

   <p>Note that the <span class="samp">-o</span> option is now fully supported.  It is emulated
on the platforms that don't support it (by locking and moving the
objects), so it is really easy to use libtool, just with minor
modifications to your Makefiles. Typing for example
<pre class="example">     libtool gcc -c foo/x.c -o foo/x.lo
</pre>
   <p>will do what you expect.

   <p>Note, however, that, if the compiler does not support <span class="samp">-c</span> and
<span class="samp">-o</span>, it is impossible to compile <span class="file">foo/x.c</span> without
overwriting an existing <span class="file">./x.o</span>.  Therefore, if you do have a
source file <span class="file">./x.c</span>, make sure you introduce dependencies in your
<span class="file">Makefile</span> to make sure <span class="file">./x.o</span> (or <span class="file">./x.lo</span>) is
re-created after any sub-directory's <span class="file">x.lo</span>:
<pre class="example">     x.o x.lo: foo/x.lo bar/x.lo
</pre>
   <p>This will also ensure that make won't try to use a temporarily corrupted
<span class="file">x.o</span> to create a program or library.  It may cause needless
recompilation on platforms that support <span class="samp">-c</span> and <span class="samp">-o</span>
together, but it's the only way to make it safe for those that don't.

<div class="node">
<p><hr>
<a name="Link-mode"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Execute-mode">Execute mode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Compile-mode">Compile mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-libtool">Invoking libtool</a>
<br>
</div>

<h3 class="section">4.2 Link mode</h3>

<p><a name="index-link-mode-51"></a><a name="index-mode_002c-link-52"></a>
<dfn>Link</dfn> mode links together object files (including library
objects) to form another library or to create an executable program.

   <p><var>mode-args</var> consist of a command using the C compiler to create an
output file (with the <span class="samp">-o</span> flag) from several object files.

   <p>The following components of <var>mode-args</var> are treated specially:

     
<a name="index-undefined-symbols_002c-allowing-53"></a>
<a name="index-unresolved-symbols_002c-allowing-54"></a>
<dl><dt><span class="samp">-all-static</span><dd>If <var>output-file</var> is a program, then do not link it against any
shared libraries at all.  If <var>output-file</var> is a library, then only
create a static library.

     <br><dt><span class="samp">-avoid-version</span><dd>Tries to avoid versioning (see <a href="#Versioning">Versioning</a>) for libraries and modules,
i.e., no version information is stored and no symbolic links are created. 
If the platform requires versioning, this option has no effect.

     <br><dt><span class="samp">-dlopen </span><var>file</var><dd>Same as <span class="samp">-dlpreopen </span><var>file</var>, if native dlopening is not
supported on the host platform (see <a href="#Dlopened-modules">Dlopened modules</a>) or if
the program is linked with <span class="samp">-static</span>, <span class="samp">-static-libtool-libs</span>,
or <span class="samp">-all-static</span>.  Otherwise, no effect.  If <var>file</var> is
<code>self</code> libtool will make sure that the program can <code>dlopen</code>
itself, either by enabling <code>-export-dynamic</code> or by falling back to
<span class="samp">-dlpreopen self</span>.

     <br><dt><span class="samp">-dlpreopen </span><var>file</var><dd>Link <var>file</var> into the output program, and add its symbols to
<var>lt_preloaded_symbols</var> (see <a href="#Dlpreopening">Dlpreopening</a>).  If <var>file</var> is
<code>self</code>, the symbols of the program itself will be added to
<var>lt_preloaded_symbols</var>. 
If <var>file</var> is <code>force</code> libtool will make sure that
<var>lt_preloaded_symbols</var> is always <em>defined</em>, regardless of whether
it's empty or not.

     <br><dt><span class="samp">-export-dynamic</span><dd>Allow symbols from <var>output-file</var> to be resolved with <code>dlsym</code>
(see <a href="#Dlopened-modules">Dlopened modules</a>).

     <br><dt><span class="samp">-export-symbols </span><var>symfile</var><dd>Tells the linker to export only the symbols listed in <var>symfile</var>. 
The symbol file should end in <span class="samp">.sym</span> and must contain the name of one
symbol per line. This option has no effect on some platforms. 
By default all symbols are exported.

     <br><dt><span class="samp">-export-symbols-regex </span><var>regex</var><dd>Same as <span class="samp">-export-symbols</span>, except that only symbols matching
the regular expression <var>regex</var> are exported. 
By default all symbols are exported.

     <br><dt><span class="samp">-L</span><var>libdir</var><dd>Search <var>libdir</var> for required libraries that have already been
installed.

     <br><dt><span class="samp">-l</span><var>name</var><dd><var>output-file</var> requires the installed library <span class="file">lib</span><var>name</var>. 
This option is required even when <var>output-file</var> is not an
executable.

     <br><dt><span class="samp">-module</span><dd>Creates a library that can be dlopened (see <a href="#Dlopened-modules">Dlopened modules</a>). 
This option doesn't work for programs. 
Module names don't need to be prefixed with 'lib'. 
In order to prevent name clashes, however, 'libname' and 'name'
must not be used at the same time in your package.

     <br><dt><span class="samp">-no-fast-install</span><dd>Disable fast-install mode for the executable <var>output-file</var>.  Useful
if the program won't be necessarily installed.

     <br><dt><span class="samp">-no-install</span><dd>Link an executable <var>output-file</var> that can't be installed and
therefore doesn't need a wrapper script on systems that allow hardcoding
of library paths.  Useful if the program is only used in the build tree,
e.g., for testing or generating other files.

     <br><dt><span class="samp">-no-undefined</span><dd>Declare that <var>output-file</var> does not depend on any other libraries. 
Some platforms cannot create shared libraries that depend on other
libraries (see <a href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a>).

     <br><dt><span class="samp">-o </span><var>output-file</var><dd>Create <var>output-file</var> from the specified objects and libraries.

     <br><dt><span class="samp">-objectlist </span><var>file</var><dd>Use a list of object files found in <var>file</var> to specify objects.

     <br><dt><span class="samp">-precious-files-regex </span><var>regex</var><dd>Prevents removal of files from the temporary output directory whose
names match this regular expression.  You might specify <span class="samp">\.bbg?$</span>
to keep those files created with <code>gcc -ftest-coverage</code> for example.

     <br><dt><span class="samp">-release </span><var>release</var><dd>Specify that the library was generated by release <var>release</var> of your
package, so that users can easily tell which versions are newer than
others.  Be warned that no two releases of your package will be binary
compatible if you use this flag.  If you want binary compatibility, use
the <span class="samp">-version-info</span> flag instead (see <a href="#Versioning">Versioning</a>).

     <br><dt><span class="samp">-rpath </span><var>libdir</var><dd>If <var>output-file</var> is a library, it will eventually be installed in
<var>libdir</var>.  If <var>output-file</var> is a program, add <var>libdir</var> to
the run-time path of the program.

     <br><dt><span class="samp">-shrext </span><var>suffix</var><dd>If <var>output-file</var> is a libtool library, replace the system's standard
file name extension for shared libraries with <var>suffix</var> (most systems
use <span class="file">.so</span> here).  This option is helpful in certain cases where an
application requires that shared libraries (typically modules) have an
extension other than the default one.  Please note you must supply the
full file name extension including any leading dot.

     <br><dt><span class="samp">-R </span><var>libdir</var><dd>If <var>output-file</var> is a program, add <var>libdir</var> to its run-time
path.  If <var>output-file</var> is a library, add -R<var>libdir</var> to its
<var>dependency_libs</var>, so that, whenever the library is linked into a
program, <var>libdir</var> will be added to its run-time path.

     <br><dt><span class="samp">-static</span><dd>If <var>output-file</var> is a program, then do not link it against any
uninstalled shared libtool libraries.  If <var>output-file</var> is a
library, then only create a static library.

     <br><dt><span class="samp">-static-libtool-libs</span><dd>If <var>output-file</var> is a program, then do not link it against any
shared libtool libraries (<span class="samp">.la</span> files).  If <var>output-file</var> is a
library, then only create a static library.

     <br><dt><span class="samp">-version-info </span><var>current</var><span class="samp">[:</span><var>revision</var><span class="samp">[:</span><var>age</var><span class="samp">]]</span><dd>If <var>output-file</var> is a libtool library, use interface version
information <var>current</var>, <var>revision</var>, and <var>age</var> to build it
(see <a href="#Versioning">Versioning</a>).  Do <strong>not</strong> use this flag to specify package
release information, rather see the <span class="samp">-release</span> flag.

     <br><dt><span class="samp">-version-number </span><var>major</var><span class="samp">[:</span><var>minor</var><span class="samp">[:</span><var>revision</var><span class="samp">]]</span><dd>If <var>output-file</var> is a libtool library, compute interface version
information so that the resulting library uses the specified major, minor and
revision numbers.  This is designed to permit libtool to be used with
existing projects where identical version numbers are already used across
operating systems.  New projects should use the <span class="samp">-version-info</span> flag
instead.

     <br><dt><span class="samp">-Wl,</span><var>flag</var><dt><span class="samp">-Xlinker </span><var>flag</var><dd>Pass a linker specific flag directly to the linker.

     <br><dt><span class="samp">-XCClinker </span><var>flag</var><dd>Pass a link specific flag to the compiler driver (<var>CC</var>) during linking. 
</dl>

   <p>If the <var>output-file</var> ends in <span class="samp">.la</span>, then a libtool library is
created, which must be built only from library objects (<span class="samp">.lo</span> files). 
The <span class="samp">-rpath</span> option is required.  In the current implementation,
libtool libraries may not depend on other uninstalled libtool libraries
(see <a href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a>).

   <p>If the <var>output-file</var> ends in <span class="samp">.a</span>, then a standard library is
created using <code>ar</code> and possibly <code>ranlib</code>.

   <p><a name="index-partial-linking-55"></a><a name="index-linking_002c-partial-56"></a>If <var>output-file</var> ends in <span class="samp">.o</span> or <span class="samp">.lo</span>, then a reloadable object
file is created from the input files (generally using <span class="samp">ld -r</span>). 
This method is often called <dfn>partial linking</dfn>.

   <p>Otherwise, an executable program is created.

<div class="node">
<p><hr>
<a name="Execute-mode"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Install-mode">Install mode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Link-mode">Link mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-libtool">Invoking libtool</a>
<br>
</div>

<h3 class="section">4.3 Execute mode</h3>

<p><a name="index-execute-mode-57"></a><a name="index-mode_002c-execute-58"></a>
For <dfn>execute</dfn> mode, the library path is automatically set, then a
program is executed.

   <p>The first of the <var>mode-args</var> is treated as a program name, with the
rest as arguments to that program.

   <p>The following components of <var>mode-args</var> are treated specially:

     <dl>
<dt><span class="samp">-dlopen </span><var>file</var><dd>Add the directory containing <var>file</var> to the library path. 
</dl>

   <p>This mode sets the library path environment variable according to any
<span class="samp">-dlopen</span> flags.

   <p>If any of the <var>args</var> are libtool executable wrappers, then they are
translated into the name of their corresponding uninstalled binary, and
any of their required library directories are added to the library path.

<div class="node">
<p><hr>
<a name="Install-mode"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Finish-mode">Finish mode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Execute-mode">Execute mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-libtool">Invoking libtool</a>
<br>
</div>

<h3 class="section">4.4 Install mode</h3>

<p><a name="index-install-mode-59"></a><a name="index-mode_002c-install-60"></a>
In <dfn>install</dfn> mode, libtool interprets most of the elements of
<var>mode-args</var> as an installation command beginning with
<code>cp</code>, or a BSD-compatible <code>install</code> program.

   <p>The following components of <var>mode-args</var> are treated specially:

     <dl>
<dt><span class="samp">-inst-prefix </span><var>inst-prefix-dir</var><dd>When installing into a temporary staging area, rather than the
final <var>prefix</var>, this argument is used to reflect the
temporary path, in much the same way <code>automake</code> uses
<var>DESTDIR</var>.  For instance, if <var>prefix</var> is <code>/usr/local</code>,
but <var>inst-prefix-dir</var> is <code>/tmp</code>, then the object will be
installed under <code>/tmp/usr/local/</code>.  If the installed object
is a libtool library, then the internal fields of that library
will reflect only <var>prefix</var>, not <var>inst-prefix-dir</var>:

     <pre class="example">          # Directory that this library needs to be installed in:
          libdir='/usr/local/lib'
     </pre>
     <p>not

     <pre class="example">          # Directory that this library needs to be installed in:
          libdir='/tmp/usr/local/lib'
     </pre>
     <p><code>inst-prefix</code> is also used to insure that if the installed
object must be relinked upon installation, that it is relinked
against the libraries in <var>inst-prefix-dir</var>/<var>prefix</var>,
not <var>prefix</var>.

     <p>In truth, this option is not really intended for use when calling
libtool directly; it is automatically used when <code>libtool --mode=install</code>
calls <code>libtool --mode=relink</code>.  Libtool does this by
analyzing the destination path given in the original
<code>libtool --mode=install</code> command and comparing it to the
expected installation path established during <code>libtool --mode=link</code>.

     <p>Thus, end-users need change nothing, and <code>automake</code>-style
<code>make install DESTDIR=/tmp</code> will Just Work(tm). 
</dl>

   <p>The rest of the <var>mode-args</var> are interpreted as arguments to the
<code>cp</code> or <code>install</code> command.

   <p>The command is run, and any necessary unprivileged post-installation
commands are also completed.

<div class="node">
<p><hr>
<a name="Finish-mode"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Uninstall-mode">Uninstall mode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Install-mode">Install mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-libtool">Invoking libtool</a>
<br>
</div>

<h3 class="section">4.5 Finish mode</h3>

<p><a name="index-finish-mode-61"></a><a name="index-mode_002c-finish-62"></a>
<dfn>Finish</dfn> mode helps system administrators install libtool libraries
so that they can be located and linked into user programs.

   <p>Each <var>mode-arg</var> is interpreted as the name of a library directory. 
Running this command may require superuser privileges, so the
<span class="samp">--dry-run</span> option may be useful.

<div class="node">
<p><hr>
<a name="Uninstall-mode"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Clean-mode">Clean mode</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Finish-mode">Finish mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-libtool">Invoking libtool</a>
<br>
</div>

<h3 class="section">4.6 Uninstall mode</h3>

<p><a name="index-uninstall-mode-63"></a><a name="index-mode_002c-uninstall-64"></a>
<dfn>Uninstall</dfn> mode deletes installed libraries, executables and objects.

   <p>The first <var>mode-arg</var> is the name of the program to use to delete
files (typically <span class="file">/bin/rm</span>).

   <p>The remaining <var>mode-args</var> are either flags for the deletion program
(beginning with a `-'), or the names of files to delete.

<div class="node">
<p><hr>
<a name="Clean-mode"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Uninstall-mode">Uninstall mode</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-libtool">Invoking libtool</a>
<br>
</div>

<h3 class="section">4.7 Clean mode</h3>

<p><a name="index-clean-mode-65"></a><a name="index-mode_002c-clean-66"></a>
<dfn>Clean</dfn> mode deletes uninstalled libraries, executables, objects
and libtool's temporary files associated with them.

   <p>The first <var>mode-arg</var> is the name of the program to use to delete
files (typically <span class="file">/bin/rm</span>).

   <p>The remaining <var>mode-args</var> are either flags for the deletion program
(beginning with a `-'), or the names of files to delete.

<div class="node">
<p><hr>
<a name="Integrating-libtool"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Versioning">Versioning</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-libtool">Invoking libtool</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">5 Integrating libtool with your package</h2>

<p>This chapter describes how to integrate libtool with your packages so
that your users can install hassle-free shared libraries.

<ul class="menu">
<li><a accesskey="1" href="#Makefile-rules">Makefile rules</a>:               Writing <span class="file">Makefile</span> rules for libtool. 
<li><a accesskey="2" href="#Using-Automake">Using Automake</a>:               Automatically supporting libtool. 
<li><a accesskey="3" href="#Configuring">Configuring</a>:                  Configuring libtool for a host system. 
<li><a accesskey="4" href="#Distributing">Distributing</a>:                 What files to distribute with your package. 
<li><a accesskey="5" href="#Static_002donly-libraries">Static-only libraries</a>:        Sometimes shared libraries are just a pain. 
</ul>

<div class="node">
<p><hr>
<a name="Makefile-rules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-Automake">Using Automake</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Integrating-libtool">Integrating libtool</a>
<br>
</div>

<h3 class="section">5.1 Writing <span class="file">Makefile</span> rules for libtool</h3>

<p><a name="index-Makefile-67"></a><a name="index-Makefile_002eam-68"></a><a name="index-Makefile_002ein-69"></a>
Libtool is fully integrated with Automake (see <a href="automake.html#Top">Introduction (The Automake Manual)</a>), starting with Automake version 1.2.

   <p>If you want to use libtool in a regular <span class="file">Makefile</span> (or
<span class="file">Makefile.in</span>), you are on your own.  If you're not using Automake
1.2, and you don't know how to incorporate libtool into your package you
need to do one of the following:

     <ol type=1 start=1>
<li>Download Automake (version 1.2 or later) from your nearest GNU mirror,
install it, and start using it.

     <li>Learn how to write <span class="file">Makefile</span> rules by hand.  They're sometimes complex,
but if you're clever enough to write rules for compiling your old
libraries, then you should be able to figure out new rules for libtool
libraries (hint: examine the <span class="file">Makefile.in</span> in the <span class="file">demo</span>
subdirectory of the libtool distribution<small class="dots">...</small> note especially that it
was automatically generated from the <span class="file">Makefile.am</span> by Automake).
        </ol>

<div class="node">
<p><hr>
<a name="Using-Automake"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Configuring">Configuring</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Makefile-rules">Makefile rules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Integrating-libtool">Integrating libtool</a>
<br>
</div>

<h3 class="section">5.2 Using Automake with libtool</h3>

<p><a name="index-LTLIBRARIES-70"></a>Libtool library support is implemented under the <span class="samp">LTLIBRARIES</span>
primary.

   <p>Here are some samples from the Automake <span class="file">Makefile.am</span> in the
libtool distribution's <span class="file">demo</span> subdirectory.

   <p>First, to link a program against a libtool library, just use the
<span class="samp">program_LDADD</span> variable:

<pre class="example">     bin_PROGRAMS = hell hell.debug
     
     # Build hell from main.c and libhello.la
     hell_SOURCES = main.c
     hell_LDADD = libhello.la
     
     # Create an easier-to-debug version of hell.
     hell_debug_SOURCES = main.c
     hell_debug_LDADD = libhello.la
     hell_debug_LDFLAGS = -static
</pre>
   <p>The flags <span class="samp">-dlopen</span> or <span class="samp">-dlpreopen</span> (see <a href="#Link-mode">Link mode</a>) would
fit better in the <var>program_LDADD</var> variable.  Unfortunately, GNU
automake, up to release 1.4, doesn't accept these flags in a
<var>program_LDADD</var> variable, so you have the following alternatives:

     <ul>
<li>add them to <var>program_LDFLAGS</var>, and list the libraries in
<var>program_DEPENDENCIES</var>, then wait for a release of GNU automake that
accepts these flags where they belong;

     <li>surround the flags between quotes, but then you must set
<var>program_DEPENDENCIES</var> too:

     <pre class="example">          program_LDADD = "-dlopen" libfoo.la
          program_DEPENDENCIES = libfoo.la
     </pre>
     <li>set and <span class="samp">AC_SUBST</span> variables <var>DLOPEN</var> and <var>DLPREOPEN</var> in
<span class="file">configure.in</span> and use <span class="samp">@DLOPEN@</span> and <span class="samp">@DLPREOPEN@</span>
as replacements for the explicit flags <span class="samp">-dlopen</span> and
<span class="samp">-dlpreopen</span> in <span class="samp">program_LDADD</span>.  Automake will discard
<span class="samp">AC_SUBST</span>ed variables from dependencies, so it will behave exactly
as we expect it to behave when it accepts these flags in
<span class="samp">program_LDADD</span>.  But hey!, this is ugly! 
</ul>

   <p>You may use the <span class="samp">program_LDFLAGS</span> variable to stuff in any flags
you want to pass to libtool while linking <span class="samp">program</span> (such as
<span class="samp">-static</span> to avoid linking uninstalled shared libtool libraries).

   <p>Building a libtool library is almost as trivial<small class="dots">...</small> note the use of
<span class="samp">libhello_la_LDFLAGS</span> to pass the <span class="samp">-version-info</span>
(see <a href="#Versioning">Versioning</a>) option to libtool:

<pre class="example">     # Build a libtool library, libhello.la for installation in libdir.
     lib_LTLIBRARIES = libhello.la
     libhello_la_SOURCES = hello.c foo.c
     libhello_la_LDFLAGS = -version-info 3:12:1
</pre>
   <p>The <span class="samp">-rpath</span> option is passed automatically by Automake (except for
libraries listed as <code>noinst_LTLIBRARIES</code>), so you
should not specify it.

   <p>See <a href="automake.html#A-Shared-Library">Building a Shared Library (The Automake Manual)</a>, for more information.

<div class="node">
<p><hr>
<a name="Configuring"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Distributing">Distributing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-Automake">Using Automake</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Integrating-libtool">Integrating libtool</a>
<br>
</div>

<h3 class="section">5.3 Configuring libtool</h3>

<p><a name="index-configuring-libtool-71"></a>
Libtool requires intimate knowledge of your compiler suite and operating
system in order to be able to create shared libraries and link against
them properly.  When you install the libtool distribution, a
system-specific libtool script is installed into your binary directory.

   <p>However, when you distribute libtool with your own packages
(see <a href="#Distributing">Distributing</a>), you do not always know which compiler suite and
operating system are used to compile your package.

   <p>For this reason, libtool must be <dfn>configured</dfn> before it can be
used.  This idea should be familiar to anybody who has used a GNU
<code>configure</code> script.  <code>configure</code> runs a number of tests for
system features, then generates the <span class="file">Makefiles</span> (and possibly a
<span class="file">config.h</span> header file), after which you can run <code>make</code> and
build the package.

   <p>Libtool adds its own tests to your <code>configure</code> script in order to
generate a libtool script for the installer's host machine.

<ul class="menu">
<li><a accesskey="1" href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a>:              Configuring <code>libtool</code> in <span class="file">configure.in</span>. 
<li><a accesskey="2" href="#Configure-notes">Configure notes</a>:              Platform-specific notes for configuration. 
</ul>

<div class="node">
<p><hr>
<a name="AC_005fPROG_005fLIBTOOL"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Configure-notes">Configure notes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Configuring">Configuring</a>
<br>
</div>

<h4 class="subsection">5.3.1 The <code>AC_PROG_LIBTOOL</code> macro</h4>

<p>If you are using GNU Autoconf (or Automake), you should add a call to
<code>AC_PROG_LIBTOOL</code> to your <span class="file">configure.in</span> file.  This macro
adds many new tests to the <code>configure</code> script so that the generated
libtool script will understand the characteristics of the host:

<div class="defun">
&mdash; Macro: <b>AC_PROG_LIBTOOL</b><var><a name="index-AC_005fPROG_005fLIBTOOL-72"></a></var><br>
&mdash; Macro: <b>AM_PROG_LIBTOOL</b><var><a name="index-AM_005fPROG_005fLIBTOOL-73"></a></var><br>
<blockquote><p>Add support for the <span class="samp">--enable-shared</span> and <span class="samp">--disable-shared</span>
<code>configure</code> flags.<a rel="footnote" href="#fn-4" name="fnd-4"><sup>4</sup></a>  <code>AM_PROG_LIBTOOL</code> was the
old name for this macro, and although supported at the moment is
deprecated.

        <p>By default, this macro turns on shared libraries if they are available,
and also enables static libraries if they don't conflict with the shared
libraries.  You can modify these defaults by calling either the
<code>AC_DISABLE_SHARED</code> or <code>AC_DISABLE_STATIC</code> macros:

     <pre class="example">          # Turn off shared libraries during beta-testing, since they
          # make the build process take too long.
          AC_DISABLE_SHARED
          AC_PROG_LIBTOOL
     </pre>
        <p>The user may specify modified forms of the configure flags
<span class="samp">--enable-shared</span> and <span class="samp">--enable-static</span> to choose whether
shared or static libraries are built based on the name of the package. 
For example, to have shared <span class="samp">bfd</span> and <span class="samp">gdb</span> libraries built,
but not shared <span class="samp">libg++</span>, you can run all three <code>configure</code>
scripts as follows:

     <pre class="example">          trick$ ./configure --enable-shared=bfd,gdb
     </pre>
        <p>In general, specifying <span class="samp">--enable-shared=</span><var>pkgs</var> is the same as
configuring with <span class="samp">--enable-shared</span> every package named in the
comma-separated <var>pkgs</var> list, and every other package with
<span class="samp">--disable-shared</span>.  The <span class="samp">--enable-static=</span><var>pkgs</var> flag
behaves similarly, but it uses <span class="samp">--enable-static</span> and
<span class="samp">--disable-static</span>. The same applies to the
<span class="samp">--enable-fast-install=</span><var>pkgs</var> flag, which uses
<span class="samp">--enable-fast-install</span> and <span class="samp">--disable-fast-install</span>.

        <p>The package name <span class="samp">default</span> matches any packages which have not set
their name in the <code>PACKAGE</code> environment variable.

        <p>This macro also sets the shell variable <var>LIBTOOL_DEPS</var>, that you can
use to automatically update the libtool script if it becomes
out-of-date.  In order to do that, add to your <span class="file">configure.in</span>:

     <pre class="example">          AC_PROG_LIBTOOL
          AC_SUBST(LIBTOOL_DEPS)
     </pre>
        <p>and, to <span class="file">Makefile.in</span> or <span class="file">Makefile.am</span>:

     <pre class="example">          LIBTOOL_DEPS = @LIBTOOL_DEPS@
          libtool: $(LIBTOOL_DEPS)
                  $(SHELL) ./config.status --recheck
     </pre>
        <p>If you are using GNU automake, you can omit the assignment, as automake
will take care of it.  You'll obviously have to create some dependency
on <span class="file">libtool</span>.

        </blockquote></div>

<div class="defun">
&mdash; Macro: <b>AC_LIBTOOL_DLOPEN</b><var><a name="index-AC_005fLIBTOOL_005fDLOPEN-74"></a></var><br>
<blockquote><p>Enable checking for dlopen support. This macro should be used if
the package makes use of the <span class="samp">-dlopen</span> and <span class="samp">-dlpreopen</span> flags,
otherwise libtool will assume that the system does not support dlopening. 
The macro must be called <strong>before</strong> <code>AC_PROG_LIBTOOL</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>AC_LIBTOOL_WIN32_DLL</b><var><a name="index-AC_005fLIBTOOL_005fWIN32_005fDLL-75"></a></var><br>
<blockquote><p>This macro should be used if the package has been ported to build clean
dlls on win32 platforms.  Usually this means that any library data items
are exported with <code>__declspec(dllexport)</code> and imported with
<code>__declspec(dllimport)</code>.  If this macro is not used, libtool will
assume that the package libraries are not dll clean and will build only
static libraries on win32 hosts.

        <p>This macro must be called <strong>before</strong> <code>AC_PROG_LIBTOOL</code>, and
provision must be made to pass <span class="samp">-no-undefined</span> to <code>libtool</code>
in link mode from the package <code>Makefile</code>.  Naturally, if you pass
<span class="samp">-no-undefined</span>, you must ensure that all the library symbols
<strong>really are</strong> defined at link time! 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>AC_DISABLE_FAST_INSTALL</b><var><a name="index-AC_005fDISABLE_005fFAST_005fINSTALL-76"></a></var><br>
<blockquote><p>Change the default behaviour for <code>AC_PROG_LIBTOOL</code> to disable
optimization for fast installation.  The user may still override this
default, depending on platform support, by specifying
<span class="samp">--enable-fast-install</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>AC_DISABLE_SHARED</b><var><a name="index-AC_005fDISABLE_005fSHARED-77"></a></var><br>
&mdash; Macro: <b>AM_DISABLE_SHARED</b><var><a name="index-AM_005fDISABLE_005fSHARED-78"></a></var><br>
<blockquote><p>Change the default behaviour for <code>AC_PROG_LIBTOOL</code> to disable
shared libraries.  The user may still override this default by
specifying <span class="samp">--enable-shared</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>AC_DISABLE_STATIC</b><var><a name="index-AC_005fDISABLE_005fSTATIC-79"></a></var><br>
&mdash; Macro: <b>AM_DISABLE_STATIC</b><var><a name="index-AM_005fDISABLE_005fSTATIC-80"></a></var><br>
<blockquote><p>Change the default behaviour for <code>AC_PROG_LIBTOOL</code> to disable
static libraries.  The user may still override this default by
specifying <span class="samp">--enable-static</span>. 
</p></blockquote></div>

   <p>The tests in <code>AC_PROG_LIBTOOL</code> also recognize the following
environment variables:

<div class="defun">
&mdash; Variable: <b>CC</b><var><a name="index-CC-81"></a></var><br>
<blockquote><p>The C compiler that will be used by the generated <code>libtool</code>.  If
this is not set, <code>AC_PROG_LIBTOOL</code> will look for <code>gcc</code> or
<code>cc</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>CFLAGS</b><var><a name="index-CFLAGS-82"></a></var><br>
<blockquote><p>Compiler flags used to generate standard object files.  If this is not
set, <code>AC_PROG_LIBTOOL</code> will not use any such flags.  It affects
only the way <code>AC_PROG_LIBTOOL</code> runs tests, not the produced
<code>libtool</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>CPPFLAGS</b><var><a name="index-CPPFLAGS-83"></a></var><br>
<blockquote><p>C preprocessor flags.  If this is not set, <code>AC_PROG_LIBTOOL</code> will
not use any such flags.  It affects only the way <code>AC_PROG_LIBTOOL</code>
runs tests, not the produced <code>libtool</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>LD</b><var><a name="index-LD-84"></a></var><br>
<blockquote><p>The system linker to use (if the generated <code>libtool</code> requires one). 
If this is not set, <code>AC_PROG_LIBTOOL</code> will try to find out what is
the linker used by <var>CC</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>LDFLAGS</b><var><a name="index-LDFLAGS-85"></a></var><br>
<blockquote><p>The flags to be used by <code>libtool</code> when it links a program.  If
this is not set, <code>AC_PROG_LIBTOOL</code> will not use any such flags.  It
affects only the way <code>AC_PROG_LIBTOOL</code> runs tests, not the produced
<code>libtool</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>LIBS</b><var><a name="index-LIBS-86"></a></var><br>
<blockquote><p>The libraries to be used by <code>AC_PROG_LIBTOOL</code> when it links a
program.  If this is not set, <code>AC_PROG_LIBTOOL</code> will not use any
such flags.  It affects only the way <code>AC_PROG_LIBTOOL</code> runs tests,
not the produced <code>libtool</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>NM</b><var><a name="index-NM-87"></a></var><br>
<blockquote><p>Program to use rather than checking for <code>nm</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>RANLIB</b><var><a name="index-RANLIB-88"></a></var><br>
<blockquote><p>Program to use rather than checking for <code>ranlib</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>LN_S</b><var><a name="index-LN_005fS-89"></a></var><br>
<blockquote><p>A command that creates a link of a program, a soft-link if possible, a
hard-link otherwise.  <code>AC_PROG_LIBTOOL</code> will check for a suitable
program if this variable is not set. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>DLLTOOL</b><var><a name="index-DLLTOOL-90"></a></var><br>
<blockquote><p>Program to use rather than checking for <code>dlltool</code>.  Only meaningful
for Cygwin/MS-Windows. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>OBJDUMP</b><var><a name="index-OBJDUMP-91"></a></var><br>
<blockquote><p>Program to use rather than checking for <code>objdump</code>.  Only meaningful
for Cygwin/MS-Windows. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>AS</b><var><a name="index-AS-92"></a></var><br>
<blockquote><p>Program to use rather than checking for <code>as</code>.  Only used on
Cygwin/MS-Windows at the moment. 
</p></blockquote></div>

   <p><a name="index-aclocal-93"></a>When you invoke the <code>libtoolize</code> program (see <a href="#Invoking-libtoolize">Invoking libtoolize</a>), it will tell you where to find a definition of
<code>AC_PROG_LIBTOOL</code>.  If you use Automake, the <code>aclocal</code> program
will automatically add <code>AC_PROG_LIBTOOL</code> support to your
<code>configure</code> script.

   <p>Nevertheless, it is advisable to include a copy of <span class="file">libtool.m4</span> in
<span class="file">acinclude.m4</span>, so that, even if <span class="file">aclocal.m4</span> and
<span class="file">configure</span> are rebuilt for any reason, the appropriate libtool
macros will be used.  The alternative is to hope the user will have a
compatible version of <span class="file">libtool.m4</span> installed and accessible for
<code>aclocal</code>.  This may lead to weird errors when versions don't
match.

<div class="node">
<p><hr>
<a name="Configure-notes"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Configuring">Configuring</a>
<br>
</div>

<h4 class="subsection">5.3.2 Platform-specific configuration notes</h4>

<p>While Libtool tries to hide as many platform-specific features as possible,
some have to be taken into account when configuring either the Libtool package
or a libtoolized package.

     <ul>
<li>Note that Sun C++ compiler versions before 5.6 may need some special
setup to link properly against shared versions of the C++ standard libraries. 
See <a href="http://lists.gnu.org/archive/html/libtool/2005-08/msg00088.html">http://lists.gnu.org/archive/html/libtool/2005-08/msg00088.html</a> for
more information.

     <li>On AIX there are two different styles of shared linking, one in which symbols
are bound at link-time and one in which symbols are bound at runtime only,
similar to ELF.  In case of doubt use <code>LDFLAGS=-Wl,-brtl</code> for the latter style.

     <li>On AIX, native tools are to be preferred over binutils; especially for C++ code,
if using the AIX Toolbox GCC 4.0 and binutils, configure with
<code>AR=/usr/bin/ar LD=/usr/bin/ld NM='/usr/bin/nm -B'</code>.

     <li>On AIX, the <span class="command">/bin/sh</span> is very slow due to its inefficient handling
of here-documents.  A modern shell is preferable:
     <pre class="example">          CONFIG_SHELL=/bin/bash; export $CONFIG_SHELL
          $CONFIG_SHELL ./configure [...]
     </pre>
     <!-- @item -->
<!-- FreeBSD @command{make} does not conform to @sc{posix} in its handling -->
<!-- of file modification times, which causes it to loop while building libtool. -->
<!-- Consider using a different @command{such} as GNU make instead. -->
<li>Note in some cases you might need to put ABI-changing compiler flags
into the compiler name.  For example, use of
     <pre class="example">            configure CC='gcc -m32'
     </pre>
     <p>rather than
     <pre class="example">            configure CC=gcc CFLAGS=-m32 LDFLAGS=-m32
     </pre>
     <p>might help with this Libtool release.

     <li>The default shell on UNICOS 9, a ksh 88e variant, is too buggy to
correctly execute the libtool script.  Users are advised to install a
modern shell such as GNU bash.

     <li>Some HP-UX <span class="command">sed</span> programs are horribly broken, and cannot handle
libtool's requirements, so users may report unusual problems.  There
is no workaround except to install a working <span class="command">sed</span> (such as GNU sed)
on these systems.

     <li>The vendor-distributed NCR MP-RAS <span class="command">cc</span> programs emits copyright
on standard error that confuse tests on size of <span class="file">conftest.err</span>.  The
workaround is to specify <span class="env">CC</span> when run configure with
<code>CC='cc -Hnocopyr'</code>.

     <li>Any earlier DG/UX system with ELF executables, such as R3.10 or
R4.10, is also likely to work, but hasn't been explicitly tested.

     <li>On Reliant Unix libtool has only been tested with the Siemens C-compiler
and an old version of <span class="command">gcc</span> provided by Marco Walther.

     <li><span class="file">libtool.m4</span>, <span class="file">ltdl.m4</span> and the <span class="file">configure.ac</span> files are marked
to use autoconf-mode, which is distributed with GNU Emacs 21, Autoconf itself,
and all recent releases of XEmacs.

     <li>When building on some linux systems for multilib targets
<span class="command">libtool</span> sometimes guesses the wrong paths that the linker
and dynamic linker search by default. If this occurs, you may override
libtool's guesses at <span class="command">configure</span> time by setting the
<span class="command">autoconf</span> cache variables
<code>lt_cv_sys_lib_search_path_spec</code> and
<code>lt_cv_sys_lib_dlsearch_path_spec</code> respectively to the correct search
paths.

   </ul>

<div class="node">
<p><hr>
<a name="Distributing"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Static_002donly-libraries">Static-only libraries</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuring">Configuring</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Integrating-libtool">Integrating libtool</a>
<br>
</div>

<h3 class="section">5.4 Including libtool in your package</h3>

<p>In order to use libtool, you need to include the following files with
your package:

     <dl>
<dt><span class="file">config.guess</span><dd><a name="index-config_002eguess-94"></a>Attempt to guess a canonical system name.

     <br><dt><span class="file">config.sub</span><dd><a name="index-config_002esub-95"></a>Canonical system name validation subroutine script.

     <br><dt><span class="file">install-sh</span><dd><a name="index-install_002dsh-96"></a>BSD-compatible <span class="command">install</span> replacement script.

     <br><dt><span class="file">ltmain.sh</span><dd><a name="index-ltmain_002esh-97"></a>A generic script implementing basic libtool functionality. 
</dl>

   <p>Note that the libtool script itself should <em>not</em> be included with
your package.  See <a href="#Configuring">Configuring</a>.

   <p>You should use the <code>libtoolize</code> program, rather than manually
copying these files into your package.  Note however, that <span class="file">install-sh</span>
is not copied by <code>libtoolize</code>; if you use Automake, it will take care
of that, otherwise you may obtain a copy from the package data directory
of the installed Libtool.  This may change in a future Libtool version.

<ul class="menu">
<li><a accesskey="1" href="#Invoking-libtoolize">Invoking libtoolize</a>:          <code>libtoolize</code> command line options. 
<li><a accesskey="2" href="#Autoconf-_002eo-macros">Autoconf .o macros</a>:           Autoconf macros that set object file names. 
</ul>

<div class="node">
<p><hr>
<a name="Invoking-libtoolize"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Autoconf-_002eo-macros">Autoconf .o macros</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Distributing">Distributing</a>
<br>
</div>

<h4 class="subsection">5.4.1 Invoking <code>libtoolize</code></h4>

<p><a name="index-libtoolize-98"></a><a name="index-libtoolize-command-options-99"></a><a name="index-command-options_002c-libtoolize-100"></a><a name="index-options_002c-libtoolize-command-101"></a>
The <code>libtoolize</code> program provides a standard way to add libtool
support to your package.  In the future, it may implement better usage
checking, or other features to make libtool even easier to use.

   <p>The <code>libtoolize</code> program has the following synopsis:

<pre class="example">     libtoolize [<var>option</var>]...
</pre>
   <p class="noindent">and accepts the following options:

     <dl>
<dt><span class="samp">--automake</span><dd>Work silently, and assume that Automake libtool support is used.

     <p><span class="samp">libtoolize --automake</span> is used by Automake to add libtool files to
your package, when <code>AC_PROG_LIBTOOL</code> appears in your
<span class="file">configure.in</span>.

     <br><dt><span class="samp">--copy</span><dt><span class="samp">-c</span><dd>Copy files from the libtool data directory rather than creating
symlinks.

     <br><dt><span class="samp">--debug</span><dd>Dump a trace of shell script execution to standard output.  This
produces a lot of output, so you may wish to pipe it to <code>less</code> (or
<code>more</code>) or redirect to a file.

     <br><dt><span class="samp">--dry-run</span><dt><span class="samp">-n</span><dd>Don't run any commands that modify the file system, just print them
out.

     <br><dt><span class="samp">--force</span><dt><span class="samp">-f</span><dd>Replace existing libtool files.  By default, <code>libtoolize</code> won't
overwrite existing files.

     <br><dt><span class="samp">--help</span><dd>Display a help message and exit.

     <br><dt><span class="samp">--ltdl</span><dd>Install libltdl in a subdirectory of your package.

     <br><dt><span class="samp">--ltdl-tar</span><dd>Add the file libltdl.tar.gz to your package.

     <br><dt><span class="samp">--version</span><dd>Print <code>libtoolize</code> version information and exit. 
</dl>

   <p><a name="index-AC_005fCONFIG_005fAUX_005fDIR-102"></a>If <code>libtoolize</code> detects an explicit call to
<code>AC_CONFIG_AUX_DIR</code> (see <a href="autoconf.html#Input">The Autoconf Manual (The Autoconf Manual)</a>) in your <span class="file">configure.in</span>, it
will put the files in the specified directory.

   <p><code>libtoolize</code> displays hints for adding libtool support to your
package, as well.

<div class="node">
<p><hr>
<a name="Autoconf-_002eo-macros"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-libtoolize">Invoking libtoolize</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Distributing">Distributing</a>
<br>
</div>

<h4 class="subsection">5.4.2 Autoconf <span class="samp">.o</span> macros</h4>

<p>The Autoconf package comes with a few macros that run tests, then set a
variable corresponding to the name of an object file.  Sometimes it is
necessary to use corresponding names for libtool objects.

   <p>Here are the names of variables that list libtool objects:

<div class="defun">
&mdash; Variable: <b>LTALLOCA</b><var><a name="index-LTALLOCA-103"></a></var><br>
<blockquote><p><a name="index-AC_005fFUNC_005fALLOCA-104"></a>Substituted by <code>AC_FUNC_ALLOCA</code> (see <a href="autoconf.html#Particular-Functions">Particular Function Checks (The Autoconf Manual)</a>).  Is either empty, or contains <span class="samp">alloca.lo</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>LTLIBOBJS</b><var><a name="index-LTLIBOBJS-105"></a></var><br>
<blockquote><p><a name="index-AC_005fREPLACE_005fFUNCS-106"></a>Substituted by <code>AC_REPLACE_FUNCS</code> (see <a href="autoconf.html#Generic-Functions">Generic Function Checks (The Autoconf Manual)</a>), and a few other functions. 
</p></blockquote></div>

   <p>Unfortunately, the stable release of Autoconf (2.13, at the time of
this writing) does not have any way for libtool to provide support for
these variables.  So, if you depend on them, use the following code
immediately before the call to <code>AC_OUTPUT</code> in your
<span class="file">configure.in</span>:

<pre class="example">     LTLIBOBJS=`echo "$LIBOBJS" | sed 's/\.[^.]* /.lo /g;s/\.[^.]*$/.lo/'`
     AC_SUBST(LTLIBOBJS)
     LTALLOCA=`echo "$ALLOCA" | sed 's/\.[^.]* /.lo /g;s/\.[^.]*$/.lo/'`
     AC_SUBST(LTALLOCA)
     AC_OUTPUT(...)
</pre>
   <div class="node">
<p><hr>
<a name="Static_002donly-libraries"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Distributing">Distributing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Integrating-libtool">Integrating libtool</a>
<br>
</div>

<h3 class="section">5.5 Static-only libraries</h3>

<p><a name="index-debugging-libraries-107"></a><a name="index-developing-libraries-108"></a><a name="index-double_002dcompilation_002c-avoiding-109"></a><a name="index-avoiding-shared-libraries-110"></a><a name="index-eliding-shared-libraries-111"></a><a name="index-using-shared-libraries_002c-not-112"></a><a name="index-shared-libraries_002c-not-using-113"></a><a name="index-time_002c-saving-114"></a><a name="index-saving-time-115"></a>
When you are developing a package, it is often worthwhile to configure
your package with the <span class="samp">--disable-shared</span> flag, or to override the
defaults for <code>AC_PROG_LIBTOOL</code> by using the
<code>AC_DISABLE_SHARED</code> Autoconf macro (see <a href="#AC_005fPROG_005fLIBTOOL">The <code>AC_PROG_LIBTOOL</code> macro</a>).  This prevents libtool from building
shared libraries, which has several advantages:

     <ul>
<li>compilation is twice as fast, which can speed up your development cycle,

     <li>debugging is easier because you don't need to deal with any complexities
added by shared libraries, and

     <li>you can see how libtool behaves on static-only platforms. 
</ul>

   <p>You may want to put a small note in your package <span class="file">README</span> to let
other developers know that <span class="samp">--disable-shared</span> can save them time. 
The following example note is taken from the GIMP<a rel="footnote" href="#fn-5" name="fnd-5"><sup>5</sup></a> distribution <span class="file">README</span>:

<pre class="example">     The GIMP uses GNU Libtool in order to build shared libraries on a
     variety of systems. While this is very nice for making usable
     binaries, it can be a pain when trying to debug a program. For that
     reason, compilation of shared libraries can be turned off by
     specifying the <span class="samp">--disable-shared</span> option to <span class="file">configure</span>.
</pre>
   <div class="node">
<p><hr>
<a name="Versioning"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Library-tips">Library tips</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Integrating-libtool">Integrating libtool</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">6 Library interface versions</h2>

<p><a name="index-dynamic-dependencies-116"></a><a name="index-dependency-versioning-117"></a><a name="index-shared-library-versions-118"></a>
The most difficult issue introduced by shared libraries is that of
creating and resolving runtime dependencies.  Dependencies on programs
and libraries are often described in terms of a single name, such as
<code>sed</code>.  So, one may say &ldquo;libtool depends on sed,&rdquo; and that is
good enough for most purposes.

   <p>However, when an interface changes regularly, we need to be more
specific: &ldquo;Gnus 5.1 requires Emacs 19.28 or above.&rdquo;  Here, the
description of an interface consists of a name, and a &ldquo;version
number.&rdquo;

   <p>Even that sort of description is not accurate enough for some purposes. 
What if Emacs 20 changes enough to break Gnus 5.1?

   <p>The same problem exists in shared libraries: we require a formal version
system to describe the sorts of dependencies that programs have on
shared libraries, so that the dynamic linker can guarantee that programs
are linked only against libraries that provide the interface they
require.

<ul class="menu">
<li><a accesskey="1" href="#Interfaces">Interfaces</a>:                   What are library interfaces? 
<li><a accesskey="2" href="#Libtool-versioning">Libtool versioning</a>:           Libtool's versioning system. 
<li><a accesskey="3" href="#Updating-version-info">Updating version info</a>:        Changing version information before releases. 
<li><a accesskey="4" href="#Release-numbers">Release numbers</a>:              Breaking binary compatibility for aesthetics. 
</ul>

<div class="node">
<p><hr>
<a name="Interfaces"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Libtool-versioning">Libtool versioning</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Versioning">Versioning</a>
<br>
</div>

<h3 class="section">6.1 What are library interfaces?</h3>

<p><a name="index-library-interfaces-119"></a>
Interfaces for libraries may be any of the following (and more):

     <ul>
<li>global variables: both names and types

     <li>global functions: argument types and number, return types, and function names

     <li>standard input, standard output, standard error, and file formats

     <li>sockets, pipes, and other inter-process communication protocol formats
</ul>

   <p>Note that static functions do not count as interfaces, because they are
not directly available to the user of the library.

<div class="node">
<p><hr>
<a name="Libtool-versioning"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Updating-version-info">Updating version info</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Interfaces">Interfaces</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Versioning">Versioning</a>
<br>
</div>

<h3 class="section">6.2 Libtool's versioning system</h3>

<p><a name="index-libtool-library-versions-120"></a><a name="index-formal-versioning-121"></a><a name="index-versioning_002c-formal-122"></a>
Libtool has its own formal versioning system.  It is not as flexible as
some, but it is definitely the simplest of the more powerful versioning
systems.

   <p>Think of a library as exporting several sets of interfaces, arbitrarily
represented by integers.  When a program is linked against a library, it
may use any subset of those interfaces.

   <p>Libtool's description of the interfaces that a program uses is simple:
it encodes the least and the greatest interface numbers in the resulting
binary (<var>first-interface</var>, <var>last-interface</var>).

   <p>The dynamic linker is guaranteed that if a library supports <em>every</em>
interface number between <var>first-interface</var> and <var>last-interface</var>,
then the program can be relinked against that library.

   <p>Note that this can cause problems because libtool's compatibility
requirements are actually stricter than is necessary.

   <p>Say <span class="file">libhello</span> supports interfaces 5, 16, 17, 18, and 19, and that
libtool is used to link <span class="file">test</span> against <span class="file">libhello</span>.

   <p>Libtool encodes the numbers 5 and 19 in <span class="file">test</span>, and the dynamic
linker will only link <span class="file">test</span> against libraries that support
<em>every</em> interface between 5 and 19.  So, the dynamic linker refuses
to link <span class="file">test</span> against <span class="file">libhello</span>!

   <p>In order to eliminate this problem, libtool only allows libraries to
declare consecutive interface numbers.  So, <span class="file">libhello</span> can declare at
most that it supports interfaces 16 through 19.  Then, the dynamic
linker will link <span class="file">test</span> against <span class="file">libhello</span>.

   <p>So, libtool library versions are described by three integers:

     <dl>
<dt><var>current</var><dd>The most recent interface number that this library implements.

     <br><dt><var>revision</var><dd>The implementation number of the <var>current</var> interface.

     <br><dt><var>age</var><dd>The difference between the newest and oldest interfaces that this
library implements.  In other words, the library implements all the
interface numbers in the range from number <var>current</var><code> -
</code><var>age</var> to <var>current</var>. 
</dl>

   <p>If two libraries have identical <var>current</var> and <var>age</var> numbers,
then the dynamic linker chooses the library with the greater
<var>revision</var> number.

<div class="node">
<p><hr>
<a name="Updating-version-info"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Release-numbers">Release numbers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Libtool-versioning">Libtool versioning</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Versioning">Versioning</a>
<br>
</div>

<h3 class="section">6.3 Updating library version information</h3>

<p>If you want to use libtool's versioning system, then you must specify
the version information to libtool using the <span class="samp">-version-info</span> flag
during link mode (see <a href="#Link-mode">Link mode</a>).

   <p>This flag accepts an argument of the form
<var>current</var><span class="samp">[:</span><var>revision</var><span class="samp">[:</span><var>age</var><span class="samp">]]</span>.  So, passing
<span class="samp">-version-info 3:12:1</span> sets <var>current</var> to 3, <var>revision</var> to
12, and <var>age</var> to 1.

   <p>If either <var>revision</var> or <var>age</var> are omitted, they default to 0. 
Also note that <var>age</var> must be less than or equal to the <var>current</var>
interface number.

   <p>Here are a set of rules to help you update your library version
information:

     <ol type=1 start=1>
<li>Start with version information of <span class="samp">0:0:0</span> for each libtool library.

     <li>Update the version information only immediately before a public release
of your software.  More frequent updates are unnecessary, and only
guarantee that the current interface number gets larger faster.

     <li>If the library source code has changed at all since the last update,
then increment <var>revision</var> (<var>c</var><span class="samp">:</span><var>r</var><span class="samp">:</span><var>a</var> becomes
<var>c</var><span class="samp">:r+1:</span><var>a</var>).

     <li>If any interfaces have been added, removed, or changed since the last
update, increment <var>current</var>, and set <var>revision</var> to 0.

     <li>If any interfaces have been added since the last public release, then
increment <var>age</var>.

     <li>If any interfaces have been removed since the last public release, then
set <var>age</var> to 0.
        </ol>

   <p><em>Never</em> try to set the interface numbers so that they
correspond to the release number of your package.  This is an abuse that
only fosters misunderstanding of the purpose of library versions. 
Instead, use the <span class="samp">-release</span> flag (see <a href="#Release-numbers">Release numbers</a>), but be
warned that every release of your package will not be binary compatible
with any other release.

<div class="node">
<p><hr>
<a name="Release-numbers"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Updating-version-info">Updating version info</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Versioning">Versioning</a>
<br>
</div>

<h3 class="section">6.4 Managing release information</h3>

<p>Often, people want to encode the name of the package release into the
shared library so that it is obvious to the user which package their
programs are linked against.  This convention is used especially on
GNU/Linux:

<pre class="example">     trick$ <kbd>ls /usr/lib/libbfd*</kbd>
     /usr/lib/libbfd.a	    /usr/lib/libbfd.so.2.7.0.2
     /usr/lib/libbfd.so
     trick$
</pre>
   <p>On <span class="samp">trick</span>, <span class="file">/usr/lib/libbfd.so</span> is a symbolic link to
<span class="file">libbfd.so.2.7.0.2</span>, which was distributed as a part of
<span class="samp">binutils-2.7.0.2</span>.

   <p>Unfortunately, this convention conflicts directly with libtool's idea of
library interface versions, because the library interface rarely changes
at the same time that the release number does, and the library suffix is
never the same across all platforms.

   <p>So, in order to accommodate both views, you can use the <span class="samp">-release</span>
flag in order to set release information for libraries which you do not
want to use <span class="samp">-version-info</span>.  For the <span class="file">libbfd</span> example, the
next release which uses libtool should be built with <span class="samp">-release
2.9.0</span>, which will produce the following files on GNU/Linux:

<pre class="example">     trick$ <kbd>ls /usr/lib/libbfd*</kbd>
     /usr/lib/libbfd-2.9.0.so     /usr/lib/libbfd.a
     /usr/lib/libbfd.so
     trick$
</pre>
   <p>In this case, <span class="file">/usr/lib/libbfd.so</span> is a symbolic link to
<span class="file">libbfd-2.9.0.so</span>.  This makes it obvious that the user is dealing
with <span class="samp">binutils-2.9.0</span>, without compromising libtool's idea of
interface versions.

   <p>Note that this option causes a modification of the library name, so do
not use it unless you want to break binary compatibility with any past
library releases.  In general, you should only use <span class="samp">-release</span> for
package-internal libraries or for ones whose interfaces change very
frequently.

<div class="node">
<p><hr>
<a name="Library-tips"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Versioning">Versioning</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">7 Tips for interface design</h2>

<p><a name="index-library-interfaces_002c-design-123"></a><a name="index-design-of-library-interfaces-124"></a>
Writing a good library interface takes a lot of practice and thorough
understanding of the problem that the library is intended to solve.

   <p>If you design a good interface, it won't have to change often, you won't
have to keep updating documentation, and users won't have to keep
relearning how to use the library.

   <p>Here is a brief list of tips for library interface design, which may
help you in your exploits:

     <dl>
<dt>Plan ahead<dd>Try to make every interface truly minimal, so that you won't need to
delete entry points very often.

     <br><dt>Avoid interface changes<dd><a name="index-renaming-interface-functions-125"></a>Some people love redesigning and changing entry points just for the heck
of it (note: <em>renaming</em> a function is considered changing an entry
point).  Don't be one of those people.  If you must redesign an
interface, then try to leave compatibility functions behind so that
users don't need to rewrite their existing code.

     <br><dt>Use opaque data types<dd><a name="index-opaque-data-types-126"></a>The fewer data type definitions a library user has access to, the
better.  If possible, design your functions to accept a generic pointer
(which you can cast to an internal data type), and provide access
functions rather than allowing the library user to directly manipulate
the data. 
That way, you have the freedom to change the data structures without
changing the interface.

     <p>This is essentially the same thing as using abstract data types and
inheritance in an object-oriented system.

     <br><dt>Use header files<dd><a name="index-header-files-127"></a>If you are careful to document each of your library's global functions
and variables in header files, and include them in your library source
files, then the compiler will let you know if you make any interface
changes by accident (see <a href="#C-header-files">C header files</a>).

     <br><dt>Use the <code>static</code> keyword (or equivalent) whenever possible<dd><a name="index-global-functions-128"></a>The fewer global functions your library has, the more flexibility you'll
have in changing them.  Static functions and variables may change forms
as often as you like<small class="dots">...</small> your users cannot access them, so they
aren't interface changes.

     <br><dt>Be careful with array dimensions<dd>The number of elements in a global array is part of an interface, even
if the header just declares <code>extern int foo[];</code>.  This is because
on i386 and some other SVR4/ELF systems, when an application
references data in a shared library the size of that data (whatever
its type) is included in the application executable.  If you might
want to change the size of an array or string then provide a pointer
not the actual array. 
</dl>

<ul class="menu">
<li><a accesskey="1" href="#C-header-files">C header files</a>:               How to write portable include files. 
</ul>

<div class="node">
<p><hr>
<a name="C-header-files"></a>Up:&nbsp;<a rel="up" accesskey="u" href="#Library-tips">Library tips</a>
<br>
</div>

<h3 class="section">7.1 Writing C header files</h3>

<p><a name="index-portable-C-headers-129"></a><a name="index-C-header-files_002c-portable-130"></a><a name="index-include-files_002c-portable-131"></a>
Writing portable C header files can be difficult, since they may be read
by different types of compilers:

     <dl>
<dt>C++ compilers<dd>C++ compilers require that functions be declared with full prototypes,
since C++ is more strongly typed than C.  C functions and variables also
need to be declared with the <code>extern "C"</code> directive, so that the
names aren't mangled.  See <a href="#C_002b_002b-libraries">C++ libraries</a>, for other issues relevant
to using C++ with libtool.

     <br><dt>ANSI C compilers<dd>ANSI C compilers are not as strict as C++ compilers, but functions
should be prototyped to avoid unnecessary warnings when the header file
is <code>#include</code>d.

     <br><dt>non-ANSI C compilers<dd>Non-ANSI compilers will report errors if functions are prototyped. 
</dl>

   <p>These complications mean that your library interface headers must use
some C preprocessor magic in order to be usable by each of the above
compilers.

   <p><span class="file">foo.h</span> in the <span class="file">demo</span> subdirectory of the libtool distribution
serves as an example for how to write a header file that can be
safely installed in a system directory.

   <p>Here are the relevant portions of that file:

<pre class="example">     /* BEGIN_C_DECLS should be used at the beginning of your declarations,
        so that C++ compilers don't mangle their names.  Use END_C_DECLS at
        the end of C declarations. */
     #undef BEGIN_C_DECLS
     #undef END_C_DECLS
     #ifdef __cplusplus
     # define BEGIN_C_DECLS extern "C" {
     # define END_C_DECLS }
     #else
     # define BEGIN_C_DECLS /* empty */
     # define END_C_DECLS /* empty */
     #endif
     
     /* PARAMS is a macro used to wrap function prototypes, so that
        compilers that don't understand ANSI C prototypes still work,
        and ANSI C compilers can issue warnings about type mismatches. */
     #undef PARAMS
     #if defined (__STDC__) || defined (_AIX) \
             || (defined (__mips) &amp;&amp; defined (_SYSTYPE_SVR4)) \
             || defined(WIN32) || defined(__cplusplus)
     # define PARAMS(protos) protos
     #else
     # define PARAMS(protos) ()
     #endif
</pre>
   <p>These macros are used in <span class="file">foo.h</span> as follows:

<pre class="example">     #ifndef FOO_H
     #define FOO_H 1
     
     /* The above macro definitions. */
     #include "..."
     
     BEGIN_C_DECLS
     
     int foo PARAMS((void));
     int hello PARAMS((void));
     
     END_C_DECLS
     
     #endif /* !FOO_H */
</pre>
   <p>Note that the <span class="file">#ifndef FOO_H</span> prevents the body of <span class="file">foo.h</span>
from being read more than once in a given compilation.

   <p>Also the only thing that must go outside the
<code>BEGIN_C_DECLS</code>/<code>END_C_DECLS</code> pair are <code>#include</code> lines. 
Strictly speaking it is only C symbol names that need to be protected,
but your header files will be more maintainable if you have a single
pair of of these macros around the majority of the header contents.

   <p>You should use these definitions of <code>PARAMS</code>, <code>BEGIN_C_DECLS</code>,
and <code>END_C_DECLS</code> into your own headers.  Then, you may use them to
create header files that are valid for C++, ANSI, and non-ANSI
compilers<a rel="footnote" href="#fn-6" name="fnd-6"><sup>6</sup></a>.

   <p>Do not be naive about writing portable code.  Following the tips given
above will help you miss the most obvious problems, but there are
definitely other subtle portability issues.  You may need to cope with
some of the following issues:

     <ul>
<li>Pre-ANSI compilers do not always support the <code>void *</code> generic
pointer type, and so need to use <code>char *</code> in its place.

     <li>The <code>const</code>, <code>inline</code> and <code>signed</code> keywords are not
supported by some compilers, especially pre-ANSI compilers.

     <li>The <code>long double</code> type is not supported by many compilers. 
</ul>

<div class="node">
<p><hr>
<a name="Inter_002dlibrary-dependencies"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Dlopened-modules">Dlopened modules</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Library-tips">Library tips</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">8 Inter-library dependencies</h2>

<p><a name="index-dependencies-between-libraries-132"></a><a name="index-inter_002dlibrary-dependencies-133"></a>
By definition, every shared library system provides a way for
executables to depend on libraries, so that symbol resolution is
deferred until runtime.

   <p>An <dfn>inter-library dependency</dfn> is one in which a library depends on
other libraries.  For example, if the libtool library <span class="file">libhello</span>
uses the <code>cos</code> function, then it has an inter-library dependency
on <span class="file">libm</span>, the math library that implements <code>cos</code>.

   <p>Some shared library systems provide this feature in an
internally-consistent way: these systems allow chains of dependencies of
potentially infinite length.

   <p>However, most shared library systems are restricted in that they only
allow a single level of dependencies.  In these systems, programs may
depend on shared libraries, but shared libraries may not depend on other
shared libraries.

   <p>In any event, libtool provides a simple mechanism for you to declare
inter-library dependencies: for every library <span class="file">lib</span><var>name</var> that
your own library depends on, simply add a corresponding
<code>-l</code><var>name</var> option to the link line when you create your
library.  To make an example of our
<span class="file">libhello</span> that depends on <span class="file">libm</span>:

<pre class="example">     burger$ <kbd>libtool --mode=link gcc -g -O -o libhello.la foo.lo hello.lo \
                     -rpath /usr/local/lib -lm</kbd>
     burger$
</pre>
   <p>When you link a program against <span class="file">libhello</span>, you don't need to
specify the same <span class="samp">-l</span> options again: libtool will do that for you,
in order to guarantee that all the required libraries are found.  This
restriction is only necessary to preserve compatibility with static
library systems and simple dynamic library systems.

   <p>Some platforms, such as AIX, do not even allow you this
flexibility.  In order to build a shared library, it must be entirely
self-contained (that is, have references only to symbols that are found
in the <span class="samp">.lo</span> files or the specified <span class="samp">-l</span> libraries), and you
need to specify the <span class="samp">-no-undefined</span> flag.  By default, libtool
builds only static libraries on these kinds of platforms.

   <p>The simple-minded inter-library dependency tracking code of libtool
releases prior to 1.2 was disabled because it was not clear when it was
possible to link one library with another, and complex failures would
occur.  A more complex implementation of this concept was re-introduced
before release 1.3, but it has not been ported to all platforms that
libtool supports.  The default, conservative behavior is to avoid
linking one library with another, introducing their inter-dependencies
only when a program is linked with them.

<div class="node">
<p><hr>
<a name="Dlopened-modules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Using-libltdl">Using libltdl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">9 Dlopened modules</h2>

<p><a name="index-dlopen-134"></a><a name="index-dlsym-135"></a><a name="index-dlclose-136"></a><a name="index-shl_005fload-137"></a><a name="index-dynamic-linking_002c-applications-138"></a><a name="index-dlopening-modules-139"></a><a name="index-modules_002c-dynamic-140"></a><a name="index-application_002dlevel-dynamic-linking-141"></a>
It can sometimes be confusing to discuss <dfn>dynamic linking</dfn>, because
the term is used to refer to two different concepts:

     <ol type=1 start=1>
<li>Compiling and linking a program against a shared library, which is
resolved automatically at run time by the dynamic linker.  In this
process, dynamic linking is transparent to the application.

     <li>The application calling functions such as <code>dlopen</code>,<a rel="footnote" href="#fn-7" name="fnd-7"><sup>7</sup></a> which load
arbitrary, user-specified modules at runtime.  This type of dynamic
linking is explicitly controlled by the application.
        </ol>

   <p>To mitigate confusion, this manual refers to the second type of dynamic
linking as <dfn>dlopening</dfn> a module.

   <p>The main benefit to dlopening object modules is the ability to access
compiled object code to extend your program, rather than using an
interpreted language.  In fact, dlopen calls are frequently used in
language interpreters to provide an efficient way to extend the
language.

   <p>As of version 1.5.26, libtool provides support for dlopened
modules.  However, you should indicate that your package is willing to
use such support, by using the macro <span class="samp">AC_LIBTOOL_DLOPEN</span> in
<span class="file">configure.in</span>.  If this macro is not used (or it is used
<em>after</em> <span class="samp">AC_PROG_LIBTOOL</span>), libtool will assume no dlopening
mechanism is available, and will try to simulate it.

   <p>This chapter discusses how you as a dlopen application developer might
use libtool to generate dlopen-accessible modules.

<ul class="menu">
<li><a accesskey="1" href="#Building-modules">Building modules</a>:             Creating dlopenable objects and libraries. 
<li><a accesskey="2" href="#Dlpreopening">Dlpreopening</a>:                 Dlopening that works on static platforms. 
<li><a accesskey="3" href="#Finding-the-dlname">Finding the dlname</a>:           Choosing the right file to <code>dlopen</code>. 
<li><a accesskey="4" href="#Dlopen-issues">Dlopen issues</a>:                Unresolved problems that need your attention. 
</ul>

<div class="node">
<p><hr>
<a name="Building-modules"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Dlpreopening">Dlpreopening</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Dlopened-modules">Dlopened modules</a>
<br>
</div>

<h3 class="section">9.1 Building modules to dlopen</h3>

<p>On some operating systems, a program symbol must be specially declared
in order to be dynamically resolved with the <code>dlsym</code> (or
equivalent) function.

   <p>Libtool provides the <span class="samp">-export-dynamic</span> and <span class="samp">-module</span>
link flags (see <a href="#Link-mode">Link mode</a>), which do this declaration. 
You need to use these flags if you are linking an application program that
dlopens other modules or a libtool library that will also be dlopened.

   <p>For example, if we wanted to build a shared library, <span class="file">libhello</span>,
that would later be dlopened by an application, we would add
<span class="samp">-module</span> to the other link flags:

<pre class="example">     burger$ <kbd>libtool --mode=link gcc -module -o libhello.la foo.lo \
                     hello.lo -rpath /usr/local/lib -lm</kbd>
     burger$
</pre>
   <p>If symbols from your <em>executable</em> are needed to satisfy unresolved
references in a library you want to dlopen you will have to use the flag
<span class="samp">-export-dynamic</span>. 
You should use <span class="samp">-export-dynamic</span> while linking the executable that calls
dlopen:

<pre class="example">     burger$ <kbd>libtool --mode=link gcc -export-dynamic -o hell-dlopener main.o</kbd>
     burger$
</pre>
   <div class="node">
<p><hr>
<a name="Dlpreopening"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Finding-the-dlname">Finding the dlname</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Building-modules">Building modules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Dlopened-modules">Dlopened modules</a>
<br>
</div>

<h3 class="section">9.2 Dlpreopening</h3>

<p>Libtool provides special support for dlopening libtool object and
libtool library files, so that their symbols can be resolved <em>even
on platforms without any </em><code>dlopen</code><em> and </em><code>dlsym</code><em>
functions</em>.

   <p>Consider the following alternative ways of loading code into your
program, in order of increasing &ldquo;laziness&rdquo;:

     <ol type=1 start=1>
<li>Linking against object files that become part of the program executable,
whether or not they are referenced.  If an object file cannot be found,
then the linker refuses to create the executable.

     <li>Declaring a static library to the linker, so that it is searched at link
time in order to satisfy any undefined references in the above object
files.  If the static library cannot be found, then the linker refuses
to link the executable.

     <li>Declaring a shared library to the runtime linker, so that it is searched
at runtime in order to satisfy any undefined references in the above
files.  If the shared library cannot be found, then the dynamic linker
aborts the program before it runs.

     <li>Dlopening a module, so that the application can resolve its own,
dynamically-computed references.  If there is an error opening the
module, or the module is not found, then the application can recover
without crashing.
        </ol>

   <p>Libtool emulates <span class="samp">-dlopen</span> on static platforms by linking objects
into the program at compile time, and creating data structures that
represent the program's symbol table.

   <p>In order to use this feature, you must declare the objects you want your
application to dlopen by using the <span class="samp">-dlopen</span> or <span class="samp">-dlpreopen</span>
flags when you link your program (see <a href="#Link-mode">Link mode</a>).

<div class="defun">
&mdash; Structure: struct <b>lt_dlsymlist</b><var> { const&nbsp;char&nbsp;*name;<!-- /@w --> lt_ptr&nbsp;address;<!-- /@w --> }<a name="index-lt_005fdlsymlist-142"></a></var><br>
<blockquote><p>The <var>name</var> attribute is a null-terminated character string of the
symbol name, such as <code>"fprintf"</code>.  The <var>address</var> attribute is a
generic pointer to the appropriate object, such as <code>&amp;fprintf</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: const lt_dlsymlist * <b>lt_preloaded_symbols</b><var><a name="index-lt_005fpreloaded_005fsymbols-143"></a></var><br>
<blockquote><p>An array of <var>lt_symbol</var> structures, representing all the preloaded
symbols linked into the program. For each <span class="samp">-dlpreopen</span>ed file
there is an element with the <var>name</var> of the file and a <var>address</var>
of <code>0</code>, followed by all symbols exported from this file. 
For the executable itself the special name @PROGRAM@ is used. 
The last element has a <var>name</var> and <var>address</var> of <code>0</code>. 
</p></blockquote></div>

   <p>Some compilers may allow identifiers which are not valid in ANSI C, such
as dollar signs.  Libtool only recognizes valid ANSI C symbols (an
initial ASCII letter or underscore, followed by zero or more ASCII
letters, digits, and underscores), so non-ANSI symbols will not appear
in <var>lt_preloaded_symbols</var>.

<div class="node">
<p><hr>
<a name="Finding-the-dlname"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Dlopen-issues">Dlopen issues</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Dlpreopening">Dlpreopening</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Dlopened-modules">Dlopened modules</a>
<br>
</div>

<h3 class="section">9.3 Finding the correct name to dlopen</h3>

<p><a name="index-names-of-dynamic-modules-144"></a><a name="index-dynamic-modules_002c-names-145"></a>
After a library has been linked with <span class="samp">-module</span>, it can be dlopened. 
Unfortunately, because of the variation in library names,
your package needs to determine the correct file to dlopen.

   <p>The most straightforward and flexible implementation is to determine the
name at runtime, by finding the installed <span class="samp">.la</span> file, and searching
it for the following lines:

<pre class="example">     # The name that we can <code>dlopen</code>.
     dlname='<var>dlname</var>'
</pre>
   <p>If <var>dlname</var> is empty, then the library cannot be dlopened. 
Otherwise, it gives the dlname of the library.  So, if the library was
installed as <span class="file">/usr/local/lib/libhello.la</span>, and the <var>dlname</var> was
<span class="file">libhello.so.3</span>, then <span class="file">/usr/local/lib/libhello.so.3</span> should be
dlopened.

   <p>If your program uses this approach, then it should search the
directories listed in the <code>LD_LIBRARY_PATH</code><a rel="footnote" href="#fn-8" name="fnd-8"><sup>8</sup></a> environment variable, as well as
the directory where libraries will eventually be installed.  Searching
this variable (or equivalent) will guarantee that your program can find
its dlopened modules, even before installation, provided you have linked
them using libtool.

<div class="node">
<p><hr>
<a name="Dlopen-issues"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Finding-the-dlname">Finding the dlname</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Dlopened-modules">Dlopened modules</a>
<br>
</div>

<h3 class="section">9.4 Unresolved dlopen issues</h3>

<p><a name="index-pitfalls-with-dlopen-146"></a><a name="index-dlopening_002c-pitfalls-147"></a><a name="index-trouble-with-dlopen-148"></a>
The following problems are not solved by using libtool's dlopen support:

     <ul>
<li>Dlopen functions are generally only available on shared library
platforms.  If you want your package to be portable to static platforms,
you have to use either libltdl (see <a href="#Using-libltdl">Using libltdl</a>) or develop your
own alternatives to dlopening dynamic code. 
Most reasonable solutions involve writing wrapper functions for the
<code>dlopen</code> family, which do package-specific tricks when dlopening
is unsupported or not available on a given platform.

     <li>There are major differences in implementations of the <code>dlopen</code>
family of functions.  Some platforms do not even use the same function
names (notably HP-UX, with its <code>shl_load</code> family).

     <li>The application developer must write a custom search function in order
to discover the correct module filename to supply to <code>dlopen</code>. 
</ul>

<div class="node">
<p><hr>
<a name="Using-libltdl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Other-languages">Other languages</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Dlopened-modules">Dlopened modules</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">10 Using libltdl</h2>

<p><a name="index-libltdl-149"></a><a name="index-dlopen-150"></a><a name="index-dlsym-151"></a><a name="index-dlclose-152"></a><a name="index-dlerror-153"></a><a name="index-shl_005fload-154"></a><a name="index-dynamic-linking_002c-applications-155"></a><a name="index-dlopening-modules-156"></a><a name="index-modules_002c-dynamic-157"></a><a name="index-application_002dlevel-dynamic-linking-158"></a>
Libtool provides a small library, called <span class="file">libltdl</span>, that aims at
hiding the various difficulties of dlopening libraries from programmers. 
It consists of a header-file and a small C source file that can be
distributed with applications that need dlopening functionality.  On
some platforms, whose dynamic linkers are too limited for a simple
implementation of <span class="file">libltdl</span> services, it requires GNU DLD, or it
will only emulate dynamic linking with libtool's dlpreopening mechanism.

<p class="noindent">libltdl supports currently the following dynamic linking mechanisms:

     <ul>
<li><code>dlopen</code> (Solaris, Linux and various BSD flavors)
<li><code>shl_load</code> (HP-UX)
<li><code>LoadLibrary</code> (Win16 and Win32)
<li><code>load_add_on</code> (BeOS)
<li>GNU DLD (emulates dynamic linking for static libraries)
<li>libtool's dlpreopen (see see <a href="#Dlpreopening">Dlpreopening</a>)
</ul>

<p class="noindent">libltdl is licensed under the terms of the GNU Library General Public License,
with the following exception:

   <blockquote>
As a special exception to the GNU Lesser General Public License,
if you distribute this file as part of a program or library that
is built using GNU libtool, you may include it under the same
distribution terms that you use for the rest of that program. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#Libltdl-interface">Libltdl interface</a>:            How to use libltdl in your programs. 
<li><a accesskey="2" href="#Modules-for-libltdl">Modules for libltdl</a>:          Creating modules that can be <code>dlopen</code>ed. 
<li><a accesskey="3" href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a>: 	Registering callbacks for multi-thread safety. 
<li><a accesskey="4" href="#User-defined-module-data">User defined module data</a>:     Associating data with loaded modules. 
<li><a accesskey="5" href="#Module-loaders-for-libltdl">Module loaders for libltdl</a>:   Creating user defined module loaders. 
<li><a accesskey="6" href="#Distributing-libltdl">Distributing libltdl</a>:         How to distribute libltdl with your package. 
</ul>

<div class="node">
<p><hr>
<a name="Libltdl-interface"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Modules-for-libltdl">Modules for libltdl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libltdl">Using libltdl</a>
<br>
</div>

<h3 class="section">10.1 How to use libltdl in your programs</h3>

<p class="noindent">The libltdl API is similar to the dlopen interface of Solaris and Linux,
which is very simple but powerful.

<p class="noindent">To use libltdl in your program you have to include the header file <span class="file">ltdl.h</span>:

<pre class="example">     #include &lt;ltdl.h&gt;
</pre>
   <p class="noindent">The last release of libltdl used some symbols that violated the
<span class="sc">posix</span> namespace conventions.  These symbols are now deprecated,
and have been replaced by those described here.  If you have code that
relies on the old deprecated symbol names, defining
<span class="samp">LT_NON_POSIX_NAMESPACE</span> before you include <span class="file">ltdl.h</span> provides
conversion macros.  Whichever set of symbols you use, the new api is
not binary compatible with the last, so you will need to recompile
your application in order to use this version of libltdl.

<p class="noindent">Note that libltdl is not threadsafe, i.e. a multithreaded application
has to use a mutex for libltdl.  It was reported that GNU/Linux's glibc
2.0's <code>dlopen</code> with <span class="samp">RTLD_LAZY</span> (which libltdl uses by
default) is not thread-safe, but this problem is supposed to be fixed in
glibc 2.1.  On the other hand, <span class="samp">RTLD_NOW</span> was reported to introduce
problems in multi-threaded applications on FreeBSD.  Working around
these problems is left as an exercise for the reader; contributions are
certainly welcome.

<p class="noindent">The following types are defined in <span class="file">ltdl.h</span>:

<div class="defun">
&mdash; Type: <b>lt_ptr</b><var><a name="index-lt_005fptr-159"></a></var><br>
<blockquote><p><code>lt_ptr</code> is a generic pointer. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: <b>lt_dlhandle</b><var><a name="index-lt_005fdlhandle-160"></a></var><br>
<blockquote><p><code>lt_dlhandle</code> is a module "handle". 
Every lt_dlopened module has a handle associated with it. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: <b>lt_dlsymlist</b><var><a name="index-lt_005fdlsymlist-161"></a></var><br>
<blockquote><p><code>lt_dlsymlist</code> is a symbol list for dlpreopened modules. 
This structure is described in see <a href="#Dlpreopening">Dlpreopening</a>. 
</p></blockquote></div>

<p class="noindent">libltdl provides the following functions:

<div class="defun">
&mdash; Function: int <b>lt_dlinit</b> (<var>void</var>)<var><a name="index-lt_005fdlinit-162"></a></var><br>
<blockquote><p>Initialize libltdl. 
This function must be called before using libltdl
and may be called several times. 
Return 0 on success, otherwise the number of errors. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlexit</b> (<var>void</var>)<var><a name="index-lt_005fdlexit-163"></a></var><br>
<blockquote><p>Shut down libltdl and close all modules. 
This function will only then shut down libltdl when it was called as
many times as <code>lt_dlinit</code> has been successfully called. 
Return 0 on success, otherwise the number of errors. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: lt_dlhandle <b>lt_dlopen</b> (<var>const char *filename</var>)<var><a name="index-lt_005fdlopen-164"></a></var><br>
<blockquote><p>Open the module with the file name <var>filename</var> and return a
handle for it.  <code>lt_dlopen</code> is able to open libtool dynamic
modules, preloaded static modules, the program itself and
native dynamic libraries.

        <p>Unresolved symbols in the module are resolved using its dependency
libraries (not implemented yet) and previously dlopened modules.  If the
executable using this module was linked with the <code>-export-dynamic</code>
flag, then the global symbols in the executable will also be used to
resolve references in the module.

        <p>If <var>filename</var> is <code>NULL</code> and the program was linked with
<code>-export-dynamic</code> or <code>-dlopen self</code>, <code>lt_dlopen</code> will
return a handle for the program itself, which can be used to access its
symbols.

        <p>If libltdl cannot find the library and the file name <var>filename</var> does
not have a directory component it will additionally search in the
following search paths for the module (in the order as follows):

          <ol type=1 start=1>
<li>user-defined search path:
This search path can be changed by the program using the
functions <code>lt_dlsetsearchpath</code>, <code>lt_dladdsearchdir</code> and
<code>lt_dlinsertsearchdir</code>.

          <li>libltdl's search path:
This search path is the value of the environment variable
<var>LTDL_LIBRARY_PATH</var>.

          <li>system library search path:
The system dependent library search path
(e.g. on Linux it is <var>LD_LIBRARY_PATH</var>).
             </ol>

        <p>Each search path must be a colon-separated list of absolute directories,
for example, <code>"/usr/lib/mypkg:/lib/foo"</code>.

        <p>If the same module is loaded several times, the same handle is returned. 
If <code>lt_dlopen</code> fails for any reason, it returns <code>NULL</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: lt_dlhandle <b>lt_dlopenext</b> (<var>const char *filename</var>)<var><a name="index-lt_005fdlopenext-165"></a></var><br>
<blockquote><p>The same as <code>lt_dlopen</code>, except that it tries to append
different file name extensions to the file name. 
If the file with the file name <var>filename</var> cannot be found
libltdl tries to append the following extensions:

          <ol type=1 start=1>
<li>the libtool archive extension <span class="samp">.la</span>
<li>the extension used for native dynamic libraries on the host platform,
e.g., <span class="samp">.so</span>, <span class="samp">.sl</span>, etc.
             </ol>

        <p>This lookup strategy was designed to allow programs that don't
have knowledge about native dynamic libraries naming conventions
to be able to <code>dlopen</code> such libraries as well as libtool modules
transparently. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlclose</b> (<var>lt_dlhandle handle</var>)<var><a name="index-lt_005fdlclose-166"></a></var><br>
<blockquote><p>Decrement the reference count on the module <var>handle</var>. 
If it drops to zero and no other module depends on this module,
then the module is unloaded. 
Return 0 on success. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: lt_ptr <b>lt_dlsym</b> (<var>lt_dlhandle handle, const char *name</var>)<var><a name="index-lt_005fdlsym-167"></a></var><br>
<blockquote><p>Return the address in the module <var>handle</var>, where the symbol given
by the null-terminated string <var>name</var> is loaded. 
If the symbol cannot be found, <code>NULL</code> is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: const char * <b>lt_dlerror</b> (<var>void</var>)<var><a name="index-lt_005fdlerror-168"></a></var><br>
<blockquote><p>Return a human readable string describing the most
recent error that occurred from any of libltdl's functions. 
Return <code>NULL</code> if no errors have occurred since initialization
or since it was last called. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlpreload</b> (<var>const lt_dlsymlist *preloaded</var>)<var><a name="index-lt_005fdlpreload-169"></a></var><br>
<blockquote><p>Register the list of preloaded modules <var>preloaded</var>. 
If <var>preloaded</var> is <code>NULL</code>, then all previously registered
symbol lists, except the list set by <code>lt_dlpreload_default</code>,
are deleted. Return 0 on success. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlpreload_default</b> (<var>const lt_dlsymlist *preloaded</var>)<var><a name="index-lt_005fdlpreload_005fdefault-170"></a></var><br>
<blockquote><p>Set the default list of preloaded modules to <var>preloaded</var>, which
won't be deleted by <code>lt_dlpreload</code>.  Note that this function does
<em>not</em> require libltdl to be initialized using <code>lt_dlinit</code> and
can be used in the program to register the default preloaded modules. 
Instead of calling this function directly, most programs will use the
macro <code>LTDL_SET_PRELOADED_SYMBOLS</code>.

        <p>Return 0 on success. 
</p></blockquote></div>

<div class="defun">
&mdash; Macro: <b>LTDL_SET_PRELOADED_SYMBOLS</b><var><a name="index-LTDL_005fSET_005fPRELOADED_005fSYMBOLS-171"></a></var><br>
<blockquote><p>Set the default list of preloaded symbols. 
Should be used in your program to initialize libltdl's
list of preloaded modules.

     <pre class="example">          #include &lt;ltdl.h&gt;
          
          int main() {
            /* ... */
            LTDL_SET_PRELOADED_SYMBOLS();
            /* ... */
          }
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dladdsearchdir</b> (<var>const char *search_dir</var>)<var><a name="index-lt_005fdladdsearchdir-172"></a></var><br>
<blockquote><p>Append the search directory <var>search_dir</var> to the current user-defined
library search path. Return 0 on success. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlinsertsearchdir</b> (<var>const&nbsp;char&nbsp;*before<!-- /@w -->, const&nbsp;char&nbsp;*search_dir<!-- /@w --></var>)<var><a name="index-lt_005fdlinsertsearchdir-173"></a></var><br>
<blockquote><p>Insert the search directory <var>search_dir</var> into the user-defined library
search path, immediately before the element starting at address
<var>before</var>.  If <var>before</var> is <span class="samp">NULL</span>, then <var>search_dir</var> is
appending as if <code>lt_dladdsearchdir</code> had been called.  Return 0 on success. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlsetsearchpath</b> (<var>const char *search_path</var>)<var><a name="index-lt_005fdlsetsearchpath-174"></a></var><br>
<blockquote><p>Replace the current user-defined library search path with
<var>search_path</var>, which must be a colon-separated list of absolute
directories.  Return 0 on success. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: const char * <b>lt_dlgetsearchpath</b> (<var>void</var>)<var><a name="index-lt_005fdlgetsearchpath-175"></a></var><br>
<blockquote><p>Return the current user-defined library search path. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlforeachfile</b> (<var>const&nbsp;char&nbsp;*search_path<!-- /@w -->, int&nbsp;(*func)&nbsp;(const&nbsp;char&nbsp;*filename,&nbsp;lt_ptr&nbsp;data)<!-- /@w -->, lt_ptr&nbsp;data<!-- /@w --></var>)<var><a name="index-lt_005fdlforeachfile-176"></a></var><br>
<blockquote><p>In some applications you may not want to load individual modules with
known names, but rather find all of the modules in a set of
directories and load them all during initialisation.  With this function
you can have libltdl scan the colon delimited directory list in
<var>search_path</var> for candidates, and pass them, along with <var>data</var>
to your own callback function, <var>func</var>.  If <var>search_path</var> is
<span class="samp">NULL</span>, then search all of the standard locations that
<code>lt_dlopen</code> would examine.  This function will continue to make
calls to <var>func</var> for each file that it discovers in <var>search_path</var>
until one of these calls returns non-zero, or until the files are
exhausted.  <span class="samp">lt_dlforeachfile</span> returns the value returned by the last
call made to <var>func</var>.

        <p>For example you could define <var>func</var> to build an ordered
<dfn>argv</dfn>-like vector of files using <var>data</var> to hold the address of
the start of the vector. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlmakeresident</b> (<var>lt_dlhandle handle</var>)<var><a name="index-lt_005fdlmakeresident-177"></a></var><br>
<blockquote><p>Mark a module so that it cannot be <span class="samp">lt_dlclose</span>d.  This can be
useful if a module implements some core functionality in your project,
which would cause your code to crash if removed.  Return 0 on success.

        <p>If you use <span class="samp">lt_dlopen (NULL)</span> to get a <var>handle</var> for the running
binary, that handle will always be marked as resident, and consequently
cannot be successfully <span class="samp">lt_dlclose</span>d. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlisresident</b> (<var>lt_dlhandle handle</var>)<var><a name="index-lt_005fdlisresident-178"></a></var><br>
<blockquote><p>Check whether a particular module has been marked as resident, returning 1
if it has or 0 otherwise.  If there is an error while executing this
function, return -1 and set an error message for retrieval with
<code>lt_dlerror</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: lt_ptr (*) (size_t <var>size</var>) <b>lt_dlmalloc</b><var><a name="index-lt_005fdlmalloc-179"></a></var><br>
&mdash; Variable: lt_ptr (*) (lt_ptr <var>ptr</var>, size_t <var>size</var>) <b>lt_dlrealloc</b><var><a name="index-lt_005fdlrealloc-180"></a></var><br>
&mdash; Variable: void (*) (lt_ptr <var>ptr</var>) <b>lt_dlfree</b><var><a name="index-lt_005fdlfree-181"></a></var><br>
<blockquote><p>These variables are set to <code>malloc</code>, <code>realloc</code> and <code>free</code> by
default, but you can set them to any other functions that provide equivalent
functionality.  If you change any of these function pointers, you will almost
certainly need to change all three to point into the same malloc library. 
Strange things will happen if you allocate memory from one library, and then
pass it to an implementation of <code>free</code> that doesn't know what book
keeping the allocator used.

        <p>You must not modify any of their values after calling any libltdl function
other than <code>lt_dlpreopen_default</code> or the macro
<code>LTDL_SET_PRELOADED_SYMBOLS</code>. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="Modules-for-libltdl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Libltdl-interface">Libltdl interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libltdl">Using libltdl</a>
<br>
</div>

<h3 class="section">10.2 Creating modules that can be <code>dlopen</code>ed</h3>

<p>Libtool modules are like normal libtool libraries with a few exceptions:

   <p>You have to link the module with libtool's <span class="samp">-module</span> switch,
and you should link any program that is intended to dlopen the module with
<span class="samp">-dlopen modulename.la</span> so that libtool can dlpreopen the module
on platforms which don't support dlopening.  If the module depends on any
other libraries, make sure you specify them either when you link the module
or when you link programs that dlopen it. 
If you want to disable see <a href="#Versioning">Versioning</a> for a specific module
you should link it with the <span class="samp">-avoid-version</span> switch. 
Note that libtool modules don't need to have a "lib" prefix. 
However, automake 1.4 or higher is required to build such modules.

   <p>Usually a set of modules provide the same interface, i.e, exports the same
symbols, so that a program can dlopen them without having to know more
about their internals. 
In order to avoid symbol conflicts all exported symbols must be prefixed
with "modulename_LTX_" (<span class="samp">modulename</span> is the name of the module). 
Internal symbols must be named in such a way that they won't conflict
with other modules, for example, by prefixing them with "_modulename_". 
Although some platforms support having the same symbols defined more than
once it is generally not portable and it makes it impossible to dlpreopen
such modules.  libltdl will automatically cut the prefix off to get
the real name of the symbol.  Additionally, it supports modules which
don't use a prefix so that you can also dlopen non-libtool modules.

   <p><span class="file">foo1.c</span> gives an example of a portable libtool module. 
Exported symbols are prefixed with "foo1_LTX_", internal symbols
with "_foo1_". Aliases are defined at the beginning so that the code
is more readable.

<pre class="example">     /* aliases for the exported symbols */
     #define foo	foo1_LTX_foo
     #define bar	foo1_LTX_bar
     
     /* a global variable definition */
     int bar = 1;
     
     /* a private function */
     int _foo1_helper() {
       return bar;
     }
     
     /* an exported function */
     int foo() {
       return _foo1_helper();
     }
</pre>
   <p class="noindent">The <span class="file">Makefile.am</span> contains the necessary rules to build the
module <span class="file">foo1.la</span>:

<pre class="example">     ...
     lib_LTLIBRARIES = foo1.la
     
     foo1_la_SOURCES = foo1.c
     foo1_la_LDFLAGS = -module
     ...
</pre>
   <div class="node">
<p><hr>
<a name="Thread-Safety-in-libltdl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#User-defined-module-data">User defined module data</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Modules-for-libltdl">Modules for libltdl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libltdl">Using libltdl</a>
<br>
</div>

<h3 class="section">10.3 Using libltdl in a multi threaded environment</h3>

<p>Using the <code>lt_dlmutex_register()</code> function, and by providing some
appropriate callback function definitions, libltdl can be used in a
multi-threaded environment.

<div class="defun">
&mdash; Type: void <b>lt_dlmutex_lock</b> (<var>void</var>)<var><a name="index-lt_005fdlmutex_005flock-182"></a></var><br>
<blockquote><p>This is the type of a function pointer holding the address of a function
which will be called at the start of parts of the libltdl implementation
code which require a mutex lock.

        <p>Because libltdl is inherently recursive, it is important that the
locking mechanism employed by these callback functions are reentrant, or
else strange problems will occur. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: void <b>lt_dlmutex_unlock</b> (<var>void</var>)<var><a name="index-lt_005fdlmutex_005funlock-183"></a></var><br>
<blockquote><p>The type of a matching unlock function. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: void <b>lt_dlmutex_seterror</b><var> (const&nbsp;char&nbsp;*error);<!-- /@w --><a name="index-lt_005fdlmutex_005fseterror-184"></a></var><br>
<blockquote><p>Many of the functions in the libltdl <span class="sc">api</span> have a special return
value to indicate to the client that an error has occurred.  Normally (in
single threaded applications) a string describing that error can be
retrieved from internal storage with <code>lt_dlerror()</code>.

        <p>A function of this type must be registered with the library in order for
it to work in a multi-threaded context.  The function should store any
error message passed in thread local storage. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: const char * <b>lt_dlmutex_geterror</b> (<var>void</var>)<var><a name="index-lt_005fdlmutex_005fgeterror-185"></a></var><br>
<blockquote><p>The type of a matching callback function to retrieve the last stored
error message from thread local storage.

        <p>When registered correctly this function will be used by
<code>lt_dlerror())</code> from all threads to retrieve error messages for the
client. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlmutex_register</b> (<var>lt_dlmutex_lock&nbsp;*lock<!-- /@w -->, lt_dlmutex_unlock&nbsp;*unlock<!-- /@w -->, lt_dlmutex_set_error&nbsp;*seterror<!-- /@w -->, lt_dlmutex_geterror&nbsp;*geterror)<!-- /@w --><a name="index-lt_005fdlmutex_005fregister-186"></a></var><br>
<blockquote><p>Use this function to register one of each of function types described
above in preparation for multi-threaded use of libltdl.  All arguments
must be valid non-<code>NULL</code> function addresses, or else all
<code>NULL</code> to return to single threaded operation. 
</p></blockquote></div>

<div class="node">
<p><hr>
<a name="User-defined-module-data"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Module-loaders-for-libltdl">Module loaders for libltdl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libltdl">Using libltdl</a>
<br>
</div>

<h3 class="section">10.4 Data associated with loaded modules</h3>

<p>Some of the internal information about each loaded module that is
maintained by libltdl is available to the user, in the form of this
structure:

<div class="defun">
&mdash; Type: struct <b>lt_dlinfo</b><var> { char&nbsp;*filename;<!-- /@w --> char&nbsp;*name;<!-- /@w --> int&nbsp;ref_count;<!-- /@w --> }<a name="index-lt_005fdlinfo-187"></a></var><br>
<blockquote><p><code>lt_dlinfo</code> is used to store information about a module. 
The <var>filename</var> attribute is a null-terminated character string of
the real module file name.  If the module is a libtool module then
<var>name</var> is its module name (e.g. <code>"libfoo"</code> for
<code>"dir/libfoo.la"</code>), otherwise it is set to <code>NULL</code>.  The
<var>ref_count</var> attribute is a reference counter that describes how
often the same module is currently loaded. 
</p></blockquote></div>

   <p>The following function will return a pointer to libltdl's internal copy
of this structure for the given <var>handle</var>:

<div class="defun">
&mdash; Function: const lt_dlinfo * <b>lt_dlgetinfo</b> (<var>lt_dlhandle&nbsp;handle<!-- /@w --></var>)<var><a name="index-lt_005fdlgetinfo-188"></a></var><br>
<blockquote><p>Return a pointer to a struct that contains some information about
the module <var>handle</var>.  The contents of the struct must not be modified. 
Return <code>NULL</code> on failure. 
</p></blockquote></div>

   <p>Furthermore, in order to save you from having to keep a list of the
handles of all the modules you have loaded, these functions allow you to
iterate over libltdl's list of loaded modules:

<div class="defun">
&mdash; Function: int <b>lt_dlforeach</b> (<var>int&nbsp;(*func)&nbsp;(lt_dlhandle&nbsp;handle,&nbsp;lt_ptr&nbsp;data)<!-- /@w -->, lt_ptr&nbsp;data<!-- /@w --></var>)<var><a name="index-lt_005fdlforeach-189"></a></var><br>
<blockquote><p>For each loaded module call the function <var>func</var>.  The argument
<var>handle</var> is the handle of one of the loaded modules, <var>data</var> is
the <var>data</var> argument passed to <code>lt_dlforeach</code>. 
As soon as <var>func</var> returns a non-zero value for one of the handles,
<code>lt_dlforeach</code> will stop calling <var>func</var> and immediately return 1. 
Otherwise 0 is returned. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: lt_dlhandle <b>lt_dlhandle_next</b> (<var>lt_dlhandle&nbsp;place<!-- /@w --></var>)<var><a name="index-lt_005fdlhandle_005fnext-190"></a></var><br>
<blockquote><p>Iterate over the loaded module handles, returning the first handle in the
list if <var>place</var> is <code>NULL</code>, and the next one on subsequent calls. 
If <var>place</var> is the last element in the list of loaded modules, this
function returns <code>NULL</code>. 
</p></blockquote></div>

   <p>Of course, you would still need to maintain your own list of loaded
module handles to parallel the list maintained by libltdl if there are
any other data that you need to associate with each handle for the
purposes of your application.  However, if you use the following
<span class="sc">api</span> calls to associate your application data with individual module
handles as they are loaded there is actually no need to do that.  You
must first obtain a unique caller id from libltdl which you subsequently
use to retrieve the data you stored earlier.  This allows for different
libraries that each wish to store their own data against loaded modules
to do so without interfering with one another's data.

<div class="defun">
&mdash; Type: <b>lt_dlcaller_id</b><var><a name="index-lt_005fdlcaller_005fid-191"></a></var><br>
<blockquote><p>The opaque type used to hold individual data set keys. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: lt_dlcaller_id <b>lt_dlcaller_register</b> (<var>void</var>)<var><a name="index-lt_005fdlcaller_005fregister-192"></a></var><br>
<blockquote><p>Use this to obtain a unique key to store and retrieve individual sets of
per module data. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: lt_ptr <b>lt_dlcaller_set_data</b> (<var>lt_dlcaller_id&nbsp;key<!-- /@w -->, lt_dlhandle&nbsp;handle<!-- /@w -->, lt_ptr&nbsp;data<!-- /@w --></var>)<var><a name="index-lt_005fdlcaller_005fset_005fdata-193"></a></var><br>
<blockquote><p>Set <var>data</var> as the set of data uniquely associated with <var>key</var> and
<var>handle</var> for later retrieval.  This function returns the <var>data</var>
previously associated with <var>key</var> and <var>handle</var> if any.  A result of
0, may indicate that a diagnostic for the last error (if any) is available
from <code>lt_dlerror()</code>.

        <p>For example, to correctly remove some associated data:

     <pre class="example">              lt_ptr stale = lt_dlcaller_set_data (key, handle, 0);
              if (stale == NULL)
                {
                  char *error_msg = lt_dlerror ();
          
                  if (error_msg != NULL)
                    {
                      my_error_handler (error_msg);
                      return STATUS_FAILED;
                    }
                }
              else
                {
                  free (stale);
                }
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: lt_ptr <b>lt_dlcaller_get_data</b> (<var>lt_dlcaller_id&nbsp;key<!-- /@w -->, lt_dlhandle&nbsp;handle<!-- /@w --></var>)<var><a name="index-lt_005fdlcaller_005fget_005fdata-194"></a></var><br>
<blockquote><p>Return the address of the data associated with <var>key</var> and
<var>handle</var>, or else <code>NULL</code> if there is none. 
</p></blockquote></div>

   <p>The preceding functions can be combined with <code>lt_dlforeach</code> to
implement search and apply operations without the need for your
application to track the modules that have been loaded and unloaded:

<pre class="example">     int
     my_dlcaller_callback (lt_dlhandle handle, lt_ptr key_ptr)
     {
       struct my_module_data *my_data;
     
       my_data = lt_dlcaller_get_data (handle, (lt_dlcaller_id) *key_ptr);
     
       return process (my_data);
     }
     
     int
     my_dlcaller_foreach (lt_dlcaller_id key)
     {
       lt_dlforeach (my_dlcaller_callback, (lt_ptr) &amp;key);
     }
</pre>
   <div class="node">
<p><hr>
<a name="Module-loaders-for-libltdl"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Distributing-libltdl">Distributing libltdl</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#User-defined-module-data">User defined module data</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libltdl">Using libltdl</a>
<br>
</div>

<h3 class="section">10.5 How to create and register new module loaders</h3>

<p>Sometimes libltdl's many ways of gaining access to modules are not
sufficient for the purposes of a project.  You can write your own
loader, and register it with libltdl so that <code>lt_dlopen</code> will be
able to use it.

   <p>Writing a loader involves writing at least three functions which can be
called  by <code>lt_dlopen</code>, <code>lt_dlsym</code> and <code>lt_dlclose</code>. 
Optionally, you can provide a finalisation function to perform any
cleanup operations when <code>lt_dlexit</code> executes, and a symbol prefix
string which will be prepended to any symbols passed to <code>lt_dlsym</code>. 
These functions must match the function pointer types below, after
which they can be allocated to an instance of <code>lt_user_dlloader</code>
and registered.

   <p>Registering the loader requires that you choose a name for it, so that it
can be recognised by <code>lt_dlloader_find</code> and removed with
<code>lt_dlloader_remove</code>.  The name you choose must be unique, and not
already in use by libltdl's builtin loaders:

     <dl>
<dt>"dlopen"<dd>The system dynamic library loader, if one exists. 
<br><dt>"dld"<dd>The <span class="sc">gnu</span> dld loader, if <span class="file">libdld</span> was installed when libltdl was
built. 
<br><dt>"dlpreload"<dd>The loader for <code>lt_dlopen</code>ing of preloaded static modules. 
</dl>

   <p>The prefix "dl" is reserved for loaders supplied with future versions of
libltdl, so you should not use that for your own loader names.

<p class="noindent">The following types are defined in <span class="file">ltdl.h</span>:

<div class="defun">
&mdash; Type: <b>lt_module</b><var><a name="index-lt_005fmodule-195"></a></var><br>
<blockquote><p><code>lt_module</code> is a dlloader dependent module. 
The dynamic module loader extensions communicate using these low
level types. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: <b>lt_dlloader</b><var><a name="index-lt_005fdlloader-196"></a></var><br>
<blockquote><p><code>lt_dlloader</code> is a handle for module loader types. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: <b>lt_user_data</b><var><a name="index-lt_005fuser_005fdata-197"></a></var><br>
<blockquote><p><code>lt_user_data</code> is used for specifying loader instance data. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: struct <b>lt_user_dlloader</b><var> {const&nbsp;char&nbsp;*sym_prefix;<!-- /@w --> lt_module_open&nbsp;*module_open;<!-- /@w --> lt_module_close&nbsp;*module_close;<!-- /@w --> lt_find_sym&nbsp;*find_sym;<!-- /@w --> lt_dlloader_exit&nbsp;*dlloader_exit;<!-- /@w --> }<a name="index-lt_005fuser_005fdlloader-198"></a></var><br>
<blockquote><p>If you want to define a new way to open dynamic modules, and have the
<code>lt_dlopen</code> <span class="sc">api</span> use it, you need to instantiate one of these
structures and pass it to <code>lt_dlloader_add</code>.  You can pass whatever
you like in the <var>dlloader_data</var> field, and it will be passed back as
the value of the first parameter to each of the functions specified in
the function pointer fields. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: lt_module <b>lt_module_open</b> (<var>const&nbsp;char&nbsp;*filename<!-- /@w --></var>)<var><a name="index-lt_005fmodule_005fopen-199"></a></var><br>
<blockquote><p>The type of the loader function for an <code>lt_dlloader</code> module
loader.  The value set in the dlloader_data field of the <code>struct
lt_user_dlloader</code> structure will be passed into this function in the
<var>loader_data</var> parameter.  Implementation of such a function should
attempt to load the named module, and return an <code>lt_module</code>
suitable for passing in to the associated <code>lt_module_close</code> and
<code>lt_sym_find</code> function pointers.  If the function fails it should
return <code>NULL</code>, and set the error message with <code>lt_dlseterror</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: int <b>lt_module_close</b> (<var>lt_user_data&nbsp;loader_data,<!-- /@w --> lt_module&nbsp;module<!-- /@w --></var>)<var><a name="index-lt_005fmodule_005fclose-200"></a></var><br>
<blockquote><p>The type of the unloader function for a user defined module loader. 
Implementation of such a function should attempt to release
any resources tied up by the <var>module</var> module, and then unload it
from memory.  If the function fails for some reason, set the error
message with <code>lt_dlseterror</code> and return non-zero. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: lt_ptr <b>lt_find_sym</b> (<var>lt_module&nbsp;module,<!-- /@w --> const&nbsp;char&nbsp;*symbol<!-- /@w --></var>)<var><a name="index-lt_005ffind_005fsym-201"></a></var><br>
<blockquote><p>The type of the symbol lookup function for a user defined module loader. 
Implementation of such a function should return the address of the named
<var>symbol</var> in the module <var>module</var>, or else set the error message
with <code>lt_dlseterror</code> and return <code>NULL</code> if lookup fails. 
</p></blockquote></div>

<div class="defun">
&mdash; Type: int <b>lt_dlloader_exit</b> (<var>lt_user_data&nbsp;loader_data<!-- /@w --></var>)<var><a name="index-lt_005fdlloader_005fexit-202"></a></var><br>
<blockquote><p>The type of the finalisation function for a user defined module loader. 
Implementation of such a function should free any resources associated
with the loader, including any user specified data in the
<code>dlloader_data</code> field of the <code>lt_user_dlloader</code>.  If non-<code>NULL</code>,
the function will be called by <code>lt_dlexit</code>, and
<code>lt_dlloader_remove</code>. 
</p></blockquote></div>

   <p>For example:

<pre class="example">     int
     register_myloader (void)
     {
       lt_user_dlloader dlloader;
     
       /* User modules are responsible for their own initialisation. */
       if (myloader_init () != 0)
         return MYLOADER_INIT_ERROR;
     
       dlloader.sym_prefix    = NULL;
       dlloader.module_open   = myloader_open;
       dlloader.module_close  = myloader_close;
       dlloader.find_sym      = myloader_find_sym.
       dlloader.dlloader_exit = myloader_exit;
       dlloader.dlloader_data = (lt_user_data)myloader_function;
     
       /* Add my loader as the default module loader. */
       if (lt_dlloader_add (lt_dlloader_next (NULL), &amp;dlloader, "myloader") \
                     != 0)
         return ERROR;
     
       return OK;
     }
</pre>
   <p>Note that if there is any initialisation required for the loader,
it must be performed manually before the loader is registered &ndash;
libltdl doesn't handle user loader initialisation.

   <p>Finalisation <em>is</em> handled by libltdl however, and it is important
to ensure the <code>dlloader_exit</code> callback releases any resources claimed
during the initialisation phase.

<p class="noindent">libltdl provides the following functions for writing your own module
loaders:

<div class="defun">
&mdash; Function: int <b>lt_dlloader_add</b> (<var>lt_dlloader&nbsp;*place,<!-- /@w --> lt_user_dlloader&nbsp;*dlloader,<!-- /@w --> const&nbsp;char&nbsp;*loader_name<!-- /@w --></var>)<var><a name="index-lt_005fdlloader_005fadd-203"></a></var><br>
<blockquote><p>Add a new module loader to the list of all loaders, either as the
last loader (if <var>place</var> is <code>NULL</code>), else immediately before the
loader passed as <var>place</var>.  <var>loader_name</var> will be returned by
<code>lt_dlloader_name</code> if it is subsequently passed a newly
registered loader.  These <var>loader_name</var>s must be unique, or
<code>lt_dlloader_remove</code> and <code>lt_dlloader_find</code> cannot
work. Returns 0 for success.

     <pre class="example">          {
            /* Make myloader be the last one. */
            if (lt_dlloader_add (NULL, myloader) != 0)
              perror (lt_dlerror ());
          }
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlloader_remove</b> (<var>const&nbsp;char&nbsp;*loader_name<!-- /@w --></var>)<var><a name="index-lt_005fdlloader_005fremove-204"></a></var><br>
<blockquote><p>Remove the loader identified by the unique name, <var>loader_name</var>. 
Before this can succeed, all modules opened by the named loader must
have been closed.  Returns 0 for success, otherwise an error message can
be obtained from <code>lt_dlerror</code>.

     <pre class="example">          {
            /* Remove myloader. */
            if (lt_dlloader_remove ("myloader") != 0)
              perror (lt_dlerror ());
          }
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: lt_dlloader * <b>lt_dlloader_next</b> (<var>lt_dlloader&nbsp;*place<!-- /@w --></var>)<var><a name="index-lt_005fdlloader_005fnext-205"></a></var><br>
<blockquote><p>Iterate over the module loaders, returning the first loader if <var>place</var> is
<code>NULL</code>, and the next one on subsequent calls. The handle is for use with
<code>lt_dlloader_add</code>.

     <pre class="example">          {
            /* Make myloader be the first one. */
            if (lt_dlloader_add (lt_dlloader_next (NULL), myloader) != 0)
              return ERROR;
          }
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: lt_dlloader * <b>lt_dlloader_find</b> (<var>const&nbsp;char&nbsp;*loader_name<!-- /@w --></var>)<var><a name="index-lt_005fdlloader_005ffind-206"></a></var><br>
<blockquote><p>Return the first loader with a matching <var>loader_name</var> identifier, or else
<code>NULL</code>, if the identifier is not found.

        <p>The identifiers which may be used by libltdl itself, if the host
architecture supports them are <dfn>dlopen</dfn><a rel="footnote" href="#fn-9" name="fnd-9"><sup>9</sup></a>, <dfn>dld</dfn> and <dfn>dlpreload</dfn>.

     <pre class="example">          {
            /* Add a user loader as the next module loader to be tried if
               the standard dlopen loader were to fail when lt_dlopening. */
            if (lt_dlloader_add (lt_dlloader_find ("dlopen"), myloader) != 0)
              return ERROR;
          }
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: const char * <b>lt_dlloader_name</b> (<var>lt_dlloader&nbsp;*place<!-- /@w --></var>)<var><a name="index-lt_005fdlloader_005fname-207"></a></var><br>
<blockquote><p>Return the identifying name of <var>PLACE</var>, as obtained from
<code>lt_dlloader_next</code> or <code>lt_dlloader_find</code>.  If this function fails,
it will return <code>NULL</code> and set an error for retrieval with
<code>lt_dlerror</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Function: lt_user_data * <b>lt_dlloader_data</b> (<var>lt_dlloader&nbsp;*place<!-- /@w --></var>)<var><a name="index-lt_005fdlloader_005fdata-208"></a></var><br>
<blockquote><p>Return the address of the <code>dlloader_data</code> of <var>PLACE</var>, as
obtained from <code>lt_dlloader_next</code> or <code>lt_dlloader_find</code>.  If
this function fails, it will return <code>NULL</code> and set an error for
retrieval with <code>lt_dlerror</code>. 
</p></blockquote></div>

<h4 class="subsection">10.5.1 Error handling within user module loaders</h4>

<div class="defun">
&mdash; Function: int <b>lt_dladderror</b> (<var>const&nbsp;char&nbsp;*diagnostic<!-- /@w --></var>)<var><a name="index-lt_005fdladderror-209"></a></var><br>
<blockquote><p>This function allows you to integrate your own error messages into
<code>lt_dlerror</code>.  Pass in a suitable diagnostic message for return by
<code>lt_dlerror</code>, and an error identifier for use with
<code>lt_dlseterror</code> is returned.

        <p>If the allocation of an identifier fails, this function returns -1.

     <pre class="example">          int myerror = lt_dladderror ("Doh!");
          if (myerror &lt; 0)
            perror (lt_dlerror ());
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: int <b>lt_dlseterror</b> (<var>int&nbsp;errorcode<!-- /@w --></var>)<var><a name="index-lt_005fdlseterror-210"></a></var><br>
<blockquote><p>When writing your own module loaders, you should use this function to
raise errors so that they are propagated through the <code>lt_dlerror</code>
interface. All of the standard errors used by libltdl are declared in
<span class="file">ltdl.h</span>, or you can add more of your own with
<code>lt_dladderror</code>.  This function returns 0 on success.

     <pre class="example">          if (lt_dlseterror (LTDL_ERROR_NO_MEMORY) != 0)
            perror (lt_dlerror ());
     </pre>
        </blockquote></div>

<div class="node">
<p><hr>
<a name="Distributing-libltdl"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Module-loaders-for-libltdl">Module loaders for libltdl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Using-libltdl">Using libltdl</a>
<br>
</div>

<h3 class="section">10.6 How to distribute libltdl with your package</h3>

<p>Even though libltdl is installed together with libtool, you may wish to
include libltdl in the distribution of your package, for the convenience
of users of your package that don't have libtool or libltdl installed. 
In this case, you must decide whether to manually add the <code>ltdl</code>
objects to your package, or else which flavor of libltdl you want to use:
a convenience library or an installable libtool library.

   <p>The most simplistic way to add <code>libltdl</code> to your package is to copy
the source files, <span class="file">ltdl.c</span> and <span class="file">ltdl.h</span>, to a source directory
within your package and to build and link them along with the rest of
your sources.  To help you do this, the m4 macros for autoconf are
available in <span class="file">ltdl.m4</span>.  You must ensure that they are available in
<span class="file">aclocal.m4</span> before you run Autoconf &ndash; by appending the contents
of <span class="file">ltdl.m4</span> to <span class="file">acinclude.m4</span>, if you are using automake, or
to <span class="file">aclocal.m4</span> if you are not.  Having made the macros available,
you must add a call to the <span class="samp">AC_LIB_LTDL</span> macro to your package's
<span class="file">configure.in</span> to perform the configure time checks required to
build <span class="file">ltdl.o</span> correctly.  This method has problems if you then try
to link the package binaries with an installed libltdl, or a library
which depends on libltdl: you may have problems with duplicate symbol
definitions.

   <p>One advantage of the convenience library is that it is not installed, so
the fact that you use libltdl will not be apparent to the user, and it
will not overwrite a pre-installed version of libltdl a user might have. 
On the other hand, if you want to upgrade libltdl for any reason
(e.g. a bugfix) you'll have to recompile your package instead of just
replacing an installed version of libltdl. 
However, if your programs or libraries are linked with other libraries
that use such a pre-installed version of libltdl, you may get linker
errors or run-time crashes.  Another problem is that you cannot link the
convenience library into more than one libtool library, then link a
single program with these libraries, because you may get duplicate
symbols. In general you can safely use the convenience library in programs
which don't depend on other libraries that might use libltdl too. 
In order to enable this flavor of libltdl, you should add the
line <span class="samp">AC_LIBLTDL_CONVENIENCE</span> to your <span class="file">configure.in</span>,
<em>before</em> <span class="samp">AC_PROG_LIBTOOL</span>.

   <p>In order to select the installable version of libltdl, you should add a
call of the macro <span class="samp">AC_LIBLTDL_INSTALLABLE</span> to your
<span class="file">configure.in</span> <em>before</em> <span class="samp">AC_PROG_LIBTOOL</span>.  This macro
will check whether libltdl is already installed and, if not, request the
libltdl embedded in your package to be built and installed.  Note,
however, that no version checking is performed.  The user may override
the test and determine that the libltdl embedded must be installed,
regardless of the existence of another version, using the configure
switch <span class="samp">--enable-ltdl-install</span>.

   <p>In order to embed libltdl into your package, just add <span class="samp">--ltdl</span> to
the <code>libtoolize</code> command line. It will copy the libltdl sources
to a subdirectory <span class="samp">libltdl</span> in your package. 
Both macros accept an optional argument to specify the location
of the <span class="samp">libltdl</span> directory. By the default both macros assume that it
is <span class="samp">${top_srcdir}/libltdl</span>.

   <p>Whatever macro you use, it is up to you to ensure that your
<span class="file">configure.in</span> will configure libltdl, using
<span class="samp">AC_CONFIG_SUBDIRS</span>, and that your <span class="file">Makefile</span>s will start
sub-makes within libltdl's directory, using automake's <var>SUBDIRS</var>,
for example.  Both macros define the shell variables <var>LIBLTDL</var>, to
the link flag that you should use to link with libltdl, and
<var>LTDLINCL</var>, to the preprocessor flag that you should use to compile
with programs that include <span class="file">ltdl.h</span>.  It is up to you to use
<span class="samp">AC_SUBST</span> to ensure that this variable will be available in
<span class="file">Makefile</span>s, or add them to variables that are <span class="samp">AC_SUBST</span>ed by
default, such as <var>LIBS</var> and <var>CPPFLAGS</var>.  Also note that you should
not include <span class="file">libltdl/Makefile</span> in the list of files to be configured
from your toplevel <span class="file">configure.in</span>; this is done by
<span class="file">libltdl/configure.ac</span>.

   <p>If you're using the convenience libltdl, <var>LIBLTDL</var> will be the
pathname for the convenience version of libltdl and <var>LTDLINCL</var> will be
<span class="samp">-I</span> followed by the directory that contains libltdl, both starting
with <span class="samp">${top_builddir}/</span> or <span class="samp">${top_srcdir}/</span>, respectively.

   <p>If you request an installed version of libltdl and one is
found<a rel="footnote" href="#fn-10" name="fnd-10"><sup>10</sup></a>, <var>LIBLTDL</var> will
be set to <span class="samp">-lltdl</span> and <var>LTDLINCL</var> will be empty (which is just a
blind assumption that <span class="file">ltdl.h</span> is somewhere in the include path if
libltdl is in the library path).  If an installable version of libltdl
must be built, its pathname, starting with <span class="samp">${top_builddir}/</span>,
will be stored in <var>LIBLTDL</var>, and <var>LTDLINCL</var> will be set just like
in the case of convenience library.

   <p>So, when you want to link a program with libltdl, be it a convenience,
installed or installable library, just compile with <span class="samp">$(LTDLINCL)</span>
and link it with <span class="samp">$(LIBLTDL)</span>, using libtool.

   <p>You should probably also add <span class="samp">AC_LIBTOOL_DLOPEN</span> to your
<span class="file">configure.in</span> <em>before</em> <span class="samp">AC_PROG_LIBTOOL</span>, otherwise
libtool will assume no dlopening mechanism is supported, and revert to
dlpreopening, which is probably not what you want.

   <p>Avoid using the <code>-static</code>, <code>-static-libtool-libs</code> or
<code>-all-static</code> switches when linking programs with libltdl.  This
will not work on all platforms, because the dlopening functions may not
be available for static linking.

   <p>The following example shows you how to embed the convenience libltdl in
your package.  In order to use the installable variant just replace
<span class="samp">AC_LIBLTDL_CONVENIENCE</span> with <span class="samp">AC_LIBLTDL_INSTALLABLE</span>.  We
assume that libltdl was embedded using <span class="samp">libtoolize --ltdl</span>.

   <p>configure.in:
<pre class="example">     ...
     dnl Enable building of the convenience library
     dnl and set LIBLTDL accordingly
     AC_LIBLTDL_CONVENIENCE
     dnl Check for dlopen support
     AC_LIBTOOL_DLOPEN
     dnl Configure libtool
     AC_PROG_LIBTOOL
     dnl Configure libltdl
     AC_CONFIG_SUBDIRS(libltdl)
     ...
</pre>
   <p>Makefile.am:
<pre class="example">     ...
     SUBDIRS = libltdl
     
     INCLUDES = $(LTDLINCL)
     
     myprog_LDFLAGS = -export-dynamic
     # The quotes around -dlopen below fool automake &lt;= 1.4 into accepting it
     myprog_LDADD = $(LIBLTDL) "-dlopen" self "-dlopen" foo1.la
     myprog_DEPENDENCIES = $(LIBLTDL) foo1.la
     ...
</pre>
   <div class="node">
<p><hr>
<a name="Other-languages"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Troubleshooting">Troubleshooting</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-libltdl">Using libltdl</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">11 Using libtool with other languages</h2>

<p><a name="index-C_002c-not-using-211"></a><a name="index-languages_002c-non_002dC-212"></a><a name="index-C_002b_002b_002c-using-213"></a>
Libtool was first implemented in order to add support for writing shared
libraries in the C language.  However, over time, libtool is being
integrated with other languages, so that programmers are free to reap
the benefits of shared libraries in their favorite programming language.

   <p>This chapter describes how libtool interacts with other languages,
and what special considerations you need to make if you do not use C.

<ul class="menu">
<li><a accesskey="1" href="#C_002b_002b-libraries">C++ libraries</a>:                Writing libraries for C++
<li><a accesskey="2" href="#Tags">Tags</a>:                         Tags
</ul>

<div class="node">
<p><hr>
<a name="C_002b_002b-libraries"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Tags">Tags</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-languages">Other languages</a>
<br>
</div>

<h3 class="section">11.1 Writing libraries for C++</h3>

<!-- FIXME: in the TOC, the ++ is too large (seems to be math mode) -->
<p><a name="index-trouble-with-C_002b_002b-214"></a><a name="index-pitfalls-using-C_002b_002b-215"></a><a name="index-C_002b_002b_002c-pitfalls-216"></a>
Creating libraries of C++ code should be a fairly straightforward
process, because its object files differ from C ones in only three ways:

     <ol type=1 start=1>
<li>Because of name mangling, C++ libraries are only usable by the C++
compiler that created them.  This decision was made by the designers of
C++ in order to protect users from conflicting implementations of
features such as constructors, exception handling, and RTTI.

     <li>On some systems, the C++ compiler must take special actions for the
dynamic linker to run dynamic (i.e., run-time) initializers.  This means
that we should not call <span class="file">ld</span> directly to link such libraries, and
we should use the C++ compiler instead.

     <li>C++ compilers will link some Standard C++ library in by default, but
libtool does not know which are these libraries, so it cannot even run
the inter-library dependence analyzer to check how to link it in. 
Therefore, running <span class="file">ld</span> to link a C++ program or library is deemed
to fail.
        </ol>

   <p>Because of these three issues, Libtool has been designed to always use
the C++ compiler to compile and link C++ programs and libraries.  In
some instances the <code>main()</code> function of a program must also be
compiled with the C++ compiler for static C++ objects to be properly
initialized.

<div class="node">
<p><hr>
<a name="Tags"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#C_002b_002b-libraries">C++ libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Other-languages">Other languages</a>
<br>
</div>

<h3 class="section">11.2 Tags</h3>

<p><a name="index-tag-names-217"></a><a name="index-language-names-218"></a><a name="index-inferring-tags-219"></a>
Libtool supports multiple languages through the use of tags.  Technically
a tag corresponds to a set of configuration variables associated with a
language.  These variables tell <span class="command">libtool</span> how it should create
objects and libraries for each language.

   <p>Tags are defined at <span class="command">configure</span>-time for each language activated
in the package.  Here is the correspondence between language names and tags
names.

   <p><table summary=""><tr align="left"><td valign="top">Language name    </td><td valign="top">Tag name
<br></td></tr><tr align="left"><td valign="top">C                </td><td valign="top">CC
<br></td></tr><tr align="left"><td valign="top">C++              </td><td valign="top">CXX
<br></td></tr><tr align="left"><td valign="top">Java             </td><td valign="top">GCJ
<br></td></tr><tr align="left"><td valign="top">Fortran 77       </td><td valign="top">F77
<br></td></tr><tr align="left"><td valign="top">Windows Resource </td><td valign="top">RC
   <br></td></tr></table>

   <p><span class="command">libtool</span> tries to automatically infer which tag to use from
the compiler command being used to compile or link.  If it can't infer
a tag, then it defaults to the configuration for the <code>C</code> language.

   <p>The tag can also be specified using <span class="command">libtool</span>'s
<span class="option">--tag=</span><var>tag</var> option (see <a href="#Invoking-libtool">Invoking libtool</a>).  It is a good
idea to do so in <span class="file">Makefile</span> rules, because that will allow users to
substitute the compiler without relying on <span class="command">libtool</span> inference
heuristics.  When no tag is specified, <span class="command">libtool</span> will default
to <code>CC</code>; this tag always exists.

<div class="node">
<p><hr>
<a name="Troubleshooting"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Maintaining">Maintaining</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Other-languages">Other languages</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">12 Troubleshooting</h2>

<p><a name="index-troubleshooting-220"></a><a name="index-problems_002c-solving-221"></a><a name="index-solving-problems-222"></a><a name="index-problems_002c-blaming-somebody-else-for-223"></a>
Libtool is under constant development, changing to remain up-to-date
with modern operating systems.  If libtool doesn't work the way you
think it should on your platform, you should read this chapter to help
determine what the problem is, and how to resolve it.

<ul class="menu">
<li><a accesskey="1" href="#Libtool-test-suite">Libtool test suite</a>:           Libtool's self-tests. 
<li><a accesskey="2" href="#Reporting-bugs">Reporting bugs</a>:               How to report problems with libtool. 
</ul>

<div class="node">
<p><hr>
<a name="Libtool-test-suite"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Reporting-bugs">Reporting bugs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Troubleshooting">Troubleshooting</a>
<br>
</div>

<h3 class="section">12.1 The libtool test suite</h3>

<p><a name="index-test-suite-224"></a>
Libtool comes with its own set of programs that test its capabilities,
and report obvious bugs in the libtool program.  These tests, too, are
constantly evolving, based on past problems with libtool, and known
deficiencies in other operating systems.

   <p>As described in the <span class="file">INSTALL</span> file, you may run <kbd>make check</kbd>
after you have built libtool (possibly before you install it) in order
to make sure that it meets basic functional requirements.

<ul class="menu">
<li><a accesskey="1" href="#Test-descriptions">Test descriptions</a>:            The contents of the test suite. 
<li><a accesskey="2" href="#When-tests-fail">When tests fail</a>:              What to do when a test fails. 
</ul>

<div class="node">
<p><hr>
<a name="Test-descriptions"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#When-tests-fail">When tests fail</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Libtool-test-suite">Libtool test suite</a>
<br>
</div>

<h4 class="subsection">12.1.1 Description of test suite</h4>

<p>Here is a list of the current programs in the test suite, and what they
test for:

     <dl>
<dt><span class="file">cdemo-conf.test</span><dt><span class="file">cdemo-exec.test</span><dt><span class="file">cdemo-make.test</span><dt><span class="file">cdemo-static.test</span><dt><span class="file">cdemo-shared.test</span><dd><a name="index-cdemo_002dconf_002etest-225"></a><a name="index-cdemo_002dexec_002etest-226"></a><a name="index-cdemo_002dmake_002etest-227"></a><a name="index-cdemo_002dstatic_002etest-228"></a><a name="index-cdemo_002dshared_002etest-229"></a>These programs check to see that the <span class="file">cdemo</span> subdirectory of the
libtool distribution can be configured and built correctly.

     <p>The <span class="file">cdemo</span> subdirectory contains a demonstration of libtool
convenience libraries, a mechanism that allows build-time static
libraries to be created, in a way that their components can be later
linked into programs or other libraries, even shared ones.

     <p>The tests <span class="file">cdemo-make.test</span> and <span class="file">cdemo-exec.test</span> are executed
three times, under three different libtool configurations:
<span class="file">cdemo-conf.test</span> configures <span class="file">cdemo/libtool</span> to build both
static and shared libraries (the default for platforms that support
both), <span class="file">cdemo-static.test</span> builds only static libraries
(<span class="samp">--disable-shared</span>), and <span class="file">cdemo-shared.test</span> builds only
shared libraries (<span class="samp">--disable-static</span>).

     <br><dt><span class="file">demo-conf.test</span><dt><span class="file">demo-exec.test</span><dt><span class="file">demo-inst.test</span><dt><span class="file">demo-make.test</span><dt><span class="file">demo-unst.test</span><dt><span class="file">demo-static.test</span><dt><span class="file">demo-shared.test</span><dt><span class="file">demo-nofast.test</span><dt><span class="file">demo-pic.test</span><dt><span class="file">demo-nopic.test</span><dd><a name="index-demo_002dconf_002etest-230"></a><a name="index-demo_002dexec_002etest-231"></a><a name="index-demo_002dinst_002etest-232"></a><a name="index-demo_002dmake_002etest-233"></a><a name="index-demo_002dunst_002etest-234"></a><a name="index-demo_002dstatic_002etest-235"></a><a name="index-demo_002dshared_002etest-236"></a><a name="index-demo_002dnofast_002etest-237"></a><a name="index-demo_002dpic_002etest-238"></a><a name="index-demo_002dnopic_002etest-239"></a>These programs check to see that the <span class="file">demo</span> subdirectory of the
libtool distribution can be configured, built, installed, and
uninstalled correctly.

     <p>The <span class="file">demo</span> subdirectory contains a demonstration of a trivial
package that uses libtool.  The tests <span class="file">demo-make.test</span>,
<span class="file">demo-exec.test</span>, <span class="file">demo-inst.test</span> and
<span class="file">demo-unst.test</span> are executed four times, under four different
libtool configurations: <span class="file">demo-conf.test</span> configures
<span class="file">demo/libtool</span> to build both static and shared libraries,
<span class="file">demo-static.test</span> builds only static libraries
(<span class="samp">--disable-shared</span>), and <span class="file">demo-shared.test</span> builds only
shared libraries (<span class="samp">--disable-static</span>). 
<span class="file">demo-nofast.test</span> configures <span class="file">demo/libtool</span> to
disable the fast-install mode (<span class="samp">--enable-fast-install=no</span>). 
<span class="file">demo-pic.test</span> configures <span class="file">demo/libtool</span> to
prefer building PIC code (<span class="samp">--with-pic</span>), <span class="file">demo-nopic.test</span>
to prefer non-PIC code (<span class="samp">--without-pic</span>).

     <br><dt><span class="file">deplibs.test</span><dd><a name="index-deplibs_002etest-240"></a>Many systems cannot link static libraries into shared libraries. 
libtool uses a <code>deplibs_check_method</code> to prevent such cases. 
This tests checks whether libtool's <code>deplibs_check_method</code>
works properly.

     <br><dt><span class="file">hardcode.test</span><dd><a name="index-hardcode_002etest-241"></a>On all systems with shared libraries, the location of the library can be
encoded in executables that are linked against it see <a href="#Linking-executables">Linking executables</a>.  This test checks the conditions under which your system
linker hardcodes the library location, and guarantees that they
correspond to libtool's own notion of how your linker behaves.

     <br><dt><span class="file">build-relink.test</span><dd><a name="index-build_002drelink_002etest-242"></a>Checks whether variable <var>shlibpath_overrides_runpath</var> is properly
set.  If the test fails and <var>VERBOSE</var> is set, it will indicate what
the variable should have been set to.

     <br><dt><span class="file">noinst-link.test</span><dd><a name="index-noinst_002dlink_002etest-243"></a>Checks whether libtool will not try to link with a previously installed
version of a library when it should be linking with a just-built one.

     <br><dt><span class="file">depdemo-conf.test</span><dt><span class="file">depdemo-exec.test</span><dt><span class="file">depdemo-inst.test</span><dt><span class="file">depdemo-make.test</span><dt><span class="file">depdemo-unst.test</span><dt><span class="file">depdemo-static.test</span><dt><span class="file">depdemo-shared.test</span><dt><span class="file">depdemo-nofast.test</span><dd><a name="index-depdemo_002dconf_002etest-244"></a><a name="index-depdemo_002dexec_002etest-245"></a><a name="index-depdemo_002dinst_002etest-246"></a><a name="index-depdemo_002dmake_002etest-247"></a><a name="index-depdemo_002dunst_002etest-248"></a><a name="index-depdemo_002dstatic_002etest-249"></a><a name="index-depdemo_002dshared_002etest-250"></a><a name="index-depdemo_002dnofast_002etest-251"></a>These programs check to see that the <span class="file">depdemo</span> subdirectory of the
libtool distribution can be configured, built, installed, and
uninstalled correctly.

     <p>The <span class="file">depdemo</span> subdirectory contains a demonstration of inter-library
dependencies with libtool.  The test programs link some interdependent
libraries.

     <p>The tests <span class="file">depdemo-make.test</span>, <span class="file">depdemo-exec.test</span>,
<span class="file">depdemo-inst.test</span> and <span class="file">depdemo-unst.test</span> are executed
four times, under four different libtool configurations:
<span class="file">depdemo-conf.test</span> configures <span class="file">depdemo/libtool</span> to build both
static and shared libraries, <span class="file">depdemo-static.test</span> builds only static
libraries (<span class="samp">--disable-shared</span>), and <span class="file">depdemo-shared.test</span> builds
only shared libraries (<span class="samp">--disable-static</span>). 
<span class="file">depdemo-nofast.test</span> configures <span class="file">depdemo/libtool</span> to
disable the fast-install mode (<span class="samp">--enable-fast-install=no</span>.

     <br><dt><span class="file">mdemo-conf.test</span><dt><span class="file">mdemo-exec.test</span><dt><span class="file">mdemo-inst.test</span><dt><span class="file">mdemo-make.test</span><dt><span class="file">mdemo-unst.test</span><dt><span class="file">mdemo-static.test</span><dt><span class="file">mdemo-shared.test</span><dd><a name="index-mdemo_002dconf_002etest-252"></a><a name="index-mdemo_002dexec_002etest-253"></a><a name="index-mdemo_002dinst_002etest-254"></a><a name="index-mdemo_002dmake_002etest-255"></a><a name="index-mdemo_002dunst_002etest-256"></a><a name="index-mdemo_002dstatic_002etest-257"></a><a name="index-mdemo_002dshared_002etest-258"></a>These programs check to see that the <span class="file">mdemo</span> subdirectory of the
libtool distribution can be configured, built, installed, and
uninstalled correctly.

     <p>The <span class="file">mdemo</span> subdirectory contains a demonstration of a package that
uses libtool and the system independent dlopen wrapper <span class="file">libltdl</span> to
load modules.  The library <span class="file">libltdl</span> provides a dlopen wrapper for
various platforms (Linux, Solaris, HP/UX etc.) including support for
dlpreopened modules (see <a href="#Dlpreopening">Dlpreopening</a>).

     <p>The tests <span class="file">mdemo-make.test</span>, <span class="file">mdemo-exec.test</span>,
<span class="file">mdemo-inst.test</span> and <span class="file">mdemo-unst.test</span> are executed
three times, under three different libtool configurations:
<span class="file">mdemo-conf.test</span> configures <span class="file">mdemo/libtool</span> to build both
static and shared libraries, <span class="file">mdemo-static.test</span> builds only static
libraries (<span class="samp">--disable-shared</span>), and <span class="file">mdemo-shared.test</span> builds
only shared libraries (<span class="samp">--disable-static</span>).

     <br><dt><span class="file">dryrun.test</span><dd><a name="index-dryrun_002etest-259"></a>This test checks whether libtool's <code>--dry-run</code> mode works properly.

     <br><dt><span class="file">assign.test</span><dd><a name="index-assign_002etest-260"></a>Checks whether we don't put break or continue on the same
line as an assignment in the libtool script.

     <br><dt><span class="file">link.test</span><dd><a name="index-link_002etest-261"></a>This test guarantees that linking directly against a non-libtool static
library works properly.

     <br><dt><span class="file">link-2.test</span><dd><a name="index-link_002d2_002etest-262"></a>This test makes sure that files ending in <span class="samp">.lo</span> are never linked
directly into a program file.

     <br><dt><span class="file">nomode.test</span><dd><a name="index-nomode_002etest-263"></a>Check whether we can actually get help for libtool.

     <br><dt><span class="file">quote.test</span><dd><a name="index-quote_002etest-264"></a>This program checks libtool's metacharacter quoting.

     <br><dt><span class="file">sh.test</span><dd><a name="index-sh_002etest-265"></a>Checks whether a `test' command was forgotten in libtool.

     <br><dt><span class="file">suffix.test</span><dd><a name="index-suffix_002etest-266"></a>When other programming languages are used with libtool (see <a href="#Other-languages">Other languages</a>), the source files may end in suffixes other than <span class="samp">.c</span>. 
This test validates that libtool can handle suffixes for all the file
types that it supports, and that it fails when the suffix is invalid.

   </dl>

<div class="node">
<p><hr>
<a name="When-tests-fail"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Test-descriptions">Test descriptions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Libtool-test-suite">Libtool test suite</a>
<br>
</div>

<h4 class="subsection">12.1.2 When tests fail</h4>

<p><a name="index-failed-tests-267"></a><a name="index-tests_002c-failed-268"></a>
Each of the above tests are designed to produce no output when they are
run via <kbd>make check</kbd>.  The exit status of each program tells the
<span class="file">Makefile</span> whether or not the test succeeded.

   <p>If a test fails, it means that there is either a programming error in
libtool, or in the test program itself.

   <p>To investigate a particular test, you may run it directly, as you would
a normal program.  When the test is invoked in this way, it produces
output which may be useful in determining what the problem is.

   <p>Another way to have the test programs produce output is to set the
<var>VERBOSE</var> environment variable to <span class="samp">yes</span> before running them. 
For example, <kbd>env VERBOSE=yes make check</kbd> runs all the tests, and
has each of them display debugging information.

<div class="node">
<p><hr>
<a name="Reporting-bugs"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Libtool-test-suite">Libtool test suite</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Troubleshooting">Troubleshooting</a>
<br>
</div>

<h3 class="section">12.2 Reporting bugs</h3>

<p><a name="index-bug-reports-269"></a><a name="index-reporting-bugs-270"></a><a name="index-problem-reports-271"></a>
If you think you have discovered a bug in libtool, you should think
twice: the libtool maintainer is notorious for passing the buck (or
maybe that should be &ldquo;passing the bug&rdquo;).  Libtool was invented to fix
known deficiencies in shared library implementations, so, in a way, most
of the bugs in libtool are actually bugs in other operating systems. 
However, the libtool maintainer would definitely be happy to add support
for somebody else's buggy operating system.  [I wish there was a good
way to do winking smiley-faces in Texinfo.]

   <p>Genuine bugs in libtool include problems with shell script portability,
documentation errors, and failures in the test suite (see <a href="#Libtool-test-suite">Libtool test suite</a>).

   <p>First, check the documentation and help screens to make sure that the
behaviour you think is a problem is not already mentioned as a feature.

   <p>Then, you should read the Emacs guide to reporting bugs (see <a href="emacs.html#Bugs">Reporting Bugs (The Emacs Manual)</a>).  Some of the details
listed there are specific to Emacs, but the principle behind them is a
general one.

   <p>Finally, send a bug report to the libtool bug reporting address <a href="mailto:bug-libtool@gnu.org">bug-libtool@gnu.org</a> with any appropriate
<em>facts</em>, such as test suite output (see <a href="#When-tests-fail">When tests fail</a>), all
the details needed to reproduce the bug, and a brief description of why
you think the behaviour is a bug.  Be sure to include the word
&ldquo;libtool&rdquo; in the subject line, as well as the version number you are
using (which can be found by typing <kbd>libtool --version</kbd>).

<div class="node">
<p><hr>
<a name="Maintaining"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Troubleshooting">Troubleshooting</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="chapter">13 Maintenance notes for libtool</h2>

<p>This chapter contains information that the libtool maintainer finds
important.  It will be of no use to you unless you are considering
porting libtool to new systems, or writing your own libtool.

<ul class="menu">
<li><a accesskey="1" href="#New-ports">New ports</a>:                    How to port libtool to new systems. 
<li><a accesskey="2" href="#Tested-platforms">Tested platforms</a>:             When libtool was last tested. 
<li><a accesskey="3" href="#Platform-quirks">Platform quirks</a>:              Information about different library systems. 
<li><a accesskey="4" href="#libtool-script-contents">libtool script contents</a>:      Configuration information that libtool uses. 
<li><a accesskey="5" href="#Cheap-tricks">Cheap tricks</a>:                 Making libtool maintainership easier. 
</ul>

<div class="node">
<p><hr>
<a name="New-ports"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Tested-platforms">Tested platforms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Maintaining">Maintaining</a>
<br>
</div>

<h3 class="section">13.1 Porting libtool to new systems</h3>

<p>Before you embark on porting libtool to an unsupported system, it is
worthwhile to send e-mail to the libtool mailing list <a href="mailto:libtool@gnu.org">libtool@gnu.org</a>, to make sure that you are
not duplicating existing work.

   <p>If you find that any porting documentation is missing, please complain! 
Complaints with patches and improvements to the documentation, or to
libtool itself, are more than welcome.

<ul class="menu">
<li><a accesskey="1" href="#Information-sources">Information sources</a>:          Where to find relevant documentation
<li><a accesskey="2" href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a>:   Implementation details explained
</ul>

<div class="node">
<p><hr>
<a name="Information-sources"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#New-ports">New ports</a>
<br>
</div>

<h4 class="subsection">13.1.1 Information sources</h4>

<p>Once it is clear that a new port is necessary, you'll generally need the
following information:

     <dl>
<dt>canonical system name<dd>You need the output of <code>config.guess</code> for this system, so that you
can make changes to the libtool configuration process without affecting
other systems.

     <br><dt>man pages for <code>ld</code> and <code>cc</code><dd>These generally describe what flags are used to generate PIC, to create
shared libraries, and to link against only static libraries.  You may
need to follow some cross references to find the information that is
required.

     <br><dt>man pages for <code>ld.so</code>, <code>rtld</code>, or equivalent<dd>These are a valuable resource for understanding how shared libraries are
loaded on the system.

     <br><dt>man page for <code>ldconfig</code>, or equivalent<dd>This page usually describes how to install shared libraries.

     <br><dt>output from <kbd>ls -l /lib /usr/lib</kbd><dd>This shows the naming convention for shared libraries on the system,
including which names should be symbolic links.

     <br><dt>any additional documentation<dd>Some systems have special documentation on how to build and install
shared libraries. 
</dl>

   <p>If you know how to program the Bourne shell, then you can complete the
port yourself; otherwise, you'll have to find somebody with the relevant
skills who will do the work.  People on the libtool mailing list are
usually willing to volunteer to help you with new ports, so you can send
the information to them.

   <p>To do the port yourself, you'll definitely need to modify the
<code>libtool.m4</code> macros in order to make platform-specific changes to
the configuration process.  You should search that file for the
<code>PORTME</code> keyword, which will give you some hints on what you'll
need to change.  In general, all that is involved is modifying the
appropriate configuration variables (see <a href="#libtool-script-contents">libtool script contents</a>).

   <p>Your best bet is to find an already-supported system that is similar to
yours, and make your changes based on that.  In some cases, however,
your system will differ significantly from every other supported system,
and it may be necessary to add new configuration variables, and modify
the <code>ltmain.in</code> script accordingly.  Be sure to write to the
mailing list before you make changes to <code>ltmain.in</code>, since they may
have advice on the most effective way of accomplishing what you want.

<div class="node">
<p><hr>
<a name="Porting-inter_002dlibrary-dependencies"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Information-sources">Information sources</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#New-ports">New ports</a>
<br>
</div>

<h4 class="subsection">13.1.2 Porting inter-library dependencies support</h4>

<p><a name="index-inter_002dlibrary-dependency-272"></a><a name="index-deplibs_005fcheck_005fmethod-273"></a>
Since version 1.2c, libtool has re-introduced the ability to do
inter-library dependency on some platforms, thanks to a patch by Toshio
Kuratomi <a href="mailto:badger@prtr-13.ucsc.edu">badger@prtr-13.ucsc.edu</a>.  Here's a shortened version
of the message that contained his patch:

   <p>The basic architecture is this: in <span class="file">libtool.m4</span>, the person who
writes libtool makes sure <span class="samp">$deplibs</span> is included in
<span class="samp">$archive_cmds</span> somewhere and also sets the variable
<span class="samp">$deplibs_check_method</span>, and maybe <span class="samp">$file_magic_cmd</span> when
<span class="samp">deplibs_check_method</span> is file_magic.

   <p><span class="samp">deplibs_check_method</span> can be one of five things:
     <dl>
<dt><span class="samp">file_magic [</span><var>regex</var><span class="samp">]</span><dd><a name="index-file_005fmagic-274"></a><a name="index-file_005fmagic_005fcmd-275"></a><a name="index-file_005fmagic_005ftest_005ffile-276"></a>looks in the library link path for libraries that have the right
libname.  Then it runs <span class="samp">$file_magic_cmd</span> on the library and checks
for a match against the extended regular expression <var>regex</var>.  When
<var>file_magic_test_file</var> is set by <span class="file">libtool.m4</span>, it is used as an
argument to <span class="samp">$file_magic_cmd</span> in order to verify whether the
regular expression matches its output, and warn the user otherwise.

     <br><dt><span class="samp">test_compile</span><dd><a name="index-test_005fcompile-277"></a>just checks whether it is possible to link a program out of a list of
libraries, and checks which of those are listed in the output of
<code>ldd</code>.  It is currently unused, and will probably be dropped in the
future.

     <br><dt><span class="samp">pass_all</span><dd><a name="index-pass_005fall-278"></a>will pass everything without any checking.  This may work on platforms
in which code is position-independent by default and inter-library
dependencies are properly supported by the dynamic linker, for example,
on DEC OSF/1 3 and 4.

     <br><dt><span class="samp">none</span><dd><a name="index-none-279"></a>It causes deplibs to be reassigned deplibs="".  That way
<span class="samp">archive_cmds</span> can contain deplibs on all platforms, but not have
deplibs used unless needed.

     <br><dt><span class="samp">unknown</span><dd><a name="index-unknown-280"></a>is the default for all systems unless overridden in <span class="file">libtool.m4</span>. 
It is the same as <span class="samp">none</span>, but it documents that we really don't
know what the correct value should be, and we welcome patches that
improve it. 
</dl>

   <p>Then in <span class="file">ltmain.in</span> we have the real workhorse: a little
initialization and postprocessing (to setup/release variables for use
with eval echo libname_spec etc.) and a case statement that decides
which method is being used.  This is the real code... I wish I could
condense it a little more, but I don't think I can without function
calls.  I've mostly optimized it (moved things out of loops, etc.) but
there is probably some fat left.  I thought I should stop while I was
ahead, work on whatever bugs you discover, etc. before thinking about
more than obvious optimizations.

<div class="node">
<p><hr>
<a name="Tested-platforms"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Platform-quirks">Platform quirks</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#New-ports">New ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Maintaining">Maintaining</a>
<br>
</div>

<h3 class="section">13.2 Tested platforms</h3>

<p>This table describes when libtool was last known to be tested on
platforms where it claims to support shared libraries:

<pre class="example">     -------------------------------------------------------
     canonical host name          compiler  libtool results
       (tools versions)                     release
     -------------------------------------------------------
     alpha-dec-osf5.1		cc	 1.3e	  ok (1.910)
     alpha-dec-osf4.0f               gcc      1.3e     ok (1.910)
     alpha-dec-osf4.0f               cc       1.3e     ok (1.910)
     alpha-dec-osf3.2                gcc      0.8      ok
     alpha-dec-osf3.2                cc       0.8      ok
     alpha-dec-osf2.1                gcc      1.2f     NS
     alpha*-unknown-linux-gnu        gcc      1.3b     ok
       (egcs-1.1.2, GNU ld 2.9.1.0.23)
     hppa2.0w-hp-hpux11.00           cc       1.2f     ok
     hppa2.0-hp-hpux10.20            cc       1.3.2    ok
     hppa1.1-hp-hpux10.20            gcc      1.2f     ok
     hppa1.1-hp-hpux10.20            cc       1.3c     ok (1.821)
     hppa1.1-hp-hpux10.10            gcc      1.2f     ok
     hppa1.1-hp-hpux10.10            cc       1.2f     ok
     hppa1.1-hp-hpux9.07             gcc      1.2f     ok
     hppa1.1-hp-hpux9.07             cc       1.2f     ok
     hppa1.1-hp-hpux9.05             gcc      1.2f     ok
     hppa1.1-hp-hpux9.05             cc       1.2f     ok
     hppa1.1-hp-hpux9.01             gcc      1.2f     ok
     hppa1.1-hp-hpux9.01             cc       1.2f     ok
     i*86-*-beos                     gcc      1.2f     ok
     i*86-*-bsdi4.0.1                gcc      1.3c     ok
       (gcc-2.7.2.1)
     i*86-*-bsdi4.0                  gcc      1.2f     ok
     i*86-*-bsdi3.1                  gcc      1.2e     NS
     i*86-*-bsdi3.0                  gcc      1.2e     NS
     i*86-*-bsdi2.1                  gcc      1.2e     NS
     i*86-pc-cygwin                  gcc      1.3b     NS
       (egcs-1.1 stock b20.1 compiler)
     i*86-*-dguxR4.20MU01            gcc      1.2      ok
     i*86-*-freebsd4.3		gcc      1.3e     ok (1.912)
     i*86-*-freebsdelf4.0            gcc      1.3c     ok
       (egcs-1.1.2)
     i*86-*-freebsdelf3.2            gcc      1.3c     ok
       (gcc-2.7.2.1)
     i*86-*-freebsdelf3.1            gcc      1.3c     ok
       (gcc-2.7.2.1)
     i*86-*-freebsdelf3.0            gcc      1.3c     ok
     i*86-*-freebsd3.0               gcc      1.2e     ok
     i*86-*-freebsd2.2.8             gcc      1.3c     ok
       (gcc-2.7.2.1)
     i*86-*-freebsd2.2.6             gcc      1.3b     ok
       (egcs-1.1 &amp; gcc-2.7.2.1, native ld)
     i*86-*-freebsd2.1.5             gcc      0.5      ok
     i*86-*-netbsd1.5                gcc      1.3e     ok (1.901)
       (egcs-1.1.2)
     i*86-*-netbsd1.4                gcc      1.3c     ok
       (egcs-1.1.1)
     i*86-*-netbsd1.4.3A             gcc      1.3e     ok (1.901)
     i*86-*-netbsd1.3.3              gcc      1.3c     ok
       (gcc-2.7.2.2+myc2)
     i*86-*-netbsd1.3.2              gcc      1.2e     ok
     i*86-*-netbsd1.3I               gcc      1.2e     ok
       (egcs 1.1?)
     i*86-*-netbsd1.2                gcc      0.9g     ok
     i*86-*-linux-gnu		gcc	 1.3e	  ok (1.901)
       (Red Hat 7.0, gcc "2.96")
     i*86-*-linux-gnu		gcc	 1.3e	  ok (1.911)
       (SuSE 7.0, gcc 2.95.2)
     i*86-*-linux-gnulibc1           gcc      1.2f     ok
     i*86-*-openbsd2.5               gcc      1.3c     ok
       (gcc-2.8.1)
     i*86-*-openbsd2.4               gcc      1.3c     ok
       (gcc-2.8.1)
     i*86-*-solaris2.7               gcc      1.3b     ok
       (egcs-1.1.2, native ld)
     i*86-*-solaris2.6               gcc      1.2f     ok
     i*86-*-solaris2.5.1             gcc      1.2f     ok
     i*86-ncr-sysv4.3.03             gcc      1.2f     ok
     i*86-ncr-sysv4.3.03             cc       1.2e     ok
       (cc -Hnocopyr)
     i*86-pc-sco3.2v5.0.5		cc	 1.3c	  ok
     i*86-pc-sco3.2v5.0.5		gcc	 1.3c	  ok
       (gcc 95q4c)
     i*86-pc-sco3.2v5.0.5		gcc	 1.3c	  ok
       (egcs-1.1.2)
     i*86-sco-sysv5uw7.1.1		gcc	 1.3e	  ok (1.901)
       (gcc-2.95.2, SCO linker)
     i*86-UnixWare7.1.0-sysv5	cc	 1.3c	  ok
     i*86-UnixWare7.1.0-sysv5	gcc	 1.3c	  ok
       (egcs-1.1.1)
     m68k-next-nextstep3             gcc      1.2f     NS
     m68k-sun-sunos4.1.1             gcc      1.2f     NS
       (gcc-2.5.7)
     m88k-dg-dguxR4.12TMU01          gcc      1.2      ok
     m88k-motorola-sysv4             gcc      1.3      ok
       (egcs-1.1.2)
     mips-sgi-irix6.5                gcc      1.2f     ok
       (gcc-2.8.1)
     mips-sgi-irix6.4                gcc      1.2f     ok
     mips-sgi-irix6.3                gcc      1.3b     ok
       (egcs-1.1.2, native ld)
     mips-sgi-irix6.3                cc       1.3b     ok
       (cc 7.0)
     mips-sgi-irix6.2                gcc      1.2f     ok
     mips-sgi-irix6.2                cc       0.9      ok
     mips-sgi-irix5.3                gcc      1.2f     ok
       (egcs-1.1.1)
     mips-sgi-irix5.3                gcc      1.2f     NS
       (gcc-2.6.3)
     mips-sgi-irix5.3                cc       0.8      ok
     mips-sgi-irix5.2                gcc      1.3b     ok
       (egcs-1.1.2, native ld)
     mips-sgi-irix5.2                cc       1.3b     ok
       (cc 3.18)
     mips-sni-sysv4			cc       1.3.5    ok
       (Siemens C-compiler)
     mips-sni-sysv4			gcc      1.3.5    ok
       (gcc-2.7.2.3, GNU assembler 2.8.1, native ld)
     mipsel-unknown-openbsd2.1       gcc      1.0      ok
     powerpc-apple-darwin6.4         gcc      1.5      ok
     (apple dev tools released 12/2002)
     powerpc-ibm-aix4.3.1.0          gcc      1.2f     ok
       (egcs-1.1.1)
     powerpc-ibm-aix4.2.1.0          gcc      1.2f     ok
       (egcs-1.1.1)
     powerpc-ibm-aix4.1.5.0          gcc      1.2f     ok
       (egcs-1.1.1)
     powerpc-ibm-aix4.1.5.0          gcc      1.2f     NS
       (gcc-2.8.1)
     powerpc-ibm-aix4.1.4.0          gcc      1.0      ok
     powerpc-ibm-aix4.1.4.0          xlc      1.0i     ok
     rs6000-ibm-aix4.1.5.0           gcc      1.2f     ok
       (gcc-2.7.2)
     rs6000-ibm-aix4.1.4.0           gcc      1.2f     ok
       (gcc-2.7.2)
     rs6000-ibm-aix3.2.5             gcc      1.0i     ok
     rs6000-ibm-aix3.2.5             xlc      1.0i     ok
     sparc-sun-solaris2.8		gcc	 1.3e	  ok (1.913)
       (gcc-2.95.3 &amp; native ld)
     sparc-sun-solaris2.7            gcc      1.3e     ok (1.913)
       (gcc-2.95.3 &amp; native ld)
     sparc-sun-solaris2.6            gcc      1.3e     ok (1.913)
       (gcc-2.95.3 &amp; native ld)
     sparc-sun-solaris2.5.1          gcc      1.3e     ok (1.911)
     sparc-sun-solaris2.5            gcc      1.3b     ok
       (egcs-1.1.2, GNU ld 2.9.1 &amp; native ld)
     sparc-sun-solaris2.5            cc       1.3b     ok
       (SC 3.0.1)
     sparc-sun-solaris2.4            gcc      1.0a     ok
     sparc-sun-solaris2.4            cc       1.0a     ok
     sparc-sun-solaris2.3            gcc      1.2f     ok
     sparc-sun-sunos4.1.4            gcc      1.2f     ok
     sparc-sun-sunos4.1.4            cc       1.0f     ok
     sparc-sun-sunos4.1.3_U1         gcc      1.2f     ok
     sparc-sun-sunos4.1.3C           gcc      1.2f     ok
     sparc-sun-sunos4.1.3            gcc      1.3b     ok
       (egcs-1.1.2, GNU ld 2.9.1 &amp; native ld)
     sparc-sun-sunos4.1.3            cc       1.3b     ok
     sparc-unknown-bsdi4.0           gcc      1.2c     ok
     sparc-unknown-linux-gnulibc1    gcc      1.2f     ok
     sparc-unknown-linux-gnu         gcc      1.3b     ok
       (egcs-1.1.2, GNU ld 2.9.1.0.23)
     sparc64-unknown-linux-gnu       gcc      1.2f     ok
     
     Notes:
     - "ok" means "all tests passed".
     - "NS" means "Not Shared", but OK for static libraries
</pre>
   <p>Note: The vendor-distributed HP-UX <code>sed</code>(1) programs are horribly
broken, and cannot handle libtool's requirements, so users may report
unusual problems.  There is no workaround except to install a working
<code>sed</code> (such as GNU <code>sed</code>) on these systems.

   <p>Note: The vendor-distributed NCR MP-RAS <code>cc</code> programs emits
copyright on standard error that confuse tests on size of
<span class="file">conftest.err</span>.  The workaround is to specify <code>CC</code>
when run <code>configure</code> with <kbd>CC='cc -Hnocopyr'</kbd>.

<div class="node">
<p><hr>
<a name="Platform-quirks"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#libtool-script-contents">libtool script contents</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Tested-platforms">Tested platforms</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Maintaining">Maintaining</a>
<br>
</div>

<h3 class="section">13.3 Platform quirks</h3>

<p>This section is dedicated to the sanity of the libtool maintainers.  It
describes the programs that libtool uses, how they vary from system to
system, and how to test for them.

   <p>Because libtool is a shell script, it can be difficult to understand
just by reading it from top to bottom.  This section helps show why
libtool does things a certain way.  Combined with the scripts
themselves, you should have a better sense of how to improve libtool, or
write your own.

<ul class="menu">
<li><a accesskey="1" href="#References">References</a>:                   Finding more information. 
<li><a accesskey="2" href="#Compilers">Compilers</a>:                    Creating object files from source files. 
<li><a accesskey="3" href="#Reloadable-objects">Reloadable objects</a>:           Binding object files together. 
<li><a accesskey="4" href="#Multiple-dependencies">Multiple dependencies</a>: 	Removing duplicate dependent libraries. 
<li><a accesskey="5" href="#Archivers">Archivers</a>:                    Programs that create static archives. 
</ul>

<div class="node">
<p><hr>
<a name="References"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Compilers">Compilers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Platform-quirks">Platform quirks</a>
<br>
</div>

<h4 class="subsection">13.3.1 References</h4>

<p>The following is a list of valuable documentation references:

     <ul>
<li>SGI's IRIX Manual Pages, which can be found at
<a href="http://techpubs.sgi.com/cgi-bin/infosrch.cgi?cmd=browse&amp;db=man">http://techpubs.sgi.com/cgi-bin/infosrch.cgi?cmd=browse&amp;db=man</a>.

     <li>Sun's free service area
(<a href="http://www.sun.com/service/online/free.html">http://www.sun.com/service/online/free.html</a>) and documentation
server (<a href="http://docs.sun.com/">http://docs.sun.com/</a>).

     <li>Compaq's Tru64 UNIX online documentation is at <br>
(<a href="http://tru64unix.compaq.com/faqs/publications/pub_page/doc_list.html">http://tru64unix.compaq.com/faqs/publications/pub_page/doc_list.html</a>)
with C++ documentation at <br>
(<a href="http://tru64unix.compaq.com/cplus/docs/index.htm">http://tru64unix.compaq.com/cplus/docs/index.htm</a>).

     <li>Hewlett-Packard has online documentation at
(<a href="http://docs.hp.com/index.html">http://docs.hp.com/index.html</a>).

     <li>IBM has online documentation at
(<a href="http://www.rs6000.ibm.com/resource/aix_resource/Pubs/">http://www.rs6000.ibm.com/resource/aix_resource/Pubs/</a>). 
</ul>

<div class="node">
<p><hr>
<a name="Compilers"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Reloadable-objects">Reloadable objects</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#References">References</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Platform-quirks">Platform quirks</a>
<br>
</div>

<h4 class="subsection">13.3.2 Compilers</h4>

<p>The only compiler characteristics that affect libtool are the flags
needed (if any) to generate PIC objects.  In general, if a C compiler
supports certain PIC flags, then any derivative compilers support the
same flags.  Until there are some noteworthy exceptions to this rule,
this section will document only C compilers.

   <p>The following C compilers have standard command line options, regardless
of the platform:

     <dl>
<dt><code>gcc</code><dd>
This is the GNU C compiler, which is also the system compiler for many
free operating systems (FreeBSD, GNU/Hurd, GNU/Linux, Lites, NetBSD, and
OpenBSD, to name a few).

     <p>The <span class="samp">-fpic</span> or <span class="samp">-fPIC</span> flags can be used to generate
position-independent code.  <span class="samp">-fPIC</span> is guaranteed to generate
working code, but the code is slower on m68k, m88k, and Sparc chips. 
However, using <span class="samp">-fpic</span> on those chips imposes arbitrary size limits
on the shared libraries. 
</dl>

   <p>The rest of this subsection lists compilers by the operating system that
they are bundled with:

<!-- FIXME these should all be better-documented -->
<dl>
<dt><code>aix3*</code><dt><code>aix4*</code><dd>Most AIX compilers have no PIC flags, since AIX (with the exception of
AIX for IA-64) runs on PowerPC and RS/6000 chips. <a rel="footnote" href="#fn-11" name="fnd-11"><sup>11</sup></a>

     <br><dt><code>hpux10*</code><dd>Use <span class="samp">+Z</span> to generate PIC.

     <br><dt><code>osf3*</code><dd>Digital/UNIX 3.x does not have PIC flags, at least not on the PowerPC
platform.

     <br><dt><code>solaris2*</code><dd>Use <span class="samp">-KPIC</span> to generate PIC.

     <br><dt><code>sunos4*</code><dd>Use <span class="samp">-PIC</span> to generate PIC. 
</dl>

<div class="node">
<p><hr>
<a name="Reloadable-objects"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Multiple-dependencies">Multiple dependencies</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Compilers">Compilers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Platform-quirks">Platform quirks</a>
<br>
</div>

<h4 class="subsection">13.3.3 Reloadable objects</h4>

<p>On all known systems, a reloadable object can be created by running
<kbd>ld -r -o </kbd><var>output</var><kbd>.o </kbd><var>input1</var><kbd>.o </kbd><var>input2</var><kbd>.o</kbd>.  This
reloadable object may be treated as exactly equivalent to other
objects.

<div class="node">
<p><hr>
<a name="Multiple-dependencies"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Archivers">Archivers</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Reloadable-objects">Reloadable objects</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Platform-quirks">Platform quirks</a>
<br>
</div>

<h4 class="subsection">13.3.4 Multiple dependencies</h4>

<p>On most modern platforms the order that dependent libraries are listed
has no effect on object generation.  In theory, there are platforms
which require libraries which provide missing symbols to other libraries
to listed after those libraries whose symbols they provide.

   <p>Particularly, if a pair of static archives each resolve some of the
other's symbols, it might be necessary to list one of those archives
both before and after the other one.  Libtool does not currently cope
with this situation well, since duplicate libraries are removed from
the link line by default.  Libtool provides the command line option
<span class="samp">--preserve-dup-deps</span> to preserve all duplicate dependencies
in cases where it is necessary.

<div class="node">
<p><hr>
<a name="Archivers"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multiple-dependencies">Multiple dependencies</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Platform-quirks">Platform quirks</a>
<br>
</div>

<h4 class="subsection">13.3.5 Archivers</h4>

<p>On all known systems, building a static library can be accomplished by
running <kbd>ar cru lib</kbd><var>name</var><kbd>.a </kbd><var>obj1</var><kbd>.o </kbd><var>obj2</var><kbd>.o ...</kbd>,
where the <span class="samp">.a</span> file is the output library, and each <span class="samp">.o</span> file is an
object file.

   <p>On all known systems, if there is a program named <code>ranlib</code>, then it
must be used to &ldquo;bless&rdquo; the created library before linking against it,
with the <kbd>ranlib lib</kbd><var>name</var><kbd>.a</kbd> command.  Some systems, like Irix,
use the <code>ar ts</code> command, instead.

<div class="node">
<p><hr>
<a name="libtool-script-contents"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Cheap-tricks">Cheap tricks</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Platform-quirks">Platform quirks</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Maintaining">Maintaining</a>
<br>
</div>

<h3 class="section">13.4 <code>libtool</code> script contents</h3>

<p><a name="index-implementation-of-libtool-281"></a><a name="index-libtool-implementation-282"></a>
Since version 1.4, the <code>libtool</code> script is generated by
<code>configure</code> (see <a href="#Configuring">Configuring</a>).  In earlier versions,
<code>configure</code> achieved this by calling a helper script called
<span class="file">ltconfig</span>.  From libtool version 0.7 to 1.0, this script
simply set shell variables, then sourced the libtool backend,
<code>ltmain.sh</code>.  <code>ltconfig</code> from libtool version 1.1 through 1.3
inlined the contents of <code>ltmain.sh</code> into the generated
<code>libtool</code>, which improved performance on many systems.  The tests
that <span class="file">ltconfig</span> used to perform are now kept in <span class="file">libtool.m4</span>
where they can be written using Autoconf.  This has the runtime
performance benefits of inlined <code>ltmain.sh</code>, <em>and</em> improves
the build time a little while considerably easing the amount of raw
shell code that used to need maintaining.

   <p>The convention used for naming variables which hold shell commands for
delayed evaluation, is to use the suffix <code>_cmd</code> where a single
line of valid shell script is needed, and the suffix <code>_cmds</code> where
multiple lines of shell script <strong>may</strong> be delayed for later
evaluation.  By convention, <code>_cmds</code> variables delimit the
evaluation units with the <code>~</code> character where necessary.

   <p>Here is a listing of each of the configuration variables, and how they
are used within <code>ltmain.sh</code> (see <a href="#Configuring">Configuring</a>):

<div class="defun">
&mdash; Variable: <b>AR</b><var><a name="index-AR-283"></a></var><br>
<blockquote><p>The name of the system library archiver. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>CC</b><var><a name="index-CC-284"></a></var><br>
<blockquote><p>The name of the C compiler used to configure libtool. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>LD</b><var><a name="index-LD-285"></a></var><br>
<blockquote><p>The name of the linker that libtool should use internally for reloadable
linking and possibly shared libraries. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>NM</b><var><a name="index-NM-286"></a></var><br>
<blockquote><p>The name of a BSD-compatible <code>nm</code> program, which produces listings
of global symbols in one the following formats:

     <pre class="example">          <var>address</var> C <var>global-variable-name</var>
          <var>address</var> D <var>global-variable-name</var>
          <var>address</var> T <var>global-function-name</var>
     </pre>
        </blockquote></div>

<div class="defun">
&mdash; Variable: <b>RANLIB</b><var><a name="index-RANLIB-287"></a></var><br>
<blockquote><p>Set to the name of the ranlib program, if any. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>allow_undefined_flag</b><var><a name="index-allow_005fundefined_005fflag-288"></a></var><br>
<blockquote><p>The flag that is used by <span class="samp">archive_cmds</span> in order to declare that
there will be unresolved symbols in the resulting shared library. 
Empty, if no such flag is required.  Set to <span class="samp">unsupported</span> if there
is no way to generate a shared library with references to symbols that
aren't defined in that library. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>always_export_symbols</b><var><a name="index-always_005fexport_005fsymbols-289"></a></var><br>
<blockquote><p>Whether libtool should automatically generate a list of exported symbols
using <var>export_symbols_cmds</var> before linking an archive. 
Set to <span class="samp">yes</span> or <span class="samp">no</span>.  Default is <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>archive_cmds</b><var><a name="index-archive_005fcmds-290"></a></var><br>
&mdash; Variable: <b>archive_expsym_cmds</b><var><a name="index-archive_005fexpsym_005fcmds-291"></a></var><br>
&mdash; Variable: <b>old_archive_cmds</b><var><a name="index-old_005farchive_005fcmds-292"></a></var><br>
<blockquote><p>Commands used to create shared libraries, shared libraries with
<span class="samp">-export-symbols</span> and static libraries, respectively. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>old_archive_from_new_cmds</b><var><a name="index-old_005farchive_005ffrom_005fnew_005fcmds-293"></a></var><br>
<blockquote><p>If the shared library depends on a static library,
<span class="samp">old_archive_from_new_cmds</span> contains the commands used to create that
static library.  If this variable is not empty, <span class="samp">old_archive_cmds</span> is
not used. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>old_archive_from_expsyms_cmds</b><var><a name="index-old_005farchive_005ffrom_005fexpsyms_005fcmds-294"></a></var><br>
<blockquote><p>If a static library must be created from the export symbol list in order to
correctly link with a shared library, <span class="samp">old_archive_from_expsyms_cmds</span>
contains the commands needed to create that static library.  When these
commands are executed, the variable <var>soname</var> contains the name of the
shared library in question, and the <var>$objdir/$newlib</var> contains the
path of the static library these commands should build.  After executing
these commands, libtool will proceed to link against <var>$objdir/$newlib</var>
instead of <var>soname</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>build_libtool_libs</b><var><a name="index-build_005flibtool_005flibs-295"></a></var><br>
<blockquote><p>Whether libtool should build shared libraries on this system.  Set to
<span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>build_old_libs</b><var><a name="index-build_005fold_005flibs-296"></a></var><br>
<blockquote><p>Whether libtool should build static libraries on this system.  Set to
<span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>compiler_c_o</b><var><a name="index-compiler_005fc_005fo-297"></a></var><br>
<blockquote><p>Whether the compiler supports the <code>-c</code> and <code>-o</code> options
simultaneously. Set to <span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>compiler_o_lo</b><var><a name="index-compiler_005fo_005flo-298"></a></var><br>
<blockquote><p>Whether the compiler supports compiling directly to a ".lo" file,
i.e whether object files do not have to have the suffix ".o". 
Set to <span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>dlopen_support</b><var><a name="index-dlopen_005fsupport-299"></a></var><br>
<blockquote><p>Whether <code>dlopen</code> is supported on the platform. 
Set to <span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>dlopen_self</b><var><a name="index-dlopen_005fself-300"></a></var><br>
<blockquote><p>Whether it is possible to <code>dlopen</code> the executable itself. 
Set to <span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>dlopen_self_static</b><var><a name="index-dlopen_005fself_005fstatic-301"></a></var><br>
<blockquote><p>Whether it is possible to <code>dlopen</code> the executable itself, when it
is linked statically (<span class="samp">-all-static</span>).  Set to <span class="samp">yes</span> or
<span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>echo</b><var><a name="index-echo-302"></a></var><br>
<blockquote><p>An <code>echo</code> program which does not interpret backslashes as an
escape character. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>exclude_expsyms</b><var><a name="index-exclude_005fexpsyms-303"></a></var><br>
<blockquote><p>List of symbols that should not be listed in the preloaded symbols. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>export_dynamic_flag_spec</b><var><a name="index-export_005fdynamic_005fflag_005fspec-304"></a></var><br>
<blockquote><p>Compiler link flag that allows a dlopened shared library to reference
symbols that are defined in the program. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>export_symbols_cmds</b><var><a name="index-export_005fsymbols_005fcmds-305"></a></var><br>
<blockquote><p>Commands to extract exported symbols from <var>libobjs</var> to the
file <var>export_symbols</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>extract_expsyms_cmds</b><var><a name="index-extract_005fexpsyms_005fcmds-306"></a></var><br>
<blockquote><p>Commands to extract the exported symbols list from a shared library. 
These commands are executed if there is no file <var>$objdir/$soname-def</var>,
and should write the names of the exported symbols to that file, for
the use of <span class="samp">old_archive_from_expsyms_cmds</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>fast_install</b><var><a name="index-fast_005finstall-307"></a></var><br>
<blockquote><p>Determines whether libtool will privilege the installer or the
developer.  The assumption is that installers will seldom run programs
in the build tree, and the developer will seldom install.  This is only
meaningful on platforms in which <var>shlibpath_overrides_runpath</var> is
not <span class="samp">yes</span>, so <var>fast_install</var> will be set to <span class="samp">needless</span> in
this case.  If <var>fast_install</var> set to <span class="samp">yes</span>, libtool will create
programs that search for installed libraries, and, if a program is run
in the build tree, a new copy will be linked on-demand to use the
yet-to-be-installed libraries.  If set to <span class="samp">no</span>, libtool will create
programs that use the yet-to-be-installed libraries, and will link
a new copy of the program at install time.  The default value is
<span class="samp">yes</span> or <span class="samp">needless</span>, depending on platform and configuration
flags, and it can be turned from <span class="samp">yes</span> to <span class="samp">no</span> with the
configure flag <span class="samp">--disable-fast-install</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>finish_cmds</b><var><a name="index-finish_005fcmds-308"></a></var><br>
<blockquote><p>Commands to tell the dynamic linker how to find shared libraries in a
specific directory. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>finish_eval</b><var><a name="index-finish_005feval-309"></a></var><br>
<blockquote><p>Same as <var>finish_cmds</var>, except the commands are not displayed. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>fix_srcfile_path</b><var><a name="index-fix_005fsrcfile_005fpath-310"></a></var><br>
<blockquote><p>Expression to fix the shell variable $srcfile for the compiler. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>global_symbol_pipe</b><var><a name="index-global_005fsymbol_005fpipe-311"></a></var><br>
<blockquote><p>A pipeline that takes the output of <var>NM</var>, and produces a listing of
raw symbols followed by their C names.  For example:

     <pre class="example">          $ <kbd>eval "$NM progname | $global_symbol_pipe"</kbd>
          D <var>symbol1</var> <var>C-symbol1</var>
          T <var>symbol2</var> <var>C-symbol2</var>
          C <var>symbol3</var> <var>C-symbol3</var>
          ...
          $
     </pre>
        <p>The first column contains the symbol type (used to tell data from code
on some platforms), but its meaning is system dependent. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>global_symbol_to_cdecl</b><var><a name="index-global_005fsymbol_005fto_005fcdecl-312"></a></var><br>
<blockquote><p>A pipeline that translates the output of <var>global_symbol_pipe</var> into
proper C declarations.  On platforms whose linkers differentiate code
from data, such as HP/UX, data symbols will be declared as such, and
code symbols will be declared as functions.  On platforms that don't
care, everything is assumed to be data. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>hardcode_action</b><var><a name="index-hardcode_005faction-313"></a></var><br>
<blockquote><p>Either <span class="samp">immediate</span> or <span class="samp">relink</span>, depending on whether shared
library paths can be hardcoded into executables before they are installed,
or if they need to be relinked. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>hardcode_direct</b><var><a name="index-hardcode_005fdirect-314"></a></var><br>
<blockquote><p>Set to <span class="samp">yes</span> or <span class="samp">no</span>, depending on whether the linker
hardcodes directories if a library is directly specified on the command
line (such as <var>dir</var><span class="samp">/lib</span><var>name</var><span class="samp">.a</span>) when
<var>hardcode_libdir_flag_spec</var> is specified. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>hardcode_into_libs</b><var><a name="index-hardcode_005finto_005flibs-315"></a></var><br>
<blockquote><p>Whether the platform supports hardcoding of run-paths into libraries. 
If enabled, linking of programs will be much simpler but libraries will
need to be relinked during installation.   Set to <span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>hardcode_libdir_flag_spec</b><var><a name="index-hardcode_005flibdir_005fflag_005fspec-316"></a></var><br>
<blockquote><p>Flag to hardcode a <var>libdir</var> variable into a binary, so that the
dynamic linker searches <var>libdir</var> for shared libraries at runtime. 
If it is empty, libtool will try to use some other hardcoding mechanism. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>hardcode_libdir_separator</b><var><a name="index-hardcode_005flibdir_005fseparator-317"></a></var><br>
<blockquote><p>If the compiler only accepts a single <var>hardcode_libdir_flag</var>, then
this variable contains the string that should separate multiple
arguments to that flag. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>hardcode_minus_L</b><var><a name="index-hardcode_005fminus_005fL-318"></a></var><br>
<blockquote><p>Set to <span class="samp">yes</span> or <span class="samp">no</span>, depending on whether the linker
hardcodes directories specified by <span class="samp">-L</span> flags into the resulting
executable when <var>hardcode_libdir_flag_spec</var> is specified. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>hardcode_shlibpath_var</b><var><a name="index-hardcode_005fshlibpath_005fvar-319"></a></var><br>
<blockquote><p>Set to <span class="samp">yes</span> or <span class="samp">no</span>, depending on whether the linker
hardcodes directories by writing the contents of <span class="samp">$shlibpath_var</span>
into the resulting executable when <var>hardcode_libdir_flag_spec</var> is
specified.  Set to <span class="samp">unsupported</span> if directories specified by
<span class="samp">$shlibpath_var</span> are searched at run time, but not at link time. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>host</b><var><a name="index-host-320"></a></var><br>
&mdash; Variable: <b>host_alias</b><var><a name="index-host_005falias-321"></a></var><br>
<blockquote><p>For information purposes, set to the specified and canonical names of
the system that libtool was configured for. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>include_expsyms</b><var><a name="index-include_005fexpsyms-322"></a></var><br>
<blockquote><p>List of symbols that must always be exported when using <var>export_symbols</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>libext</b><var><a name="index-libext-323"></a></var><br>
<blockquote><p>The standard old archive suffix (normally "a"). 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>libname_spec</b><var><a name="index-libname_005fspec-324"></a></var><br>
<blockquote><p>The format of a library name prefix.  On all Unix systems, static
libraries are called <span class="samp">lib</span><var>name</var><span class="samp">.a</span>, but on some systems (such
as OS/2 or MS-DOS), the library is just called <var>name</var><span class="samp">.a</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>library_names_spec</b><var><a name="index-library_005fnames_005fspec-325"></a></var><br>
<blockquote><p>A list of shared library names.  The first is the name of the file,
the rest are symbolic links to the file.  The name in the list is
the file name that the linker finds when given <span class="samp">-l</span><var>name</var>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>link_all_deplibs</b><var><a name="index-link_005fall_005fdeplibs-326"></a></var><br>
<blockquote><p>Whether libtool must link a program against all its dependency libraries. 
Set to <span class="samp">yes</span> or <span class="samp">no</span>.  Default is <span class="samp">unknown</span>, which is
a synonym for <span class="samp">yes</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>link_static_flag</b><var><a name="index-link_005fstatic_005fflag-327"></a></var><br>
<blockquote><p>Linker flag (passed through the C compiler) used to prevent dynamic
linking. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>need_lib_prefix</b><var><a name="index-need_005flib_005fprefix-328"></a></var><br>
<blockquote><p>Whether libtool should automatically prefix module names with 'lib'. 
Set to <span class="samp">yes</span> or <span class="samp">no</span>.  By default, it is <span class="samp">unknown</span>, which
means the same as <span class="samp">yes</span>, but documents that we are not really sure
about it. 
<span class="samp">yes</span> means that it is possible both to <code>dlopen</code> and to
link against a library without 'lib' prefix,
i.e., it requires <var>hardcode_direct</var> to be <span class="samp">yes</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>need_version</b><var><a name="index-need_005fversion-329"></a></var><br>
<blockquote><p>Whether versioning is required for libraries, i.e. whether the
dynamic linker requires a version suffix for all libraries. 
Set to <span class="samp">yes</span> or <span class="samp">no</span>.  By default, it is <span class="samp">unknown</span>, which
means the same as <span class="samp">yes</span>, but documents that we are not really sure
about it. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>need_locks</b><var><a name="index-need_005flocks-330"></a></var><br>
<blockquote><p>Whether files must be locked to prevent conflicts when compiling
simultaneously. Set to <span class="samp">yes</span> or <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>no_builtin_flag</b><var><a name="index-no_005fbuiltin_005fflag-331"></a></var><br>
<blockquote><p>Compiler flag to disable builtin functions that conflict with declaring
external global symbols as <code>char</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>no_undefined_flag</b><var><a name="index-no_005fundefined_005fflag-332"></a></var><br>
<blockquote><p>The flag that is used by <span class="samp">archive_cmds</span> in order to declare that
there will be no unresolved symbols in the resulting shared library. 
Empty, if no such flag is required. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>objdir</b><var><a name="index-objdir-333"></a></var><br>
<blockquote><p>The name of the directory that contains temporary libtool files. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>objext</b><var><a name="index-objext-334"></a></var><br>
<blockquote><p>The standard object file suffix (normally "o"). 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>pic_flag</b><var><a name="index-pic_005fflag-335"></a></var><br>
<blockquote><p>Any additional compiler flags for building library object files. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>postinstall_cmds</b><var><a name="index-postinstall_005fcmds-336"></a></var><br>
&mdash; Variable: <b>old_postinstall_cmds</b><var><a name="index-old_005fpostinstall_005fcmds-337"></a></var><br>
<blockquote><p>Commands run after installing a shared or static library, respectively. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>postuninstall_cmds</b><var><a name="index-postuninstall_005fcmds-338"></a></var><br>
&mdash; Variable: <b>old_postuninstall_cmds</b><var><a name="index-old_005fpostuninstall_005fcmds-339"></a></var><br>
<blockquote><p>Commands run after uninstalling a shared or static library, respectively. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>reload_cmds</b><var><a name="index-reload_005fcmds-340"></a></var><br>
&mdash; Variable: <b>reload_flag</b><var><a name="index-reload_005fflag-341"></a></var><br>
<blockquote><p>Commands to create a reloadable object. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>runpath_var</b><var><a name="index-runpath_005fvar-342"></a></var><br>
<blockquote><p>The environment variable that tells the linker which directories to
hardcode in the resulting executable. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>shlibpath_overrides_runpath</b><var><a name="index-shlibpath_005foverrides_005frunpath-343"></a></var><br>
<blockquote><p>Indicates whether it is possible to override the hard-coded library
search path of a program with an environment variable.  If this is set
to no, libtool may have to create two copies of a program in the build
tree, one to be installed and one to be run in the build tree only. 
When each of these copies is created depends on the value of
<code>fast_install</code>.  The default value is <span class="samp">unknown</span>, which is
equivalent to <span class="samp">no</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>shlibpath_var</b><var><a name="index-shlibpath_005fvar-344"></a></var><br>
<blockquote><p>The environment variable that tells the dynamic linker where to find
shared libraries. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>soname_spec</b><var><a name="index-soname_005fspec-345"></a></var><br>
<blockquote><p>The name coded into shared libraries, if different from the real name of
the file. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>striplib</b><var><a name="index-striplib-346"></a></var><br>
&mdash; Variable: <b>old_striplib</b><var><a name="index-old_005fstriplib-347"></a></var><br>
<blockquote><p>Command to strip a shared (<code>striplib</code>) or static (<code>old_striplib</code>)
library, respectively.  If these variables are empty, the strip flag
in the install mode will be ignored for libraries (see <a href="#Install-mode">Install mode</a>). 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>sys_lib_dlsearch_path_spec</b><var><a name="index-sys_005flib_005fdlsearch_005fpath_005fspec-348"></a></var><br>
<blockquote><p>Expression to get the run-time system library search path.  Directories
that appear in this list are never hard-coded into executables. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>sys_lib_search_path_spec</b><var><a name="index-sys_005flib_005fsearch_005fpath_005fspec-349"></a></var><br>
<blockquote><p>Expression to get the compile-time system library search path.  This
variable is used by libtool when it has to test whether a certain
library is shared or static.  The directories listed in
<var>shlibpath_var</var> are automatically appended to this list, every time
libtool runs (i.e., not at configuration time), because some linkers use
this variable to extend the library search path.  Linker switches such
as <code>-L</code> also augment the search path. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>thread_safe_flag_spec</b><var><a name="index-thread_005fsafe_005fflag_005fspec-350"></a></var><br>
<blockquote><p>Linker flag (passed through the C compiler) used to generate thread-safe
libraries. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>version_type</b><var><a name="index-version_005ftype-351"></a></var><br>
<blockquote><p>The library version numbering type.  One of <span class="samp">libtool</span>,
<span class="samp">freebsd-aout</span>, <span class="samp">freebsd-elf</span>, <span class="samp">irix</span>, <span class="samp">linux</span>,
<span class="samp">osf</span>, <span class="samp">sunos</span>, <span class="samp">windows</span>, or <span class="samp">none</span>. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>whole_archive_flag_spec</b><var><a name="index-whole_005farchive_005fflag_005fspec-352"></a></var><br>
<blockquote><p>Compiler flag to generate shared objects from convenience archives. 
</p></blockquote></div>

<div class="defun">
&mdash; Variable: <b>wl</b><var><a name="index-wl-353"></a></var><br>
<blockquote><p>The C compiler flag that allows libtool to pass a flag directly to the
linker.  Used as: <code>${wl}</code><var>some-flag</var>. 
</p></blockquote></div>

   <p>Variables ending in <span class="samp">_cmds</span> or <span class="samp">_eval</span> contain a
<span class="samp">~</span>-separated list of commands that are <code>eval</code>ed one after
another.  If any of the commands return a nonzero exit status, libtool
generally exits with an error message.

   <p>Variables ending in <span class="samp">_spec</span> are <code>eval</code>ed before being used by
libtool.

<div class="node">
<p><hr>
<a name="Cheap-tricks"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#libtool-script-contents">libtool script contents</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Maintaining">Maintaining</a>
<br>
</div>

<h3 class="section">13.5 Cheap tricks</h3>

<p>Here are a few tricks that you can use in order to make maintainership
easier:

     <ul>
<li>When people report bugs, ask them to use the <span class="samp">--config</span>,
<span class="samp">--debug</span>, or <span class="samp">--features</span> flags, if you think they will help
you.  These flags are there to help you get information directly, rather
than having to trust second-hand observation.

     <li>Rather than reconfiguring libtool every time I make a change to
<code>ltmain.in</code>, I keep a permanent <code>libtool</code> script in my
<var>PATH</var>, which sources <code>ltmain.in</code> directly.

     <p>The following steps describe how to create such a script, where
<code>/home/src/libtool</code> is the directory containing the libtool source
tree, <code>/home/src/libtool/libtool</code> is a libtool script that has been
configured for your platform, and <code>~/bin</code> is a directory in your
<var>PATH</var>:

     <pre class="example">          trick$ cd ~/bin
          trick$ sed '/^# ltmain\.sh/q' /home/src/libtool/libtool &gt; libtool
          trick$ echo '. /home/src/libtool/ltmain.in' &gt;&gt; libtool
          trick$ chmod +x libtool
          trick$ libtool --version
          ltmain.sh (GNU @PACKAGE@) @VERSION@@TIMESTAMP@
          trick$
     </pre>
     </ul>

   <p>The output of the final <span class="samp">libtool --version</span> command shows that the
<code>ltmain.in</code> script is being used directly.  Now, modify
<code>~/bin/libtool</code> or <code>/home/src/libtool/ltmain.in</code> directly in
order to test new changes without having to rerun <code>configure</code>.

<div class="node">
<p><hr>
<a name="GNU-Free-Documentation-License"></a>Next:&nbsp;<a rel="next" accesskey="n" href="#Index">Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Maintaining">Maintaining</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="appendix">Appendix A GNU Free Documentation License</h2>

<p><a name="index-FDL_002c-GNU-Free-Documentation-License-354"></a>

<!-- The GNU Free Documentation License. -->
<div align="center">Version 1.2, November 2002</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2000,2001,2002 Free Software Foundation, Inc.
     51 Franklin St, Fifth Floor, Boston, MA  02110-1301, USA
     
     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.
</pre>
     <ol type=1 start=0>
<li>PREAMBLE

     <p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <dfn>free</dfn> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially. 
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.

     <p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.

     <p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.

     <li>APPLICABILITY AND DEFINITIONS

     <p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.

     <p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.

     <p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document's overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.

     <p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.

     <p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.

     <p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent. 
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.

     <p>Examples of suitable formats for Transparent copies include plain
<span class="sc">ascii</span> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.

     <p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text.

     <p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.

     <p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.

     <li>VERBATIM COPYING

     <p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.

     <p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.

     <li>COPYING IN QUANTITY

     <p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document's license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition. 
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.

     <p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.

     <p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material. 
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.

     <p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.

     <li>MODIFICATIONS

     <p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:

          <ol type=A start=1>
<li>Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

          <li>List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

          <li>State on the Title page the name of the publisher of the
Modified Version, as the publisher.

          <li>Preserve all the copyright notices of the Document.

          <li>Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

          <li>Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

          <li>Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document's license notice.

          <li>Include an unaltered copy of this License.

          <li>Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

          <li>Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section. 
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

          <li>For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

          <li>Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

          <li>Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

          <li>Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

          <li>Preserve any Warranty Disclaimers.
          </ol>

     <p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice. 
These titles must be distinct from any other section titles.

     <p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.

     <p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.

     <p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.

     <li>COMBINING DOCUMENTS

     <p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.

     <p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number. 
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.

     <p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;

     <li>COLLECTIONS OF DOCUMENTS

     <p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.

     <p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.

     <li>AGGREGATION WITH INDEPENDENT WORKS

     <p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation's users beyond what the individual works permit. 
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.

     <p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document's Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form. 
Otherwise they must appear on printed covers that bracket the whole
aggregate.

     <li>TRANSLATION

     <p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4. 
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.

     <p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.

     <li>TERMINATION

     <p>You may not copy, modify, sublicense, or distribute the Document except
as expressly provided for under this License.  Any other attempt to
copy, modify, sublicense or distribute the Document is void, and will
automatically terminate your rights under this License.  However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.

     <li>FUTURE REVISIONS OF THIS LICENSE

     <p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.

     <p>Each version of the License is given a distinguishing version number. 
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.
        </ol>

<h3 class="heading">ADDENDUM: How to use this License for your documents</h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:

<pre class="smallexample">       Copyright (C)  <var>year</var>  <var>your name</var>.
       Permission is granted to copy, distribute and/or modify this document
       under the terms of the GNU Free Documentation License, Version 1.2
       or any later version published by the Free Software Foundation;
       with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
       Texts.  A copy of the license is included in the section entitled ``GNU
       Free Documentation License''.
</pre>
   <p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with<small class="dots">...</small>Texts.&rdquo; line with this:

<pre class="smallexample">         with the Invariant Sections being <var>list their titles</var>, with
         the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
         being <var>list</var>.
</pre>
   <p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.

   <p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.

<!-- Local Variables: -->
<!-- ispell-local-pdict: "ispell-dict" -->
<!-- End: -->
<div class="node">
<p><hr>
<a name="Index"></a>Previous:&nbsp;<a rel="previous" accesskey="p" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>
<br>
</div>

<h2 class="unnumbered">Index</h2>

<ul class="index-cp" compact>
<li><a href="#index-_0040samp_007b_002ela_007d-files-24"><span class="samp">.la</span> files</a>: <a href="#Linking-libraries">Linking libraries</a></li>
<li><a href="#index-_0040file_007b_0040value_007bobjdir_007d_007d-subdirectory-25"><span class="file">.libs</span> subdirectory</a>: <a href="#Linking-libraries">Linking libraries</a></li>
<li><a href="#index-_0040samp_007b_002elo_007d-files-19"><span class="samp">.lo</span> files</a>: <a href="#Creating-object-files">Creating object files</a></li>
<li><a href="#index-AC_005fCONFIG_005fAUX_005fDIR-102"><code>AC_CONFIG_AUX_DIR</code></a>: <a href="#Invoking-libtoolize">Invoking libtoolize</a></li>
<li><a href="#index-AC_005fDISABLE_005fFAST_005fINSTALL-76"><code>AC_DISABLE_FAST_INSTALL</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AC_005fDISABLE_005fSHARED-77"><code>AC_DISABLE_SHARED</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AC_005fDISABLE_005fSTATIC-79"><code>AC_DISABLE_STATIC</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AC_005fFUNC_005fALLOCA-104"><code>AC_FUNC_ALLOCA</code></a>: <a href="#Autoconf-_002eo-macros">Autoconf .o macros</a></li>
<li><a href="#index-AC_005fLIBTOOL_005fDLOPEN-74"><code>AC_LIBTOOL_DLOPEN</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AC_005fLIBTOOL_005fWIN32_005fDLL-75"><code>AC_LIBTOOL_WIN32_DLL</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AC_005fPROG_005fLIBTOOL-72"><code>AC_PROG_LIBTOOL</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AC_005fREPLACE_005fFUNCS-106"><code>AC_REPLACE_FUNCS</code></a>: <a href="#Autoconf-_002eo-macros">Autoconf .o macros</a></li>
<li><a href="#index-aclocal-93"><code>aclocal</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-allow_005fundefined_005fflag-288"><code>allow_undefined_flag</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-always_005fexport_005fsymbols-289"><code>always_export_symbols</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-AM_005fDISABLE_005fSHARED-78"><code>AM_DISABLE_SHARED</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AM_005fDISABLE_005fSTATIC-80"><code>AM_DISABLE_STATIC</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-AM_005fPROG_005fLIBTOOL-73"><code>AM_PROG_LIBTOOL</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-application_002dlevel-dynamic-linking-141">application-level dynamic linking</a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-application_002dlevel-dynamic-linking-158">application-level dynamic linking</a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-AR-283"><code>AR</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-ar-21"><code>ar</code></a>: <a href="#Linking-libraries">Linking libraries</a></li>
<li><a href="#index-archive_005fcmds-290"><code>archive_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-archive_005fexpsym_005fcmds-291"><code>archive_expsym_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-AS-92"><code>AS</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-assign_002etest-260"><code>assign.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-avoiding-shared-libraries-110">avoiding shared libraries</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-bug-reports-269">bug reports</a>: <a href="#Reporting-bugs">Reporting bugs</a></li>
<li><a href="#index-buggy-system-linkers-27">buggy system linkers</a>: <a href="#Linking-executables">Linking executables</a></li>
<li><a href="#index-bugs_002c-subtle-ones-caused-by-buggy-linkers-29">bugs, subtle ones caused by buggy linkers</a>: <a href="#Linking-executables">Linking executables</a></li>
<li><a href="#index-build_002drelink_002etest-242"><code>build-relink.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-build_005flibtool_005flibs-295"><code>build_libtool_libs</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-build_005fold_005flibs-296"><code>build_old_libs</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-C-header-files_002c-portable-130">C header files, portable</a>: <a href="#C-header-files">C header files</a></li>
<li><a href="#index-C_002b_002b_002c-pitfalls-216">C++, pitfalls</a>: <a href="#C_002b_002b-libraries">C++ libraries</a></li>
<li><a href="#index-C_002b_002b_002c-using-213">C++, using</a>: <a href="#Other-languages">Other languages</a></li>
<li><a href="#index-C_002c-not-using-211">C, not using</a>: <a href="#Other-languages">Other languages</a></li>
<li><a href="#index-CC-81"><code>CC</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-CC-284"><code>CC</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-cdemo_002dconf_002etest-225"><code>cdemo-conf.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-cdemo_002dexec_002etest-226"><code>cdemo-exec.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-cdemo_002dmake_002etest-227"><code>cdemo-make.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-cdemo_002dshared_002etest-229"><code>cdemo-shared.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-cdemo_002dstatic_002etest-228"><code>cdemo-static.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-CFLAGS-82"><code>CFLAGS</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-clean-mode-65">clean mode</a>: <a href="#Clean-mode">Clean mode</a></li>
<li><a href="#index-command-options_002c-libtool-48">command options, libtool</a>: <a href="#Invoking-libtool">Invoking libtool</a></li>
<li><a href="#index-command-options_002c-libtoolize-100">command options, libtoolize</a>: <a href="#Invoking-libtoolize">Invoking libtoolize</a></li>
<li><a href="#index-compile-mode-50">compile mode</a>: <a href="#Compile-mode">Compile mode</a></li>
<li><a href="#index-compiler_005fc_005fo-297"><code>compiler_c_o</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-compiler_005fo_005flo-298"><code>compiler_o_lo</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-compiling-object-files-14">compiling object files</a>: <a href="#Creating-object-files">Creating object files</a></li>
<li><a href="#index-complexity-of-library-systems-9">complexity of library systems</a>: <a href="#Postmortem">Postmortem</a></li>
<li><a href="#index-config_002eguess-94"><code>config.guess</code></a>: <a href="#Distributing">Distributing</a></li>
<li><a href="#index-config_002esub-95"><code>config.sub</code></a>: <a href="#Distributing">Distributing</a></li>
<li><a href="#index-configuring-libtool-71">configuring libtool</a>: <a href="#Configuring">Configuring</a></li>
<li><a href="#index-convenience-libraries-43">convenience libraries</a>: <a href="#Static-libraries">Static libraries</a></li>
<li><a href="#index-CPPFLAGS-83"><code>CPPFLAGS</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-debugging-libraries-107">debugging libraries</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-definition-of-libraries-10">definition of libraries</a>: <a href="#Libtool-paradigm">Libtool paradigm</a></li>
<li><a href="#index-demo_002dconf_002etest-230"><code>demo-conf.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dexec_002etest-231"><code>demo-exec.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dinst_002etest-232"><code>demo-inst.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dmake_002etest-233"><code>demo-make.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dnofast_002etest-237"><code>demo-nofast.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dnopic_002etest-239"><code>demo-nopic.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dpic_002etest-238"><code>demo-pic.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dshared_002etest-236"><code>demo-shared.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dstatic_002etest-235"><code>demo-static.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-demo_002dunst_002etest-234"><code>demo-unst.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dconf_002etest-244"><code>depdemo-conf.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dexec_002etest-245"><code>depdemo-exec.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dinst_002etest-246"><code>depdemo-inst.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dmake_002etest-247"><code>depdemo-make.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dnofast_002etest-251"><code>depdemo-nofast.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dshared_002etest-250"><code>depdemo-shared.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dstatic_002etest-249"><code>depdemo-static.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-depdemo_002dunst_002etest-248"><code>depdemo-unst.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-dependencies-between-libraries-132">dependencies between libraries</a>: <a href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a></li>
<li><a href="#index-dependency-versioning-117">dependency versioning</a>: <a href="#Versioning">Versioning</a></li>
<li><a href="#index-deplibs_002etest-240"><code>deplibs.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-deplibs_005fcheck_005fmethod-273"><code>deplibs_check_method</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-design-issues-6">design issues</a>: <a href="#Issues">Issues</a></li>
<li><a href="#index-design-of-library-interfaces-124">design of library interfaces</a>: <a href="#Library-tips">Library tips</a></li>
<li><a href="#index-design-philosophy-2">design philosophy</a>: <a href="#Motivation">Motivation</a></li>
<li><a href="#index-developing-libraries-108">developing libraries</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-dlclose-152"><code>dlclose</code></a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-dlclose-136"><code>dlclose</code></a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-dlerror-153"><code>dlerror</code></a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-DLLTOOL-90"><code>DLLTOOL</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-dlopen-134"><code>dlopen</code></a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-dlopen-150"><code>dlopen</code></a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-dlopen_005fself-300"><code>dlopen_self</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-dlopen_005fself_005fstatic-301"><code>dlopen_self_static</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-dlopen_005fsupport-299"><code>dlopen_support</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-dlopening-modules-139">dlopening modules</a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-dlopening-modules-156">dlopening modules</a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-dlopening_002c-pitfalls-147">dlopening, pitfalls</a>: <a href="#Dlopen-issues">Dlopen issues</a></li>
<li><a href="#index-dlsym-135"><code>dlsym</code></a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-dlsym-151"><code>dlsym</code></a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-double_002dcompilation_002c-avoiding-109">double-compilation, avoiding</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-dryrun_002etest-259"><code>dryrun.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-dynamic-dependencies-116">dynamic dependencies</a>: <a href="#Versioning">Versioning</a></li>
<li><a href="#index-dynamic-linking_002c-applications-155">dynamic linking, applications</a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-dynamic-linking_002c-applications-138">dynamic linking, applications</a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-dynamic-modules_002c-names-145">dynamic modules, names</a>: <a href="#Finding-the-dlname">Finding the dlname</a></li>
<li><a href="#index-echo-302"><code>echo</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-eliding-shared-libraries-111">eliding shared libraries</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-examples-of-using-libtool-12">examples of using libtool</a>: <a href="#Using-libtool">Using libtool</a></li>
<li><a href="#index-exclude_005fexpsyms-303"><code>exclude_expsyms</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-execute-mode-57">execute mode</a>: <a href="#Execute-mode">Execute mode</a></li>
<li><a href="#index-export_005fdynamic_005fflag_005fspec-304"><code>export_dynamic_flag_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-export_005fsymbols_005fcmds-305"><code>export_symbols_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-extract_005fexpsyms_005fcmds-306"><code>extract_expsyms_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-failed-tests-267">failed tests</a>: <a href="#When-tests-fail">When tests fail</a></li>
<li><a href="#index-fast_005finstall-307"><code>fast_install</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-FDL_002c-GNU-Free-Documentation-License-354">FDL, GNU Free Documentation License</a>: <a href="#GNU-Free-Documentation-License">GNU Free Documentation License</a></li>
<li><a href="#index-file_005fmagic-274"><code>file_magic</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-file_005fmagic_005fcmd-275"><code>file_magic_cmd</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-file_005fmagic_005ftest_005ffile-276"><code>file_magic_test_file</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-finish-mode-61">finish mode</a>: <a href="#Finish-mode">Finish mode</a></li>
<li><a href="#index-finish_005fcmds-308"><code>finish_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-finish_005feval-309"><code>finish_eval</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-fix_005fsrcfile_005fpath-310"><code>fix_srcfile_path</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-formal-versioning-121">formal versioning</a>: <a href="#Libtool-versioning">Libtool versioning</a></li>
<li><a href="#index-global-functions-128">global functions</a>: <a href="#Library-tips">Library tips</a></li>
<li><a href="#index-global_005fsymbol_005fpipe-311"><code>global_symbol_pipe</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-global_005fsymbol_005fto_005fcdecl-312"><code>global_symbol_to_cdecl</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-hardcode_002etest-241"><code>hardcode.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-hardcode_005faction-313"><code>hardcode_action</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-hardcode_005fdirect-314"><code>hardcode_direct</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-hardcode_005finto_005flibs-315"><code>hardcode_into_libs</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-hardcode_005flibdir_005fflag_005fspec-316"><code>hardcode_libdir_flag_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-hardcode_005flibdir_005fseparator-317"><code>hardcode_libdir_separator</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-hardcode_005fminus_005fL-318"><code>hardcode_minus_L</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-hardcode_005fshlibpath_005fvar-319"><code>hardcode_shlibpath_var</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-header-files-127">header files</a>: <a href="#Library-tips">Library tips</a></li>
<li><a href="#index-host-320"><code>host</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-host_005falias-321"><code>host_alias</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-implementation-of-libtool-281">implementation of libtool</a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-include-files_002c-portable-131">include files, portable</a>: <a href="#C-header-files">C header files</a></li>
<li><a href="#index-include_005fexpsyms-322"><code>include_expsyms</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-inferring-tags-219">inferring tags</a>: <a href="#Tags">Tags</a></li>
<li><a href="#index-install-36"><code>install</code></a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-install-mode-59">install mode</a>: <a href="#Install-mode">Install mode</a></li>
<li><a href="#index-install_002dsh-96"><code>install-sh</code></a>: <a href="#Distributing">Distributing</a></li>
<li><a href="#index-installation_002c-finishing-40">installation, finishing</a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-inter_002dlibrary-dependencies-133">inter-library dependencies</a>: <a href="#Inter_002dlibrary-dependencies">Inter-library dependencies</a></li>
<li><a href="#index-inter_002dlibrary-dependency-272">inter-library dependency</a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-language-names-218">language names</a>: <a href="#Tags">Tags</a></li>
<li><a href="#index-languages_002c-non_002dC-212">languages, non-C</a>: <a href="#Other-languages">Other languages</a></li>
<li><a href="#index-LD-285"><code>LD</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-LD-84"><code>LD</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-LDFLAGS-85"><code>LDFLAGS</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-libext-323"><code>libext</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-libltdl-149"><code>libltdl</code></a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-libname_005fspec-324"><code>libname_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-libraries_002c-definition-of-11">libraries, definition of</a>: <a href="#Libtool-paradigm">Libtool paradigm</a></li>
<li><a href="#index-libraries_002c-finishing-installation-41">libraries, finishing installation</a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-libraries_002c-stripping-38">libraries, stripping</a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-library-interfaces-119">library interfaces</a>: <a href="#Interfaces">Interfaces</a></li>
<li><a href="#index-library-interfaces_002c-design-123">library interfaces, design</a>: <a href="#Library-tips">Library tips</a></li>
<li><a href="#index-library-object-file-18">library object file</a>: <a href="#Creating-object-files">Creating object files</a></li>
<li><a href="#index-library_005fnames_005fspec-325"><code>library_names_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-LIBS-86"><code>LIBS</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-libtool-45"><code>libtool</code></a>: <a href="#Invoking-libtool">Invoking libtool</a></li>
<li><a href="#index-libtool-command-options-46">libtool command options</a>: <a href="#Invoking-libtool">Invoking libtool</a></li>
<li><a href="#index-libtool-examples-13">libtool examples</a>: <a href="#Using-libtool">Using libtool</a></li>
<li><a href="#index-libtool-implementation-282">libtool implementation</a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-libtool-libraries-23">libtool libraries</a>: <a href="#Linking-libraries">Linking libraries</a></li>
<li><a href="#index-libtool-library-versions-120">libtool library versions</a>: <a href="#Libtool-versioning">Libtool versioning</a></li>
<li><a href="#index-libtool-specifications-4">libtool specifications</a>: <a href="#Motivation">Motivation</a></li>
<li><a href="#index-libtoolize-98"><code>libtoolize</code></a>: <a href="#Invoking-libtoolize">Invoking libtoolize</a></li>
<li><a href="#index-libtoolize-command-options-99">libtoolize command options</a>: <a href="#Invoking-libtoolize">Invoking libtoolize</a></li>
<li><a href="#index-link-mode-51">link mode</a>: <a href="#Link-mode">Link mode</a></li>
<li><a href="#index-link_002d2_002etest-262"><code>link-2.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-link_002etest-261"><code>link.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-link_005fall_005fdeplibs-326"><code>link_all_deplibs</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-link_005fstatic_005fflag-327"><code>link_static_flag</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-linking-against-installed-libraries-26">linking against installed libraries</a>: <a href="#Linking-executables">Linking executables</a></li>
<li><a href="#index-linking-against-uninstalled-libraries-30">linking against uninstalled libraries</a>: <a href="#Linking-executables">Linking executables</a></li>
<li><a href="#index-linking-with-installed-libtool-libraries-31">linking with installed libtool libraries</a>: <a href="#Linking-executables">Linking executables</a></li>
<li><a href="#index-linking_002c-partial-56">linking, partial</a>: <a href="#Link-mode">Link mode</a></li>
<li><a href="#index-LN_005fS-89"><code>LN_S</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-lt_005fdladderror-209"><code>lt_dladderror</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdladdsearchdir-172"><code>lt_dladdsearchdir</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlcaller_005fget_005fdata-194"><code>lt_dlcaller_get_data</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlcaller_005fid-191"><code>lt_dlcaller_id</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlcaller_005fregister-192"><code>lt_dlcaller_register</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlcaller_005fset_005fdata-193"><code>lt_dlcaller_set_data</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlclose-166"><code>lt_dlclose</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlerror-168"><code>lt_dlerror</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlexit-163"><code>lt_dlexit</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlforeach-189"><code>lt_dlforeach</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlforeachfile-176"><code>lt_dlforeachfile</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlfree-181"><code>lt_dlfree</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlgetinfo-188"><code>lt_dlgetinfo</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlgetsearchpath-175"><code>lt_dlgetsearchpath</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlhandle-160"><code>lt_dlhandle</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlhandle_005fnext-190"><code>lt_dlhandle_next</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlinfo-187"><code>lt_dlinfo</code></a>: <a href="#User-defined-module-data">User defined module data</a></li>
<li><a href="#index-lt_005fdlinit-162"><code>lt_dlinit</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlinsertsearchdir-173"><code>lt_dlinsertsearchdir</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlisresident-178"><code>lt_dlisresident</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlloader-196"><code>lt_dlloader</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlloader_005fadd-203"><code>lt_dlloader_add</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlloader_005fdata-208"><code>lt_dlloader_data</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlloader_005fexit-202"><code>lt_dlloader_exit</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlloader_005ffind-206"><code>lt_dlloader_find</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlloader_005fname-207"><code>lt_dlloader_name</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlloader_005fnext-205"><code>lt_dlloader_next</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlloader_005fremove-204"><code>lt_dlloader_remove</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlmakeresident-177"><code>lt_dlmakeresident</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlmalloc-179"><code>lt_dlmalloc</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlmutex_005fgeterror-185"><code>lt_dlmutex_geterror</code></a>: <a href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a></li>
<li><a href="#index-lt_005fdlmutex_005flock-182"><code>lt_dlmutex_lock</code></a>: <a href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a></li>
<li><a href="#index-lt_005fdlmutex_005fregister-186"><code>lt_dlmutex_register</code></a>: <a href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a></li>
<li><a href="#index-lt_005fdlmutex_005fseterror-184"><code>lt_dlmutex_seterror</code></a>: <a href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a></li>
<li><a href="#index-lt_005fdlmutex_005funlock-183"><code>lt_dlmutex_unlock</code></a>: <a href="#Thread-Safety-in-libltdl">Thread Safety in libltdl</a></li>
<li><a href="#index-lt_005fdlopen-164"><code>lt_dlopen</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlopenext-165"><code>lt_dlopenext</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlpreload-169"><code>lt_dlpreload</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlpreload_005fdefault-170"><code>lt_dlpreload_default</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlrealloc-180"><code>lt_dlrealloc</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlseterror-210"><code>lt_dlseterror</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fdlsetsearchpath-174"><code>lt_dlsetsearchpath</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlsym-167"><code>lt_dlsym</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fdlsymlist-142"><code>lt_dlsymlist</code></a>: <a href="#Dlpreopening">Dlpreopening</a></li>
<li><a href="#index-lt_005fdlsymlist-161"><code>lt_dlsymlist</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005ffind_005fsym-201"><code>lt_find_sym</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fmodule-195"><code>lt_module</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fmodule_005fclose-200"><code>lt_module_close</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fmodule_005fopen-199"><code>lt_module_open</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fpreloaded_005fsymbols-143"><code>lt_preloaded_symbols</code></a>: <a href="#Dlpreopening">Dlpreopening</a></li>
<li><a href="#index-lt_005fptr-159"><code>lt_ptr</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-lt_005fuser_005fdata-197"><code>lt_user_data</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-lt_005fuser_005fdlloader-198"><code>lt_user_dlloader</code></a>: <a href="#Module-loaders-for-libltdl">Module loaders for libltdl</a></li>
<li><a href="#index-LTALLOCA-103"><code>LTALLOCA</code></a>: <a href="#Autoconf-_002eo-macros">Autoconf .o macros</a></li>
<li><a href="#index-LTDL_005fSET_005fPRELOADED_005fSYMBOLS-171"><code>LTDL_SET_PRELOADED_SYMBOLS</code></a>: <a href="#Libltdl-interface">Libltdl interface</a></li>
<li><a href="#index-LTLIBOBJS-105"><code>LTLIBOBJS</code></a>: <a href="#Autoconf-_002eo-macros">Autoconf .o macros</a></li>
<li><a href="#index-LTLIBRARIES-70"><code>LTLIBRARIES</code></a>: <a href="#Using-Automake">Using Automake</a></li>
<li><a href="#index-ltmain_002esh-97"><code>ltmain.sh</code></a>: <a href="#Distributing">Distributing</a></li>
<li><a href="#index-Makefile-67">Makefile</a>: <a href="#Makefile-rules">Makefile rules</a></li>
<li><a href="#index-Makefile_002eam-68">Makefile.am</a>: <a href="#Makefile-rules">Makefile rules</a></li>
<li><a href="#index-Makefile_002ein-69">Makefile.in</a>: <a href="#Makefile-rules">Makefile rules</a></li>
<li><a href="#index-mdemo_002dconf_002etest-252"><code>mdemo-conf.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-mdemo_002dexec_002etest-253"><code>mdemo-exec.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-mdemo_002dinst_002etest-254"><code>mdemo-inst.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-mdemo_002dmake_002etest-255"><code>mdemo-make.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-mdemo_002dshared_002etest-258"><code>mdemo-shared.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-mdemo_002dstatic_002etest-257"><code>mdemo-static.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-mdemo_002dunst_002etest-256"><code>mdemo-unst.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-mode_002c-clean-66">mode, clean</a>: <a href="#Clean-mode">Clean mode</a></li>
<li><a href="#index-mode_002c-compile-49">mode, compile</a>: <a href="#Compile-mode">Compile mode</a></li>
<li><a href="#index-mode_002c-execute-58">mode, execute</a>: <a href="#Execute-mode">Execute mode</a></li>
<li><a href="#index-mode_002c-finish-62">mode, finish</a>: <a href="#Finish-mode">Finish mode</a></li>
<li><a href="#index-mode_002c-install-60">mode, install</a>: <a href="#Install-mode">Install mode</a></li>
<li><a href="#index-mode_002c-link-52">mode, link</a>: <a href="#Link-mode">Link mode</a></li>
<li><a href="#index-mode_002c-uninstall-64">mode, uninstall</a>: <a href="#Uninstall-mode">Uninstall mode</a></li>
<li><a href="#index-modules_002c-dynamic-157">modules, dynamic</a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-modules_002c-dynamic-140">modules, dynamic</a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-motivation-for-writing-libtool-1">motivation for writing libtool</a>: <a href="#Motivation">Motivation</a></li>
<li><a href="#index-names-of-dynamic-modules-144">names of dynamic modules</a>: <a href="#Finding-the-dlname">Finding the dlname</a></li>
<li><a href="#index-need_005flib_005fprefix-328"><code>need_lib_prefix</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-need_005flocks-330"><code>need_locks</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-need_005fversion-329"><code>need_version</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-NM-87"><code>NM</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-NM-286"><code>NM</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-no_005fbuiltin_005fflag-331"><code>no_builtin_flag</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-no_005fundefined_005fflag-332"><code>no_undefined_flag</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-noinst_002dlink_002etest-243"><code>noinst-link.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-nomode_002etest-263"><code>nomode.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-none-279"><code>none</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-objdir-333"><code>objdir</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-OBJDUMP-91"><code>OBJDUMP</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-object-files_002c-compiling-15">object files, compiling</a>: <a href="#Creating-object-files">Creating object files</a></li>
<li><a href="#index-object-files_002c-library-20">object files, library</a>: <a href="#Creating-object-files">Creating object files</a></li>
<li><a href="#index-objext-334"><code>objext</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-old_005farchive_005fcmds-292"><code>old_archive_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-old_005farchive_005ffrom_005fexpsyms_005fcmds-294"><code>old_archive_from_expsyms_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-old_005farchive_005ffrom_005fnew_005fcmds-293"><code>old_archive_from_new_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-old_005fpostinstall_005fcmds-337"><code>old_postinstall_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-old_005fpostuninstall_005fcmds-339"><code>old_postuninstall_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-old_005fstriplib-347"><code>old_striplib</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-opaque-data-types-126">opaque data types</a>: <a href="#Library-tips">Library tips</a></li>
<li><a href="#index-options_002c-libtool-command-47">options, libtool command</a>: <a href="#Invoking-libtool">Invoking libtool</a></li>
<li><a href="#index-options_002c-libtoolize-command-101">options, libtoolize command</a>: <a href="#Invoking-libtoolize">Invoking libtoolize</a></li>
<li><a href="#index-other-implementations_002c-flaws-in-7">other implementations, flaws in</a>: <a href="#Postmortem">Postmortem</a></li>
<li><a href="#index-partial-linking-55">partial linking</a>: <a href="#Link-mode">Link mode</a></li>
<li><a href="#index-pass_005fall-278"><code>pass_all</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-PIC-_0028position_002dindependent-code_0029-17">PIC (position-independent code)</a>: <a href="#Creating-object-files">Creating object files</a></li>
<li><a href="#index-pic_005fflag-335"><code>pic_flag</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-pitfalls-using-C_002b_002b-215">pitfalls using C++</a>: <a href="#C_002b_002b-libraries">C++ libraries</a></li>
<li><a href="#index-pitfalls-with-dlopen-146">pitfalls with dlopen</a>: <a href="#Dlopen-issues">Dlopen issues</a></li>
<li><a href="#index-portable-C-headers-129">portable C headers</a>: <a href="#C-header-files">C header files</a></li>
<li><a href="#index-position_002dindependent-code-16">position-independent code</a>: <a href="#Creating-object-files">Creating object files</a></li>
<li><a href="#index-postinstall_005fcmds-336"><code>postinstall_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-postinstallation-39">postinstallation</a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-postuninstall_005fcmds-338"><code>postuninstall_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-problem-reports-271">problem reports</a>: <a href="#Reporting-bugs">Reporting bugs</a></li>
<li><a href="#index-problems_002c-blaming-somebody-else-for-223">problems, blaming somebody else for</a>: <a href="#Troubleshooting">Troubleshooting</a></li>
<li><a href="#index-problems_002c-solving-221">problems, solving</a>: <a href="#Troubleshooting">Troubleshooting</a></li>
<li><a href="#index-program-wrapper-scripts-33">program wrapper scripts</a>: <a href="#Linking-executables">Linking executables</a></li>
<li><a href="#index-quote_002etest-264"><code>quote.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-RANLIB-88"><code>RANLIB</code></a>: <a href="#AC_005fPROG_005fLIBTOOL">AC_PROG_LIBTOOL</a></li>
<li><a href="#index-ranlib-22"><code>ranlib</code></a>: <a href="#Linking-libraries">Linking libraries</a></li>
<li><a href="#index-RANLIB-287"><code>RANLIB</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-reload_005fcmds-340"><code>reload_cmds</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-reload_005fflag-341"><code>reload_flag</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-renaming-interface-functions-125">renaming interface functions</a>: <a href="#Library-tips">Library tips</a></li>
<li><a href="#index-reporting-bugs-270">reporting bugs</a>: <a href="#Reporting-bugs">Reporting bugs</a></li>
<li><a href="#index-reusability-of-library-systems-8">reusability of library systems</a>: <a href="#Postmortem">Postmortem</a></li>
<li><a href="#index-runpath_005fvar-342"><code>runpath_var</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-saving-time-115">saving time</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-security-problems-with-buggy-linkers-28">security problems with buggy linkers</a>: <a href="#Linking-executables">Linking executables</a></li>
<li><a href="#index-sh_002etest-265"><code>sh.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-shared-libraries_002c-not-using-113">shared libraries, not using</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-shared-library-versions-118">shared library versions</a>: <a href="#Versioning">Versioning</a></li>
<li><a href="#index-shl_005fload-137"><code>shl_load</code></a>: <a href="#Dlopened-modules">Dlopened modules</a></li>
<li><a href="#index-shl_005fload-154"><code>shl_load</code></a>: <a href="#Using-libltdl">Using libltdl</a></li>
<li><a href="#index-shlibpath_005foverrides_005frunpath-343"><code>shlibpath_overrides_runpath</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-shlibpath_005fvar-344"><code>shlibpath_var</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-solving-problems-222">solving problems</a>: <a href="#Troubleshooting">Troubleshooting</a></li>
<li><a href="#index-soname_005fspec-345"><code>soname_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-specifications-for-libtool-3">specifications for libtool</a>: <a href="#Motivation">Motivation</a></li>
<li><a href="#index-standalone-binaries-44">standalone binaries</a>: <a href="#Static-libraries">Static libraries</a></li>
<li><a href="#index-static-linking-42">static linking</a>: <a href="#Static-libraries">Static libraries</a></li>
<li><a href="#index-strip-34"><code>strip</code></a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-striplib-346"><code>striplib</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-stripping-libraries-37">stripping libraries</a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-su-35"><code>su</code></a>: <a href="#Installing-libraries">Installing libraries</a></li>
<li><a href="#index-suffix_002etest-266"><code>suffix.test</code></a>: <a href="#Test-descriptions">Test descriptions</a></li>
<li><a href="#index-sys_005flib_005fdlsearch_005fpath_005fspec-348"><code>sys_lib_dlsearch_path_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-sys_005flib_005fsearch_005fpath_005fspec-349"><code>sys_lib_search_path_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-tag-names-217">tag names</a>: <a href="#Tags">Tags</a></li>
<li><a href="#index-test-suite-224">test suite</a>: <a href="#Libtool-test-suite">Libtool test suite</a></li>
<li><a href="#index-test_005fcompile-277"><code>test_compile</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-tests_002c-failed-268">tests, failed</a>: <a href="#When-tests-fail">When tests fail</a></li>
<li><a href="#index-thread_005fsafe_005fflag_005fspec-350"><code>thread_safe_flag_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-time_002c-saving-114">time, saving</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-tricky-design-issues-5">tricky design issues</a>: <a href="#Issues">Issues</a></li>
<li><a href="#index-trouble-with-C_002b_002b-214">trouble with C++</a>: <a href="#C_002b_002b-libraries">C++ libraries</a></li>
<li><a href="#index-trouble-with-dlopen-148">trouble with dlopen</a>: <a href="#Dlopen-issues">Dlopen issues</a></li>
<li><a href="#index-troubleshooting-220">troubleshooting</a>: <a href="#Troubleshooting">Troubleshooting</a></li>
<li><a href="#index-undefined-symbols_002c-allowing-53">undefined symbols, allowing</a>: <a href="#Link-mode">Link mode</a></li>
<li><a href="#index-uninstall-mode-63">uninstall mode</a>: <a href="#Uninstall-mode">Uninstall mode</a></li>
<li><a href="#index-unknown-280"><code>unknown</code></a>: <a href="#Porting-inter_002dlibrary-dependencies">Porting inter-library dependencies</a></li>
<li><a href="#index-unresolved-symbols_002c-allowing-54">unresolved symbols, allowing</a>: <a href="#Link-mode">Link mode</a></li>
<li><a href="#index-using-shared-libraries_002c-not-112">using shared libraries, not</a>: <a href="#Static_002donly-libraries">Static-only libraries</a></li>
<li><a href="#index-version_005ftype-351"><code>version_type</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-versioning_002c-formal-122">versioning, formal</a>: <a href="#Libtool-versioning">Libtool versioning</a></li>
<li><a href="#index-whole_005farchive_005fflag_005fspec-352"><code>whole_archive_flag_spec</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-wl-353"><code>wl</code></a>: <a href="#libtool-script-contents">libtool script contents</a></li>
<li><a href="#index-wrapper-scripts-for-programs-32">wrapper scripts for programs</a>: <a href="#Linking-executables">Linking executables</a></li>
   </ul><!-- summarycontents -->

<div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">Shared library support for GNU</a>
<li><a name="toc_Introduction" href="#Introduction">1 Introduction</a>
<ul>
<li><a href="#Motivation">1.1 Motivation for writing libtool</a>
<li><a href="#Issues">1.2 Implementation issues</a>
<li><a href="#Other-implementations">1.3 Other implementations</a>
<li><a href="#Postmortem">1.4 A postmortem analysis of other implementations</a>
</li></ul>
<li><a name="toc_Libtool-paradigm" href="#Libtool-paradigm">2 The libtool paradigm</a>
<li><a name="toc_Using-libtool" href="#Using-libtool">3 Using libtool</a>
<ul>
<li><a href="#Creating-object-files">3.1 Creating object files</a>
<li><a href="#Linking-libraries">3.2 Linking libraries</a>
<li><a href="#Linking-executables">3.3 Linking executables</a>
<li><a href="#Debugging-executables">3.4 Debugging executables</a>
<li><a href="#Installing-libraries">3.5 Installing libraries</a>
<li><a href="#Installing-executables">3.6 Installing executables</a>
<li><a href="#Static-libraries">3.7 Linking static libraries</a>
</li></ul>
<li><a name="toc_Invoking-libtool" href="#Invoking-libtool">4 Invoking <code>libtool</code></a>
<ul>
<li><a href="#Compile-mode">4.1 Compile mode</a>
<li><a href="#Link-mode">4.2 Link mode</a>
<li><a href="#Execute-mode">4.3 Execute mode</a>
<li><a href="#Install-mode">4.4 Install mode</a>
<li><a href="#Finish-mode">4.5 Finish mode</a>
<li><a href="#Uninstall-mode">4.6 Uninstall mode</a>
<li><a href="#Clean-mode">4.7 Clean mode</a>
</li></ul>
<li><a name="toc_Integrating-libtool" href="#Integrating-libtool">5 Integrating libtool with your package</a>
<ul>
<li><a href="#Makefile-rules">5.1 Writing <span class="file">Makefile</span> rules for libtool</a>
<li><a href="#Using-Automake">5.2 Using Automake with libtool</a>
<li><a href="#Configuring">5.3 Configuring libtool</a>
<ul>
<li><a href="#AC_005fPROG_005fLIBTOOL">5.3.1 The <code>AC_PROG_LIBTOOL</code> macro</a>
<li><a href="#Configure-notes">5.3.2 Platform-specific configuration notes</a>
</li></ul>
<li><a href="#Distributing">5.4 Including libtool in your package</a>
<ul>
<li><a href="#Invoking-libtoolize">5.4.1 Invoking <code>libtoolize</code></a>
<li><a href="#Autoconf-_002eo-macros">5.4.2 Autoconf <span class="samp">.o</span> macros</a>
</li></ul>
<li><a href="#Static_002donly-libraries">5.5 Static-only libraries</a>
</li></ul>
<li><a name="toc_Versioning" href="#Versioning">6 Library interface versions</a>
<ul>
<li><a href="#Interfaces">6.1 What are library interfaces?</a>
<li><a href="#Libtool-versioning">6.2 Libtool's versioning system</a>
<li><a href="#Updating-version-info">6.3 Updating library version information</a>
<li><a href="#Release-numbers">6.4 Managing release information</a>
</li></ul>
<li><a name="toc_Library-tips" href="#Library-tips">7 Tips for interface design</a>
<ul>
<li><a href="#C-header-files">7.1 Writing C header files</a>
</li></ul>
<li><a name="toc_Inter_002dlibrary-dependencies" href="#Inter_002dlibrary-dependencies">8 Inter-library dependencies</a>
<li><a name="toc_Dlopened-modules" href="#Dlopened-modules">9 Dlopened modules</a>
<ul>
<li><a href="#Building-modules">9.1 Building modules to dlopen</a>
<li><a href="#Dlpreopening">9.2 Dlpreopening</a>
<li><a href="#Finding-the-dlname">9.3 Finding the correct name to dlopen</a>
<li><a href="#Dlopen-issues">9.4 Unresolved dlopen issues</a>
</li></ul>
<li><a name="toc_Using-libltdl" href="#Using-libltdl">10 Using libltdl</a>
<ul>
<li><a href="#Libltdl-interface">10.1 How to use libltdl in your programs</a>
<li><a href="#Modules-for-libltdl">10.2 Creating modules that can be <code>dlopen</code>ed</a>
<li><a href="#Thread-Safety-in-libltdl">10.3 Using libltdl in a multi threaded environment</a>
<li><a href="#User-defined-module-data">10.4 Data associated with loaded modules</a>
<li><a href="#Module-loaders-for-libltdl">10.5 How to create and register new module loaders</a>
<ul>
<li><a href="#Module-loaders-for-libltdl">10.5.1 Error handling within user module loaders</a>
</li></ul>
<li><a href="#Distributing-libltdl">10.6 How to distribute libltdl with your package</a>
</li></ul>
<li><a name="toc_Other-languages" href="#Other-languages">11 Using libtool with other languages</a>
<ul>
<li><a href="#C_002b_002b-libraries">11.1 Writing libraries for C++</a>
<li><a href="#Tags">11.2 Tags</a>
</li></ul>
<li><a name="toc_Troubleshooting" href="#Troubleshooting">12 Troubleshooting</a>
<ul>
<li><a href="#Libtool-test-suite">12.1 The libtool test suite</a>
<ul>
<li><a href="#Test-descriptions">12.1.1 Description of test suite</a>
<li><a href="#When-tests-fail">12.1.2 When tests fail</a>
</li></ul>
<li><a href="#Reporting-bugs">12.2 Reporting bugs</a>
</li></ul>
<li><a name="toc_Maintaining" href="#Maintaining">13 Maintenance notes for libtool</a>
<ul>
<li><a href="#New-ports">13.1 Porting libtool to new systems</a>
<ul>
<li><a href="#Information-sources">13.1.1 Information sources</a>
<li><a href="#Porting-inter_002dlibrary-dependencies">13.1.2 Porting inter-library dependencies support</a>
</li></ul>
<li><a href="#Tested-platforms">13.2 Tested platforms</a>
<li><a href="#Platform-quirks">13.3 Platform quirks</a>
<ul>
<li><a href="#References">13.3.1 References</a>
<li><a href="#Compilers">13.3.2 Compilers</a>
<li><a href="#Reloadable-objects">13.3.3 Reloadable objects</a>
<li><a href="#Multiple-dependencies">13.3.4 Multiple dependencies</a>
<li><a href="#Archivers">13.3.5 Archivers</a>
</li></ul>
<li><a href="#libtool-script-contents">13.4 <code>libtool</code> script contents</a>
<li><a href="#Cheap-tricks">13.5 Cheap tricks</a>
</li></ul>
<li><a name="toc_GNU-Free-Documentation-License" href="#GNU-Free-Documentation-License">Appendix A GNU Free Documentation License</a>
<li><a name="toc_Index" href="#Index">Index</a>
</li></ul>
</div>

<div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> If you don't
specify an <code>rpath</code>, then libtool builds a libtool convenience
archive, not a shared library (see <a href="#Static-libraries">Static libraries</a>).</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> However, you should avoid using
<span class="samp">-L</span> or <span class="samp">-l</span> flags to link against an uninstalled libtool
library.  Just specify the relative path to the <span class="samp">.la</span> file, such as
<span class="file">../intl/libintl.la</span>.  This is a design decision to eliminate any
ambiguity when linking against uninstalled shared libraries.</p>

   <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> Don't
accidentally strip the libraries, though, or they will be unusable.</p>

   <p class="footnote"><small>[<a name="fn-4" href="#fnd-4">4</a>]</small> <code>AC_PROG_LIBTOOL</code> requires that
you define the <span class="file">Makefile</span> variable <code>top_builddir</code> in your
<span class="file">Makefile.in</span>.  Automake does this automatically, but Autoconf
users should set it to the relative path to the top of your build
directory (<span class="file">../..</span>, for example).</p>

   <p class="footnote"><small>[<a name="fn-5" href="#fnd-5">5</a>]</small> GNU Image
Manipulation Program, for those who haven't taken the plunge.  See
<a href="http://www.gimp.org/">http://www.gimp.org/</a>.</p>

   <p class="footnote"><small>[<a name="fn-6" href="#fnd-6">6</a>]</small> We used to recommend <code>__P</code>,
<code>__BEGIN_DECLS</code> and <code>__END_DECLS</code>.  This was bad advice since
symbols (even preprocessor macro names) that begin with an underscore
are reserved for the use of the compiler.</p>

   <p class="footnote"><small>[<a name="fn-7" href="#fnd-7">7</a>]</small> HP-UX,
to be different, uses a function named <code>shl_load</code>.</p>

   <p class="footnote"><small>[<a name="fn-8" href="#fnd-8">8</a>]</small> <code>LIBPATH</code>
on AIX, and <code>SHLIB_PATH</code> on HP-UX.</p>

   <p class="footnote"><small>[<a name="fn-9" href="#fnd-9">9</a>]</small> This is used for
the host dependent module loading <span class="sc">api</span> &ndash; <code>shl_load</code> and
<code>LoadLibrary</code> for example</p>

   <p class="footnote"><small>[<a name="fn-10" href="#fnd-10">10</a>]</small> Even if libltdl is installed,
<span class="samp">AC_LIBLTDL_INSTALLABLE</span> may fail to detect it, if libltdl depends
on symbols provided by libraries other than the C library.  In this
case, it will needlessly build and install libltdl.</p>

   <p class="footnote"><small>[<a name="fn-11" href="#fnd-11">11</a>]</small> All code compiled
for the PowerPC and RS/6000 chips (<code>powerpc-*-*</code>, <code>powerpcle-*-*</code>,
and <code>rs6000-*-*</code>) is position-independent, regardless of the operating
system or compiler suite.  So, &ldquo;regular objects&rdquo; can be used to build
shared libraries on these systems and no special PIC compiler flags are
required.</p>

   <p><hr></div>

</body></html>

