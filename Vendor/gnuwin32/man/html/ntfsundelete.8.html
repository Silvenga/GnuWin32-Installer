   <!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>NTFSUNDELETE(8) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
ntfsundelete - recover a deleted file from an NTFS volume. 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>ntfsundelete</b>
[ <i>options</i> ] <b>device</b> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>ntfsundelete</b> has three modes of operation:
<i>scan</i>, <i>undelete</i> and <i>copy</i>. 
<h3><a name='sect3' href='#toc3'>Scan</a></h3>
<p>
The default mode, <i>scan</i> simply reads an NTFS
Volume and looks for files that have been deleted.  Then it will print a
list giving the inode number, name and size. 
<h3><a name='sect4' href='#toc4'>Undelete</a></h3>
<p>
The <i>undelete</i> mode takes
the inode and recovers as much of the data as possible.  It saves the result
to another location.  Partly for safety, but mostly because NTFS write support
isn&rsquo;t finished. 
<h3><a name='sect5' href='#toc5'>Copy</a></h3>
<p>
This is a wizard&rsquo;s option.  It will save a portion of the
MFT to a file.  This probably only be useful when debugging <i>ntfsundelete</i>

<h3><a name='sect6' href='#toc6'>Notes</a></h3>
<b>ntfsundelete</b> only ever <b>reads</b> from the NTFS Volume. <b>ntfsundelete</b> will
never change the volume. 
<h2><a name='sect7' href='#toc7'>Caveats</a></h2>

<h3><a name='sect8' href='#toc8'>Miracles</a></h3>
<b>ntfsundelete</b> cannot perform the
impossible. <p>
When a file is deleted the MFT Record is marked as not in use
and the bitmap representing the disk usage is updated.  If the power isn&rsquo;t
turned off immediately, the free space, where the file used to live, may
become overwritten.  Worse, the MFT Record may be reused for another file.
 If this happens it is impossible to tell where the file was on disk. <p>
Even
if all the clusters of a file are not in use, there is no guarantee that
they haven&rsquo;t been overwritten by some short-lived file. 
<h3><a name='sect9' href='#toc9'>Locale</a></h3>
In NTFS all
the filenames are stored as Unicode.  They will be converted into the current
locale for display by <b>ntfsundelete</b>. The utility has successfully displayed
some Chinese pictogram filenames and then correctly recovered them. 
<h3><a name='sect10' href='#toc10'>Extended
MFT Records</a></h3>
In rare circumstances, a single MFT Record will not be large
enough to hold the metadata describing a file (a file would have to be
in hundreds of fragments for this to happen).  In these cases one MFT record
may hold the filename, but another will hold the information about the
data. <b>ntfsundelete</b> will not try and piece together such records.  It will
simply show unnamed files with data. 
<h3><a name='sect11' href='#toc11'>Compressed and Encrypted Files</a></h3>
<b>ntfsundelete</b>
cannot recover compressed or encrypted files.  When scanning for them, it
will display as being 0% recoverable. 
<h3><a name='sect12' href='#toc12'>The Recovered File&rsquo;s Size and Date</a></h3>
To
recover a file <b>ntfsundelete</b> has to read the file&rsquo;s metadata.  Unfortunately,
this isn&rsquo;t always intact. When a file is deleted, the metadata can be left
in an inconsistant state. e.g. the file size may be zero; the dates of the
file may be set to the time it was deleted, or random. <br>
To be safe <b>ntfsundelete</b> will pick the largest file size it finds and write
that to disk.  It will also try and set the file&rsquo;s date to the last modified
date.  This date may be the correct last modified date, or something unexpected.

<h2><a name='sect13' href='#toc13'>Options</a></h2>
Below is a summary of all the options that <b>ntfsundelete</b> accepts.
 All options have two equivalent names.  The short name is preceded by <b>-</b>
and the long name is preceded by <b>--</b>. Any single letter options, that don&rsquo;t
take an argument, can be combined into a single command, e.g. <b>-fv</b> is equivalent
to <b>-f -v</b>. Long named options can be abbreviated to any unique prefix of their
name. 
<dl>

<dt><b>-b </b><i>num</i> </dt>
<dd><br>
 </dd>

<dt><b>--byte </b><i>num</i> </dt>
<dd>If any clusters of the file cannot be recovered, the missing
parts will be filled with this byte.  The default is zeros. </dd>

<dt><b>-C</b> </dt>
<dd><br>
 </dd>

<dt><b>--case</b> </dt>
<dd>When scanning an NTFS volume, any filename matching (using the <b>--match</b>
option) is case-insensitive.  This option makes the maching case-sensitive.
</dd>

<dt><b>-c </b><i>range</i> </dt>
<dd><br>
 </dd>

<dt><b>--copy </b><i>range</i> </dt>
<dd>This wizard&rsquo;s option will write a block of MFT FILE records
to a file.  The default file is <i>mft</i> which will be created in the current
directory.  This option can be combined with the <b>--output</b> and <b>--destination</b>
options. </dd>

<dt><b>-d </b><i>dir</i> </dt>
<dd><br>
 </dd>

<dt><b>--destination </b><i>dir</i> </dt>
<dd>This option controls where to put the output file of the
<b>--undelete</b> and <b>--copy</b> options. </dd>

<dt><b>-f</b> </dt>
<dd><br>
 </dd>

<dt><b>--force</b> </dt>
<dd>This will override some sensible defaults, such as not overwriting
an existing file.  Use this option with caution. </dd>

<dt><b>-h</b> </dt>
<dd><br>
 </dd>

<dt><b>--help</b> </dt>
<dd>Show a list of options with a brief description of each one. </dd>

<dt><b>-m </b><i>pattern</i>
</dt>
<dd><br>
 </dd>

<dt><b>--match </b><i>pattern</i> </dt>
<dd>Filter the output of the <b>--scan</b> option, by only looking for
matching filenames.  The pattern can include the wildcards &rsquo;?&rsquo;, match exactly
one character or &rsquo;*&rsquo;, match zero or more characters.  By default the matching
is case-insensitive.  To make the search case sensitive, use the <b>--case</b> option.
</dd>

<dt><b>-o </b><i>file</i> </dt>
<dd><br>
 </dd>

<dt><b>--output </b><i>file</i> </dt>
<dd>Use this option to set name of output file that <b>--undelete</b> or
<b>--copy</b> will create. </dd>

<dt><b>-p </b><i>num</i> </dt>
<dd><br>
 </dd>

<dt><b>--percentage </b><i>num</i> </dt>
<dd>Filter the output of the <b>--scan</b> option, by only matching
files with a certain amount of recoverable content. <b>Please read the caveats
section for more details.</b> </dd>

<dt><b>-q</b> </dt>
<dd><br>
 </dd>

<dt><b>--quiet</b> </dt>
<dd>Reduce the amount of output to a minimum.  Naturally, it doesn&rsquo;t make
sense to combine this option with <b>--scan</b>. </dd>

<dt><b>-s</b> </dt>
<dd><br>
 </dd>

<dt><b>--scan</b> </dt>
<dd>Search through an NTFS volume and print a list of files that could
be recovered. This is the default action of <b>ntfsundelete</b>. This list can be
filtered by filename, size, percentage recoverable or last modification
time, using the <b>--match</b>, <b>--size</b>, <b>--percent</b> and <b>--time</b> options, respectively. <p>
The
output of scan will be: <p>
<br>
<pre>Inode  Flags  %age     Date      Size  Filename
 6038  FN..    93%  2002-07-17  26629  thesis.doc
</pre><table border='0'>
<tr><td align='left'><b>Flag</b></td><td align='left'><b>Description</b></td></tr>
<tr><td align='left'>F/D</td><td align='left'>File/Directory</td></tr>
<tr><td align='left'>N/R</td><td align='left'>(Non-)Resident data stream</td></tr>
<tr><td align='left'>C/E</td><td align='left'>Compressed/Encrypted
data stream</td></tr>
<tr><td align='left'>!</td><td align='left'>Missing attributes</td></tr>
</table>
<blockquote><p>
<br>
The percentage field shows how much of the file can potentially be recovered.
<p>
<br>
</dd>
</dl>
</blockquote>
<b>-S </b><i>range</i> <br>
 
<dl>

<dt><b>--size </b><i>range</i> </dt>
<dd>Filter the output of the <b>--scan</b> option, by looking for a particular
range of file sizes.  The range may be specified as two numbers separated
by a &rsquo;-&rsquo;.  The sizes may be abbreviated using the suffixes k, m, g, t, for
kilobytes, megabytes, gigabytes and terabytes respectively. </dd>

<dt><b>-t </b><i>since</i> </dt>
<dd><br>
 </dd>

<dt><b>--time </b><i>since</i> </dt>
<dd>Filter the output of the <b>--scan</b> option.  Only match files that
have been altered since this time.  The time must be given as number using
a suffix of d, w, m, y for days, weeks, months or years ago. </dd>

<dt><b>-u </b><i>num</i> </dt>
<dd><br>
 </dd>

<dt><b>--undelete </b><i>num</i> </dt>
<dd>Recover the file with this inode number.  This option can
be combined with <b>--output</b>, <b>--destination</b>, and <b>--byte</b>. <p>
When the file is recovered
it will be given its original name, unless the <b>--output</b> option is used. </dd>

<dt><b>-v</b>
</dt>
<dd><br>
 </dd>

<dt><b>--verbose</b> </dt>
<dd>Increase the amount of output that <b>ntfsundelete</b> prints. </dd>

<dt><b>-V</b> </dt>
<dd><br>
 </dd>

<dt><b>--version</b> </dt>
<dd>Show the version number, copyright and license <b>ntfsundelete</b>. </dd>
</dl>

<h2><a name='sect14' href='#toc14'>Examples</a></h2>
Look
for deleted files on /dev/hda1. <blockquote><p>
<b>ntfsundelete /dev/hda1</b> <p>
</blockquote>
Look for deleted
documents on /dev/hda1. <blockquote><p>
<b>ntfsundelete /dev/hda1 -s -m &rsquo;*.doc&rsquo;</b> <p>
</blockquote>
Look for deleted
files between 5000 and 6000000 bytes, with at least 90% of the data recoverable,
on /dev/hda1. <blockquote><p>
<b>ntfsundelete /dev/hda1 -S 5k-6m -p 90</b> <p>
</blockquote>
Look for deleted files
altered in the last two days <blockquote><p>
<b>ntfsundelete /dev/hda1 -t 2d</b> <p>
</blockquote>
Undelete inode
number 3689, call the file &rsquo;work.doc&rsquo; and put it in the user&rsquo;s home directory.
<blockquote><p>
<b>ntfsundelete /dev/hda1 -u 3689 -o work.doc -d ~</b> <p>
</blockquote>
Save MFT Records 3689 to 3690
to a file &rsquo;debug&rsquo; <blockquote><p>
<b>ntfsundelete /dev/hda1 -c 3689-3690 -o debug</b> </blockquote>

<h2><a name='sect15' href='#toc15'>Bugs</a></h2>
There are
some small limitations to this program, but currently no known bugs. If
you find one, please send an email to  &lt;linux-ntfs-dev@lists.sourceforge.net&gt;
 
<h2><a name='sect16' href='#toc16'>Author</a></h2>
<b>ntfsundelete</b> was written by Richard Russon (FlatCap) &lt;ntfs@flatcap.org&gt;
<br>
If you find this tool useful, make FlatCap happy and send him an email.

<h2><a name='sect17' href='#toc17'>Availability</a></h2>
<b>ntfsundelete</b> is part of the ntfsprogs package and is available
from <br>
 <a href='http://linux-ntfs.sourceforge.net/downloads.html'>http://linux-ntfs.sourceforge.net/downloads.html</a>
  
<h2><a name='sect18' href='#toc18'>See Also</a></h2>
<a href='ntfsinfo.8.html'><b>ntfsinfo</b>(8)</a>
, <a href='ntfsprogs.8.html'><b>ntfsprogs</b>(8)</a>


<p> <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<ul>
<li><a name='toc3' href='#sect3'>Scan</a></li>
<li><a name='toc4' href='#sect4'>Undelete</a></li>
<li><a name='toc5' href='#sect5'>Copy</a></li>
<li><a name='toc6' href='#sect6'>Notes</a></li>
</ul>
<li><a name='toc7' href='#sect7'>Caveats</a></li>
<ul>
<li><a name='toc8' href='#sect8'>Miracles</a></li>
<li><a name='toc9' href='#sect9'>Locale</a></li>
<li><a name='toc10' href='#sect10'>Extended MFT Records</a></li>
<li><a name='toc11' href='#sect11'>Compressed and Encrypted Files</a></li>
<li><a name='toc12' href='#sect12'>The Recovered File's Size and Date</a></li>
</ul>
<li><a name='toc13' href='#sect13'>Options</a></li>
<li><a name='toc14' href='#sect14'>Examples</a></li>
<li><a name='toc15' href='#sect15'>Bugs</a></li>
<li><a name='toc16' href='#sect16'>Author</a></li>
<li><a name='toc17' href='#sect17'>Availability</a></li>
<li><a name='toc18' href='#sect18'>See Also</a></li>
</ul>
</body>
</html>
