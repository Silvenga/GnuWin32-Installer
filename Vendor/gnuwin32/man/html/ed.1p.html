 <!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>"ED"(1P) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>
 
<h2><a name='sect0' href='#toc0'>Prolog</a></h2>
This manual page is part of the POSIX Programmer&rsquo;s Manual. The Linux
implementation of this interface may differ (consult the corresponding
Linux manual page for details of Linux behavior), or the interface may
not be implemented on Linux. 
<h2><a name='sect1' href='#toc1'>Name</a></h2>
ed - edit text 
<h2><a name='sect2' href='#toc2'>Synopsis</a></h2>
<p>
<b>ed</b> <b>[</b><b>-p</b> <i>string</i><b>][</b><b>-s</b><b>][</b><i>file</i><b>]</b>

<h2><a name='sect3' href='#toc3'>Description</a></h2>
<p>
The <i>ed</i> utility is a line-oriented text editor that uses two modes:
<i>command mode</i> and <i>input mode</i>. In command mode the input characters shall
be interpreted as commands, and in input mode they shall be interpreted
as text. See the EXTENDED DESCRIPTION section. 
<h2><a name='sect4' href='#toc4'>Options</a></h2>
<p>
The <i>ed</i> utility shall
conform to the Base Definitions volume of IEEE&nbsp;Std&nbsp;1003.1-2001, Section 12.2,
Utility Syntax Guidelines. <p>
The following options shall be supported: 
<dl>

<dt><b>-p&nbsp;</b> <i>string</i>
</dt>
<dd>Use <i>string</i> as the prompt string when in command mode. By default, there
shall be no prompt string. </dd>

<dt><b>-s</b> </dt>
<dd>Suppress the writing of byte counts by <b>e</b>, <b>E</b>,
<b>r</b>, and <b>w</b> commands and of the <b>&rsquo;!&rsquo;</b> prompt after a !<i>command</i>. <p>
</dd>
</dl>

<h2><a name='sect5' href='#toc5'>Operands</a></h2>
<p>
The following
operand shall be supported: 
<dl>

<dt><i>file</i> </dt>
<dd>If the <i>file</i> argument is given, <i>ed</i> shall
simulate an <b>e</b> command on the file named by the pathname, <i>file</i>, before accepting
commands from the standard input. If the <i>file</i> operand is <b>&rsquo;-&rsquo;</b>, the results are
unspecified. <p>
</dd>
</dl>

<h2><a name='sect6' href='#toc6'>Stdin</a></h2>
<p>
The standard input shall be a text file consisting of
commands, as described in the EXTENDED DESCRIPTION section. 
<h2><a name='sect7' href='#toc7'>Input Files</a></h2>
<p>
The
input files shall be text files. 
<h2><a name='sect8' href='#toc8'>Environment Variables</a></h2>
<p>
The following environment
variables shall affect the execution of <i>ed</i>: 
<dl>

<dt><i>HOME</i> </dt>
<dd>Determine the pathname
of the user&rsquo;s home directory. </dd>

<dt><i>LANG</i> </dt>
<dd>Provide a default value for the internationalization
variables that are unset or null. (See the Base Definitions volume of IEEE&nbsp;Std&nbsp;1003.1-2001,
Section 8.2, Internationalization Variables for the precedence of internationalization
variables used to determine the values of locale categories.) </dd>

<dt><i>LC_ALL</i> </dt>
<dd>If
set to a non-empty string value, override the values of all the other internationalization
variables. </dd>

<dt><i>LC_COLLATE</i> </dt>
<dd><p>
Determine the locale for the behavior of ranges, equivalence
classes, and multi-character collating elements within regular expressions.
</dd>

<dt><i>LC_CTYPE</i> </dt>
<dd>Determine the locale for the interpretation of sequences of bytes
of text data as characters (for example, single-byte as opposed to multi-byte
characters in arguments and input files) and the behavior of character
classes within regular expressions. </dd>

<dt><i>LC_MESSAGES</i> </dt>
<dd>Determine the locale that
should be used to affect the format and contents of diagnostic messages
written to standard error and informative messages written to standard
output. </dd>

<dt><i>NLSPATH</i> </dt>
<dd>Determine the location of message catalogs for the processing
of <i>LC_MESSAGES .</i>  <p>
</dd>
</dl>

<h2><a name='sect9' href='#toc9'>Asynchronous Events</a></h2>
<p>
The <i>ed</i> utility shall take the standard
action for all signals (see the ASYNCHRONOUS EVENTS section in <i>Utility
Description Defaults</i> ) with the following exceptions: 
<dl>

<dt>SIGINT </dt>
<dd>The <i>ed</i> utility
shall interrupt its current activity, write the string <b>"?\n"</b> to standard
output, and return to command mode (see the EXTENDED DESCRIPTION section).
</dd>

<dt>SIGHUP </dt>
<dd>If the buffer is not empty and has changed since the last write,
the <i>ed</i> utility shall attempt to write a copy of the buffer in a file. First,
the file named <b>ed.hup</b> in the current directory shall be used; if that fails,
the file named <b>ed.hup</b> in the directory named by the <i>HOME</i> environment variable
shall be used. In any case, the <i>ed</i> utility shall exit without returning
to command mode. </dd>

<dt>SIGQUIT </dt>
<dd>The <i>ed</i> utility shall ignore this event. <p>
</dd>
</dl>

<h2><a name='sect10' href='#toc10'>Stdout</a></h2>
<p>
Various
editing commands and the prompting feature (see <b>-p</b>) write to standard output,
as described in the EXTENDED DESCRIPTION section. 
<h2><a name='sect11' href='#toc11'>Stderr</a></h2>
<p>
The standard error
shall be used only for diagnostic messages. 
<h2><a name='sect12' href='#toc12'>Output Files</a></h2>
<p>
The output files
shall be text files whose formats are dependent on the editing commands
given. 
<h2><a name='sect13' href='#toc13'>Extended Description</a></h2>
<p>
The <i>ed</i> utility shall operate on a copy of the
file it is editing; changes made to the copy shall have no effect on the
file until a <b>w</b> (write) command is given. The copy of the text is called
the <i>buffer</i>. <p>
Commands to <i>ed</i> have a simple and regular structure: zero, one,
or two <i>addresses</i> followed by a single-character <i>command</i>, possibly followed
by parameters to that command. These addresses specify one or more lines
in the buffer. Every command that requires addresses has default addresses,
so that the addresses very often can be omitted. If the <b>-p</b> option is specified,
the prompt string shall be written to standard output before each command
is read. <p>
In general, only one command can appear on a line. Certain commands
allow text to be input. This text is placed in the appropriate place in
the buffer. While <i>ed</i> is accepting text, it is said to be in <i>input mode</i>. In
this mode, no commands shall be recognized; all input is merely collected.
Input mode is terminated by entering a line consisting of two characters:
a period ( <b>&rsquo;.&rsquo;</b> ) followed by a &lt;newline&gt;. This line is not considered part of
the input text. 
<h3><a name='sect14' href='#toc14'>Regular Expressions in ed</a></h3>
<p>
The <i>ed</i> utility shall support basic
regular expressions, as described in the Base Definitions volume of IEEE&nbsp;Std&nbsp;1003.1-2001,
Section 9.3, Basic Regular Expressions. Since regular expressions in <i>ed</i> are
always matched against single lines (excluding the terminating &lt;newline&gt;s),
never against any larger section of text, there is no way for a regular
expression to match a &lt;newline&gt;. <p>
A null RE shall be equivalent to the last
RE encountered. <p>
Regular expressions are used in addresses to specify lines,
and in some commands (for example, the <b>s</b> substitute command) to specify
portions of a line to be substituted. 
<h3><a name='sect15' href='#toc15'>Addresses in ed</a></h3>
<p>
Addressing in <i>ed</i> relates
to the current line. Generally, the current line is the last line affected
by a command. The current line number is the address of the current line.
If the edit buffer is not empty, the initial value for the current line
shall be the last line in the edit buffer; otherwise, zero. <p>
Addresses shall
be constructed as follows: 
<dl>

<dt> 1.</dt>
<dd>The period character ( <b>&rsquo;.&rsquo;</b> ) shall address the
current line. </dd>
</dl>
<p>

<dl>

<dt> 2.</dt>
<dd>The dollar sign character ( <b>&rsquo;$&rsquo;</b> ) shall address the last line
of the edit buffer. </dd>
</dl>
<p>

<dl>

<dt> 3.</dt>
<dd>The positive decimal number <i>n</i> shall address the <i>n</i>th
line of the edit buffer. </dd>
</dl>
<p>

<dl>

<dt> 4.</dt>
<dd>The apostrophe-x character pair ( <b>"&rsquo;x"</b> ) shall
address the line marked with the mark name character <i>x</i>, which shall be
a lowercase letter from the portable character set. It shall be an error
if the character has not been set to mark a line or if the line that was
marked is not currently present in the edit buffer. </dd>
</dl>
<p>

<dl>

<dt> 5.</dt>
<dd>A BRE enclosed by
slash characters ( <b>&rsquo;/&rsquo;</b> ) shall address the first line found by searching
forwards from the line following the current line toward the end of the
edit buffer and stopping at the first line for which the line excluding
the terminating &lt;newline&gt; matches the BRE. The BRE consisting of a null BRE
delimited by a pair of slash characters shall address the next line for
which the line excluding the terminating &lt;newline&gt; matches the last BRE encountered.
In addition, the second slash can be omitted at the end of a command line.
Within the BRE, a backslash-slash pair ( <b>"\/"</b> ) shall represent a literal
slash instead of the BRE delimiter. If necessary, the search shall wrap
around to the beginning of the buffer and continue up to and including
the current line, so that the entire buffer is searched. </dd>
</dl>
<p>

<dl>

<dt> 6.</dt>
<dd>A BRE enclosed
by question-mark characters ( <b>&rsquo;?&rsquo;</b> ) shall address the first line found by
searching backwards from the line preceding the current line toward the
beginning of the edit buffer and stopping at the first line for which the
line excluding the terminating &lt;newline&gt; matches the BRE. The BRE consisting
of a null BRE delimited by a pair of question-mark characters ( <b>"??"</b> ) shall
address the previous line for which the line excluding the terminating
&lt;newline&gt; matches the last BRE encountered. In addition, the second question-mark
can be omitted at the end of a command line. Within the BRE, a backslash-question-mark
pair ( <b>"\?"</b> ) shall represent a literal question mark instead of the BRE
delimiter. If necessary, the search shall wrap around to the end of the
buffer and continue up to and including the current line, so that the entire
buffer is searched. </dd>
</dl>
<p>

<dl>

<dt> 7.</dt>
<dd>A plus-sign ( <b>&rsquo;+&rsquo;</b> ) or hyphen character ( <b>&rsquo;-&rsquo;</b> ) followed
by a decimal number shall address the current line plus or minus the number.
A plus-sign or hyphen character not followed by a decimal number shall address
the current line plus or minus 1. </dd>
</dl>
<p>
<p>
Addresses can be followed by zero or more
address offsets, optionally &lt;blank&gt;-separated. Address offsets are constructed
as follows: 
<dl>

<dt> *</dt>
<dd>A plus-sign or hyphen character followed by a decimal number
shall add or subtract, respectively, the indicated number of lines to or
from the address. A plus-sign or hyphen character not followed by a decimal
number shall add or subtract 1 to or from the address. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>A decimal number
shall add the indicated number of lines to the address. </dd>
</dl>
<p>
<p>
It shall not be
an error for an intermediate address value to be less than zero or greater
than the last line in the edit buffer. It shall be an error for the final
address value to be less than zero or greater than the last line in the
edit buffer. It shall be an error if a search for a BRE fails to find a
matching line. <p>
Commands accept zero, one, or two addresses. If more than
the required number of addresses are provided to a command that requires
zero addresses, it shall be an error. Otherwise, if more than the required
number of addresses are provided to a command, the addresses specified
first shall be evaluated and then discarded until the maximum number of
valid addresses remain, for the specified command. <p>
Addresses shall be separated
from each other by a comma ( <b>&rsquo;,&rsquo;</b> ) or semicolon character ( <b>&rsquo;;&rsquo;</b> ). In the case
of a semicolon separator, the current line ( <b>&rsquo;.&rsquo;</b> ) shall be set to the first
address, and only then will the second address be calculated. This feature
can be used to determine the starting line for forwards and backwards searches;
see rules 5. and 6. <p>
Addresses can be omitted on either side of the comma
or semicolon separator, in which case the resulting address pairs shall
be as follows: <center><table border='0'>
<tr><td align='left'>; addr</td><td align='left'>. ; addr</td></tr>
<tr><td align='left'>addr ;</td><td align='left'>addr ; addr</td></tr>
</table>
</center><p>
Any &lt;blank&gt;s included between
addresses, address separators, or address offsets shall be ignored. 
<h3><a name='sect16' href='#toc16'>Commands
in ed</a></h3>
<p>
In the following list of <i>ed</i> commands, the default addresses are shown
in parentheses. The number of addresses shown in the default shall be the
number expected by the command. The parentheses are not part of the address;
they show that the given addresses are the default. <p>
It is generally invalid
for more than one command to appear on a line. However, any command (except
<b>e</b>, <b>E</b>, <b>f</b>, <b>q</b>, <b>Q</b>, <b>r</b>, <b>w</b>, and <b>!</b>) can be suffixed by the letter <b>l</b>, <b>n</b>, or <b>p</b>; in
which case, except for the <b>l</b>, <b>n</b>, and <b>p</b> commands, the command shall be executed
and then the new current line shall be written as described below under
the <b>l</b>, <b>n</b>, and <b>p</b> commands. When an <b>l</b>, <b>n</b>, or <b>p</b> suffix is used with an <b>l</b>, <b>n</b>,
or <b>p</b> command, the command shall write to standard output as described below,
but it is unspecified whether the suffix writes the current line again
in the requested format or whether the suffix has no effect. For example,
the <b>pl</b> command (base <b>p</b> command with an <b>l</b> suffix) shall either write just
the current line or write it twice-once as specified for <b>p</b> and once as specified
for <b>l</b>. Also, the <b>g</b>, <b>G</b>, <b>v</b>, and <b>V</b> commands shall take a command as a parameter.
<p>
Each address component can be preceded by zero or more &lt;blank&gt;s. The command
letter can be preceded by zero or more &lt;blank&gt;s. If a suffix letter ( <b>l</b>, <b>n</b>,
or <b>p</b>) is given, the application shall ensure that it immediately follows
the command. <p>
The <b>e</b>, <b>E</b>, <b>f</b>, <b>r</b>, and <b>w</b> commands shall take an optional <i>file</i>
parameter, separated from the command letter by one or more &lt;blank&gt;s. <p>
If changes
have been made in the buffer since the last <b>w</b> command that wrote the entire
buffer, <i>ed</i> shall warn the user if an attempt is made to destroy the editor
buffer via the <b>e</b> or <b>q</b> commands. The <i>ed</i> utility shall write the string: <p>
<blockquote><br>
<pre>"?\n"

</pre></blockquote>
<p>
(followed by an explanatory message if <i>help mode</i> has been enabled via the
<b>H</b> command) to standard output and shall continue in command mode with the
current line number unchanged. If the <b>e</b> or <b>q</b> command is repeated with no
intervening command, it shall take effect. <p>
If a terminal disconnect is detected:

<dl>

<dt> *</dt>
<dd>If the buffer is not empty and has changed since the last write, the
<i>ed</i> utility shall attempt to write a copy of the buffer to a file named
<b>ed.hup</b> in the current directory. If this write fails, <i>ed</i> shall attempt to
write a copy of the buffer to a filename <b>ed.hup</b> in the directory named by
the <i>HOME</i> environment variable. If both these attempts fail, <i>ed</i> shall exit
without saving the buffer. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>The <i>ed</i> utility shall not write the file to
the currently remembered pathname or return to command mode, and shall
terminate with a non-zero exit status. </dd>
</dl>
<p>
<p>
If an end-of-file is detected on standard
input: 
<dl>

<dt> *</dt>
<dd>If the <i>ed</i> utility is in input mode, <i>ed</i> shall terminate input mode
and return to command mode. It is unspecified if any partially entered lines
(that is, input text without a terminating &lt;newline&gt;) are discarded from
the input text. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>If the <i>ed</i> utility is in command mode, it shall act as
if a <b>q</b> command had been entered. </dd>
</dl>
<p>
<p>
If the closing delimiter of an RE or of
a replacement string (for example, <b>&rsquo;/&rsquo;</b> ) in a <b>g</b>, <b>G</b>, <b>s</b>, <b>v</b>, or <b>V</b> command would
be the last character before a &lt;newline&gt;, that delimiter can be omitted,
in which case the addressed line shall be written. For example, the following
pairs of commands are equivalent: <p>
<blockquote><br>
<pre>s/s1/s2   s/s1/s2/p
g/s1      g/s1/p
?s1       ?s1?

</pre></blockquote>
<p>
If an invalid command is entered, <i>ed</i> shall write the string: <p>
<blockquote><br>
<pre>"?\n"

</pre></blockquote>
<p>
(followed by an explanatory message if <i>help mode</i> has been enabled via the
<b>H</b> command) to standard output and shall continue in command mode with the
current line number unchanged. 
<h3><a name='sect17' href='#toc17'>Append Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.)a
&lt;text&gt;
.

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>a</b> command shall read the given text and append it after the addressed
line; the current line number shall become the address of the last inserted
line or, if there were none, the addressed line. Address 0 shall be valid
for this command; it shall cause the appended text to be placed at the
beginning of the buffer. 
<h3><a name='sect18' href='#toc18'>Change Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.,.)c
&lt;text&gt;
.

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>c</b> command shall delete the addressed lines, then accept input text
that replaces these lines; the current line shall be set to the address
of the last line input; or, if there were none, at the line after the last
line deleted; if the lines deleted were originally at the end of the buffer,
the current line number shall be set to the address of the new last line;
if no lines remain in the buffer, the current line number shall be set
to zero. Address 0 shall be valid for this command; it shall be interpreted
as if address 1 were specified. 
<h3><a name='sect19' href='#toc19'>Delete Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.,.)d

</pre></dd>
</dl>
</blockquote>
<p>
<p>
</b>The <b>d</b> command shall delete the addressed lines from the buffer. The address
of the line after the last line deleted shall become the current line number;
if the lines deleted were originally at the end of the buffer, the current
line number shall be set to the address of the new last line; if no lines
remain in the buffer, the current line number shall be set to zero. 
<h3><a name='sect20' href='#toc20'>Edit
Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>e [file]
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>e</b> command shall delete the entire contents of the buffer and then read
in the file named by the pathname <i>file</i>. The current line number shall be
set to the address of the last line of the buffer. If no pathname is given,
the currently remembered pathname, if any, shall be used (see the <b>f</b> command).
The number of bytes read shall be written to standard output, unless the
<b>-s</b> option was specified, in the following format: <p>
<blockquote><br>
<pre>"%d\n", &lt;number of bytes read&gt;

</pre></blockquote>
<p>
The name <i>file</i> shall be remembered for possible use as a default pathname
in subsequent <b>e</b>, <b>E</b>, <b>r</b>, and <b>w</b> commands. If <i>file</i> is replaced by <b>&rsquo;!&rsquo;</b>, the rest
of the line shall be taken to be a shell command line whose output is to
be read. Such a shell command line shall not be remembered as the current
<i>file</i>. All marks shall be discarded upon the completion of a successful <b>e</b>
command. If the buffer has changed since the last time the entire buffer
was written, the user shall be warned, as described previously. 
<h3><a name='sect21' href='#toc21'>Edit Without
Checking Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>E [file]
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>E</b> command shall possess all properties and restrictions of the <b>e</b> command
except that the editor shall not check to see whether any changes have
been made to the buffer since the last <b>w</b> command. 
<h3><a name='sect22' href='#toc22'>Filename Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>f [file]
</pre></dd>
</dl>
</blockquote>
<p>
<p>
If <i>file</i> is given, the <b>f</b> command shall change the currently remembered pathname
to <i>file</i>; whether the name is changed or not, it shall then write the (possibly
new) currently remembered pathname to the standard output in the following
format: <p>
<blockquote><br>
<pre>"%s\n", &lt;pathname&gt;

</pre></blockquote>
<p>
The current line number shall be unchanged. 
<h3><a name='sect23' href='#toc23'>Global Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(1,$)g/RE/command list
</pre></dd>
</dl>
</blockquote>
<p>
<p>
In the <b>g</b> command, the first step shall be to mark every line for which
the line excluding the terminating &lt;newline&gt; matches the given RE. Then, going
sequentially from the beginning of the file to the end of the file, the
given <i>command list</i> shall be executed for each marked line, with the current
line number set to the address of that line. Any line modified by the <i>command
list</i> shall be unmarked. When the <b>g</b> command completes, the current line number
shall have the value assigned by the last command in the <i>command list</i>. If
there were no matching lines, the current line number shall not be changed.
A single command or the first of a list of commands shall appear on the
same line as the global command. All lines of a multi-line list except the
last line shall be ended with a backslash preceding the terminating &lt;newline&gt;;
the <b>a</b>, <b>i</b>, and <b>c</b> commands and associated input are permitted. The <b>&rsquo;.&rsquo;</b> terminating
input mode can be omitted if it would be the last line of the <i>command list</i>.
An empty <i>command list</i> shall be equivalent to the <b>p</b> command. The use of the
<b>g</b>, <b>G</b>, <b>v</b>, <b>V</b>, and <b>!</b> commands in the <i>command list</i> produces undefined results.
Any character other than &lt;space&gt; or &lt;newline&gt; can be used instead of a slash
to delimit the RE. Within the RE, the RE delimiter itself can be used as
a literal character if it is preceded by a backslash. 
<h3><a name='sect24' href='#toc24'>Interactive Global
Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(1,$)G/RE/

</pre></dd>
</dl>
</blockquote>
<p>
<p>
In the <b>G</b> command, the first step shall be to mark every line for which
the line excluding the terminating &lt;newline&gt; matches the given RE. Then, for
every such line, that line shall be written, the current line number shall
be set to the address of that line, and any one command (other than one
of the <b>a</b>, <b>c</b>, <b>i</b>, <b>g</b>, <b>G</b>, <b>v</b>, and <b>V</b> commands) shall be read and executed. A &lt;newline&gt;
shall act as a null command (causing no action to be taken on the current
line); an <b>&rsquo;&amp;&rsquo;</b> shall cause the re-execution of the most recent non-null command
executed within the current invocation of <b>G</b>. Note that the commands input
as part of the execution of the <b>G</b> command can address and affect any lines
in the buffer. Any line modified by the command shall be unmarked. The final
value of the current line number shall be the value set by the last command
successfully executed. (Note that the last command successfully executed
shall be the <b>G</b> command itself if a command fails or the null command is
specified.) If there were no matching lines, the current line number shall
not be changed. The <b>G</b> command can be terminated by a SIGINT signal. Any character
other than &lt;space&gt; or &lt;newline&gt; can be used instead of a slash to delimit the
RE and the replacement. Within the RE, the RE delimiter itself can be used
as a literal character if it is preceded by a backslash. 
<h3><a name='sect25' href='#toc25'>Help Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>h

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>h</b> command shall write a short message to standard output that explains
the reason for the most recent <b>&rsquo;?&rsquo;</b> notification. The current line number shall
be unchanged. 
<h3><a name='sect26' href='#toc26'>Help-Mode Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>H

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>H</b> command shall cause <i>ed</i> to enter a mode in which help messages (see
the <b>h</b> command) shall be written to standard output for all subsequent <b>&rsquo;?&rsquo;</b>
notifications. The <b>H</b> command alternately shall turn this mode on and off;
it is initially off. If the help-mode is being turned on, the <b>H</b> command also
explains the previous <b>&rsquo;?&rsquo;</b> notification, if there was one. The current line
number shall be unchanged. 
<h3><a name='sect27' href='#toc27'>Insert Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.)i
&lt;text&gt;
.

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>i</b> command shall insert the given text before the addressed line; the
current line is set to the last inserted line or, if there was none, to
the addressed line. This command differs from the <b>a</b> command only in the
placement of the input text. Address 0 shall be valid for this command;
it shall be interpreted as if address 1 were specified. 
<h3><a name='sect28' href='#toc28'>Join Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>(.,.+1)j

</pre></dd>
</dl>
</blockquote>
<p>
<p>
</b>The <b>j</b> command shall join contiguous lines by removing the appropriate &lt;newline&gt;s.
If exactly one address is given, this command shall do nothing. If lines
are joined, the current line number shall be set to the address of the
joined line; otherwise, the current line number shall be unchanged. 
<h3><a name='sect29' href='#toc29'>Mark
Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.)kx
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>k</b> command shall mark the addressed line with name <i>x</i>, which the application
shall ensure is a lowercase letter from the portable character set. The
address <b>"&rsquo;x"</b> shall then refer to this line; the current line number shall
be unchanged. 
<h3><a name='sect30' href='#toc30'>List Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.,.)l

</pre></dd>
</dl>
</blockquote>
<p>
<p>
</b>The <b>l</b> command shall write to standard output the addressed lines in a visually
unambiguous form. The characters listed in the Base Definitions volume of
IEEE&nbsp;Std&nbsp;1003.1-2001, Table 5-1, Escape Sequences and Associated Actions ( <b>&rsquo;\\&rsquo;</b>,
<b>&rsquo;\a&rsquo;</b>, <b>&rsquo;\b&rsquo;</b>, <b>&rsquo;\f&rsquo;</b>, <b>&rsquo;\r&rsquo;</b>, <b>&rsquo;\t&rsquo;</b>, <b>&rsquo;\v&rsquo;</b> ) shall be written as the corresponding escape sequence;
the <b>&rsquo;\n&rsquo;</b> in that table is not applicable. Non-printable characters not in the
table shall be written as one three-digit octal number (with a preceding
backslash character) for each byte in the character (most significant byte
first). If the size of a byte on the system is greater than nine bits, the
format used for non-printable characters is implementation-defined. <p>
Long lines
shall be folded, with the point of folding indicated by &lt;newline&gt; preceded
by a backslash; the length at which folding occurs is unspecified, but
should be appropriate for the output device. The end of each line shall
be marked with a <b>&rsquo;$&rsquo;</b>, and <b>&rsquo;$&rsquo;</b> characters within the text shall be written with
a preceding backslash. An <b>l</b> command can be appended to any other command
other than <b>e</b>, <b>E</b>, <b>f</b>, <b>q</b>, <b>Q</b>, <b>r</b>, <b>w</b>, or <b>!</b>. The current line number shall be set
to the address of the last line written. 
<h3><a name='sect31' href='#toc31'>Move Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.,.)maddress
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>m</b> command shall reposition the addressed lines after the line addressed
by <i>address</i>. Address 0 shall be valid for <i>address</i> and cause the addressed
lines to be moved to the beginning of the buffer. It shall be an error if
address <i>address</i> falls within the range of moved lines. The current line
number shall be set to the address of the last line moved. 
<h3><a name='sect32' href='#toc32'>Number Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>(.,.)n

</pre></dd>
</dl>
</blockquote>
<p>
<p>
</b>The <b>n</b> command shall write to standard output the addressed lines, preceding
each line by its line number and a &lt;tab&gt;; the current line number shall be
set to the address of the last line written. The <b>n</b> command can be appended
to any command other than <b>e</b>, <b>E</b>, <b>f</b>, <b>q</b>, <b>Q</b>, <b>r</b>, <b>w</b>, or <b>!</b>. 
<h3><a name='sect33' href='#toc33'>Print Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>(.,.)p

</pre></dd>
</dl>
</blockquote>
<p>
<p>
</b>The <b>p</b> command shall write to standard output the addressed lines; the current
line number shall be set to the address of the last line written. The <b>p</b>
command can be appended to any command other than <b>e</b>, <b>E</b>, <b>f</b>, <b>q</b>, <b>Q</b>, <b>r</b>, <b>w</b>,
or <b>!</b>. 
<h3><a name='sect34' href='#toc34'>Prompt Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>P

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>P</b> command shall cause <i>ed</i> to prompt with an asterisk ( <b>&rsquo;*&rsquo;</b> ) (or <i>string</i>,
if <b>-p</b> is specified) for all subsequent commands. The <b>P</b> command alternatively
shall turn this mode on and off; it shall be initially on if the <b>-p</b> option
is specified; otherwise, off. The current line number shall be unchanged.

<h3><a name='sect35' href='#toc35'>Quit Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>q

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>q</b> command shall cause <i>ed</i> to exit. If the buffer has changed since the
last time the entire buffer was written, the user shall be warned, as described
previously. 
<h3><a name='sect36' href='#toc36'>Quit Without Checking Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>Q

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>Q</b> command shall cause <i>ed</i> to exit without checking whether changes have
been made in the buffer since the last <b>w</b> command. 
<h3><a name='sect37' href='#toc37'>Read Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>($)r [file]
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>r</b> command shall read in the file named by the pathname <i>file</i> and append
it after the addressed line. If no <i>file</i> argument is given, the currently
remembered pathname, if any, shall be used (see the <b>e</b> and <b>f</b> commands). The
currently remembered pathname shall not be changed unless there is no remembered
pathname. Address 0 shall be valid for <b>r</b> and shall cause the file to be
read at the beginning of the buffer. If the read is successful, and <b>-s</b> was
not specified, the number of bytes read shall be written to standard output
in the following format: <p>
<blockquote><br>
<pre>"%d\n", &lt;number of bytes read&gt;

</pre></blockquote>
<p>
The current line number shall be set to the address of the last line read
in. If <i>file</i> is replaced by <b>&rsquo;!&rsquo;</b>, the rest of the line shall be taken to be
a shell command line whose output is to be read. Such a shell command line
shall not be remembered as the current pathname. 
<h3><a name='sect38' href='#toc38'>Substitute Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>(.,.)s/RE/replacement/flags
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>s</b> command shall search each addressed line for an occurrence of the
specified RE and replace either the first or all (non-overlapped) matched
strings with the <i>replacement</i>; see the following description of the <b>g</b> suffix.
It is an error if the substitution fails on every addressed line. Any character
other than &lt;space&gt; or &lt;newline&gt; can be used instead of a slash to delimit the
RE and the replacement. Within the RE, the RE delimiter itself can be used
as a literal character if it is preceded by a backslash. The current line
shall be set to the address of the last line on which a substitution occurred.
<p>
An ampersand ( <b>&rsquo;&amp;&rsquo;</b> ) appearing in the <i>replacement</i> shall be replaced by the
string matching the RE on the current line. The special meaning of <b>&rsquo;&amp;&rsquo;</b> in this
context can be suppressed by preceding it by backslash. As a more general
feature, the characters <b>&rsquo;\n&rsquo;</b>, where <i>n</i> is a digit, shall be replaced by the
text matched by the corresponding back-reference expression. When the character
<b>&rsquo;%&rsquo;</b> is the only character in the <i>replacement</i>, the <i>replacement</i> used in the
most recent substitute command shall be used as the <i>replacement</i> in the
current substitute command; if there was no previous substitute command,
the use of <b>&rsquo;%&rsquo;</b> in this manner shall be an error. The <b>&rsquo;%&rsquo;</b> shall lose its special
meaning when it is in a replacement string of more than one character or
is preceded by a backslash. For each backslash ( <b>&rsquo;\&rsquo;</b> ) encountered in scanning
<i>replacement</i> from beginning to end, the following character shall lose its
special meaning (if any). It is unspecified what special meaning is given
to any character other than <b>&rsquo;&amp;&rsquo;</b>, <b>&rsquo;\&rsquo;</b>, <b>&rsquo;%&rsquo;</b>, or digits. <p>
A line can be split by substituting
a &lt;newline&gt; into it. The application shall ensure it escapes the &lt;newline&gt; in
the <i>replacement</i> by preceding it by backslash. Such substitution cannot be
done as part of a <b>g</b> or <b>v</b> <i>command list</i>. The current line number shall be
set to the address of the last line on which a substitution is performed.
If no substitution is performed, the current line number shall be unchanged.
If a line is split, a substitution shall be considered to have been performed
on each of the new lines for the purpose of determining the new current
line number. A substitution shall be considered to have been performed even
if the replacement string is identical to the string that it replaces. <p>
The
application shall ensure that the value of <i>flags</i> is zero or more of: 
<dl>

<dt><i>count</i>
</dt>
<dd>Substitute for the <i>count</i>th occurrence only of the RE found on each addressed
line. </dd>

<dt><b>g</b> </dt>
<dd>Globally substitute for all non-overlapping instances of the RE rather
than just the first one. If both <b>g</b> and <i>count</i> are specified, the results
are unspecified. </dd>

<dt><b>l</b> </dt>
<dd>Write to standard output the final line in which a substitution
was made. The line shall be written in the format specified for the <b>l</b> command.
</dd>

<dt><b>n</b> </dt>
<dd>Write to standard output the final line in which a substitution was made.
The line shall be written in the format specified for the <b>n</b> command. </dd>

<dt><b>p</b> </dt>
<dd>Write
to standard output the final line in which a substitution was made. The
line shall be written in the format specified for the <b>p</b> command. <p>
</dd>
</dl>

<h3><a name='sect39' href='#toc39'>Copy Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>(.,.)taddress
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>t</b> command shall be equivalent to the <b>m</b> command, except that a copy
of the addressed lines shall be placed after address <i>address</i> (which can
be 0); the current line number shall be set to the address of the last
line added. 
<h3><a name='sect40' href='#toc40'>Undo Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>u

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>u</b> command shall nullify the effect of the most recent command that
modified anything in the buffer, namely the most recent <b>a</b>, <b>c</b>, <b>d</b>, <b>g</b>, <b>i</b>,
<b>j</b>, <b>m</b>, <b>r</b>, <b>s</b>, <b>t</b>, <b>u</b>, <b>v</b>, <b>G</b>, or <b>V</b> command. All changes made to the buffer by
a <b>g</b>, <b>G</b>, <b>v</b>, or <b>V</b> global command shall be undone as a single change; if no
changes were made by the global command (such as with <b>g</b>/RE/ <b>p</b>), the <b>u</b> command
shall have no effect. The current line number shall be set to the value
it had immediately before the command being undone started. 
<h3><a name='sect41' href='#toc41'>Global Non-Matched
Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(1,$)v/RE/command list
</pre></dd>
</dl>
</blockquote>
<p>
<p>
This command shall be equivalent to the global command <b>g</b> except that the
lines that are marked during the first step shall be those for which the
line excluding the terminating &lt;newline&gt; does not match the RE. 
<h3><a name='sect42' href='#toc42'>Interactive
Global Not-Matched Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(1,$)V/RE/

</pre></dd>
</dl>
</blockquote>
<p>
<p>
This command shall be equivalent to the interactive global command <b>G</b> except
that the lines that are marked during the first step shall be those for
which the line excluding the terminating &lt;newline&gt; does not match the RE.

<h3><a name='sect43' href='#toc43'>Write Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(1,$)w [file]

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The <b>w</b> command shall write the addressed lines into the file named by the
pathname <i>file</i>. The command shall create the file, if it does not exist,
or shall replace the contents of the existing file. The currently remembered
pathname shall not be changed unless there is no remembered pathname. If
no pathname is given, the currently remembered pathname, if any, shall
be used (see the <b>e</b> and <b>f</b> commands); the current line number shall be unchanged.
If the command is successful, the number of bytes written shall be written
to standard output, unless the <b>-s</b> option was specified, in the following
format: <p>
<blockquote><br>
<pre>"%d\n", &lt;number of bytes written&gt;

</pre></blockquote>
<p>
If <i>file</i> begins with <b>&rsquo;!&rsquo;</b>, the rest of the line shall be taken to be a shell
command line whose standard input shall be the addressed lines. Such a shell
command line shall not be remembered as the current pathname. This usage
of the write command with <b>&rsquo;!&rsquo;</b> shall not be considered as a "last <b>w</b> command
that wrote the entire buffer", as described previously; thus, this alone
shall not prevent the warning to the user if an attempt is made to destroy
the editor buffer via the <b>e</b> or <b>q</b> commands. 
<h3><a name='sect44' href='#toc44'>Line Number Command</a></h3>

<dl>

<dt><i>Synopsis</i>:
</dt>
<dd><p>
<blockquote><br>
<pre>($)=

</pre></dd>
</dl>
</blockquote>
<p>
<p>
The line number of the addressed line shall be written to standard output
in the following format: <p>
<blockquote><br>
<pre>"%d\n", &lt;line number&gt;

</pre></blockquote>
<p>
The current line number shall be unchanged by this command. 
<h3><a name='sect45' href='#toc45'>Shell Escape
Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>!command
</pre></dd>
</dl>
</blockquote>
<p>
<p>
The remainder of the line after the <b>&rsquo;!&rsquo;</b> shall be sent to the command interpreter
to be interpreted as a shell command line. Within the text of that shell
command line, the unescaped character <b>&rsquo;%&rsquo;</b> shall be replaced with the remembered
pathname; if a <b>&rsquo;!&rsquo;</b> appears as the first character of the command, it shall
be replaced with the text of the previous shell command executed via <b>&rsquo;!&rsquo;</b>
. Thus, <b>"!!"</b> shall repeat the previous !<i>command</i>. If any replacements of <b>&rsquo;%&rsquo;</b>
or <b>&rsquo;!&rsquo;</b> are performed, the modified line shall be written to the standard
output before <i>command</i> is executed. The <b>!</b> command shall write: <p>
<blockquote><br>
<pre>"!\n"

</pre></blockquote>
<p>
to standard output upon completion, unless the <b>-s</b> option is specified. The
current line number shall be unchanged. 
<h3><a name='sect46' href='#toc46'>Null Command</a></h3>

<dl>

<dt><i>Synopsis</i>: </dt>
<dd><p>
<blockquote><br>
<pre>(.+1)

</pre></dd>
</dl>
</blockquote>
<p>
<p>
An address alone on a line shall cause the addressed line to be written.
A &lt;newline&gt; alone shall be equivalent to <b>"+1p"</b> . The current line number shall
be set to the address of the written line. 
<h2><a name='sect47' href='#toc47'>Exit Status</a></h2>
<p>
The following exit
values shall be returned: 
<ol>
&nbsp;<li>Successful completion without any file or command
errors. </dd>

<dt>&gt;0 </dt>
<dd>An error occurred. <p>
</dd>
</dl>

<h2><a name='sect48' href='#toc48'>Consequences of Errors</a></h2>
<p>
When an error in the input
script is encountered, or when an error is detected that is a consequence
of the data (not) present in the file or due to an external condition such
as a read or write error: 
<dl>

<dt> *</dt>
<dd>If the standard input is a terminal device
file, all input shall be flushed, and a new command read. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>If the standard
input is a regular file, <i>ed</i> shall terminate with a non-zero exit status.
</dd>
</dl>
<p>
<p>
<i>The following sections are informative.</i> 
<h2><a name='sect49' href='#toc49'>Application Usage</a></h2>
<p>
Because of the
extremely terse nature of the default error messages, the prudent script
writer begins the <i>ed</i> input commands with an <b>H</b> command, so that if any errors
do occur at least some clue as to the cause is made available. <p>
In previous
versions, an obsolescent <b>-</b> option was described. This is no longer specified.
Applications should use the <b>-s</b> option. Using <b>-</b> as a <i>file</i> operand now produces
unspecified results. This allows implementations to continue to support
the former required behavior. 
<h2><a name='sect50' href='#toc50'>Examples</a></h2>
<p>
None. 
<h2><a name='sect51' href='#toc51'>Rationale</a></h2>
<p>
The initial description
of this utility was adapted from the SVID. It contains some features not
found in Version 7 or BSD-derived systems. Some of the differences between
the POSIX and BSD <i>ed</i> utilities include, but need not be limited to: 
<dl>

<dt> *</dt>
<dd>The
BSD <b>-</b> option does not suppress the <b>&rsquo;!&rsquo;</b> prompt after a <b>!</b> command. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD does
not support the special meanings of the <b>&rsquo;%&rsquo;</b> and <b>&rsquo;!&rsquo;</b> characters within a <b>!</b> command.
</dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD does not support the <i>addresses</i> <b>&rsquo;;&rsquo;</b> and <b>&rsquo;,&rsquo;</b> . </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD allows the command/suffix
pairs <b>pp</b>, <b>ll</b>, and so on, which are unspecified in this volume of IEEE&nbsp;Std&nbsp;1003.1-2001.
</dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD does not support the <b>&rsquo;!&rsquo;</b> character part of the <b>e</b>, <b>r</b>, or <b>w</b> commands.
</dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>A failed <b>g</b> command in BSD sets the line number to the last line searched
if there are no matches. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD does not default the <i>command list</i> to the
<b>p</b> command. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD does not support the <b>G</b>, <b>h</b>, <b>H</b>, <b>n</b>, or <b>V</b> commands. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>On BSD,
if there is no inserted text, the insert command changes the current line
to the referenced line -1; that is, the line before the specified line. </dd>
</dl>
<p>

<dl>

<dt>
*</dt>
<dd>On BSD, the <i>join</i> command with only a single address changes the current
line to that address. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD does not support the <b>P</b> command; moreover, in
BSD it is synonymous with the <b>p</b> command. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>BSD does not support the <i>undo</i>
of the commands <b>j</b>, <b>m</b>, <b>r</b>, <b>s</b>, or <b>t</b>. </dd>
</dl>
<p>

<dl>

<dt> *</dt>
<dd>The Version 7 <i>ed</i> command <b>W</b>, and the
BSD <i>ed</i> commands <b>W</b>, <b>wq</b>, and <b>z</b> are not present in this volume of IEEE&nbsp;Std&nbsp;1003.1-2001.
</dd>
</dl>
<p>
<p>
The <b>-s</b> option was added to allow the functionality of the now withdrawn
<b>-</b> option in a manner compatible with the Utility Syntax Guidelines. <p>
In early
proposals there was a limit, {ED_FILE_MAX}, that described the historical
limitations of some <i>ed</i> utilities in their handling of large files; some
of these have had problems with files larger than 100000 bytes. It was this
limitation that prompted much of the desire to include a <i>split</i> command
in this volume of IEEE&nbsp;Std&nbsp;1003.1-2001. Since this limit was removed, this volume
of IEEE&nbsp;Std&nbsp;1003.1-2001 requires that implementations document the file size
limits imposed by <i>ed</i> in the conformance document. The limit {ED_LINE_MAX}
was also removed; therefore, the global limit {LINE_MAX} is used for input
and output lines. <p>
The manner in which the <b>l</b> command writes non-printable
characters was changed to avoid the historical backspace-overstrike method.
On video display terminals, the overstrike is ambiguous because most terminals
simply replace overstruck characters, making the <b>l</b> format not useful for
its intended purpose of unambiguously understanding the content of the
line. The historical backslash escapes were also ambiguous. (The string <b>"a\0011"</b>
could represent a line containing those six characters or a line containing
the three characters <b>&rsquo;a&rsquo;</b>, a byte with a binary value of 1, and a 1.) In the
format required here, a backslash appearing in the line is written as <b>"\\"</b>
so that the output is truly unambiguous. The method of marking the ends
of lines was adopted from the <i>ex</i> editor and is required for any line ending
in &lt;space&gt;s; the <b>&rsquo;$&rsquo;</b> is placed on all lines so that a real <b>&rsquo;$&rsquo;</b> at the end of
a line cannot be misinterpreted. <p>
Systems with bytes too large to fit into
three octal digits must devise other means of displaying non-printable characters.
Consideration was given to requiring that the number of octal digits be
large enough to hold a byte, but this seemed to be too confusing for applications
on the vast majority of systems where three digits are adequate. It would
be theoretically possible for the application to use the <i>getconf</i> utility
to find out the CHAR_BIT value and deal with such an algorithm; however,
there is really no portable way that an application can use the octal values
of the bytes across various coded character sets, so the additional specification
was not worthwhile. <p>
The description of how a NUL is written was removed.
The NUL character cannot be in text files, and this volume of IEEE&nbsp;Std&nbsp;1003.1-2001
should not dictate behavior in the case of undefined, erroneous input. <p>
Unlike
some of the other editing utilities, the filenames accepted by the <b>E</b>, <b>e</b>,
<b>R</b>, and <b>r</b> commands are not patterns. <p>
Early proposals stated that the <b>-p</b> option
worked only when standard input was associated with a terminal device. This
has been changed to conform to historical implementations, thereby allowing
applications to interpose themselves between a user and the <i>ed</i> utility.
<p>
The form of the substitute command that uses the <b>n</b> suffix was limited in
some historical documentation (where this was described incorrectly as
"backreferencing"). This limit has been omitted because there is no reason
why an editor processing lines of {LINE_MAX} length should have this restriction.
The command <b>s/x/X/2047</b> should be able to substitute the 2047th occurrence
of <b>&rsquo;x&rsquo;</b> on a line. <p>
The use of printing commands with printing suffixes (such
as <b>pn</b>, <b>lp</b>, and so on) was made unspecified because BSD-based systems allow
this, whereas System V does not. <p>
Some BSD-based systems exit immediately
upon receipt of end-of-file if all of the lines in the file have been deleted.
Since this volume of IEEE&nbsp;Std&nbsp;1003.1-2001 refers to the <b>q</b> command in this instance,
such behavior is not allowed. <p>
Some historical implementations returned exit
status zero even if command errors had occurred; this is not allowed by
this volume of IEEE&nbsp;Std&nbsp;1003.1-2001. <p>
Some historical implementations contained
a bug that allowed a single period to be entered in input mode as &lt;backslash&gt;
&lt;period&gt; &lt;newline&gt;. This is not allowed by <i>ed</i> because there is no description
of escaping any of the characters in input mode; backslashes are entered
into the buffer exactly as typed. The typical method of entering a single
period has been to precede it with another character and then use the substitute
command to delete that character. <p>
It is difficult under some modes of some
versions of historical operating system terminal drivers to distinguish
between an end-of-file condition and terminal disconnect. IEEE&nbsp;Std&nbsp;1003.1-2001
does not require implementations to distinguish between the two situations,
which permits historical implementations of the <i>ed</i> utility on historical
platforms to conform. Implementations are encouraged to distinguish between
the two, if possible, and take appropriate action on terminal disconnect.
<p>
Historically, <i>ed</i> accepted a zero address for the <b>a</b> and <b>r</b> commands in order
to insert text at the start of the edit buffer. When the buffer was empty
the command <b>.=</b> returned zero. IEEE&nbsp;Std&nbsp;1003.1-2001 requires conformance to historical
practice. <p>
For consistency with the <b>a</b> and <b>r</b> commands and better user functionality,
the <b>i</b> and <b>c</b> commands must also accept an address of 0, in which case 0<i>i</i>
is treated as 1<i>i</i> and likewise for the <b>c</b> command. <p>
All of the following are
valid addresses: 
<dl>

<dt><b>+++</b> </dt>
<dd>Three lines after the current line. </dd>

<dt><b>/</b><i>pattern</i><b>/-</b> </dt>
<dd>One line
before the next occurrence of pattern. </dd>

<dt><b>-2</b> </dt>
<dd>Two lines before the current line.
</dd>

<dt><b>3&nbsp;----&nbsp;2</b> </dt>
<dd>Line one (note the intermediate negative address). </li><b>&nbsp;&nbsp;</b><li>Line six. <p>
</li>
</ol>
<p>
Any number
of addresses can be provided to commands taking addresses; for example,
<b>"1,2,3,4,5p"</b> prints lines 4 and 5, because two is the greatest valid number
of addresses accepted by the <b>print</b> command. This, in combination with the
semicolon delimiter, permits users to create commands based on ordered
patterns in the file. For example, the command <b>"3;/foo/;+2p"</b> will display
the first line after line 3 that contains the pattern <i>foo</i>, plus the next
two lines. Note that the address <b>"3;"</b> must still be evaluated before being
discarded, because the search origin for the <b>"/foo/"</b> command depends on
this. <p>
Historically, <i>ed</i> disallowed address chains, as discussed above, consisting
solely of comma or semicolon separators; for example, <b>",,,"</b> or <b>";;;"</b> were
considered an error. For consistency of address specification, this restriction
is removed. The following table lists some of the address forms now possible:
<center><table border='0'>
<tr><td align='left'>7;9</td><td align='left'>7</td><td align='left'>9</td><td align='left'>Historical</td><td align='left'></td></tr>
<tr><td align='left'>&nbsp;7;+</td><td align='left'>7</td><td align='left'>8</td><td align='left'>Historical</td><td align='left'></td></tr>
<tr><td align='left'>&nbsp;;</td><td align='left'>.</td><td align='left'>$</td><td align='left'>Historical</td><td align='left'></td></tr>
<tr><td align='left'>&nbsp;;7</td><td align='left'>.</td><td align='left'>7</td><td align='left'>Extension</td><td align='left'></td></tr>
<tr><td align='left'>&nbsp;;;</td><td align='left'>$</td><td align='left'>$</td><td align='left'>Extension</td><td align='left'></td></tr>
<tr><td align='left'>&nbsp;;,</td><td align='left'>$</td><td align='left'>$</td><td align='left'>Extension</td><td align='left'></td></tr>
</table>
</center><p>
&nbsp;Historically,
values could be added to addresses by including them after one or more
&lt;blank&gt;s; for example, <b>"3&nbsp;-&nbsp;5p"</b> wrote the seventh line of the file, and <b>"/foo/&nbsp;5"</b>
was the same as <b>"5&nbsp;/foo/"</b> . However, only absolute values could be added;
for example, <b>"5&nbsp;/foo/"</b> was an error. IEEE&nbsp;Std&nbsp;1003.1-2001 requires conformance
to historical practice. <p>
Historically, <i>ed</i> accepted the <b>&rsquo;^&rsquo;</b> character as an address,
in which case it was identical to the hyphen character. IEEE&nbsp;Std&nbsp;1003.1-2001
does not require or prohibit this behavior. 
<h2><a name='sect52' href='#toc52'>Future Directions</a></h2>
<p>
None. 
<h2><a name='sect53' href='#toc53'>See Also</a></h2>
<p>
<i>Utility
Description Defaults</i>, <i>ex</i>, <i>sed</i>, <i>sh</i>, <i>vi</i> 
<h2><a name='sect54' href='#toc54'>Copyright</a></h2>
Portions of this text are
reprinted and reproduced in electronic form from IEEE Std 1003.1, 2003 Edition,
Standard for Information Technology -- Portable Operating System Interface
(POSIX), The Open Group Base Specifications Issue 6, Copyright (C) 2001-2003
by the Institute of Electrical and Electronics Engineers, Inc and The Open
Group. In the event of any discrepancy between this version and the original
IEEE and The Open Group Standard, the original IEEE and The Open Group
Standard is the referee document. The original Standard can be obtained
online at <a href='http://www.opengroup.org/unix/online.html'>http://www.opengroup.org/unix/online.html</a>
 . <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Prolog</a></li>
<li><a name='toc1' href='#sect1'>Name</a></li>
<li><a name='toc2' href='#sect2'>Synopsis</a></li>
<li><a name='toc3' href='#sect3'>Description</a></li>
<li><a name='toc4' href='#sect4'>Options</a></li>
<li><a name='toc5' href='#sect5'>Operands</a></li>
<li><a name='toc6' href='#sect6'>Stdin</a></li>
<li><a name='toc7' href='#sect7'>Input Files</a></li>
<li><a name='toc8' href='#sect8'>Environment Variables</a></li>
<li><a name='toc9' href='#sect9'>Asynchronous Events</a></li>
<li><a name='toc10' href='#sect10'>Stdout</a></li>
<li><a name='toc11' href='#sect11'>Stderr</a></li>
<li><a name='toc12' href='#sect12'>Output Files</a></li>
<li><a name='toc13' href='#sect13'>Extended Description</a></li>
<ul>
<li><a name='toc14' href='#sect14'>Regular Expressions in ed</a></li>
<li><a name='toc15' href='#sect15'>Addresses in ed</a></li>
<li><a name='toc16' href='#sect16'>Commands in ed</a></li>
<li><a name='toc17' href='#sect17'>Append Command</a></li>
<li><a name='toc18' href='#sect18'>Change Command</a></li>
<li><a name='toc19' href='#sect19'>Delete Command</a></li>
<li><a name='toc20' href='#sect20'>Edit Command</a></li>
<li><a name='toc21' href='#sect21'>Edit Without Checking Command</a></li>
<li><a name='toc22' href='#sect22'>Filename Command</a></li>
<li><a name='toc23' href='#sect23'>Global Command</a></li>
<li><a name='toc24' href='#sect24'>Interactive Global Command</a></li>
<li><a name='toc25' href='#sect25'>Help Command</a></li>
<li><a name='toc26' href='#sect26'>Help-Mode Command</a></li>
<li><a name='toc27' href='#sect27'>Insert Command</a></li>
<li><a name='toc28' href='#sect28'>Join Command</a></li>
<li><a name='toc29' href='#sect29'>Mark Command</a></li>
<li><a name='toc30' href='#sect30'>List Command</a></li>
<li><a name='toc31' href='#sect31'>Move Command</a></li>
<li><a name='toc32' href='#sect32'>Number Command</a></li>
<li><a name='toc33' href='#sect33'>Print Command</a></li>
<li><a name='toc34' href='#sect34'>Prompt Command</a></li>
<li><a name='toc35' href='#sect35'>Quit Command</a></li>
<li><a name='toc36' href='#sect36'>Quit Without Checking Command</a></li>
<li><a name='toc37' href='#sect37'>Read Command</a></li>
<li><a name='toc38' href='#sect38'>Substitute Command</a></li>
<li><a name='toc39' href='#sect39'>Copy Command</a></li>
<li><a name='toc40' href='#sect40'>Undo Command</a></li>
<li><a name='toc41' href='#sect41'>Global Non-Matched Command</a></li>
<li><a name='toc42' href='#sect42'>Interactive Global Not-Matched Command</a></li>
<li><a name='toc43' href='#sect43'>Write Command</a></li>
<li><a name='toc44' href='#sect44'>Line Number Command</a></li>
<li><a name='toc45' href='#sect45'>Shell Escape Command</a></li>
<li><a name='toc46' href='#sect46'>Null Command</a></li>
</ul>
<li><a name='toc47' href='#sect47'>Exit Status</a></li>
<li><a name='toc48' href='#sect48'>Consequences of Errors</a></li>
<li><a name='toc49' href='#sect49'>Application Usage</a></li>
<li><a name='toc50' href='#sect50'>Examples</a></li>
<li><a name='toc51' href='#sect51'>Rationale</a></li>
<li><a name='toc52' href='#sect52'>Future Directions</a></li>
<li><a name='toc53' href='#sect53'>See Also</a></li>
<li><a name='toc54' href='#sect54'>Copyright</a></li>
</ul>
</body>
</html>
